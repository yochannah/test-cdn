!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.imtables=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(){var b,d,e,f,g,h,i;f=a("es6-promise").Promise,i=a("underscore"),b=a("jquery"),e=a("./options"),d={server:"http://cdn.intermine.org",imtables:"/js/intermine/im-tables/2.0.0-beta/",tests:{fontawesome:/font-awesome/,glyphicons:/bootstrap-icons/},resources:{prettify:["/js/google-code-prettify/latest/prettify.js"],d3:"/js/d3/3.0.6/d3.v3.min.js",glyphicons:"/css/bootstrap/2.3.2/css/bootstrap-icons.css",fontawesome:"/css/font-awesome/4.x/css/font-awesome.min.css",filesaver:"/js/filesaver.js/FileSaver.min.js"}},e.set("CDN",d),g=function(a){var b;return null==a?!1:(b=i.asArray(document.querySelectorAll('link[rel="stylesheet"]')),i.any(b,function(b){return a.test(b.href)}))},h=function(a){return function(c,d){var e,h,j;return j=new f(function(a){return i.delay(a,50,!0)}),/\.css$/.test(c)?g(d)?j:(h=b('<link type="text/css" rel="stylesheet">'),h.appendTo("head").attr({href:a+c}),j):(e=b.ajax({url:a+c,cache:!0,dataType:"script"}),e.then(function(){return j}))}},c.load=function(a){var b,c,d,g,j;return g=e.get("CDN.server"),c=e.get(["CDN","resources",a]),j=e.get(["CDN","tests",a]),d=h(g),c?i.isArray(c)?f.all(function(){var a,e,f;for(f=[],a=0,e=c.length;e>a;a++)b=c[a],f.push(d(b));return f}()):d(c,j):f.reject("No resource is configured for "+a)}}).call(this)},{"./options":63,"es6-promise":281,jquery:309,underscore:312}],2:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h=[].slice;c=a("backbone"),e=function(a){return!a},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.destroyed=!1,b.prototype.toggle=function(a){return this.swap(a,e)},b.prototype.swap=function(a,b){return this.set(a,b(this.get(a)))},b.prototype.toJSON=function(){return this.destroyed?"DESTROYED":b.__super__.toJSON.apply(this,arguments)},b.prototype.destroy=function(){return this.destroyed?void 0:(this.stopListening(),this.destroyed=!0,this.trigger("destroy",this,this.collection),this._frozen=[],this.clear(),this.off())},b.prototype._frozen=[],b.prototype._validate=function(a,c){var d,e,f,g,h;for(h=this._frozen,f=0,g=h.length;g>f;f++)if(e=h[f],e in a&&a[e]!==this.get(e)){if(d=""+e+" is frozen (trying to set it to "+a[e]+" - is "+this.get(e)+")",!c.merge)throw new Error(d);a[e]=this.get(e)}return b.__super__._validate.apply(this,arguments)},b.prototype.freeze=function(){var a;return a=1<=arguments.length?h.call(arguments,0):[],this._frozen=this._frozen.concat(a),this},b}(c.Model)}).call(this)},{backbone:232}],3:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u={}.hasOwnProperty,v=function(a,b){function c(){this.constructor=a}for(var d in b)u.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},w=[].slice;a("./shim"),d=a("backbone"),t=a("underscore"),c=a("jquery"),e=a("./core-model"),j=a("./messages"),k=a("./templates"),h=a("./icons"),g=a("./event"),m=a("./templates/helpers"),s=a("./utils/on-change"),i=k.template("progress-bar")({doneness:1}),n=0,l=function(){return n++},p=function(){return r.call(this,"model")},q=function(){return r.call(this,"state")},o=function(){return r.call(this,"collection")},r=function(a){var b,c,d,e;if(b=t.result(this,""+a+"Events"),t.size(b)){if(null==this[a])throw new Error("Cannot listen to "+a+" - it is null.");e=[];for(c in b){if(d=b[c],d=t.isFunction(d)?d:this[d],null==d)throw new Error("No handler for "+a+":"+c);e.push(this.listenTo(this[a],c,d))}return e}},b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var d;return v(b,a),b.include=function(a){return t.extend(this.prototype,a)},b.prototype.hasOwnModel=!0,b.prototype.parameters=[],b.prototype.optionalParameters=[],b.prototype.parameterTypes={},b.prototype.initState=function(){},b.prototype.initialize=function(a){var b,c,d,f,g,i,j,k,l;for(null==a&&(a={}),this.state=a.state,f=null!=(j=t.result(this,"parameters"))?j:[],c=null!=(k=t.result(this,"optionalParameters"))?k:[],t.extend(this,t.pick.apply(t,[a].concat(w.call(f)))),g=0,i=c.length;i>g;g++)d=c[g],null!=a[d]&&(this[d]=a[d]);return this.children={},b=this.Model||e,null!=(null!=(l=this.model)?l.toJSON:void 0)&&(this.hasOwnModel=!1),null==this.model&&(this.model=new b),null==this.model.toJSON&&(this.model=new b(this.model)),null==this.state&&(this.state=new e),null==this.state.toJSON&&(this.state=new e(this.state)),null!=this.RERENDER_EVENT&&this.listenTo(this.model,this.RERENDER_EVENT,this.reRender),this.on("rendering",this.preRender),this.on("rendered",this.postRender),this.assertInvariants(),this.initState(),p.call(this),q.call(this),o.call(this),this.listenTo(h,this.ICONS,function(){return this.template?this.reRender():void 0}),this.listenTo(this.model,"destroy",function(){return this.remove()})},b.prototype.ICONS="change",b.prototype.stopListeningTo=function(a){return this.stopListening(a)},b.prototype.renderRequires=[],b.prototype.modelEvents={},b.prototype.stateEvents={},b.prototype.collectionEvents={},b.prototype.listenForChange=function(){var a,b,c;if(a=arguments[0],b=arguments[1],c=3<=arguments.length?w.call(arguments,2):[],!(null!=c?c.length:void 0))throw new Error("No properties listed");return this.listenTo(a,s(c),b)},b.prototype.renderError=function(a){return renderError(this.el)(a)},b.prototype.helpers=function(){return t.extend({IndeterminateProgressBar:i},m)},b.prototype.getBaseData=function(){var a;return m=t.result(this,"helpers"),a=t.result(this,"labels"),t.extend({state:this.state.toJSON(),Messages:j,Icons:h,labels:a},m)},b.prototype.getData=function(){var a,b;return t.extend(this.getBaseData(),this.model.toJSON(),{collection:null!=(a=null!=(b=this.collection)?b.toJSON():void 0)?a:[]})},b.prototype.reRender=function(){return this.rendered&&!this.removed&&this.render(),this},b.prototype.postRender=function(){},b.prototype.preRender=function(){},d=function(a,b){return t.all(b,function(b){return a.has(b)})},b.prototype.onRenderError=function(a){return console.error("RENDER FAILED",this,a),this.state.set({error:a})},b.prototype.render=function(){var a,b,c,e;if(!this.removed){if(e=t.result(this,"renderRequires"),(null!=e?e.length:void 0)&&!d(this.model,e))return b=s(e),this.listenToOnce(this.model,b,this.render),this;if(c=new g(this.rendered),this.trigger("rendering",c),c.cancelled)return this;if(this.removeAllChildren(),null!=this.template)try{this.$el.html(this.template(this.getData()))}catch(f){a=f,this.onRenderError(a)}return this.renderChildren(),this.trigger("rendered",this.rendered=!0),this}},b.prototype.renderChildren=function(){},b.prototype.renderChild=function(a,b,c,d){if(null==c&&(c=this.el),null==d&&(d="append"),null==a&&(a=l()),this.removeChild(a),this.children[a]=b,null==b)return this;switch(d){case"append":b.$el.appendTo(c);break;case"prepend":b.$el.prependTo(c);break;case"at":b.setElement(c[0]||c);break;default:throw new Error("Unknown position: "+d)}return b.render(),this},b.prototype.renderChildAt=function(a,b,c){return null==c&&(c=this.$(a)),this.renderChild(a,b,c,"at")},b.prototype.removeChild=function(a){var b;return null!=(b=this.children[a])&&b.remove(),delete this.children[a]},b.prototype.removeAllChildren=function(){var a,b,c,d,e;if(null!=this.children){for(d=t.keys(this.children),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.removeChild(a));return e}},b.prototype.removed=!1,b.prototype.remove=function(){return this.removed?void 0:(this.stopListening(),this.removed=!0,this.$el.parent().trigger("childremoved",this),this.trigger("remove",this),this.hasOwnModel&&this.model.destroy(),this.removeAllChildren(),this.off(),b.__super__.remove.apply(this,arguments),this)},b.prototype.make=function(a,b,d){var e,f,g,h,i,j,k;if(f=document.createElement(a),e=c(f),null!=b)for(g in b)h=b[g],"class"===g||"className"===g?e.addClass(h):e.attr(g,h);if(null!=d)if(t.isArray(d))for(j=0,k=d.length;k>j;j++)i=d[j],e.append(i);else e.append(d);return f},b.prototype.invariants=function(){return{}},b.prototype.assertInvariant=function(a,b){if(!a)throw new Error(b)},b.prototype.assertInvariants=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(g=null!=(n=t.result(this,"parameters"))?n:[],d=null!=(o=t.result(this,"optionalParameters"))?o:[],f=null!=(p=t.result(this,"parameterTypes"))?p:{},j=0,l=g.length;l>j;j++)e=g[j],i=this[e],this.assertInvariant(null!=i,"Missing required option: "+e);for(q=g.concat(d),k=0,m=q.length;m>k;k++)e=q[k],h=f[e],null!=h&&(i=this[e],a=h.test(i),c=h.message(e),this.assertInvariant(a,c));r=this.invariants(),s=[];for(b in r)c=r[b],s.push(this.assertInvariant(t.result(this,b),c));return s},b}(d.View)}).call(this)},{"./core-model":2,"./event":11,"./icons":14,"./messages":16,"./shim":66,"./templates":67,"./templates/helpers":68,"./utils/on-change":93,backbone:232,jquery:309,underscore:312}],4:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-view"),f=a("../templates"),e=a("../messages"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype["class"]="checkbox",b.prototype.template=f.template("checkbox"),b.prototype.getData=function(){return{checked:this.checked(),label:this.label?e.getText(this.label):null}},b.prototype.initialize=function(a){return this.attr=a.attr,this.label=a.label,b.__super__.initialize.apply(this,arguments)},b.prototype.checked=function(){return this.model.get(this.attr)},b.prototype.toggle=function(a){return null!=a&&a.stopPropagation(),this.model.toggle(this.attr)},b.prototype.events=function(){return{click:"toggle"}},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.attr]=this.setCheckboxState,a},b.prototype.setCheckboxState=function(){return null==this.cb&&(this.cb=this.$("input")[0]),this.cb.checked=this.model.get(this.attr)},b}(d)}).call(this)},{"../core-view":3,"../messages":16,"../templates":67}],5:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),e=a("../core-model"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.model=e,b.prototype.close=function(){var a;for(this.trigger("close",this),this.off();a=this.pop();)a.collection===this&&(delete a.collection,a.destroy());return this.reset(),this.stopListening()},b}(c.Collection)}).call(this)},{"../core-model":2,backbone:232}],6:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../core-view"),e=a("../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="input-group",b.prototype.template=e.template("input-with-button"),b.prototype.getData=function(){return f.extend(this.getBaseData(),{value:this.model.get(this.sets),placeholder:this.placeholder,button:this.button})},b.prototype.initialize=function(a){return this.placeholder=a.placeholder,this.button=a.button,this.sets=a.sets,b.__super__.initialize.apply(this,arguments),null!=this.sets?this.sets:this.sets="value"},b.prototype.postRender=function(){return this.$el.addClass(this.className)},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.sets]=this.setDomValue,a},b.prototype.events=function(){return{"keyup input":"setModelValue","click button":"act"}},b.prototype.setModelValue=function(a){return this.model.set(this.sets,a.target.value)},b.prototype.setDomValue=function(){var a,b,c;return c=this.model.get(this.sets),a=this.$("input"),b=a.val(),b!==c?a.val(c):void 0},b.prototype.act=function(){return this.trigger("act",this.model.get(this.sets))},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:312}],7:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../core-view"),e=a("../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="form-group",b.prototype.template=e.template("input-with-label"),b.prototype.parameters=function(){return["attr","placeholder","label"]},b.prototype.optionalParameters=function(){return["getProblem","helpMessage"]},b.prototype.getProblem=function(a){return null},b.prototype.helpMessage=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.setValidity()},b.prototype.setValidity=function(){return this.state.set({problem:this.getProblem(this.model.get(this.attr))})},b.prototype.getData=function(){return f.extend(this.getBaseData(),{value:this.model.get(this.attr),label:this.label,placeholder:this.placeholder,helpMessage:this.helpMessage,hasProblem:this.state.get("problem")})},b.prototype.postRender=function(){return this.$el.addClass(this.className),this.onChangeValidity()},b.prototype.events=function(){return{"keyup input":"setModelValue"}},b.prototype.stateEvents=function(){return{"change:problem":this.onChangeValidity}},b.prototype.modelEvents=function(){var a;return a={},a["change:"+this.attr]=this.onChangeValue,a},b.prototype.onChangeValue=function(){return this.setValidity(),this.setDOMValue()},b.prototype.onChangeValidity=function(){var a,b;return b=this.state.get("problem"),a=this.$(".help-block"),b?(this.$el.toggleClass("has-warning","warning"===b.level),this.$el.toggleClass("has-error","warning"!==b.level),null!=b.message&&a.text(Messages.getText(b.message)),a.slideDown()):(this.$el.removeClass("has-warning has-error"),a.slideUp())},b.prototype.setModelValue=function(a){return this.model.set(this.attr,this.$(a.target).val())},b.prototype.setDOMValue=function(){var a,b,c;return a=this.$("input"),b=a.val(),c=this.model.get(this.attr),c!==b?a.val(c):void 0},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:312}],8:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k=[].slice;h=a("underscore"),c=a("../core-model"),f=function(a,b){return h.extend({},h.isObject(a)?a:{},b)},g=function(a,b){var c;return c=a[b],h.isObject(c)?c:a[b]={}},e=function(a){return h.isObject(a)&&!h.isFunction(a)&&!h.isArray(a)},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype._triggerChangeRecursively=function(a,b){var c,d,e,f;f=[];for(c in b)e=b[c],d=""+a+"."+c,h.isObject(e)?f.push(this._triggerChangeRecursively(d,e)):f.push(this.trigger("change:"+d,this,this.get(d)));return f},b.prototype.get=function(a){var c,d;return h.isArray(a)?(c=a[0],d=2<=a.length?k.call(a,1):[],d.reduce(function(a,b){return a&&a[b]},b.__super__.get.call(this,c))):/\w+\.\w+/.test(a)?this.get(a.split(/\./)):b.__super__.get.call(this,a)},b.prototype.pick=function(){var a;return a=1<=arguments.length?k.call(arguments,0):[],h.object(h.flatten(a).map(function(a){return function(b){return[b,a.get(b)]}}(this)))},b.prototype._triggerPathChange=function(a,b){var c,d,e,f,g;for(c=[],this.trigger("change",this,a.join("."),b),g=[],e=0,f=a.length;f>e;e++)d=a[e],c.push(d),g.push(this.trigger("change:"+c.join("."),this,this.get(c)));return g},b.prototype._triggerUnsetPath=function(a,b){var c,d,e;if(h.isObject(b)){e=[];for(c in b)d=b[c],e.push(this._triggerUnsetPath(a.concat([c]),d));return e}return this.trigger("change:"+a.join("."))},b.prototype.set=function(a,c){var d,f,i,j,l,m,n,o,p,q,r;if(null==a)throw new Error("No key");if(!h.isArray(a)){if(h.isString(a))return/\w+\.\w+/.test(a)?this.set(a.split(/\./),c):h.isObject(c)&&!h.isArray(c)?this.set([a],c):b.__super__.set.apply(this,arguments);r=[];for(l in a)p=a[l],r.push(this.set(l,p));return r}{if(!e(c))return i=a[0],m=3<=a.length?k.call(a,1,q=a.length-1):(q=1,[]),f=a[q++],j=this.get(i),!j||!h.isFunction(j)&&h.isObject(j)||this.unset(i),o=null!=j?j:{},d=m.reduce(g,o),n=d[f],d[f]=c,b.__super__.set.call(this,i,o),this._triggerPathChange(a,c),null!=n&&null==c?this._triggerUnsetPath(a,n):void 0;for(l in c)p=c[l],this.set(a.concat([l]),p)}},b}(c)}).call(this)},{"../core-model":2,underscore:312}],9:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),e=a("../templates"),c=a("./input-with-label"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.parameters=function(){return["model","collection","attr","label","optionLabel"]},b.prototype.optionalParameters=function(){return["noOptionsMessage"].concat(b.__super__.optionalParameters.apply(this,arguments))},b.prototype.template=e.template("select-with-label"),b.prototype.noOptionsMessage="core.NoOptions",b.prototype.events=function(){return{"change select":"setModelValue"}},b.prototype.collectionEvents=function(){return{"add remove reset change":this.reRender}},b.prototype.getData=function(){var a;return a=this.model.get(this.attr),f.extend(this.getBaseData(),{label:this.label,model:this.model.toJSON(),selected:function(b){return b.name===a},options:this.collection.toJSON(),optionLabel:this.optionLabel,helpMessage:this.helpMessage,noOptionsMessage:this.noOptionsMessage,hasProblem:this.state.get("problem")})},b}(c)}).call(this)},{"../templates":67,"./input-with-label":7,underscore:312}],10:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o=[].slice;n=a("underscore"),d=a("backbone"),g=a("../core-model"),f=a("./collection"),c.assertMatch=function(a,b,c){var d;if(null==c&&(c="value"),d=a.test(b),!d)throw new Error(a.message(c))},i=function(){function a(b,c){return this.type=b,this.name=c,this instanceof a?void 0:new a(this.type,this.name)}return a.prototype.test=function(a){return a instanceof this.type},a.prototype.message=function(a){return""+a+" is not an instance of "+this.name},a}(),m=function(){function a(a,b){this.name=a,this.structure=b,this._msg=null}return a.prototype.failValidation=function(a){return this._msg=a,!1},a.prototype.test=function(a){var b,c,d,e,f;if(this._msg=null,null==a)return this.failValidation("it is null");if(null==a)return!1;f=this.structure;for(d in f)if(e=f[d],b=a[d],c=e.test(b),!c)return this.failValidation(e.message("."+d));return!0},a.prototype.message=function(a){return""+a+" failed "+this.name+" validation, because "+this._msg},a}(),c.InstanceOf=i,c.Structure=m,c.Model=new i(d.Model,"Backbone.Model"),c.CoreModel=new i(g,"core-model"),c.CoreCollection=new i(f,"core/collection"),c.Array=k={name:"array",test:n.isArray,message:function(a){return""+a+" is not an array"}},c.ArrayOf=b=function(a){return{name:"array of "+a.name,test:function(b){return this.passed=k.test(b)&&n.all(b,a.test)},message:function(b){var c;return""+b+" is not an array of "+(null!=(c=a.name)?c:"the correct type")}}},c.Function={name:"function",test:n.isFunction,message:function(a){return""+a+" is not a function"}},c.Number={name:"number",test:n.isNumber,message:function(a){return""+a+" is not a number"}},c.String=l={name:"string",test:n.isString,message:function(a){return""+a+" is not a string"}},c.Maybe=function(a){return{name:"maybe "+a.name,test:function(b){return null==b||a.test(b)},message:function(b){return a.message(b)}}},c.Callable=e={name:"callable",test:function(a){return null!=a&&n.isFunction(a.call)},message:function(a){return""+a+" is not callable"}},c.HasProperty=function(a){return{name:"has-property("+a+")",test:function(b){return null!=b&&a in b},message:function(b){return""+b+"."+a+" not found"}}},c.UnionOf=function(){var a;return a=1<=arguments.length?o.call(arguments,0):[],{name:function(){return"Union of "+a.map(function(a){return a.name}).join(", ")},test:function(b){return n.all(a,function(a){return function(c){return a._t=c,c.test(b)}}(this))},message:function(a){var b;return null!=(b=this._t)?b.message(a):void 0}}},c.Listenable=new m("Listenable",{on:c.Function,off:c.Function}),c.Service=j=new m("Service",{root:l,query:e,fetchModel:e,fetchLists:e,count:e,whoami:e}),c.DataModel=h=new m("imjs.Model",{name:l,makePath:e,findCommonType:e}),c.Query=new m("Query",{service:j,model:h,rows:e,count:e,toXML:e,root:l,views:b(l)})}).call(this)},{"../core-model":2,"./collection":5,backbone:232,underscore:312}],11:[function(a,b,c){(function(){var a;b.exports=a=function(){function a(a,b){this.data=a,this.target=b}return a.prototype.cancel=function(){return this.cancelled=!0},a.prototype.preventDefault=function(){return this.cancel()},a.prototype.stopPropagation=function(){},a}()}).call(this)},{}],12:[function(a,b,c){(function(){c.suppress=function(a){return null!=a&&a.preventDefault(),null!=a?a.stopPropagation():void 0}}).call(this)},{}],13:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k;k=a("underscore"),d=a("./templates"),b=a("./core/nested-model"),j=function(a){return a.isAttribute()?a.getParent().getType():a.getType()},h=function(a){var b;return b=j(a),[b.name].concat(a.model.getAncestorsOf(b))},e=function(a){return!!a},g=new b,c.getFormatter=i=function(a){var b,c,d,e,f,i,j,k,l;if(null==a||a.isRoot())throw new Error("No path or path is root");for(i=a.model,f=null!=(l=g.get([i.name]))?l:{},c=h(a),d=a.end.name,j=0,k=c.length;k>j;j++)if(b=c[j],e=f[""+b+"."+d]||f[""+b+".*"],e===!0&&(e=f[b]),null!=e)return e;return null},c.shouldFormat=function(a){if(null==a)throw new Error("no path");return a.isAttribute()?e(i(a)):!1},c.registerFormatter=function(a,b,c,d){if(null==d&&(d=["*"]),null==(null!=a?a.call:void 0))throw new Error("formatter is not a function");return 1===d.length&&"*"!==d[0]?g.set([b,""+c+"."+d[0]],a):(g.set([b,c],a),f(b,c,d))},c.disableFormatter=function(a,b,c){var d,e,f,h;for(null==c&&(c=["*"]),h=[],e=0,f=c.length;f>e;e++)d=c[e],h.push(g.set([a,""+b+"."+d],!1));return h},c.list=function(a){var b,c,d,e;d=g.get([a]),e=[];for(b in d)c=d[b],c&&e.push(b);return e},c.enableFormatter=f=function(a,b,c){var d,e,f,h;for(null==c&&(c=["*"]),h=[],e=0,f=c.length;f>e;e++)d=c[e],h.push(g.set([a,""+b+"."+d],!0));return h},c.defaultFormatter=function(a,b,c){return null!=c?k.escape(c):d.null_value},c.reset=function(){return g.clear(),g.trigger("reset")}}).call(this)},{"./core/nested-model":8,"./templates":67,underscore:312}],14:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),e=a("./core-model"),f=a("./options"),c={},g=function(a,b){return c[a]=h.extend({},b)},d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.icon=function(a,b,c){var d,e,f,g;return null==c&&(c={}),d=[],g=function(){var a;a=[];for(e in c)f=c[e],"className"!==e&&a.push(""+e+'="'+h.escape(f)+'"');return a}(),"className"in c&&d.push(h.escape(c.className)),d.push(this.iconClasses(a)),b&&d.push(this.getSize(b)),'<i class="'+d.join(" ")+'" '+g.join(" ")+"></i>"},b.prototype.iconWithProps=function(a,b){return this.icon(a,null,b)},b.prototype.getSize=function(a){var b;return null!=(b=this.get("size"+a.toUpperCase()))?b:""},b.prototype.iconClasses=function(a){return""+this.get("Base")+" "+this.get(a)},b.prototype._loadIconSet=function(){var a;return(a=c[this.options.get("icons")])&&(this.clear({silent:!0}),null!=a)?this.set(a):void 0},b.prototype.initialize=function(a){return this.options=null!=a?a:f,this._loadIconSet(),this.listenTo(this.options,"change:icons",this._loadIconSet)},b}(e),c.glyphicons={Base:"glyphicon",unsorted:"glyphicon-resize-vertical",ASC:"glyphicon-arrow-up",DESC:"glyphicon-arrow-down",headerIcon:"icon",headerIconRemove:"glyphicon-remove",headerIconHide:"glyphicon-minus",headerIconReveal:"glyphicon-fullscreen",SortStringASC:"glyphicon-sort-by-alphabet",SortStringDESC:"glyphicon-sort-by-alphabet-alt",SortNumericASC:"glyphicon-sort-by-order",SortNumericDESC:"glyphicon-sort-by-order-alt",RootClass:"glyphicon-stop",Yes:"glyphicon-star",No:"glyphicon-star-empty",Table:"glyphicon-list",Script:"glyphicon-console",Export:"glyphicon-cloud-download",Error:"glyphicon-warning-sign",Info:"glyphicon-info-sign",Warning:"glyphicon-warning-sign",Remove:"glyphicon-minus-sign",OK:"glyphicon-ok",Cancel:"glyphicon-remove",Check:"glyphicon-check",UnCheck:"glyphicon-unchecked",CheckUnCheck:"glyphicon-ok-none",Add:"glyphicon-plus-sign",Move:"glyphicon-move",More:"glyphicon-plus-sign",Filter:"glyphicon-filter",Summary:"glyphicon-stats",Undo:"glyphicon-refresh",Refresh:"glyphicon-refresh",Columns:"glyphicon-pause",Collapsed:"glyphicon-chevron-right",Expanded:"glyphicon-chevron-down",CollapsedSection:"glyphicon-triangle-right",ExpandedSection:"glyphicon-triangle-bottom",MoveDown:"glyphicon-chevron-down",GoBack:"glyphicon-chevron-left",GoForward:"glyphicon-chevron-right",MoveUp:"glyphicon-chevron-up",Toggle:"glyphicon-random",ExpandCollapse:"glyphicon-chevron-right icon-chevron-down",Help:"glyphicon-question-sign",ReverseRef:"glyphicon-retweet",Reorder:"glyphicon-menu-hamburger",Edit:"glyphicon-edit",ExtraValue:"glyphicon-map-marker",Tree:"glyphicon-plus",Download:"glyphicon-save-file",download:"glyphicon-cloud-download",Options:"glyphicon-tasks",ClipBoard:"glyphicon-paperclip",Composed:"glyphicon-tags",RemoveConstraint:"glyphicon-remove-sign",Dismiss:"glyphicon-remove-sign",ClosedReference:"glyphicon-expand",OpenReference:"glyphicon-collapse-down",Lock:"glyphicon-lock",Lists:"glyphicon-list-alt",Attribute:"glyphicon-unchecked",ExternalLink:"glyphicon-globe",tsv:"glyphicon-list",csv:"glyphicon-list",xml:"glyphicon-xml",json:"glyphicon-json",fake:"glyphicon-bug",Bug:"glyphicon-bug",Rubbish:"glyphicon-trash",RubbishFull:"glyphicon-trash",Joins:"glyphicon-link",Mail:"glyphicon-envelope"},c.fontawesome={Base:"fa",unsorted:"fa-unsorted",ASC:"fa-sort-up",DESC:"fa-sort-down",SortStringASC:"fa-sort-alpha-asc",SortStringDESC:"fa-sort-alpha-desc",SortNumericASC:"fa-sort-numeric-asc",SortNumericDESC:"fa-sort-numeric-desc",headerIcon:"fa",headerIconRemove:"fa-times",headerIconHide:"fa-ellipsis-h",headerIconReveal:"fa-arrows-h",sizeLG:"fa-2x",Yes:"fa-star",No:"fa-star-o",Table:"fa-list",EmptyTable:"fa-table",Script:"fa-file-code-o",Export:"fa-cloud-download",Remove:"fa-minus-circle",OK:"fa-check",Cancel:"fa-remove",Check:"fa-toggle-on",UnCheck:"fa-toggle-off",CheckUnCheck:"fa-toggle-on fa-toggle-off",Add:"fa-plus",Move:"fa-arrows",More:"fa-plus",Dropbox:"fa-dropbox",Drive:"fa-google",download:"fa-cloud-download",Galaxy:"fa-cloud-upload",GenomeSpace:"fa-cloud-upload",Filter:"fa-filter",Summary:"fa-bar-chart-o",Undo:"fa-undo",Refresh:"fa-refresh",Columns:"fa-columns",Collapsed:"fa-chevron-right",Expanded:"fa-chevron-down",CollapsedSection:"fa-caret-right",ExpandedSection:"fa-caret-down",MoveDown:"fa-chevron-down",GoBack:"fa-chevron-left",GoForward:"fa-chevron-right",MoveUp:"fa-chevron-up",Toggle:"fa-retweet",ExpandCollapse:"fa-chevron-right fa-chevron-down",Help:"fa-question-circle",Tree:"fa-sitemap",ReverseRef:"fa-retweet",Reorder:"fa-reorder",Options:"fa-tasks",Edit:"fa-edit",ExtraValue:"fa-database",Download:"fa-file-archive-o",ClipBoard:"fa-paperclip",Composed:"fa-tags",RemoveConstraint:"fa-times-circle",Dismiss:"fa-times-circle",Error:"fa-warning",Info:"fa-info-circle",Warning:"fa-warning",Lock:"fa-lock",RootClass:"fa-square",Attribute:"fa-tag",ClosedReference:"fa-plus-square",OpenReference:"fa-plus-square-o",CodeFile:"fa-file-code-o",Rubbish:"fa-trash-o",RubbishFull:"fa-trash",Joins:"fa-share-alt",ExternalLink:"fa-globe",Lists:"fa-cloud-upload",tsv:"fa-file-excel-o",csv:"fa-file-excel-o",xml:"fa-code",json:"fa-json",fake:"fa-bug",Bug:"fa-bug",Mail:"fa-envelope"},b.exports=new d,b.exports.Icons=d,b.exports.registerIconSet=g,b.exports.names=function(){var a,b,d;return a=function(){var a;a=[];for(b in c)d=c[b],a.push(h.keys(d));return a}(),h.union.apply(null,a)}}).call(this)},{"./core-model":2,"./options":63,underscore:312}],15:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p;p=a("underscore"),a("./shim"),k=a("imjs").Service.connect,g=a("es6-promise").Promise,o=a("./version"),i=a("./core/type-assertions"),b=a("./views/dashboard"),h=a("./views/table"),f=a("./options"),e=a("./messages"),d=a("./formatting"),n=a("./utils/simple-formatter"),m=function(a){var b;return b=function(c,d,e){var f,h,j;return i.Query.test(e)?new g(l(a,c,e,d)):(j=e.service,h=e.query,f=i.Service.test(j)?j:k(j),f.query(h).then(p.partial(b,c,d)))}},l=function(a,b,c,d){return null==d&&(d={}),function(e){var g,h,i,k,l,m,n;for(h=j(b),i="undefined"!=typeof page&&null!==page?p.pick(d,"start","size"):null,d=p.extend(p.omit(d,"start","size"),{model:i,query:c}),k=a(d),k.setElement(h),n=p.result(k,"className").split(" "),l=0,m=n.length;m>l;l++)g=n[l],h.classList.add(g);return h.classList.add(f.get("StylePrefix")),k.render(),e(k)}},j=function(a){var b,c;if(null==a)throw new Error("No target element provided");if(b=p.isString(a)?document.querySelector(a):null!=(c=a[0])?c:a,null==b)throw new Error("Target("+a+") not found on page");return b},c.version=o,c.setMessages=e.set.bind(e),c.configure=f.set.bind(f),c.loadTable=m(h.create),c.loadDash=m(function(a){return new b(a)}),c.createFormatter=n,c.formatting=p.omit(d,"getFormatter","shouldFormat","reset")}).call(this)},{"./core/type-assertions":10,"./formatting":13,"./messages":16,"./options":63,"./shim":66,"./utils/simple-formatter":104,"./version":111,"./views/dashboard":136,"./views/table":209,"es6-promise":281,imjs:290,underscore:312}],16:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),k=a("underscore"),g=a("./messages/actions"),h=a("./messages/common"),l=a("./templates/helpers"),i=l.numToString,j=l.pluralise,d=[h,g],e={formatNumber:i,pluralise:j},f=function(a){function b(){return this.getText=m(this.getText,this),b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.initialize=function(){return this.cache={},this.on("change",function(a){return function(){return a.cache={}}}(this))},b.prototype.destroy=function(){var a,b;this.off(),b=[];for(a in this)b.push(delete this[a]);return b},b.prototype.getTemplate=function(a){var b,c;return b=null!=(c=this.cache[a])?c:this.get(a),null!=b&&null==b.call&&(b=k.template(b)),this.cache[a]=b},b.prototype.getText=function(a,b){
var c,d;return null==b&&(b={}),c=this.getTemplate(a),null!=(d="function"==typeof c?c(k.extend({Messages:this},e,b)):void 0)?d:"!!!No message for "+a+"!!!"},b.prototype.setWithPrefix=function(a,b){var c,d,e;e=[];for(c in b)d=b[c],e.push(this.set(""+a+"."+c,d));return e},b.prototype.defaults=function(){return k.extend.apply(null,[{}].concat(d))},b}(c.Model),b.exports=new f,b.exports.Messages=f}).call(this)},{"./messages/actions":17,"./messages/common":20,"./templates/helpers":68,backbone:232,underscore:312}],17:[function(a,b,c){(function(){b.exports={"export.Export":"Export","export.ExportQuery":"Export","export.DialogueTitle":"Export","export.category.Format":"<%= format.EXT %> Format","export.category.Columns":"<%= columns %> Columns","export.category.Preview":"Preview","export.preview.Limit":"Preview is limited to at most 3 results.","export.heading.Columns":"Columns","export.category.Rows":"<% if (rowCount === max) { %>\n  All\n<% } else { %>\n  <%= rowCount %> of <%= max %>\n<% } %>\nRows","export.category.Compression":"<% if (compression) { %>\n  <%= compression.toUpperCase() %>\n<% } else { %>\n  No\n<% } %> Compression","export.category.Options":"Options","export.category.JsonFormat":"As <%= (jsonFormat === 'objects') ? 'Objects' : 'Rows' %>","export.category.FastaFormat":"FASTA options","export.category.ColumnHeaders":"<% if (headers) { %>\n  <%= {friendly: 'Formatted', path: 'Raw'}[headerType] %>\n<% } else { %>\n  No\n<% } %>\nColumn Headers","export.category.Destination":"<% if (dest === 'download') { %>\n  Download <%= format.EXT %> file\n<% } else { %>\n  Send <%= format.EXT %> to <%= dest %>\n<% } %>","export.galaxy.name":["<% if (orgs.length === 1) { %><%= orgs[0] %> <% } %>","<%= cls %> data","<% if (branding) { %> from <%= branding.name %><% } %>"].join(""),"export.galaxy.info":"<%= query.root %> data from <%= query.service.root %>.\nUploaded from <%= currentLocation %>.\n<% if (lists.length) { %>source: <%= lists.join(', ') %><% } %>\n<% if (orgs.length)  { %>organisms: <%= orgs.join(', ') %><% } %>","export.format.description.TSV":"A flat file format suitable for spreadsheet programmes","export.format.name.TSV":"Tab separated values.","export.format.description.CSV":"A flat file format, suitable for spreadsheet programmes","export.format.name.CSV":"Comma separated values.","export.format.description.XML":"A text format suitable for machine processing.","export.format.name.XML":"XML","export.format.name.JSON":"JSON","export.format.description.JSON":"A text format suitable for machine processing.","export.format.name.FASTA":"FASTA sequence.","export.format.description.FASTA":"FASTA output for sequence data.","export.format.name.GFF3":"GFF3 features.","export.format.description.GFF3":"GFF3 output for sequence features.","export.format.name.BED":"BED locations.","export.format.description.BED":"BED output for sequence feature locations.","export.format.name.FAKE":"Fake","export.format.description.FAKE":"Fake format for testing. Should only appear if the\nquery has departments in the view.","export.format.name.FAKE_2":"Also Fake","export.format.description.FAKE_2":"Fake format for testing. Should only appear if the\nquery has companies in the view.","export.param.Size":"Size: <%= size %>","export.param.Format":"Format","export.param.Start":"Offset: <%= start %>","export.param.Destination":"Destination","export.param.Name":"File name","export.help.AdditionalCols":"You can add any attributes of objects which are already\nin the query.","rows.All":"No limit","export.cloud.FileLocation":"Upload to <%- cloud %> successful. Your file is available at:","export.UseCompression":"Compress results","export.UseGZIP":"Use GZIP compression (produces a .gzip archive)","export.UseZIP":"Use Zip compression (produces a .zip archive)","export.AddHeaders":"Add column headers","export.json.Rows":"Return results as rows - each row is an Array of JSON values, e.g.:","export.SetTablePage":"Select rows in table","export.ResetRowSelection":"Select all rows","export.json.RowsExample":'["eve", "2R", 5866824, 5868300]',"export.json.ObjExample":'{\n  "class": "Gene",\n  "symbol": "eve",\n  "chromosomeLocation": {\n    "class": "ChromosomeLocation",\n    "start": 5866824,\n    "end": 5868300\n    "locatedOn": {\n      "class": "Chromosome",\n      "primaryIdentifier": "2R"\n    }\n  }\n}',"export.json.Objects":"Return results as objects - each result is a nested graph of\ndata, e.g.:","export.json.ObjWarning":"Please note that it is not recommended to set the size parameters\nwhen requesting object results, since the size of the result\nset, and the position of the offsets will differ when multiple\nrows are replaced by a single object with a collection.","export.ff.FriendlyHeaders":'Human readable headers (eg. "Gene > Organism Name")',"export.ff.PathHeaders":'Raw path headers (eg. "Gene.organism.shortName)',"export.error.NoColumnsSelected":"No columns selected","export.error.OffsetOutOfBounds":"The offset is greater than the total number of results.",ListNameDuplicate:"List names must be unique. This name is already taken",ListNameEmpty:"Lists must have names. Please enter one",ListNameIllegal:"Some characters are not allowed in list names. This name contains the following\nillegal characters: <%- illegals.join(', ') %>. Please remove them.",ExportTitle:"Download results for <%= name || 'query' %>",ConfigureExport:"Configure Export",GetData:"Download Data",ExportHelp:"Download file containing results to your computer",ExportButton:"Download","download-file":"Download File",download:"Download file",Galaxy:"Send to Galaxy",GenomeSpace:"Upload to Genomespace",Drive:"Save to Google Drive",Dropbox:"Save to Dropbox","Destdownload-file":"File",DestGalaxy:"Galaxy",DestGenomespace:"Genomespace",ExportAlt:"Send Data Somewhere Else",ExportLong:'<span class="hidden-tablet">Download</span>\nFile\n<span class="im-only-widescreen">to your Computer</span>',SendToGalaxy:'<span class="hidden-tablet">Send to</span>\nGalaxy\n<span class="im-only-widescreen">for analysis</span>',SendToGenomespace:'<span class="hidden-tablet">Upload to</span>\n<span class="im-only-widescreen">your</span>\nGenomespace\n<span class="im-only-widescreen">account</span>',MyGalaxy:"Send to your Galaxy",ForgetGalaxy:"Clear this galaxy URL",GalaxyHelp:"Start a file upload job within Galaxy",GalaxyURILabel:"Galaxy Location:",GalaxyAlt:"Send to a specific Galaxy",SaveGalaxyURL:"Make this my default Galaxy",WhatIsGalaxy:"What is Galaxy?",WhatIsGalaxyURL:"http://wiki.g2.bx.psu.edu/",GalaxyAuthExplanation:"If you have already logged into Galaxy with this browser, then the data\nwill be sent into your active account. Otherwise it will appear in a \ntemporary anonymous account.",CopyToClipBoard:"Copy to clipboard: <CTL>+C, <ENTER>",IsPrivateData:"This link provides access to data stored in your private lists. In order to do so\nit uses the API access token provided on initialisation. If this is your permanent\nAPI token you should be as careful of this link as you would of the data is provides\naccess to. If this is just a 24 hour access token, then you will need to replace it\nonce it becomes invalid.",LongURI:"The normal URI for this query (which includes the full query XML in the \nparameters) is too long for a GET request. The URI you can see here uses a\nquery-id, which has a limited validity. You should not store this URI for long\nterm use.",SendToOtherGalaxy:"Send",AllRows:"Whole Result Set",SomeRows:"Specific Range",WhichRows:"Rows to Export",RowsHelp:"Export all rows, or define a range of rows to export.",AllColumns:"All Current Columns",SomeColumns:"Choose Columns",CompressResults:"Compress results",NoCompression:"No compression",GZIPCompression:"GZIP",ZIPCompression:"ZIP",Copy:"copy to clip-board",ResultsPermaLink:"Perma-link to results",ResultsPermaLinkText:"Results URI",QueryXML:"Query XML",ResultsPermaLinkTitle:"Get a permanent URL for these results, suitable for your own use",ResultsPermaLinkShareTitle:"Get a permanent URL for these results, suitable for sharing with others",ColumnsHelp:"Export all columns, or choose specific columns to export.",WhichColumns:"Columns to Export",ResetColumns:"Reset Columns.",FirstRow:"From",LastRow:"To",SpreadsheetOptions:"Spreadsheet Options",ColumnHeaders:"Include Column Headers",PossibleColumns:"You can add any attribute from these nodes without changing your results:",ExportedColumns:"Exported Columns (drag to reorder)",ChangeColumns:"You may add any of the columns in the right hand box by clicking on the\nplus sign. You may remove unwanted columns by clicking on the minus signs\nin the left hand box. Note that while adding these columns will not alter your query,\nif you remove all the attributes from an item, then you <b>may change</b> the results\nyou receive.",OuterJoinWarning:"This query has outer-joined collections. This means that the number of rows in \nthe table is likely to be different from the number of rows in the exported results.\n<b>You are strongly discouraged from specifying specific ranges for export</b>. If\nyou do specify a certain range, please check that you did in fact get all the \nresults you wanted.",IncludedFeatures:"Exportable parts of this Query - <strong>choose at least one</strong>:",FastaFeatures:"Features with Sequences in this Query - <strong>select one</strong>:",FastaOptions:"FASTA Specific Options",FastaExtension:"Extension (eg: 100/100bp/5kbp/0.5mbp):",ExtraAttributes:"Columns to include as extra attributes on each exported record:",NoSuitableColumns:"There are no columns of a suitable type for this format.",BEDOptions:"BED Specific Options",Gff3Options:"GFF3 Specific Options",ChrPrefix:'Prefix "chr" to the chromosome identifier as per UCSC convention (eg: chr2)',ConfigureExportHelp:"Configure the export options in these categories","largetable.ok":"Set page size to <%- size %>","largetable.abort":"Cancel","largetable.appeal":"You have requested a very large table size (<%= size %> rows per page). Your\nbrowser may struggle to render such a large table,\nand the page could become unresponsive. In any case,\nwill be very difficult for you to read the whole table\nin the page. We suggest the following alternatives:"}}).call(this)},{}],18:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("codegen",{AsHTML:"As HTML page",DialogueTitle:'Generated <%= Messages.getText("codegen.Lang", {lang: lang}) %>\nCode for <%= query.name || "Query" %>',CannotExportXML:"You cannot save the XML as a file directly. Please use your browser's cut\nand paste functionality.",PrimaryAction:"Save",ChooseLang:"Choose Language",ShowBoilerPlate:"Show comments",HighlightSyntax:"Highlight Syntax",GenerateCodeIn:function(a){var c;return c=a.lang,"Generate "+b.getText("codegen.Lang",{lang:c})+"\n"+("xml"!==c?"code":"")},Lang:function(a){var b;switch(b=a.lang){case"py":return"Python";case"pl":return"Perl";case"java":return"Java";case"rb":return"Ruby";case"js":return"JavaScript";case"xml":return"XML";default:throw new Error("Unknown language "+b)}}})}).call(this)},{"../messages":16}],19:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("columns",{DialogueTitle:"Manage Columns",ApplyChanges:"Apply Changes",FindColumnToAdd:"Add a Column",AddColumn:"<% if (num < 1) { %>\n  No columns chosen\n<% } else { %>\n  Add <%= num %> new <%= pluralise('column', num) %>\n<% } %>",AddColumnToSortOrder:"Sort by this column",NoChangesToApply:"There are no changes to apply.",OrderVerb:"Add / Remove / Re-Arrange",OrderTitle:"Columns",SortVerb:"Configure",SortTitle:"Sort-Order",OnlyColsInView:"Only show columns in the table:",SortingHelpTitle:"What Columns Can I Sort by?",ViewTabTitle:"Selected Columns",SortOrderTabTitle:"Sort Order",CurrentView:"Current Columns",CurrentViewHelp:"Re-arrange or remove columns by dragging, or by using the buttons",CurrentSortOrder:"<% if (oes.length) { %>\n  <%= oes.length %> Order <%= pluralise('Elements', oes.length) %>\n<% } else { %>\n  Not sorted.\n<% } %>",NoSortOrder:"No sort order. Drop columns here to sort the table.",RemoveOrderElement:"Remove this column from the sort-order",CurrentSortOrderHelp:"Re-arrange, add or remove columns. The full set of available\ncolumns is listed below.",ColumnsSelected:'<%= columns.length %> <%= pluralise("Column", columns.length) %>\nSelected<% if (removed) { %>, <%= removed %> Removed<% } %>',ChooseAPathFrom:"Choose a path from <%= root %>",RemoveColumn:"Remove this column",MoveUp:"Move this column up",MoveDown:"Move this column down",ColumnWillBeRemoved:"This column will be removed",RestoreColumn:"Add this column back to the table",ChangeDirection:"Change sort direction",CurrentDirection:"Sorted in\n<%= (dir === 'DESC') ? 'reverse' : void 0 %>\n<%= numeric ? 'numerical' : 'alphabetical' %>\norder.",ManageColumns:"Manage Columns",ManageColumnsShort:"Columns"})}).call(this)},{"../messages":16}],20:[function(a,b,c){(function(){b.exports={All:"All",Reset:"Reset",Export:"Download",Clear:"Clear",Cancel:"Cancel",Complete:"Complete",Error:"Error",Warning:"Warning",Filter:"Filter",Loading:"Loading",Undo:"Undo",and:"and",or:"or",comma:",",Number:"<%= formatNumber(n) %>","modal.DefaultTitle":"Excuse me...","modal.Dismiss":"Close","modal.OK":"OK","modal.ApplyChanges":"Apply Changes","core.NoOptions":"There are no options to select from.",ErrorTitle:function(a){var b;switch(b=a.level){case"Error":return"Error";case"Warning":return"Warning";case"Info":return"nb";case"Positive":return"Success";default:return"Error"}}}}).call(this)},{}],21:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("constraints",{Heading:'<%= n %> Active <%= pluralise("Filter", n) %>',AddNewFilter:"Add New Filter",AddFilter:"Add filter",AddNew:"Add Filter",DefineNew:"Define a new filter",EditOrRemove:"edit or remove the currently active filters",None:"No active filters",NoOfValues:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("value", n) %>',NoOfIds:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("ID", n) %>',ISA:"is a",LookupIn:"in",AddConFor:"Add filter to\n<% if (isAttribute && !hideType) { %><%= typeName %><% } %>\n<%= _.last(parts) %>",ManageFilters:"Manage Filters",ManageFiltersShort:"Filters"})}).call(this)},{"../messages":16}],22:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("error",{Oops:"Oops! - Sorry we cannot get that table for you.",EmailHelp:"Send a bug report",ShowQuery:"Show query",ShowError:"Show error",ConnectionError:"Could not connect to server"}),b.setWithPrefix("error.mail",{Subject:"[IMTABLES] - Error running query."}),b.setWithPrefix("error.client",{Heading:"Application error.",Body:"This is due to an unexpected error in the tables\napplication - this is our fault, and we are sorry for the\ninconvenience. Please send us the pre-filled bug report so\nwe can fix this as soon as possible."}),b.setWithPrefix("error.server",{Heading:"Server error - our bad!",Body:"This is most likely related to the query that was just run. If you have\ntwo minutes, please send us an email with details of this query to help us\ndiagnose and fix this bug - we have already pre-filled the bug report,\nyou just need to hit send (and maybe give us some extra details).\nAlternatively, you might be able to fix this query by changing its column, \nfilters or joins; use the tools above to do so."})}).call(this)},{"../messages":16}],23:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("joins",{Heading:"Manage Relationships",Manage:function(){return b.getText("joins.Heading")},ManageShort:"Relationships",Inner:"Required",Outer:"Optional",ExplanationTitle:"What does this do?",Explanation:"You can specify the entity relationships within the query here. This\nhas a couple of effects - one is to exclude a class of matched results, the\nother is to change the way the results are presented in the table.\nIf set to required, then an entity which matches the filters\nbut lacks the given relationship will not be returned in the results,\nwhereas if set to optional it will. This also has an effect on the\nway that results are laid out: required collection relationships\nare returned inline, whereas optional collection relationships are\nreturned as nested sub-tables within the main result set."})}).call(this)},{"../messages":16}],24:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("lists",{DefaultName:"<%= typeName %> List (<%= new Date() %>)",Create:"Create List",Append:"Add to List",SaveAsList:"Save as List",CreateListTitle:"Create a new List\n<% if (state.count) { %>\n  of <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>",AppendToListTitle:"Add\n<% if (state.count) { %>\n  <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>\nto\n<%= target || 'a List' %>",NoTags:"No tags",AddTag:"Add a new tag",AddTagBtn:"add",RemoveTag:"Remove this tag",ShowExtraOptions:"<% if (minimised) { %>Show <% } %>Optional attributes",TargetDoesNotExist:"Your target list does not exist.",NoTargetSelected:"Please select a target list.",PossibleAppendTarget:"<%= name %> (<%= formatNumber(size) %> <%= pluralise((typeName || 'item'), size) %>)",NoObjectsSelected:"No objects selected. Choose objects from the table beneath. You can\ndrag this dialog around if it is in the way.",StartPicking:"Pick items from the table",NoCommonType:"There is no common type for these objects."}),b.setWithPrefix("lists.error",{MustBeLoggedIn:"You are not logged in. Anonymous users cannot create lists."}),b.setWithPrefix("lists.params",{Name:"List Name",NamePlaceholder:"List name is required",Desc:"List Description",DescPlaceholder:"Enter a description",Target:"Choose list to append items to"}),b.setWithPrefix("lists.params.help",{Name:"You must provide a unique list name",Target:"You must select a target list"}),b.setWithPrefix("lists.picker",{Expand:"show more options",Collapse:"show fewer options"}),b.setWithPrefix("lists.append",{NoSuitableLists:"No suitable lists were found\n<% if (model.type) { %>\n  for <%- model.type %>.\n<% } else { %>\n  because no items are selected, or they have no common type.\n<% } %>"})}).call(this)},{"../messages":16}],25:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("logic",{Heading:"Manage Constraint Logic",Manage:function(){return b.getText("logic.Heading")},ManageShort:"Constraint Logic",LogicLabel:function(){return b.getText("logic.ManageShort")},ApplyLogic:"Change logic"})}).call(this)},{"../messages":16}],26:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("subtables",{OpenHint:"Click to view/hide rows",RemoveColumn:"Remove this column"})}).call(this)},{"../messages":16}],27:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("summary",{Got:"<% if (available > got) { %>Showing <%= formatNumber(got) %> of<% } %>",Max:"Maximum",Min:"Minimum",Bucket:"<%= range.min %> to <%= range.max %>: <%= count %> values",Count:"Count",Item:"Item",Average:"Average",StdDev:"Standard Deviation",OnlyOne:"There is only one <%- names.typeName %> <%- names.endName %>:\n<strong><%- item.item %></strong>, which occurs\n<strong>\n  <% if (item.count === 1) { %>\n    once\n  <% } else if (item.count === 2) { %>\n    twice\n  <% } else { %>\n    <%- formatNumber(item.count) %> times\n  <% } %>\n</strong>",NumericDistribution:"Showing distribution of <%= formatNumber(n) %>",FilterValuesPlaceholder:"Filter values",DownloadData:"Download data",DownloadFormat:"As",MoreItems:"Load more items",Include:"Restrict table to matching rows",Exclude:"Exclude matching rows from table",Reset:"Reset selection",Toggle:"Toggle selection",SelectFilter:"Select filter type",FacetBar:"rgba(206, 210, 222, <%= opacity %>)",NoResults:"No results for <%= path %>",SelectedCount:"<%= isApprox ? \"ca. \" : void 0 %><%= formatNumber(selectedCount) %>\n<%= pluralise('Item', selectedCount) %> Selected",Total:"<% if (filtered) { %>(filtered from <%= formatNumber(total) %>)<% } %>"})}).call(this)},{"../messages":16}],28:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("table",{Building:"Loading Table ...",OverlayText:"Requesting data...",Empty:"No Results",EmptyWhy:"This query returns no results. You may wish to change its filters"}),b.setWithPrefix("table.lg",{ShowingAll:"Showing all <%= formatNumber(count) %> rows",ShowingRange:'Showing <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %> <%= pluralise("row", count) %>'}),b.setWithPrefix("table.md",{ShowingAll:"All <%= formatNumber(count) %> rows",ShowingRange:"Showing rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.sm",{ShowingAll:"All rows",ShowingRange:"Rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.xs",{ShowingAll:"All rows",ShowingRange:"<%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),b.setWithPrefix("table.header",{FailedToInitSortMenu:"Could not initialise the sorting menu.",FailedToInitFilter:"Could not initialise the filter menu.",FailedToInitSummary:"Could not intitialise the column summary.",ViewSummary:"View column summary",ToggleColumn:"Toggle column visibility",RemoveColumn:"Remove this column",SortColumn:"<% if (dir === 'ASC') { %>\n  Sorted in ascending order.\n<% } else if (dir === 'DESC') { %>\n  Sorted in descending order.\n<% } else { %>\n  Sort this column.\n<% } %>",ToggleTables:"Expand/collapse all sub-tables",Composed:"This column replaces <%= replaces.length %> others. Click here\nto show the individual columns separately.",FilterTitle:"<% if (count > 0) { %>\n  <%= count %> active filters.\n<% } else { %>\n  Filter by values in this column.\n<% } %>"})}).call(this)},{"../messages":16}],29:[function(a,b,c){(function(){var b;b=a("../messages"),b.setWithPrefix("undo",{StepTitle:"<% if (label === 'Initial') { %>\n  Initial State\n<% } else if (verb === 'Added') { %>\n  <% if (label === 'sort order element') { %>\n    Added <%= formatNumber(number) %> <%= pluralise('column', number) %> to the sort order\n  <% } else if (label === 'column') { %>\n    Selected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Added <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Removed') { %>\n  <% if (label === 'sort order element') { %>\n    Removed <%= formatNumber(number) %> <%= pluralise('column', number) %> from the sort order\n  <% } else if (label === 'column') { %>\n    Unselected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Removed <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Changed') { %>\n  <% if (label === 'sort order element') { %>\n    Changed sort order\n  <% } else { %>\n    Changed <%= pluralise(label, 2) %>\n  <% } %>\n<% } else if (verb === 'Rearranged') { %>\n  Rearranged <%= pluralise(label, 2) %>\n<% } else { %>\n  !!!Cannot handle <%= verb %> <%= label %>!!!\n<% } %>",StepCount:'<%= formatNumber(count) %> <%= pluralise("row", count) %>',RevertToState:"Revert to this state",IsCurrentState:"This is the current state",ViewCount:'<%= n %> <%= pluralise("column", n) %> selected',ConstraintCount:"<% if (n) { %>\n  <%= n %> <%= pluralise('filter', n) %>\n<% } else { %>\n  No filters\n<% } %>",OrderElemCount:"<% if (n) { %>\n  Sorted on <%= n %> <%= pluralise('column', n) %>\n<% } else { %>\n  Not sorted\n<% } %>",ShowAllStates:"Show <%= n %> hidden <%= pluralise('state', n) %>",ToggleTrivial:'<%= hideTrivial ? "Hiding" : "Hide" %> minor steps',ToggleTrivialTitle:'<%= hideTrivial ? "Hiding" : "Hide" %> steps that did not change the row count',Revision:"no. <%= v %>",RevisionTitle:"revision <%= v %>",MoreSteps:'<%= more %> more <%= pluralise("step", more) %>'})}).call(this)},{"../messages":16}],30:[function(a,b,c){(function(){var b,d;b=a("jquery"),d=function(a){var c,d,e;return c=b("body"),d=c.width(),e=a.width(),a.css({left:(d-e)/2,top:50})},c._showModal=function(){var a;return a=this.$el,a.modal({show:!1}).addClass("im-floating").draggable({handle:".modal-header"}).show(function(){return d(a),a.animate({opacity:1},{complete:function(){return a.addClass("in")}})}),this.listenToOnce(this,"remove",function(a){return function(){return a.$el.draggable("destroy")}}(this))},c._hideModal=function(){return this.$el.removeClass("in"),this.onHidden()}}).call(this)},{jquery:309}],31:[function(a,b,c){(function(){var b;b=a("underscore"),c.setChildIndices=function(a,c,d){var e,f,g,h,i,j,k,l,m;for(null==c&&(c="top"),null==d&&(d="collection"),g=this.children,e=this[d],j=b.compact(e.map(function(b){return g[a(b)]})),h=b.sortBy(j,function(a){return a.el.getBoundingClientRect()[c]}),m=[],f=k=0,l=h.length;l>k;f=++k)i=h[f],m.push(i.model.set({index:f}));return m}}).call(this)},{underscore:312}],32:[function(a,b,c){(function(){var b;b=a("underscore"),c.initTypeaheads=function(){return null!=this._typeaheads?this._typeaheads:this._typeaheads=[]},c.removeTypeAheads=function(){var a,b;if(null!=this._typeaheads){for(b=[];a=this._typeaheads.shift();)a.off("typeahead:select"),a.off("typeahead:selected"),a.off("typeahead:autocompleted"),a.off("typeahead:close"),b.push(a.typeahead("destroy"));return b}},c.lastTypeahead=function(){var a;return b.last(null!=(a=this._typeaheads)?a:[])},c.activateTypeahead=function(a,b,c,d,e,f){return a.attr({placeholder:d}).typeahead(b,c),a.on("typeahead:selected",e),a.on("typeahead:select",e),a.on("typeahead:autocompleted",e),null!=f&&a.on("typeahead:close",f),this.initTypeaheads().push(a),a.focus(),this}}).call(this)},{underscore:312}],33:[function(a,b,c){(function(){var b,d;d=a("underscore"),b={},c.runQuery=function(a){var c,d,e,f,g;return null==a&&(a={}),f=this.getExportParameters(a),e="results:"+this.query.service.root+":"+JSON.stringify(f),c="query/results",d=this.model.get("format"),(null!=(g=d.needs)?g.length:void 0)&&(c+="/"+d.id),null!=b[e]?b[e]:b[e]=this.query.service.post(c,f)},c.getEstimatedSize=function(){var a,c;return c=this.getExportQuery(),a="count:"+c.service.root+":"+c.toXML(),null!=b[a]?b[a]:b[a]=c.count()},c.getExportQuery=function(){var a,b;return b=this.query.clone(),a=this.model.get("columns"),(null!=a?a.length:void 0)&&b.select(a),b},c.getExportURI=function(a){return this.getExportQuery().getExportURI(this.model.get("format").id,this.getExportParameters(a))},c.getFileName=function(){return""+this.getBaseName()+"."+this.getFileExtension()},c.getBaseName=function(){return this.model.get("filename")},c.getFileExtension=function(){return this.model.get("format").ext},c.getExportParameters=function(a){var b;return null==a&&(a={}),b=this.model.pick("start","size","format","filename"),b.format=b.format.id,b.query=this.getExportQuery().toXML(),this.model.get("compress")&&(b.compress=this.model.get("compression")),this.model.get("headers")&&(b.columnheaders=this.model.get("headerType")),"json"===b.format&&"rows"!==this.model.get("jsonFormat")&&(b.format+=this.model.get("jsonFormat")),"fasta"===b.format&&this.model.get("fastaExtension")&&(b.extension=this.model.get("fastaExtension")),d.extend(b,a)}}).call(this)},{underscore:312}],34:[function(a,b,c){(function(){c.setPathNames=function(){var a,b,c,d,e,f,g,h,i,j;return b=null!=(i=this.query)?i:this.model.query,h=null!=(j=this.view)?j:this.model.view,d=b.service,g=h.getParent().getType(),a=h.end,c=this.state,e=function(a){return function(b){return c.set(a,b)}},f=e("error"),h.getDisplayName().then(e("pathName"),f),g.getDisplayName().then(e("typeName"),f),d.get("model/"+g.name+"/"+a.name).then(function(a){var b;return b=a.name}).then(e("endName"),f)}}).call(this)},{}],35:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),d=a("../core-model"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.defaults=function(){return{target:null,type:null}},b}(d)}).call(this)},{"../core-model":2,underscore:312}],36:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core/collection"),e=a("./path"),f=function(a,b,c){var d,e,f,g;return g=function(){var d,e,g,h;for(g=[b,c],h=[],d=0,e=g.length;e>d;d++)f=g[d],h.push(a(f));return h}(),d=g[0],e=g[1],e>d?-1:d>e?1:0},h=function(a){return a.get("parts").length},g=function(a){return a.get("displayName")},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.model=e,b.prototype.add=function(a){var c;return c=b.__super__.add.apply(this,arguments),c&&null==c.collection?c.collection=this:void 0},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.on("change:parts change:displayName",function(a){return function(){return a.sort()}}(this))},b.prototype.comparator=function(a,b){return f(h,a,b)||f(g,a,b)},b}(d)}).call(this)},{"../core/collection":5,"./path":56}],37:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("es6-promise").Promise,f=a("../options"),d=a("../core-model"),e="DynamicObjects.NameDelimiter",b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.defaults=function(){return{columnName:null,typeName:null,typeNames:[],entity:null,column:null,node:null,field:null,value:null}},b.prototype.initialize=function(){var a,c,d,h,i,j;return b.__super__.initialize.apply(this,arguments),i=null!=(j=this.get("entity").get("classes"))?j:[this.get("node")],c=(a=this.get("column")).model,a.getDisplayName().then(function(a){return function(b){return a.set({columnName:b})}}(this)),d=function(){var a,b,d;for(d=[],a=0,b=i.length;b>a;a++)h=i[a],d.push(c.makePath(h).getDisplayName());return d}(),g.all(d).then(function(a){return function(b){return a.set({typeNames:b,typeName:b.join(f.get(e))})}}(this))},b.prototype.getPath=function(){return this.get("column")},b.prototype.toJSON=function(){return h.extend(b.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),entity:this.get("entity").toJSON()})},b}(d)}).call(this)},{"../core-model":2,"../options":63,"es6-promise":281,underscore:312}],38:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../options"),d=a("../core-model"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.defaults=function(){return{lang:e.get("CodeGen.Default"),showBoilerPlate:!1,highlightSyntax:!0}},b}(d)}).call(this)},{"../core-model":2,"../options":63}],39:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core/collection"),e=a("./header"),f=a("../utils/build-headers"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.model=e,b.prototype.comparator="index",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:index",this.sort)},b.prototype.setHeaders=function(a,b){
var c;return c=f(a,b),c.then(function(b){return function(c){var d;return b.set(function(){var b,f,g;for(g=[],b=0,f=c.length;f>b;b++)d=c[b],g.push(new e(d,a));return g}())}}(this))},b}(c)}).call(this)},{"../core/collection":5,"../utils/build-headers":71,"./header":44}],40:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),k=a("imjs").Query,d=k.LIST_OPS,e=k.LOOP_OPS,h=k.TERNARY_OPS,g=k.RANGE_OPS,f=a("./path"),i=function(a){var b,c,f,i;if(a.path.isAttribute())return a.values?"MULTI_VALUE":"ATTR_VALUE";if(a.type)return"TYPE";if(a.ids)return"IDS";if(a.values&&(b=a.op,l.call(g,b)>=0))return"RANGE";if(c=a.op,l.call(h,c)>=0)return"LOOKUP";if(f=a.op,l.call(d,f)>=0)return"LIST";if(i=a.op,l.call(e,i)>=0)return"LOOP";throw new Error("Cannot determine constraint type: "+a.path+" "+a.op)},b.exports=c=function(a){function b(a){var c;b.__super__.constructor.call(this,a.path),c=a.type,this.unset("id"),this.unset("type"),this.set(j.omit(a,"path","type")),null!=c&&(this.set({type:c.toString()}),c.getDisplayName().then(function(a){return function(b){return a.set({typeName:b})}}(this))),this.set({CONSTRAINT_TYPE:i(a)})}return n(b,a),b.prototype.defaults=function(){return j.extend(b.__super__.defaults.apply(this,arguments),{value:null,values:[],ids:[],extraValue:null,code:null,CONSTRAINT_TYPE:"ATTR_VALUE"})},b}(f)}).call(this)},{"./path":56,imjs:290,underscore:312}],41:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("../core-model"),c=a("../core/collection"),f=/,\s*/,g=function(a){return a.replace(/(^\s+|\s+$)/g,"")},b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.defaults=function(){return{name:null,description:null}},b.prototype.initialize=function(){var a;return this.tags=new c,this.has("tags")&&this.tags.reset(function(){var b,c,d,e;for(d=this.get("tags"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push({id:a});return e}.call(this)),this.listenTo(this.tags,"remove",function(a){return function(b){return a.trigger("remove:tag",b),a.trigger("change")}}(this)),this.listenTo(this.tags,"add",function(a){return function(b){return a.trigger("add:tag",b),a.trigger("change")}}(this))},b.prototype.toJSON=function(){return h.extend(b.__super__.toJSON.apply(this,arguments),{tags:this.tags.map(function(a){return a.get("id")})})},b.prototype.addTag=function(){var a,b,c,d,e,h;if(b=this.get("nextTag"),null==b)throw new Error("No tag to add");for(this.unset("nextTag"),e=g(b).split(f),h=[],c=0,d=e.length;d>c;c++)a=e[c],h.push(this.tags.add({id:a}));return h},b.prototype.destroy=function(){var a;return null!=(a=this.tags)&&a.close(),b.__super__.destroy.apply(this,arguments)},b}(d)}).call(this)},{"../core-model":2,"../core/collection":5,underscore:312}],42:[function(a,b,c){(function(){var b,d,e;e=a("underscore"),b=function(){function a(a){var b,c,d,f,g,h;this.id=a.id,this.group=a.group,f=a.icon,h=a.needs,this.maxColumns=a.maxColumns,d="tab"===this.id?"tsv":this.id,b=d.toUpperCase(),null==f&&(f=d),null==h&&(h=[]),c="export.format.description."+b,g="export.format.name."+b,e.extend(this,{icon:f,desc:c,name:g,needs:h,ext:d,EXT:b})}return a.prototype.toString=function(){return this.ext},a.prototype.toJSON=function(){return{id:this.id,group:this.group,icon:this.icon,needs:this.needs,ext:this.ext}},a.prototype.isSuitable=function(a){return 0===this.needs.length?!0:e.any(this.needs,function(b){return a[b]})},a}(),d=[new b({id:"tab",group:"flat"}),new b({id:"csv",group:"flat"}),new b({id:"xml",group:"machine"}),new b({id:"json",group:"machine"}),new b({id:"fasta",group:"bio",icon:"dna",needs:["Protein","SequenceFeature"],maxColumns:1}),new b({id:"gff3",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new b({id:"bed",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new b({id:"fake",group:"fake",icon:"fake",needs:["Department"]}),new b({id:"fake_2",group:"fake",icon:"fake",needs:["Company"]})],c.getFormat=function(a){return e.findWhere(d,{id:a})},c.getFormats=function(a){var b,c,e,f;for(f=[],c=0,e=d.length;e>c;c++)b=d[c],b.isSuitable(a)&&f.push(b);return f},c.registerFormat=function(a){var c,e,f;return e=a.id,c=a.icons,f=a.needs,d.push(new b(e,c,f))}}).call(this)},{underscore:312}],43:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-model"),b.exports=d=function(a){function b(a,c){b.__super__.constructor.call(this),this.set({id:null,classes:[a["class"]],"service:base":"","service:url":"","report:uri":null}),this.set(c,a.value)}return f(b,a),b}(c)}).call(this)},{"../core-model":2}],44:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),e=a("./path"),d=a("../options"),h=function(a){return null!=a?a.toUpperCase():void 0},f=i.compose(i.first,i.compact,i.map),g=function(a){return null!=a&&null!=a.isReference&&null!=a.isAttribute},b.exports=c=function(a){function b(a,c){var d;if(this.query=c,!(null!=(d=this.query)?d.on:void 0))throw new Error("no query");if(null==a)throw new Error("no options");b.__super__.constructor.call(this,a.path),this.set(i.omit(a,"path")),this.set({id:""+this.query.toXML()+"-"+this.get("path")}),this.listenTo(this.query,"change:joins",this.setOuterJoined),this.listenTo(this.query,"change:sortorder",this.setSortDirection),this.listenTo(this.query,"change:constraints",this.setConstraintNum),this._update_attrs()}return k(b,a),b.prototype.defaults=function(){return i.extend(b.__super__.defaults.apply(this,arguments),{replaces:[],isFormatted:!1,isComposed:!1,sortable:!0,sortDirection:null,numOfCons:0,minimised:!1,outerJoined:!1,expanded:d.get("Subtables.Initially.Expanded")})},b.prototype._update_attrs=function(){return this.setOuterJoined(),this.setSortDirection(),this.setConstraintNum()},b.prototype.toJSON=function(){return i.extend(b.__super__.toJSON.apply(this,arguments),{replaces:this.get("replaces").map(String)})},b.prototype.getView=function(){var a,b,c,d;return d=this.pick("replaces","isFormatted","path"),c=d.replaces,a=d.isFormatted,b=d.path,String(a&&1===c.length?c[0]:b)},b.prototype.validate=function(a,b){var c;if("replaces"in a){if(c=a.replaces,!i.isArray(c))return new Error("replaces must be an array");if(c.length&&!i.all(c,g))return new Error("all elements in replaces must be PathInfo objects")}},b.prototype.setOuterJoined=function(){var a,b,c,d,e;return e=this.getView(),c=this.get("replaces"),b=this.query.isOuterJoined(e),a=this.get("isFormatted")&&c.length>1,d=!b,this.set({outerJoined:b,isComposed:a,sortable:d})},b.prototype.setSortDirection=function(){var a,b,c,d;return c=this.get("replaces"),d=this.getView(),b=function(a){return function(b){return a.query.getSortDirection(b)}}(this),a=h(f(c.concat([d]),b)),this.set({sortDirection:a})},b.prototype.setConstraintNum=function(){var a,b,c;return c=this.getView(),b=i.size(function(){var b,d,e,f;for(e=this.query.constraints,f=[],b=0,d=e.length;d>b;b++)a=e[b],a.path.match(c)&&f.push(a);return f}.call(this)),this.set({numOfCons:b})},b}(e)}).call(this)},{"../options":63,"./path":56,underscore:312}],45:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../core/collection"),e=a("./step"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.model=e,b.prototype.currentQuery=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"remove",this.unwatch),this.listenTo(this,"add",this.watch)},b.prototype.currentStep=0,b.prototype.comparator="revision",b.prototype.getCurrentQuery=function(){return this.currentQuery},b.prototype.setCurrentQuery=function(a){return this.currentQuery=a.get("query").clone()},b.prototype.unwatch=function(a){var b,c;return b=null!=(c=null!=a?a.get("query"):void 0)?c:this.getCurrentQuery(),null!=b?this.stopListening(b):void 0},b.prototype.watch=function(a){var b;return this.setCurrentQuery(a),b=this.getCurrentQuery(),null!=b?(this.listenTo(b,"change:constraints",this.onChangeConstraints),this.listenTo(b,"change:views",this.onChangeViews),this.listenTo(b,"change:joins",this.onChangeJoins),this.listenTo(b,"change:sortorder",this.onChangeSortOrder),this.listenTo(b,"change:logic",this.onChangeLogic),this.listenTo(b,"undo",this.popState)):void 0},b.prototype.onChangeConstraints=function(){return this.onChange("constraints","filter",function(a){return f.map(a,JSON.stringify)})},b.prototype.onChangeViews=function(){return this.onChange("views","column")},b.prototype.onChangeJoins=function(){return this.onChange("joins","join",function(a){return f.map(a,function(a,b){return""+b+":"+a})})},b.prototype.onChangeSortOrder=function(){return this.onChange("sortOrder","sort order element",function(a){return f.map(a,JSON.stringify)})},b.prototype.onChangeLogic=function(){return this.onChange("constraintLogic","constraint logic element",function(a){var b;return null!=(b=null!=a?a.match(/([A-Z]+)/):void 0)?b:[]})},b.prototype.triggerChangedCurrent=function(){return this.trigger("changed:current",this.last())},b.prototype.onChange=function(a,b,c){var d,e,g,h,i,j,k,l;return null==c&&(c=function(a){return a}),h=this.currentQuery,g=this.last().get("query"),k=c(g[a]),l=c(h[a]),j=k.length,e=l.length,d=Math.abs(j-e),i=function(){switch(!1){case!(e>j):return"Added";case!(j>e):return"Removed";case e!==f.union(k,l).length:return"Rearranged";default:return"Changed"}}(),this.addStep(i,d,b,h)},b.prototype.setInitialState=function(a){return this.size()&&this.reset(),this.addStep(null,null,"Initial",a)},b.prototype.addStep=function(a,b,c,d){var e,f;return f=this.currentQuery,e=d.clone(),this.unwatch(),this.add({query:e,revision:this.currentStep++,title:{verb:a,number:b,label:c}}),null!=f&&f.trigger("replaced:by",e),this.triggerChangedCurrent()},b.prototype.popState=function(){return this.revertToIndex(-2)},b.prototype.revertToIndex=function(a){var b;return 0>a&&(a=this.length+a),b=this.at(a),this.revertTo(b)},b.prototype.revertTo=function(a){var b,c;if(!this.contains(a))throw new Error("State not in history");for(c=this.getCurrentQuery(),b=a.get("revision");this.last().get("revision")>b;)this.pop();return this.watch(a),null!=c&&c.trigger("replaced:by",a.get("query")),this.triggerChangedCurrent()},b}(c)}).call(this)},{"../core/collection":5,"./step":59,underscore:312}],46:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-model"),b.exports=d=function(a){function b(a,c,d){b.__super__.constructor.call(this,{classes:null!=c?c.map(String):void 0,id:d}),this.set({"service:base":a}),this.freeze("service:base","id","classes")}return g(b,a),b.prototype.toJSON=function(){var a,c;return c=this.get("service:url"),a=/^http/.test(c)?c:this.get("service:base")+c,e.extend(b.__super__.toJSON.apply(this,arguments),{"report:uri":a})},b.prototype.merge=function(a,b){return this.set(b,a.value),this.set({"service:url":a.url})},b}(c)}).call(this)},{"../core-model":2,underscore:312}],47:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("../core/collection"),f=a("./path"),d=function(a){function b(a){var c,d;c=a.path,d=a.style,b.__super__.constructor.call(this,c),null!=d&&this.set({style:d})}return i(b,a),b.prototype.defaults=function(){return g.extend(b.__super__.defaults.apply(this,arguments),{style:"INNER"})},b}(f),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.model=d,b.prototype.comparator="displayName",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:displayName",this.sort)},b.prototype.getJoins=function(){return g.object(this.where({style:"OUTER"}).map(function(a){return[a.get("path"),a.get("style")]}))},b}(c),e.fromQuery=function(a){var b,c,f,g,h,i,j,k,l;b=new e,k=a.joins;for(f in k)h=k[f],g=a.makePath(f),b.add(new d({style:h,path:g}));for(l=a.getQueryNodes(),i=0,j=l.length;j>i;i++)for(c=l[i];!c.isRoot();)b.add(new d({path:c})),c=c.getParent();return b}}).call(this)},{"../core/collection":5,"./path":56,underscore:312}],48:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("../core-model"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.defaults=function(){return{columnName:null,columnTypeName:null,columnName:null,typeName:null,column:null,node:null,fieldName:null,contentName:null,view:[],rows:[]}},b.prototype.initialize=function(){return this.onChangeColumn(),this.listenTo(this,"change:column",this.onChangeColumn)},b.prototype.onChangeColumn=function(){var a,b,c;return a=this.get("column"),b=this.get("node"),c=this.get("view"),1===c.length&&(a=a.model.makePath(c[0],a.subclasses),b=a.isAttribute()?a.getParent():a),b.getType().getDisplayName().then(function(a){return function(b){return a.set({columnTypeName:b})}}(this)),a.getDisplayName().then(function(b){return function(c){return b.set({columnName:c}),a.isAttribute()&&b.set({fieldName:e.last(c.split(" > "))}),b.set({contentName:e.compact([b.get("columnTypeName"),b.get("fieldName")]).join(" ")})}}(this))},b.prototype.getPath=function(){return this.get("column")},b.prototype.toJSON=function(){return e.extend(b.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),rows:this.get("rows").map(function(a){return a.map(function(a){return a.toJSON()})})})},b}(c)}).call(this)},{"../core-model":2,underscore:312}],49:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-model"),b.exports=d=function(a){function b(a,c){b.__super__.constructor.call(this),this.set({id:null,isNULL:!0,classes:[a],"service:base":"","service:url":"","report:uri":null}),c&&this.set(c,null)}return f(b,a),b}(c)}).call(this)},{"../core-model":2}],50:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("underscore"),c=a("backbone"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype._defaults={},b.prototype.setLimits=function(a){return e.extend(this._defaults,a)},b.prototype.get=function(a){var c;return c=b.__super__.get.call(this,a),null!=c?c:a in this._defaults?this._defaults[a]:null},b.prototype.toJSON=function(){return e.extend({},this._defaults,this.attributes)},b.prototype.nullify=function(){var a,b,c,d,e;for(this.unset("min"),this.unset("max"),this.nulled=!0,d=["change:min","change:max","change"],e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.trigger(a,this));return e},b.prototype.reset=function(){return this.clear(),this.trigger("reset",this)},b.prototype.set=function(a,c){var d;return this.nulled=!1,e.isString(a)&&a in this._defaults?(d="min"===a?"max":"min",b.__super__.set.call(this,a,Math[d](this._defaults[a],c))):b.__super__.set.apply(this,arguments)},b.prototype.isAll=function(){return!this.isNotAll()},b.prototype.isNotAll=function(){var a,b,c;return this.nulled?!1:(c=this.toJSON(),b=c.min,a=c.max,null!=b&&b!==this._defaults.min||null!=a&&a!==this._defaults.max)},b}(c.Model)}).call(this)},{backbone:232,underscore:312}],51:[function(a,b,c){(function(){var c,d,e;e=a("underscore"),c=a("./intermine-object"),b.exports=d=function(){function a(a,b){if(this.schema=b,null==a)throw new Error("No root");if(null==this.schema)throw new Error("no schema");this.base=a.replace(/\/service\/?$/,""),this._objects={}}return a.prototype.get=function(a,b){var c,d,e;return c=null!=(d=this._objects)[e=a.id]?d[e]:d[e]=this._newObject(a),c.merge(a,b),c},a.prototype._newObject=function(a){var b,d;return d=function(){var c,d,e,f,g,h;for(g=null!=(e=null!=(f=a["class"])?f.split(","):void 0)?e:[],h=[],c=0,d=g.length;d>c;c++)b=g[c],h.push(this.schema.makePath(b));return h}.call(this),new c(this.base,d,a.id)},a.prototype.destroy=function(){var a,b,c;c=this._objects;for(a in c)b=c[a],b.destroy();return delete this.selectedObjects,delete this._objects},a}()}).call(this)},{"./intermine-object":46,underscore:312}],52:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),e=a("./uniq-items"),f=function(a,b){if(!(null!=a?a.equals:void 0)||!(null!=b?b.isRoot:void 0))return!1;for(;!a.equals(b);){if(b.isRoot())return!1;b=b.getParent()}return!0},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.contains=function(a){return a instanceof c.Model?b.__super__.contains.call(this,a):this.any(function(b){return f(a,b.get("item"))})},b.prototype.remove=function(a){var d,e,g,h,i;if(null==a)return!1;for(a instanceof c.Model&&b.__super__.remove.call(this,a),d=this.filter(function(b){return f(a,b.get("item"))}),i=[],g=0,h=d.length;h>g;g++)e=d[g],i.push(b.__super__.remove.call(this,e));return i},b}(e)}).call(this)},{"./uniq-items":62,backbone:232}],53:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("./path"),b.exports=c=function(a){function b(a){var c,d;d=a.path,c=a.direction,b.__super__.constructor.call(this,d),null==c&&(c="ASC"),this.set({direction:c})}return f(b,a),b.prototype.asOrderElement=function(){return this.pick("path","direction")},b.prototype.toOrderString=function(){return""+this.get("path")+" "+this.get("direction")},b}(d)}).call(this)},{"./path":56}],54:[function(a,b,c){(function(){var a;b.exports=a=function(){function a(a,b){if(this.start=a,this.size=null!=b?b:null,!(null!=this.start&&this.start>=0))throw new Error("Start must be >= 0");if(null!=this.size&&this.size<0)throw new Error("Size must be null or Natural")}return a.prototype.end=function(){return this.all()?null:this.start+this.size},a.prototype.all=function(){return!this.size},a.prototype.isBefore=function(a){return null!=this.size&&this.end()<a},a.prototype.isAfter=function(a){return a<this.start},a.prototype.leftGap=function(a){return this.isAfter(a)?this.start-a:null},a.prototype.rightGap=function(a){return this.isBefore(a)?a-this.end():null},a.prototype.next=function(){return new a(this.end(),this.size)},a.prototype.prev=function(){return new a(Math.max(0,this.start-this.size),this.size)},a.prototype.toString=function(){return"Page("+this.start+" .. "+this.end()+")"},a}()}).call(this)},{}],55:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("./uniq-items"),c=a("backbone"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.paths=function(){return this.map(function(a){return a.get("item")})},b.prototype.contains=function(a){return this.any(function(b){return a.equals(b.get("item"))})},b.prototype.toggle=function(a){return this.contains(a)?this.remove(a):this.add(a)},b.prototype.remove=function(a){var d;return a instanceof c.Model?b.__super__.remove.apply(this,arguments):(d=this.find(function(b){return a.equals(b.get("item"))}),null!=d?b.__super__.remove.call(this,d):void 0)},b}(e)}).call(this)},{"./uniq-items":62,backbone:232}],56:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};d=a("../core-model"),g=a("imjs").Model,e=g.NUMERIC_TYPES,c=g.BOOLEAN_TYPES,b.exports=f=function(a){function b(a){b.__super__.constructor.call(this),this.set(this.pathAttributes(a)),this.setDisplayName(a),this.setTypeName(a),this.pathInfo=function(){return a},this.freeze("path","isNumeric","isBoolean","isReference","isAttribute")}return i(b,a),b.prototype.defaults=function(){return{path:null,type:null,displayName:null,typeName:null,parts:[],isNumeric:!1,isBoolean:!1,isReference:!1,isAttribute:!0}},b.prototype.setDisplayName=function(a){return a.getDisplayName().then(function(a){return function(b){return a.set({displayName:b,parts:b.split(" > ")}),a.freeze("displayName","parts")}}(this))},b.prototype.setTypeName=function(a){var b;return b=(a.isAttribute()?a.getParent():a).getType(),b.getDisplayName().then(function(a){return function(b){return a.set({typeName:b})}}(this))},b.prototype.pathAttributes=function(a){var b,d,f,g,h;return f=String(a),d=a.isAttribute(),g=a.getType(),b={id:d?f:""+f+".id",path:f,type:null!=(h=g.name)?h:g},d?(b.isNumeric=j.call(e,g)>=0,b.isBoolean=j.call(c,g)>=0):(b.isReference=!0,b.isAttribute=!1),b},b}(d)}).call(this)},{"../core-model":2,imjs:290}],57:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),d=a("../core-model"),c=a("../core/collection"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults=function(){return{index:null,query:null,cells:[]}},b.prototype.toJSON=function(){var a;return g.extend(b.__super__.toJSON.apply(this,arguments),{cells:function(){var b,c,d,e;for(d=this.get("cells"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.toJSON());return e}.call(this)})},b}(d),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.model=e,b.prototype.comparator="index",b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,underscore:312}],58:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-model"),c=a("../core/collection"),g=a("../core/type-assertions"),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults=function(){return{"class":null,id:null}},b.prototype.validate=function(a,b){return"class"in a&&null==a["class"]?'"class" must not be null':"id"in a&&null==a.id?'"id" must not be null':!1},b}(d),b.exports=e=function(a){function b(a){b.__super__.constructor.call(this),g.assertMatch(g.Service,a,"service"),this.state=new d({node:null,commonType:null,typeName:null}),this.listenTo(this.state,"change:commonType",this.onChangeType),this.listenTo(this.state,"change:node",this.onChangeNode),this.listenTo(this,"add remove reset",this.setType),a.fetchModel().then(function(a){return function(b){return a.schema=b,a.setType()}}(this))}return i(b,a),b.prototype.model=f,b.prototype.onChangeNode=function(){return this.trigger("change:node change",this.state.get("node"))},b.prototype.onChangeType=function(){var a,b;if(null!=this.schema)return b=this.state.get("commonType"),null==b?this.state.set({typeName:null}):(a=this.schema.makePath(b),a.getDisplayName().then(function(a){return function(b){return a.state.set({typeName:b}),a.trigger("change:typeName change")}}(this)),this.trigger("change:commonType change"))},b.prototype.setType=function(){var a;if(null!=this.schema)return a=this.size()?a=this.schema.findCommonType(this.map(function(a){return a.get("class")})):null,null!=a?this.state.set({commonType:a}):this.state.set({commonType:null,typeName:null})},b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,"../core/type-assertions":10}],59:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../core-model"),d=a("../utils/count-executor"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.defaults=function(){return{count:0}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.set({createdAt:new Date}),this.listenTo(this,"change:query",this._setCount),this._setCount()},b.prototype._setCount=function(){var a;return a=this.get("query"),null!=a?d.count(a).then(function(a){return function(b){return a.set({count:b})}}(this)):this.set({count:0})},b.prototype.toJSON=function(){return f.extend(b.__super__.toJSON.apply(this,arguments),{query:this.get("query").toJSON()})},b}(c)}).call(this)},{"../core-model":2,"../utils/count-executor":77,underscore:312}],60:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),d=a("../core-model"),c=a("../core/collection"),e=a("../options"),j=a("../services/column-summary").getColumnSummary,k=function(a){return"int"===a||"Integer"===a||"long"===a||"Long"===a||"short"===a||"Short"===a},b.exports=i=function(a){function b(a){var c,d;if(this.query=a.query,this.view=a.view,b.__super__.constructor.call(this),null==this.query)throw new Error("No query in call to new SummaryModel");if(null==this.view)throw new Error("No view in call to new SummaryModel");this.fetch=l.partial(j,this.query,this.view),d=this.view.getType(),c=k(d),this.set({limit:e.get("INITIAL_SUMMARY_ROWS"),canHaveMultipleValues:this.query.canHaveMultipleValues(this.view),type:d,integral:c}),this.histogram=new f,this.items=new h,this.listenTo(this,"change:filterTerm",this.onFilterChange),this.listenTo(this,"change:summaryLimit",this.onLimitChange),this.listenTo(this.query,"change:constraints",this.load),this.load()}return n(b,a),b.prototype.defaults=function(){return{error:null,maxCount:null,loading:!1,initialized:!1,canHaveMultipleValues:!1,numeric:!1,filterTerm:null}},b.prototype.destroy=function(){return this.histogram.close(),this.items.close(),b.__super__.destroy.apply(this,arguments)},b.prototype.getMaxCount=function(){return this.get("maxCount")},b.prototype.hasMore=function(){return!this.get("numeric")&&this.get("got")<this.get("uniqueValues")},b.prototype.hasAll=function(){return!this.hasMore()},b.prototype.toJSON=function(){return l.extend(b.__super__.toJSON.apply(this,arguments),{items:this.items.toJSON(),histogram:this.getHistogram()})},b.prototype.onFilterChange=function(){return this.hasAll()?this.filterLocally():this.load()},b.prototype.filterLocally=function(){var a,b,c;return a=this.get("filterTerm"),null!=a?(b=a.toLowerCase().split(/\s+/),c=function(a){return l.all(b,function(b){return!(!a||!~a.toLowerCase().indexOf(b))})},this.items.each(function(a){return a.show(c(a.get("item")))})):this.items.each(function(a){return a.show()})},b.prototype.increaseLimit=function(a){var b;return null==a&&(a=2),b=a*this.get("limit"),this.set({limit:b})},b.prototype.onLimitChange=function(){return this.load()},b.prototype.setFilterTerm=function(a){return this.set({filterTerm:a})},b.prototype.fetchAll=function(){return this.set({limit:null})},b.prototype.load=function(){return this.set({loading:!0}),this.fetch(this.get("filterTerm"),this.get("limit")).then(this.getSummaryHandler()).then(null,function(a){return function(b){return a.set({error:b})}}(this))},b.prototype.getSummaryHandler=function(){var a;return this.lastSummaryHandlerCreatedAt=a=l.now(),function(b){return function(c){return b.handleSummary(a,c)}}(this)},b.prototype.getHistogram=function(){var a,b,c,d,e,f;if(b=this.get("buckets"),!b)return[];for(f=[],a=c=1;b>=1?b>=c:c>=b;a=b>=1?++c:--c)f.push(null!=(d=null!=(e=this.histogram.get(a))?e.get("count"):void 0)?d:0);return f},b.prototype.handleSummary=function(a,b){var c,d,e,f,g,h,i,j,k,m,n,o,p,q;return o=b.stats,n=b.results,a===this.lastSummaryHandlerCreatedAt?(m=null!=o.max,k={filteredCount:o.filteredCount,uniqueValues:o.uniqueValues,available:null!=(q=o.filteredCount)?q:o.uniqueValues,got:n.length,numeric:m,initialized:!0,loading:!1},m?(e=o.buckets,i=o.max,j=o.min,p=o.stdev,c=o.average,l.extend(k,{buckets:e,max:i,min:j,stdev:parseFloat(p),average:parseFloat(c)}),this.items.size()&&this.items.reset(),this.histogram.set(function(){var a,b,c,e;for(e=[],a=0,b=n.length;b>a;a++)c=n[a],d=c.bucket,f=c.count,e.push({item:d,count:f,id:d});return e}()),k.maxCount=this.histogram.getMaxCount()):(this.histogram.size()&&this.histogram.reset(),this.items.set(function(){var a,b,c,d;for(d=[],g=a=0,b=n.length;b>a;g=++a)c=n[g],h=c.item,f=c.count,d.push({item:h,count:f,id:g});return d}()),k.maxCount=this.items.getMaxCount()),this.set(k)):void 0},b}(d),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.defaults=function(){return{symbol:null,share:null,visible:!0,selected:!1,hover:!1,count:0,item:null}},b.prototype.select=function(){return this.set({selected:!1})},b.prototype.deselect=function(){return this.set({selected:!1})},b.prototype.hide=function(){return this.set({visible:!1})},b.prototype.show=function(a){return null==a&&(a=!0),this.set({visible:a})},b.prototype.mousein=function(){return this.set({hover:!0})},b.prototype.mouseout=function(){return this.set({hover:!1})},b}(d),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.model=g,b.prototype.getMaxCount=function(){var a;return null!=(a=this.first())?a.get("count"):void 0},b}(c),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.model=g,b.prototype.getMaxCount=function(){var a;return l.max(function(){var b,c,d,e;for(d=this.models,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.get("count"));return e}.call(this))},b}(c)}).call(this)},{"../core-model":2,"../core/collection":5,"../options":63,"../services/column-summary":65,underscore:312}],61:[function(a,b,c){(function(){var c,d,e,f,g=function(a,b){return function(){return a.apply(b,arguments)}},h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,
a.__super__=b.prototype,a};d=a("../options"),c=a("../core-model"),e=a("./path-set"),b.exports=f=function(a){function b(){return this.filled=g(this.filled,this),b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.defaults=function(){return{phase:"FETCHING",start:0,size:d.get("DefaultPageSize"),count:null,fill:0,error:null,selecting:!1,previewOwner:null,highlitNode:null,minimisedColumns:new e}},b.prototype.initialize=function(){var a;return a=this.get("minimisedColumns"),this.listenTo(a,"add remove reset",function(){return this.trigger("change:minimisedColumns change")}),this.freeze("minimisedColumns")},b.prototype.filled=function(){return this.swap("fill",function(a){return a+1})},b.prototype.toJSON=function(){var a;return a=b.__super__.toJSON.apply(this,arguments),a.minimisedColumns=this.get("minimisedColumns").toJSON().map(String),a},b.prototype.destroy=function(){return this.get("minimisedColumns").close(),b.__super__.destroy.apply(this,arguments)},b}(c)}).call(this)},{"../core-model":2,"../options":63,"./path-set":55}],62:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("backbone"),h=a("underscore"),e=a("../core-model"),d=a("../core/collection"),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.initialize=function(a,b){return null!=b&&this.set(b),this.set({item:a,id:String(a)})},b}(e),b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.model=f,b.prototype.toJSON=function(){var a,b,c,d,e;for(d=this.models,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.get("item"));return e},b.prototype.togglePresence=function(a){return this.contains(a)?this.remove(a):this.add(a)},b.prototype.get=function(a){return b.__super__.get.call(this,a instanceof c.Model?a:String(a))},b.prototype.contains=function(a){return a instanceof f?b.__super__.contains.call(this,a):null!=this.findWhere({item:a})},b.prototype.add=function(a,c){var d,e,g,i;for(a=h(a).isArray()?a:[a],i=[],e=0,g=a.length;g>e;e++)d=a[e],null!=d&&""!==d&&(this.contains(d)?i.push(void 0):i.push(b.__super__.add.call(this,new f(d,c))));return i},b.prototype.remove=function(a,c){var d,e,g,i;for(a=h(a).isArray()?a:[a],i=[],e=0,g=a.length;g>e;e++)d=a[e],d instanceof f?i.push(b.__super__.remove.call(this,d,c)):i.push(b.__super__.remove.call(this,this.findWhere({item:d}),c));return i},b}(d)}).call(this)},{"../core-model":2,"../core/collection":5,backbone:232,underscore:312}],63:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("./core/nested-model"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.defaults=function(){return{INITIAL_SUMMARY_ROWS:1e3,NUM_SEPARATOR:",",NUM_CHUNK_SIZE:3,MAX_PIE_SLICES:15,DropdownMax:20,DefaultPageSize:25,DynamicObjects:{NameDelimiter:" / "},CodeGen:{Default:"py",Langs:["py","pl","java","rb","js","xml"],Extra:{js:"codegen.AsHTML"}},ListFreshness:250,MaxSuggestions:1e3,ListCategorisers:["organism.name","department.company.name"],PieColors:"category10",TableResults:{CacheFactor:10,RequestLimit:5e3},TableHeader:{FullPathPopoverEnabled:!0},TableCell:{AddDataClasses:!0,PreviewTrigger:"hover",HoverDelay:200,IndicateOffHostLinks:!0,ExternalLinkIcons:{"http://some.host.somewhere":"http://some.host.somewhere/logo.png"}},ItemDetails:{ShowReferenceCounts:!1,Fields:{},Count:{}},StylePrefix:"imtables",SuggestionDepth:2,Events:{ActivateTab:"mouseenter"},Subtables:{Initially:{expanded:!1}},Facets:{DrawAverageLine:!0,Initially:{Open:!0}},Destinations:["download","Galaxy","GenomeSpace","Drive","Dropbox"],Destination:{download:{Enabled:!0},Galaxy:{Main:"http://main.g2.bx.psu.edu",Current:null,Tool:"flymine",Save:!1,Enabled:!0},GenomeSpace:{Upload:"https://gsui.genomespace.org/jsui/upload/loadUrlToGenomespace.html",Enabled:!0},Drive:{Library:"https://apis.google.com/js/client.js",Enabled:!1},Dropbox:{Library:"https://www.dropbox.com/static/api/2/dropins.js",Enabled:!1}},ShowId:!1,TableWidgets:{Pagination:{enabled:!0,index:0},PageSizer:{enabled:!0,index:1},TableSummary:{enabled:!0,index:2}},CellCutoff:100,ShowHistory:!0,icons:"fontawesome",D3:{Transition:{Easing:"exp",Duration:500,DurationShort:200}},brand:{"http://www_flymine_org/query/service/":{name:"FlyMine"},"http://preview_flymine_org/preview/service/":{name:"FlyMine-Preview"},"http://www_mousemine_org/mousemine/service/":{name:"MouseMine (MGI)"}},Formatters:{testmodel:{},genomic:{}},ColumnManager:{SelectColumn:{Multi:!0}},UndoHistory:{ShowAllStatesCutOff:6}}},b}(c),b.exports=new d,b.exports.Options=d}).call(this)},{"./core/nested-model":8}],64:[function(a,b,c){(function(){c.IS_BLANK=/^\s*$/}).call(this)},{}],65:[function(a,b,c){(function(){var a,b;a={},b=function(a,b){return""+a.service.root+":"+a.service.token+":"+a.toXML()+":"+b},c.getColumnSummary=function(c,d,e,f){var g;return null!=a[g=b(c,d,e,f)]?a[g]:a[g]=function(){return c.filterSummary(d,e,f)}()}}).call(this)},{}],66:[function(a,b,c){(function(b){(function(){var c,d,e,f;f=b.jQuery,e=c=a("jquery"),d=a("backbone"),d.$=e,b.jQuery=c,a("bootstrap"),a("typeahead.js"),a("jquery-ui/slider"),a("jquery-ui/draggable"),a("jquery-ui/droppable"),a("jquery-ui/sortable"),null!=f?b.jQuery=f:delete b.jQuery}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{backbone:232,bootstrap:233,jquery:309,"jquery-ui/draggable":303,"jquery-ui/droppable":304,"jquery-ui/slider":306,"jquery-ui/sortable":307,"typeahead.js":311}],67:[function(a,b,c){function d(a){if(!a)throw new Error("Name is required.");if(a=a.replace(/-/g,"_"),templ=f[a],templ)return templ;throw new Error('No template registered as "'+a+'"')}var e=a("underscore"),f=c;c.template=function(a,b){return e.template(d(a),b)},c.templateFromParts=function(a,b){var c=a.map(d).join("\n");return e.template(c,b)},f.clear='<div style="clear:both"></div>',c.constraint_adder='<div class="im-constraint-adder-options"></div>\n<div class="im-path-finder"><div>\n<div class="im-new-constraint"></div>\n',c.value_control_row='<td>\n  <input type="checkbox" {{ (selected) ? \'checked\' : void 0 }}>\n</td>\n<td class="im-multi-value">\n  {{# if (editing) { }}\n    <div class="input-group">\n      <input type="text" value="{{ value }}" class="form-control">\n      <span class="input-group-btn">\n        <button class="btn btn-success im-save"\n                title="{{ messages.getText(\'multivalue.SaveValue\') }}"\n                type="button">\n            {{{ icons.icon(\'OK\') }}}\n            <span class="im-long">{{ messages.getText(\'multivalue.SaveValue\') }}</span>\n        </button>\n        <button class="btn btn-danger im-cancel"\n                title="{{ messages.getText(\'Cancel\') }}"\n                type="button">\n            {{{ icons.icon(\'Cancel\') }}}\n            <span class="im-long">{{ messages.getText(\'Cancel\') }}</span>\n        </button>\n      </span>\n    </div>\n  {{# } else { }}\n    <a class="im-edit pull-right">{{{ icons.icon(\'Edit\') }}}</a>\n    {{ value }}\n  {{# } }}\n</td>\n',c.constraints_heading="<% /* requires constraints.length */ %>\n<h3>\n  <%- Messages.getText('constraints.Heading', {n: constraints.length}) %>\n</h3>\n",c.join_style='<% /* requires innerJoinBtn, outerJoinBtn */ %>\n<div class="btn-group pull-right">\n  <button class="<%- innerJoinBtn %>">\n    <%- Messages.getText(\'joins.Inner\') %>\n  </button>\n  <button class="<%- outerJoinBtn %>">\n    <%- Messages.getText(\'joins.Outer\') %>\n  </button>\n</div>\n',c.export_row_controls='<h4 class="im-title"></h4>\n\n<div class="form-group">\n    <label class="size-label"></label>\n    <input name="size"\n           step="1"\n           type="range"\n           min="1"\n           max="<%= max %>"\n           value="<%= size || max %>">\n</div>\n\n<div class="form-group">\n    <label class="start-label"></label>\n    <input name="start"\n           step="1"\n           type="range"\n           min="0"\n           max="<%= max - 1 %>"\n           value="<%= start %>">\n</div>\n\n<div class="form-group im-reset">\n</div>\n',c.summary_no_results="<div class=\"alert alert-warning\">\n    <%= Icons.icon('Warning') %>\n    <%- Messages.getText('summary.NoResults', {path: pathName}) %>\n</div>\n\n",c.page_sizer='<% /* Expects size, sizes */ %>\n<% if (sizes.length) { %>\n    <label>\n        <span class="hidden-tablet">Rows per page:</span>\n    </label>\n    <select class="form-control" title="Rows per page">\n        <% sizes.forEach(function (s) { %>\n            <option value="<%= s[0] %>" <%= (s[0] === size) && \'selected\' %>>\n            <%= s[1] || s[0] %>\n            </option>\n        <% }); %>\n    </select>\n<% } %>\n',c.modal_dialogue_opener='<button class="btn btn-default im-open-dialogue">\n  <%= Icons.icon(labels.ICON) %>\n  <span class="im-hidden-sm hidden-sm hidden-xs">\n    <%- Messages.getText(labels.LONG, state) %>\n  </span>\n  <span class="im-visible-sm-inline visible-sm-inline">\n    <%- Messages.getText(labels.SHORT, state) %>\n  <span>\n</button>\n',c.summary_selected_count="<% if (state.selectedCount) { %>\n    <div class=\"alert alert-info im-selected-count\">\n        <strong>\n            <%- Messages.getText('summary.SelectedCount', state) %>\n        </strong>\n    </div>\n<% } %>\n",c.export_add_column_control='<div class="row">\n    <div class="col-sm-1 im-help"\n         title="<%- Messages.getText(\'export.help.AdditionalCols\') %>">\n        <%= Icons.icon(\'Help\', \'lg\') %>\n    </div>\n    <div class="col-sm-11 form-group">\n        <input type="text" class="form-control">\n    </div>\n</div>\n',c.type_value_controls="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",c.select_with_label='<label><%- Messages.getText(label) %></label>\n\n<% if (options.length) { %>\n    <select class="form-control">\n        <% _.each(options, function (option) { %>\n            <option selected="<%= selected(option) ? \'selected\' : void 0 %>"\n                    value="<%- option.name %>">\n                <%- Messages.getText(optionLabel, option) %>\n            </option>\n        <% }) %>\n    </select>\n    <% if (helpMessage) { %>\n        <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n              class="help-block">\n                <%- Messages.getText(helpMessage) %>\n        </span>\n    <% } %>\n<% } else { %>\n    <span class="help-block">\n        <%- Messages.getText(noOptionsMessage, {model: model}) %>\n    </span>\n<% } %>\n\n',c.export_fasta_options='<h3><%- Messages.getText(\'export.category.Options\') %></h3>\n\n<div class="form-group">\n    <label><%- Messages.getText(\'FastaExtension\') %></label>\n    <input type="text"\n           value="<%- fastaExtension %>"\n           placeholder="5kbp"\n           class="form-control im-fasta-ext">\n</div>\n',c.list_dialogue_button_node='<a href="#">\n    <strong>\n        <%- displayName || path %>\n    </strong>\n    <% if (state.count) { %>\n        (<%- numToString(state.count) %>\n        <%- pluralise((typeName || type), state.count) %>)\n    <% } %>\n</a>\n',c.undo_history='<button class="btn btn-default im-undo">\n  <%= Icons.icon(\'Undo\') %>\n  <span class="visible-lg-inline">\n    <%- Messages.getText(\'Undo\') %>\n  </span>\n</button>\n\n<button class="btn btn-default dropdown-toggle"\n        data-toggle="dropdown">\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu im-state-list">\n    <li>\n      <button\n          title="<%- Messages.getText(\'undo.ToggleTrivialTitle\', state) %>"\n          class="btn btn-xs btn-default im-toggle-trivial <%= state.hideTrivial ? \'active\' : void 0 %>">\n        <%- Messages.getText(\'undo.ToggleTrivial\', state) %>\n      </button>\n    </li>\n</ul>\n',c.cell_preview_reference_relation='<% _.each(collection, function (relation) { %>\n  <li class="im-relation">\n    <span class="im-name"><%- _.last(relation.parts) %></span>\n    <span class="im-count"><%- numToString(relation.count) %></span>\n  </li>\n<% }); %>\n',c.select='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',c.list_dialogue_expander="<button class=\"btn btn-default im-expand-dialogue <%= minimised ? 'active' : void 0 %>\">\n  <%- Messages.getText('lists.picker.Collapse') %>\n</button>\n",c.code_gen_body='<div class="row">\n  <div class="col-sm-2">\n    <% /* requires lang :: string, options :: {Extra :: {}, Langs :: [string]} */ %>\n    <div class="btn-group language-selector">\n      <button type="button"\n              data-toggle="dropdown"\n              aria-expanded="false"\n              class="btn btn-default dropdown-toggle">\n        <span class="im-current-lang">\n          <%- Messages.getText(\'codegen.Lang\', {lang: lang}) %>\n        </span>\n        <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>"\n                class="<%= (l === lang) ? \'active\' : void 0 %>">\n              <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n      </ul>\n    </div>\n    <div class="im-show-boilerplate"></div>\n    <div class="im-highlight-syntax"></div>\n    <div class="im-extra-options"></div>\n  </div>\n  <div class="col-sm-10">\n    <pre class="im-generated-code"><%- generatedCode %></pre>\n  </div>\n</div>\n',c.checkbox="<label>\n    <input type=\"checkbox\" \n           <%= checked ? 'checked' : void 0 %>\n           >\n    <%- label %>\n</label>\n",c.table_cell='<% if (state.minimised) { %>\n  &hellip;\n<% } else if (entity.id == null) { %>\n  <% if (value != null && formattedValue != null) { %>\n    <span class="im-displayed-value"><%= value %></span>\n  <% } else if (entity.isNULL) { %>\n    <span class="im-null-entity">\n      <%- Messages.getText(\'table.cell.NullEntity\', {type: entity[\'class\']}) %>\n    </span>\n  <% } else { %>\n    <%= NULL_VALUE %>\n  <% } %>\n<% } else { %>\n  <input\n    class="im-list-chooser"\n    type="checkbox"\n    <% if (input.checked) { %>checked<% } %>\n    <% if (input.disabled) { %>disabled<% } %>\n    style="display:<%- input.display %>">\n\n  <a class="im-cell-link" target="<%- target %>" href="<%= url %>">\n\n    <% if (isForeign) { %>\n      <% if (icon) { %>\n        <img src="<%= icon %>" class="im-external-link"></img>\n      <% } else { %>\n        <%= Icons.icon(\'ExternalLink\') %>\n      <% } %>\n    <% } %>\n\n    <% if (value != null && formattedValue != null) { %>\n      <span class="im-displayed-value"><%= formattedValue %></span>\n    <% } else { %>\n      <%= NULL_VALUE %>\n    <% } %>\n\n  </a>\n\n  <% if (value != null && field === \'url\' && rawValue != url) { %>\n    <a class="im-cell-link external" href="<%= rawValue %>">\n      <%= Icons.icon(\'ExternalLink\') %>\n      <%- Messages.getText(\'table.cell.Link\') %>\n    </a>\n  <% } %>\n<% } %>\n',c.export_dialogue_footer='<% if (linkToFile) { %>\n    <div class="pull-left alert alert-info">\n        <%- Messages.getText(\'export.cloud.FileLocation\', {cloud: dest}) %>\n        <a href="<%= linkToFile %>" target="_blank"><%- linkToFile %></a>\n    </div>\n<% } %>\n\n<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n\n<% if (dest === \'download\') { %>\n    <a class="btn btn-primary"\n        href="<%- exportURI %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <button type="button"\n            <%= (error || doneness != null) ? \'disabled\' : void 0 %>\n            class="btn btn-primary">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </button>\n<% } %>\n\n',c.formatted_sorting="<a> <% /* requires Icons, direction and name */ %>\n    <%= Icons.icon(direction || 'unsorted') %>\n    <span class=\"im-sort-path\"><%- name %></span>\n</a>\n",c.modal_footer='<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n<% if (exportLink != null) { %>\n    <a class="btn btn-primary"\n        <%= (error) ? \'disabled\' : void 0 %>\n        href="<%- exportLink %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <% /* We need the wrapper to deal with the fact that tooltips do not\n        * work on disabled buttons. */ %>\n    <div class="im-tooltip-wrapper"\n        <% if (disabled && disabledReason) { %>\n          title="<%- Messages.getText(disabledReason)  %>"\n        <% } %>>\n        <button type="button"\n                <%= (error || disabled) ? \'disabled\' : void 0 %>\n                class="btn btn-primary">\n            <%= Icons.icon(primaryIcon) %>\n            <%- primaryAction %>\n        </button>\n    </div>\n<% } %>\n',c.column_manager_position_controls="<div class=\"im-position-controls\">\n    <% if (index > 0) { %>\n        <%= Icons.iconWithProps('ASC', {\n            className: 'im-move-up',\n            title: Messages.getText('columns.MoveUp')\n        }) %>\n    <% } %>\n    <% if (!isLast) { %>\n        <%= Icons.iconWithProps('DESC', {\n            className: 'im-move-down',\n            title: Messages.getText('columns.MoveDown')\n        }) %>\n    <% } %>\n</div>\n\n",c.row_surrogate="<%= Icons.icon(above ? 'ASC' : 'DESC') %>\n<%- item %>: <%- count %>\n",c.list_dialogue_button='<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">\n  <%= Icons.icon(\'Lists\') %>\n  <span class="hidden-xxs">\n    <%- Messages.getText(\'lists.SaveAsList\') %>\n  </span>\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu dropdown-menu-right" role="menu">\n    <li class="divider"></li>\n    <li>\n        <a class="im-pick-items" href="#">\n            <%- Messages.getText(\'lists.StartPicking\') %>\n        </a>\n    </li>\n    <li class="divider"></li>\n    <li>\n        <div class="btn-group btn-group-justified" role="group">\n            <a role="button" class="<%- createBtnClasses %>">\n                <%- Messages.getText(\'lists.Create\') %>\n            </a>\n            <a role="button" class="<%- appendBtnClasses %>">\n                <%- Messages.getText(\'lists.Append\') %>\n            </a>\n        </div>\n    </li>\n</ul>\n',c.active_constraint='<div class="im-con-overview">\n  <% if (data.con.editable != null && data.con.editable === false) { %>\n    <a title="<%- data.messages.getText(\'conbuilder.NotEditable\') %>">\n        <%= data.icons.icon(\'Lock\') %>\n    </a>\n  <% } else { %>\n    <a class="im-remove-constraint"\n        title="<%- data.messages.getText(\'conbuilder.Remove\') %>"\n        >\n        <%= data.icons.icon(\'RemoveConstraint\') %>\n    </a>\n    <a class="im-edit" title="<%- data.messages.getText(\'conbuilder.EditCon\') %>">\n        <%= data.icons.icon(\'Edit\') %>\n    </a>\n  <% } %>\n</div>\n\n<% /* We use the :empty selector on this element - hence it must be on one line */ %>\n<div class="im-constraint-editor"></div>\n',c.logic_manager_body='<div class="form-group">\n  <label class="form-label">\n    <%- Messages.getText(\'logic.LogicLabel\') %>\n    <input type="text"\n          class="im-logic form-control"\n          placeholder="<%- state.defaultLogic %>"\n          value="<%- logic %>">\n  </label>\n</div>\n<div class="form-group">\n  <button class="pull-right btn btn-primary <%- (state.disabled) ? \'disabled\' : null %>"\n          type="submit">\n    <%- Messages.getText(\'logic.ApplyLogic\') %>\n  </button>\n</div>\n',c.table_throbber='<tr class="im-table-throbber">\n  <td colspan="<%= colcount %>">\n    <h2><%- Messages.getText(\'table.RequestingData\') %></h2>\n    <div class="progress progress-info progress-striped active">\n      <div class="bar" style="width: 100%"></div>\n    </div>\n  </td>\n</tr>\n',c.join_manager_body="<ul class=\"list-group\"></ul>\n\n<div class=\"alert alert-info\">\n  <%= Icons.icon('Info') %>\n  <strong class=\"im-clickable\">\n    <%- Messages.getText('joins.ExplanationTitle') %>\n  </strong>\n  <p class=\"<%= (!state.explaining) ? 'im-latent' : void 0 %>\">\n    <%- Messages.getText('joins.Explanation') %>\n  </p>\n</div>\n",c.large_table_disuader='<div class="modal-dialog">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h3>\n            <%= size %> rows - are you sure?\n            </h3>\n        </div>\n\n        <div class="modal-body">\n\n            <p><%= Messages.getText(\'largetable.appeal\', {size: size}) %></p>\n\n            <ul>\n                <li>\n                    <p>\n                        If you want to see all the data, you can page \n                        <span class="label label-info">\n                            <%= Icons.icon(\'GoBack\') %>\n                            backwards\n                        </span>\n                        and \n                        <span class="label label-info">\n                            forwards\n                            <%= Icons.icon(\'GoForward\') %>\n                        </span>\n                        through the results.\n                    </p>\n                    <div class="btn-group">\n                        <a class="btn btn-default im-alternative-action page-backwards" href="#">\n                            <%= Icons.icon(\'GoBack\') %>\n                            go one page back\n                        </a>\n                        <a class="btn btn-default im-alternative-action page-forwards" href="#">\n                            go one page forward\n                            <%= Icons.icon(\'GoForward\') %>\n                        </a>\n                    </div>\n                </li>\n\n                <li>\n                    <p>\n                        If you are looking for something specific, you can use the\n                        <span class="label label-info">filtering tools</span>\n                        to narrow down the result set. Then you \n                        might be able to fit the items you are interested in in a\n                        single page.\n                    </p>\n                    <button class="btn btn-default im-alternative-action add-filter-dialogue">\n                        <%= Icons.icon(\'Filter\') %>\n                        Add a new filter.\n                    </button>\n                </li>\n\n                <li>\n                    <p>\n                        If you want to get and save the results, we suggest\n                        <span class="label label-info">downloading</span>\n                        the results in a format that suits you. \n                    <p>\n                    <button class="btn btn-default im-alternative-action download-menu">\n                        <%= Icons.icon(\'Export\') %>\n                        Open the download menu.\n                    </buttn>\n                </li>\n\n            </ul>\n        </div>\n\n        <div class="modal-footer">\n            <button class="btn btn-primary pull-right">\n                <%- Messages.getText(\'largetable.ok\', {size: size}) %>\n            </button>\n            <button class="btn pull-left close">\n                <%- Messages.getText(\'largetable.abort\') %>\n            </button>\n        </div>\n    </div>\n</div>\n',c.input_with_button='<input type="text" class="form-control"\n       value="<%- value %>"\n       placeholder="<%- Messages.getText(placeholder) %>">\n<span class="input-group-btn">\n  <button class="btn btn-default" type="button">\n    <%- Messages.getText(button) %>\n  </button>\n</span>\n\n',c.add_value_control='<div class="im-table-height-wrapper">\n    <table class="table table-condensed"></table>\n</div>\n<div class="input-group">\n    <input type="text" class="im-new-multi-value form-control">\n    <span class="input-group-btn">\n        <button class="btn btn-primary im-add" type="button">\n            <span class="im-long"><%- messages.getText(\'multivalue.AddValue\') %></span>\n            <span class="im-short"><%- messages.getText(\'multivalue.AddValueShort\') %></span>\n        </button>\n    </span>\n</div>\n',c.export_format_controls='<h4 class="im-title"></h4>\n\n<% _.each(formats, function (formatDef) { %>\n    <div class="radio">\n        <label>\n            <input type="radio"\n                   name="format"\n                   value="<%= formatDef.id %>"\n                   <%= (formatDef.id === format) ? \'checked\' : void 0 %>>\n            <%= Icons.icon(formatDef.icon) %>\n            <%= Messages.getText(formatDef.desc) %>\n        </label>\n    </div>\n<% }); %>\n',c.export_column_controls='<h4><%- Messages.getText(\'export.heading.Columns\') %></h4>\n\n<ul class="list-group">\n</ul>\n\n<div class="row controls"></div>\n',c.list_dialogue_body='<div class="im-list-name"></div>\n\n<div class="row">\n  <div class="col-sm-12 im-more-options">\n    <h4>\n      <%= Icons.icon(\'Options\') %>\n      <span class="msg"><%- Messages.getText(\'lists.ShowExtraOptions\', state) %></span>\n    </h4>\n  </div>\n</div>\n\n<div class="im-optional-attributes" style="<%- state.minimised ? \'display:none\' : void 0 %>">\n  <div class="im-list-desc"></div>\n\n  <div class="well im-tags">\n    <div class="row im-active-tags">\n    </div>\n    <div class="row">\n      <div class="col-sm-6 im-apology">\n      </div>\n      <div class="col-sm-6">\n        <div class="im-next-tag">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',c.constraint_editor='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',c.column_manager_path_name='<% /* requires parts */ %>\n<span class="im-path-name">\n    <% _.each(parts, function (part) { %>\n        <span class="im-name-part"><%- part %></span>\n    <% }); %>\n</span>\n\n',c.column_manager_path_remover='<% /* requires: removeTitle */ %>\n<span class="pull-right im-remove-view"\n      title="<%- Messages.getText(removeTitle) %>">\n    <%= Icons.icon(\'Remove\') %>\n</span>\n\n',c.facet_frequency='<% /* requires: error, initialized */ %>\n<% if (error) { %>\n    <% /* Oh noes - something went wrong. */ %>\n    <div class="alert alert-warning">\n        <%= Icons.icon(\'Error\') %>\n        <strong><%- Messages.getText(\'Error\') %></strong>\n        <% if (error.key) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } else if (initialized) { %>\n    <% /* Huzzah - there is data, which will be added here as child views */ %>\n<% } else { %>\n    <% /* Boo - no data. Show an indeterminate progress bar while we wait. */ %>\n    <div class="progress">\n      <div class="progress-bar progress-bar-info progress-bar-striped active"\n           role="progressbar"\n           style="width:100%">\n        <span class="sr-only"><%- Messages.getText(\'Loading\') %>.</span>\n      </div>\n    </div>\n<% } %>\n',c.column_manager_path_chooser_buttons="<button class=\"btn btn-default im-rearrange-columns\">\n  <%- Messages.getText('Cancel') %>\n</button>\n<button class=\"btn btn-success im-add-column\"\n  <%= collection.length ? (void 0) : 'disabled' %> >\n  <%- Messages.getText('columns.AddColumn', {num: collection.length}) %>\n</button>\n\n",c.null_value='<span class="im-null-value">&nbsp;</span>\n',c.table_subtable='<span class="im-subtable-summary">\n</span>\n<div class="im-table-wrapper">\n</div>\n',c.constraint_adder_options='<% if (showTree) { %>\n    <div class="col-sm-5">\n        <div class="input-group">\n            <span class="input-group-addon">find</span>\n            <input type="text"\n                value="<%- filter %>"\n                class="im-tree-filter form-control" placeholder="path">\n            <span class="input-group-btn">\n                <button class="btn btn-default im-clear-filter" type="button">\n                    <%- Messages.getText(\'Clear\') %>\n                </button>\n            </span>\n        </div>\n    </div>\n<% } %>\n<div class="col-sm-7">\n    <div class="btn-group">\n        <% if (!showTree) { %>\n            <button type="button" class="btn btn-default btn-chooser im-choose">\n                <%= Icons.icon(\'Tree\') %>\n                <span><%- Messages.getText(\'constraints.BrowseForColumn\') %></span>\n            </button>\n        <% } else { %>\n            <button <%= anyNodeChosen ? void 0 : \'disabled\' %>\n                    class="btn btn-primary im-approve"\n                    type="button" >\n                <%- Messages.getText(\'constraints.Choose\') %>\n                <% _.each(chosen, function (path, i) { %>\n                    <%- path %>\n                    <% if (i + 2 === chosen.length) { %>\n                        <%- Messages.get(\'and\') %>\n                    <% } else if (i + 2 < chosen.length) { %>\n                        <%- Messages.get(\'comma\') %>\n                    <% } %>\n                <% }); %>\n            </button>\n        <% } %>\n    </div>\n    <div class="form-group">\n        <label class="im-tree-option">\n            <%- Messages.getText(\'columns.AllowRevRef\') %>\n            <input type="checkbox"\n                    class="im-allow-rev-ref"\n                    <%= allowRevRefs ? \'checked\' : void 0 %> >\n        </label>\n    </div>\n</div>\n',c.summary_items_controls='<button class="btn btn-default pull-right im-download">\n  <%= Icons.icon(\'Download\') %>\n  <%- Messages.getText(\'summary.DownloadData\') %>\n</button>\n\n<div class="btn-group im-filter-group">\n  <button type="submit"\n        class="btn btn-primary im-filter-in"\n        <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <%- Messages.getText(\'Filter\') %>\n  </button>\n  <button class="btn btn-primary dropdown-toggle" \n          title="<%- Messages.getText(\'summary.SelectFilter\') %>"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu">\n    <li>\n      <a href="#" class="im-filter-in">\n        <%- Messages.getText(\'summary.Include\') %>\n      </a>\n    </li>\n    <li>\n      <a href="#" class="im-filter-out">\n        <%- Messages.getText(\'summary.Exclude\') %>\n      </a>\n    </li>\n  </ul>\n</div>\n\n<div class="btn-group">\n  <button class="btn btn-default btn-cancel"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>\n          title="<%- Messages.getText(\'summary.Reset\') %>">\n    <%= Icons.icon(\'Undo\') %>\n  </button>\n  <% if (!(/boolean/i).test(type)) { %>\n    <button class="btn btn-default btn-toggle-selection"\n            title="<%- Messages.getText(\'summary.Toggle\') %>">\n        <%= Icons.icon(\'Toggle\') %>\n    </button>\n  <% } %>\n</div>\n\n',
c.modal_base='<div class="modal-dialog <%- modalSize %>">\n    <div class="modal-content">\n        <div class="modal-header">\n            <button type="button" class="close">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n            <h4 class="modal-title"><%- title %></h4>\n        </div>\n        <div class="modal-body">\n            <%= body %>\n        </div>\n    </div>\n</div>\n',c.count_summary="<% if (size && count) { %>\n  <% var msg = (size == 0 ? '.ShowingAll' : '.ShowingRange'); %>\n  <% ['xs', 'sm', 'md', 'lg'].forEach(function (pageSize) { %>\n    <span class=\"visible-<%= pageSize %>-inline\">\n      <%- Messages.getText('table.' + pageSize + msg, page) %>\n    </span>\n  <% }); %>\n<% } %>\n",c.active_progress_bar='<div class="progress progress-info progress-striped active">\n  <div class="bar" style="width: 100%"></div>\n</div>\n',c.boolean_value_controls="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",c.summary_heading='<% /* requires:\n    *  numeric, available, got, uniqueValues\n    *  state.typeName, state.endName\n    *  filtered \n    */ %>\n<h3>\n  <% if (numeric) { %>\n    <%- Messages.getText(\'summary.NumericDistribution\', {n: available}) %>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n  <% } else { %> \n    <span class="im-item-got">\n      <%- Messages.getText(\'summary.Got\', {available: available, got: got}) %>\n    </span>\n    <span class="im-item-available">\n      <%- Messages.getText(\'Number\', {n: available}) %>\n    </span>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n    <span class="im-item-total">\n      <%- Messages.getText(\'summary.Total\', {\n            filtered: filtered,\n            total: uniqueValues\n          }) %>\n    </span>\n  <% } %> \n</h3>\n',c.column_manager_path_chooser="<div class=\"btn-group pull-right\">\n</div>\n<h4>\n  <%- Messages.getText('columns.ChooseAPathFrom', {root: state.rootName}) %>\n</h4>\n\n",c.column_name_popover='<% _.each(parts, function (part) { %>\n  <span class="im-name-part"><%- part %></span>\n<% }); %>\n',c.classy_popover='<div class="popover <%- classes %>" role="tooltip">\n  <div class="arrow"></div>\n  <h3 class="popover-title"></h3>\n  <div class="popover-content"></div>\n</div>\n',c.code_gen_button_main="<%= Icons.icon('CodeFile') %>\n<span class=\"hidden-sm hidden-xs\">\n  <%- Messages.getText('codegen.GenerateCodeIn', {lang: lang}) %>\n</span>\n<span class=\"visible-sm-inline im-current-lang\">\n    <%- Messages.getText('codegen.Lang', {lang: lang}) %>\n</span>\n\n",c.undo_history_step='<% if (!state.current) { %>\n  <button class="btn btn-default btn-small im-state-revert"\n      title="<%- Messages.getText(\'undo.RevertToState\') %>">\n      <%= Icons.icon(\'Undo\') %>\n  </button>\n<% } %>\n\n<h4>\n    <%- Messages.getText(\'undo.StepTitle\', title) %>\n</h4>\n\n<% if (state.current) { %>\n  <span class="help-block"><%- Messages.getText(\'undo.IsCurrentState\') %></span>\n<% } %>\n<div style="clear:both"></div>\n\n<span class="im-revision" title="<%- Messages.getText(\'undo.RevisionTitle\', {v: revision}) %>">\n  <%- Messages.getText(\'undo.Revision\', {v: revision}) %>\n</span>\n\n<div class="im-step-count">\n  <span><%- Messages.getText(\'undo.StepCount\', {count: count}) %></span>\n  <% if (diff) { %>\n    <span class="label im-label-<%= (diff > 0 ) ? \'pos\' : \'neg\' %>">\n      <% if (diff > 0) { %>+<% } %><%- numToString(diff) %>\n    </span>\n  <% } %>\n</div>\n\n<div class="im-step-details"></div>\n\n<div style="clear:both"></div>\n',c.export_preview='<div class="form-group im-export-formats">\n  <label><%- Messages.getText(\'export.param.Format\') %></label>\n  <select class="form-control">\n    <% _.each(formats, function (fmt) { %>\n      <option value="<%- fmt.id %>"\n              <%= (fmt.id === format.id) ? \'selected\' : void 0 %>>\n        <%- Messages.getText(fmt.name) %>\n      </option>\n    <% }); %>\n  </select>\n</div>\n\n<pre class="im-export-preview">\n<%- state.preview %>\n</pre>\n\n<div class="alert alert-info">\n    <strong class="nb">nb</strong>\n    <%- Messages.getText(\'export.preview.Limit\') %>\n</div>\n',c.list_value_controls="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",c.column_manager_sort_order_editor='<% /* requires: collection, available */ %>\n<h4>\n  <%- Messages.getText(\'columns.CurrentSortOrder\', {\n    oes: collection\n  }) %>\n</h4>\n\n<span class="help-block">\n  <%- Messages.getText(\'columns.CurrentSortOrderHelp\') %>\n</span>\n\n<div class="well im-current-sort-order">\n\n  <div class="row">\n    <div class="col-md-6">\n        <% if (collection.length) { %>\n          <ul class="list-group im-active-oes im-connected-list"></ul>\n        <% } else { %>\n          <div class="im-empty-collection">\n            <%- Messages.getText(\'columns.NoSortOrder\') %>\n          </div>\n        <% } %>\n    </div>\n\n    <div class="col-md-6">\n        <% if (available) { %>\n          <div class="im-rubbish-bin">\n            <ul class="list-group im-removed im-available-oes im-connected-list">\n            </ul>\n          </div>\n        <% } %>\n    </div>\n  </div>\n</div>\n',c.extra_value_controls='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',c.undo_history_step_section="<div class=\"im-section-summary\">\n  <% if (collection.length) { %>\n    <%= Icons.icon(state.open ? 'ExpandedSection' : 'CollapsedSection') %>\n  <% } %>\n  <%- Messages.getText(summaryLabel, {n: count}) %>\n</div>\n<% if (collection.length) { %>\n  <div class=\"<%- collectionClasses %>\">\n    <% _.each(collection, function (e) { %>\n      <span class=\"label label-<%= e.added ? 'success' : (e.removed ? 'danger' : 'default') %>\">\n        <%- labelContent(e) %>\n      </span>\n    <% }); %>\n  </div>\n<% } %>\n",c.summary_items='<% if (!(/boolean/i).test(type)) { %>\n    <div class="input-group im-filter-group">\n    <span class="input-group-btn">\n        <button class="btn btn-default im-clear-value-filter">\n        <%= Icons.icon(\'Refresh\') %>\n        </button>\n    </span>\n    <input type="search" class="form-control im-filter-values"\n        value="<%- filterTerm %>"\n        placeholder="<%- Messages.getText(\'summary.FilterValuesPlaceholder\') %>">\n    </div>\n<% } %>\n\n<div class="im-item-table">\n  <table class="table table-condensed table-striped">\n    <colgroup>\n      <% _.each(colClasses, function (cls) { %>\n        <col class="<%- cls %>">\n      <% }); %>\n    </colgroup>\n    <thead>\n      <tr>\n        <% _.each(colHeaders, function (hdr) { %>\n          <th><%- hdr %></th>\n        <% }); %>\n      </tr>\n    </thead>\n    <tbody class="scrollable">\n    </tbody>\n  </table>\n\n  <% if (hasMore) { %>\n    <div class="im-load-more">\n      <%- Messages.getText(\'summary.MoreItems\') %>\n    </div>\n  <% } %>\n</div>\n\n<div class="im-summary-controls">\n</div>\n',c.facet_title="<%= Icons.icon(state.open ? 'Expanded' : 'Collapsed') %>\n<span class=\"im-facet-title\"><%- pathName %></span>\n&nbsp;\n<span class=\"im-facet-count\"><%- Messages.getText('Number', {n: got} %></span>\n",c.too_many_suggestions="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",c.active_constraints='<% /* requires: constraints.length */ %>\n<div class="well im-current-constraints">\n    <p class="well-help">\n      <% if (constraints.length) { %>\n        <%- Messages.getText(\'constraints.EditOrRemove\') %>\n      <% } else { %>\n        <%- Messages.getText(\'constraints.None\') %>\n      <% } %>\n    </p>\n\n    <ul class="im-active-constraints">\n    </ul>\n</div>\n',c.reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n    <%- Messages.getText('Reset') %>\n</button>\n",c.cell_preview_attribute='<tr>\n  <td class="im-field-name"><%- _.last(parts) %></td>\n  <td class="im-field-value <%- field.toLowerCase() %> <%- type %>">\n    <% if (isNumeric) { %>\n      <%- numToString(+value) %>\n    <% } else { %>\n      <%- value %>\n    <% } %>\n    <% if (tooLong) { %>\n      <span class="im-overspill"><%- valueOverspill %></span>\n      <a class="im-too-long">\n        <span class="im-ellipsis">...</span>\n        <%= Icons.icon(\'More\') %>\n      </a>\n    <% } %>\n  </td>\n</tr>\n',c.export_destination_radios='<label><%- Messages.getText(\'export.param.Destination\') %></label>\n<% _.each(destinations, function (d) { %>\n    <div class="radio im-dest-<%- d %>">\n        <label>\n            <input type="radio"\n                    name="dest"\n                    <%= (d === dest) ? \'checked\' : void 0 %>>\n            <%- Messages.getText(d) %>\n        </label>\n    </div>\n<% }); %>\n\n',c.export_dialogue='<div class="row">\n    <nav class="col-sm-3 menu">\n    </nav>\n    <div class="col-sm-9 main">\n    </div>\n</div>\n',c.column_manager_select_list='<div class="im-removal-and-rearrangement">\n  <button class="pull-right btn btn-success im-add-view-path">\n      <%= Icons.icon(\'Add\') %>\n      <%- Messages.getText(\'columns.FindColumnToAdd\') %>\n  </button>\n\n  <h4>\n    <%- Messages.getText(\'columns.ColumnsSelected\', {columns: collection, removed: hasRubbish}) %>\n  </h4>\n\n  <span class="help-block"><%- Messages.getText(\'columns.CurrentViewHelp\') %></span>\n\n  <div class="well im-current-view">\n\n    <div class="row">\n\n      <div class="col-md-6">\n        <ul class="list-group im-active-view im-connected-list">\n        </ul>\n      </div>\n\n      <div class="col-md-6">\n        <div class="im-rubbish-bin">\n            <%= Icons.icon((hasRubbish ? \'RubbishFull\' : \'Rubbish\'), \'lg\') %>\n            <% if (hasRubbish) { %>\n                <ul class="list-group im-removed im-removed-view im-connected-list">\n                </ul>\n            <% } %>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n<div class="im-addition">\n</div>\n\n',c.table_building="<h2><%- Messages.getText('table.Building') %></h2>\n<%= IndeterminateProgressBar %>\n",c.constraint_summary="<% if (code) { %>\n  <li><span class=\"text-muted\"><strong><%- code %>:</strong></span></li>\n<% } %>\n<% _.each(labels, function (label) { %>\n  <li>        \n    <span class=\"label label-<%- label.type %>\">\n      <% if (_.include(['error', 'warning'], label.type)) { %>\n        <%= Icons.icon('Error') %>\n        <%- Messages.getText('consummary.' + label.content) %>\n      <% } else if (label.type === 'path') { %>\n        <% _.each(label.content.split(' > '), function (part) { %>\n          <span title=\"<%- label.content %>\" class=\"im-name-part\"><%- part %></span>\n        <% }); %>\n      <% } else { %>\n        <% if (label.icon) { %><%= Icons.icon(label.icon) %><% } %>\n        <%- label.content %>\n      <% } %>\n    </span>\n  </li>\n<% }); %>\n",c.cell_preview_items='<colgroup>\n  <col class="im-item-field"/>\n  <col class="im-item-value"/>\n</colgroup>\n<tbody></tbody>\n',c.slider='<div class="im-slider">\n    <% _.each(markers, function(marker) { %>\n        <span class="im-slider-marker"><%- marker.value %></span>\n    <% }); %>\n</div>\n',c.export_tab_menu='<% _.each(data.tabs, function (tabDef) { %>\n  <li role="presentation" class="im-tab-<%= tabDef.ident %> <%= data.tab === tabDef.ident ? \'active\' : void 0 %>">\n    <a><%- data.Messages.getText(tabDef.key, data) %></a>\n  </li>\n<% }); %>\n',c.loop_value_controls="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",c.export_column_control="<span class=\"badge\"><%- item.getType() %></span>\n<span class=\"im-active-state\">\n    <% if (active) { %>\n        <%= Icons.icon('Check') %>\n    <% } else { %>\n        <%= Icons.icon('UnCheck') %>\n    <% } %>\n</span>\n<%- name %>\n",c.export_rows_reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n        <%- Messages.getText('export.ResetRowSelection') %>\n</button>\n\n<% if (tablePage) { %>\n    <button type=\"button\"\n            <%= (tablePage.start === start && tablePage.size === size) ? 'disabled' : void 0 %>\n            class=\"btn btn-default im-set-table-page\">\n            <%- Messages.getText('export.SetTablePage') %>\n    </button>\n<% } %>\n        \n",c.input_with_label='<label><%- Messages.getText(label) %></label>\n<input class="form-control"\n       placeholder="<%- Messages.getText(placeholder) %>"\n       value="<%- value %>">\n<% if (helpMessage) { %>\n  <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n        class="help-block">\n        <%- Messages.getText(helpMessage) %>\n  </span>\n<% } %>\n',c.error_message="<% if (error) { %>\n    <div class=\"alert alert-<%= error.level || 'danger' %>\">\n        <%= icons.icon('Error') %>\n        <span class=\"im-conbuilder-error\">\n            <%- error.message || error %>\n        </span>\n    </div>\n<% } %>\n\n",c.column_manager_tabs='<ul class="nav nav-tabs">\n    <li role="presentation" class="<%- classes.view %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.ViewTabTitle\') %>\n      </a>\n    </li>\n    <li role="presentation" class="<%- classes.sortorder %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.SortOrderTabTitle\') %>\n      </a>\n    </li>\n</ul>\n',c.modal_error='<% /* Renders an alert box at various levels, with appropriate icons and messages */ %>\n<% if (error) { %>\n    <div class="pull-left alert <%- errorAlert(error) %>">\n        <% if (!error.cannotDismiss) { %>\n            <button type="button" class="dismiss">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n        <% } %>\n        <%= Icons.icon(errorIcon(error)) %>\n        <strong><%- Messages.getText(\'ErrorTitle\', error) %></strong>\n        <% if (error.key != null) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } %>\n',c.no_results="<% /* requires: selectList :: [], canUndo :: bool */ %>\n<td colspan=\"<%- selectList.length %>\">\n  <div class=\"alert alert-warning\">\n    <% if (canUndo) { %>\n      <button class=\"pull-right btn btn-large btn-default btn-undo\">\n        <%= Icons.icon('Undo') %>\n        <%- Messages.getText('Undo') %>\n      </button>\n    <% } %>\n    <strong><%- Messages.getText('table.Empty') %></strong>\n    <p><%- Messages.getText('table.EmptyWhy') %></p>\n  </div>\n</td>\n",c.only_one_item="<div class=\"alert alert-info\">\n    <%= Icons.icon('Info') %>\n    <%= Messages.getText('summary.OnlyOne', {names: state, item: items[0]}) %>\n</div>\n\n",c.code_gen_button='<% /* requires lang :: string, options.Langs :: [string] */ %>\n<div class="btn-group language-selector">\n    <button type="button"\n            class="btn btn-default im-show-code-gen-dialogue">\n    </button>\n    <button type="button"\n            data-toggle="dropdown"\n            aria-expanded="false"\n            class="btn btn-default dropdown-toggle">\n        <span class="caret"></span>\n    </button>\n    <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>" class="<%= (l === lang) ? \'active\' : void 0 %>">\n                <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n    </ul>\n</div>\n',c.export_compression_controls="<h4><%- Messages.getText('export.category.Compression', state) %></h4>\n\n<div class=\"checkbox im-compress\">\n    <label>\n        <input type=\"checkbox\" <%= compress ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.UseCompression') %>\n    </label>\n</div>\n\n<fieldset <%= compress ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"gzip\"\n                <%= (compression === 'gzip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseGZIP') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"zip\"\n                <%= (compression === 'zip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseZIP') %>\n        </label>\n    </div>\n</fieldset>\n\n",c.column_manager_order_direction="<% /* requires: direction, isNumeric */ %>\n<span class=\"im-change-direction\"\n  title=\"<%- Messages.getText('columns.ChangeDirection') %>\">\n  <span class=\"sr-only\">\n    <%- Messages.getText('columns.CurrentDirection', {\n      dir: direction, numeric: isNumeric\n    }) %>\n  </span>\n  <%= Icons.icon('Sort' + (isNumeric ? 'Numeric' : 'String') + direction) %>\n</span>\n",c.progress_bar='<% /* requires: doneness (float: 0 <= i <= 1) */ %>\n<% if (doneness != null && doneness >= 0) { %>\n    <div class="progress">\n        <div class="progress-bar progress-bar-striped active"\n             role="progressbar"\n             aria-valuenow="<%- doneness %>"\n             aria-valuemin="0"\n             aria-valuemax="1"\n             style="width: <%- 100 * doneness %>%;">\n            <% if (doneness < 1) { %>\n              <span class="sr-only">\n                <%- Math.round(100 * doneness) %>% <%- Messages.getText(\'Complete\') %>\n              </span>\n            <% } %>\n        </div>\n    </div>\n<% } %>\n',c.export_json_options="<h3><%- Messages.getText('export.category.Options') %></h3>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"rows\"\n               <%= (jsonFormat === 'rows') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Rows') %>\n        <pre><%- Messages.getText('export.json.RowsExample') %></pre>\n    </label>\n</div>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"objects\"\n               <%= (jsonFormat === 'objects') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Objects') %>\n        <pre><%- Messages.getText('export.json.ObjExample') %></pre>\n    </label>\n</div>\n\n<% if ((size || start) && jsonFormat === 'objects') { %>\n    <div class=\"alert alert-warning\">\n        <h4><%- Messages.get('Warning') %></h4>\n        <p><%- Messages.get('export.json.ObjWarning') %></p>\n    </div>\n<% } %>\n\n",c.export_destination_galaxy_options='<div class="form-group">\n    <label><%- Messages.getText(\'GalaxyURILabel\') %></label>\n    <input type="url"\n           class="form-control im-galaxy-uri-param"\n           value="<%- Galaxy.Current || Galaxy.Main %>">\n</div>\n<div class="checkbox im-save-galaxy">\n    <label>\n        <input type="checkbox" <%= (Galaxy.Save) ? \'checked\' : void 0 %>>\n        <%- Messages.getText(\'SaveGalaxyURL\') %></label>\n    </label>\n</div>\n',c.new_filter_dialogue='<div class="modal-body">\n</div>\n<div class="modal-footer">\n    <button class="disabled btn btn-primary pull-right im-add-constraint">\n        <%- Messages.getText(\'constraints.AddFilter\') %>\n    </button>\n    <button class="btn im-close pull-left">\n        <%- Messages.getText(\'Cancel\') %>\n        Cancel\n    </button>\n</div>\n',c.list_tags_apology="<% if (!hasTags) { %>\n  <span>\n    <%- Messages.getText('lists.NoTags') %>\n  </span>\n<% } %>\n",c.column_manager_restore_path='<% /* requires: restoreTitle */ %>\n<span class="pull-right im-restore-view"\n    title="<%- Messages.getText(restoreTitle) %>">\n    <%= Icons.icon(\'Add\') %>\n</span>\n\n',c.table_subtables_header="<a title=\"<%- Messages.getText('subtables.RemoveColumn') %>\">\n  <%= Icons.icon('Remove') %>\n</a>\n<% if (displayName && columnName) { %>\n  <%- displayName.replace(columnName, '').replace(/^ > /, '') %>\n<% } %>\n",c.pagination='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',c.facet_row='<% /* requires: selected, symbol, item, count, percent, opacity, share */ %>\n<td class="im-selector-col">\n  <span><%- symbol %></span>\n  <div class="checkbox"></div>\n</td>\n\n<td class="im-item-col">\n  <% if (item != null) { %>\n    <%- item %>\n  <% } else { %>\n    <span class=null-value>&nbsp;</span>\n  <% } %>\n</td>\n\n<td class="im-count-col">\n  <% if (max > 1) { %>\n    <div class="im-facet-bar"\n         style="width:<%- percent %>%;background:<%- Messages.getText(\'summary.FacetBar\', {opacity: opacity}) %>">\n    </div>\n  <% } %>\n  <span class="im-count"><%- numToString(count) %></span>\n</td>\n\n<% if (share != null) { %>\n    <td class="im-percent-col"><i><%- share.toFixed() %>%</i></td>\n<% } %>\n',c.table_subtable_summary="<% if (rows.length) { %>\n  <%= Icons.icon('Table') %>\n<% } else { %>\n  <%= Icons.icon('EmptyTable') %>\n<% } %>\n<%- rows.length %>\n<%- pluralise(contentName, rows.length) %>\n",c.attribute_value_select='<select class="form-control im-con-value-attr">\n    <% _.each(items, function (item) { %>\n    <option <%= (item.item === value) ? \'selected\' : void 0 %> value="<%- item.item %>">\n            <%- item.item %>\n        </option>\n    <% }); %>\n</select>\n',c.code_gen_js='<% if (asHTML) { %>\n<!-- The Element we will target -->\n<div id="some-elem"></div>\n<!-- The imtables source -->\n<script src="<%= imtablesJS %>" charset="UTF-8"></script>\n<link rel="stylesheet" href="<%= imtablesCSS %>">\n<script>\n<% } %>\n<% if (!asHTML) { %>\n/* Install from npm: npm install imtables\n * This snippet assumes the presence on the page of an element like:\n * <div id="some-elem"></div>\n */\nvar imtables = require(\'imtables\');\n<% } %>\n\nvar selector = \'#some-elem\';\nvar service  = {root: \'<%= service.root %>\'};\nvar query    = <%= JSON.stringify(query, null, 2) %>;\n\nimtables.loadTable(\n  selector, // Can also be an element, or a jQuery object.\n  <%= JSON.stringify(page) %>, // May be null\n  {service: service, query: query} // May be an imjs.Query\n).then(\n  function (table) { console.log(\'Table loaded\', table); },\n  function (error) { console.error(\'Could not load table\', error); }\n);\n<% if (asHTML) { %>\n</script>\n<% } %>\n',c.export_flat_file_options="<h4><%- Messages.getText('export.category.ColumnHeaders', state) %></h4>\n\n<div class=\"checkbox im-headers\">\n    <label>\n        <input type=\"checkbox\" <%= headers ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.AddHeaders') %>\n    </label>\n</div>\n\n<fieldset <%= headers ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-friendly\"\n                <%= (headerType === 'friendly') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.FriendlyHeaders') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-path\"\n                <%= (headerType === 'path') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.PathHeaders') %>\n        </label>\n    </div>\n</fieldset>\n\n",c.cell_preview_error='<div class="alert alert-error">\n    <h4>Error</h4>\n    <p>Sorry. We could not fetch the preview due to an error:</p>\n    <code><%- message %></code>\n</div>\n',c.cell_preview_reference="<tr>\n    <td class=\"im-field-name\"><%- _.rest(parts).join(' ') %></td>\n    <td class=\"im-field-value <%- field.toLowerCase() %>\">\n        <%- values.join(', ') %>\n    </td>\n</tr>\n",c.export_destination_options='<div class="form-group im-param-name">\n    <label><%- Messages.getText(\'export.param.Name\') %></label>\n    <div class="input-group">\n      <input type="text"\n             value="<%- filename %>"\n             class="form-control"\n             placeholder="<%- Messages.getText(\'export.param.Name\') %>"\n             aria-label="<%- Messages.getText(\'export.param.Name\') %>">\n      <div class="input-group-btn">\n        <button type="button"\n                class="btn btn-default dropdown-toggle"\n                data-toggle="dropdown"\n                aria-expanded="false">\n          .<%- format %>\n          <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu dropdown-menu-right" role="menu">\n          <% _.chain(formats).groupBy(\'group\').each(function (fmts, grp) { %>\n            <% if (this.i++) { %><li class="divider"></li><% } %>\n            <% _.each(fmts, function (fmt) { %>\n                <li>\n                    <a href="#"\n                       class="im-fmt-<%- fmt.id %>">\n                      <%= Icons.icon(fmt.icon) %>\n                      <%- Messages.getText(fmt.name) %>\n                    </a>\n                </li>\n            <% }); %>\n          <% }, {i: 0}); %>\n        </ul>\n      </div>\n    </div>\n</div>\n\n<% if (format && format.desc) { %>\n  <div class="alert alert-info">\n    <%- Messages.getText(format.desc) %>\n  </div>\n<% } %>\n\n<div class="row">\n    <div class="col-sm-6 im-param-dest">\n    </div>\n    <div class="col-sm-6 im-dest-opts">\n    </div>\n</div>\n',c.column_header='<% /* requires the properties of HeaderModel +\n    *  penult, last, headerClasses, colTitleClasses, penultClasses\n    *  and the usual Icons, Messages\n    */ %>\n<div class="<%- headerClasses %>">\n\n<div class="im-th-buttons">\n    \n    <% if (outerJoined && isReference) { %>\n      <a href="#" \n          class="im-subtable-expander im-th-button"\n          title="<%- Messages.getText(\'table.header.ToggleTables\') %>">\n        <%= Icons.icon(\'Table\') %>\n      </a>\n    <% } %>\n\n    <% if (sortable) { %>\n        <span class="im-th-dropdown im-col-sort dropdown">\n            <a class="im-th-button im-col-sort-indicator"\n                title="<%- Messages.getText(\'table.header.SortColumn\', {dir: sortDirection}) %>">\n                <%= Icons.icon(sortDirection || \'unsorted\') %>\n            </a>\n            <div class="dropdown-menu">\n                <div><%- Messages.getText(\'table.header.FailedToInitSortMenu\') %></div>\n            </div>\n        </span>\n    <% } %>\n\n    <a class="im-th-button im-col-remover"\n        title="<%- Messages.getText(\'table.header.RemoveColumn\') %>">\n        <%= Icons.icon(\'headerIconRemove\') %>\n    </a>\n\n    <a class="im-th-button im-col-minumaximiser"\n        title="<%- Messages.getText(\'table.header.ToggleColumn\') %>">\n        <%= Icons.icon(minimised ? \'headerIconReveal\' : \'headerIconHide\') %>\n    </a>\n\n    <span class="dropdown im-filter-summary im-th-dropdown">\n        <a class="im-th-button im-col-filters dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.FilterTitle\', {count: numOfCons}) %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Filter\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitFilter\') %></div>\n        </div>\n    </span>\n\n    <span class="dropdown im-summary im-th-dropdown">\n        <a class="im-th-button summary-img dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.ViewSummary\') %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Summary\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitSummary\') %></div>\n        </div>\n    </span>\n\n    <% if (isComposed) { %>\n        <a class="im-th-button im-col-composed"\n            title="<%- Messages.getText(\'table.header.Composed\', {replaces: replaces}) %>">\n            <%= Icons.icon(\'Composed\') %>\n        </a>\n    <% } %>\n</div>\n\n<div class="<%- colTitleClasses %>">\n  <div class="<%- penultClasses %>">\n      <%- penult %>\n  </div>\n  <% if (last) { %>\n    <div class="im-title-part im-last">\n        <%- last %>\n    </div>\n  <% } %>\n</div>\n\n</div>\n\n',c.summary_stats='<table class="table">\n    <thead>\n        <tr>\n            <th><%- Messages.getText(\'summary.Max\') %></th>\n            <th><%- Messages.getText(\'summary.Min\') %></th>\n            <th><%- Messages.getText(\'summary.Average\') %></th>\n            <th><%- Messages.getText(\'summary.StdDev\') %></th>\n        </tr>\n        <tr>\n            <td><%- Messages.getText(\'Number\', {n: max}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: min}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: average}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: stdev}) %></td>\n        </tr>\n    </thead>\n</table>\n\n<div class="row im-range-controls">\n    <div class="col-sm-4 im-range-from">\n        <input type="text"\n               class="form-control im-range-min input im-range-val"\n               value="<%- min %>">\n    </div>\n    <div class="col-sm-1 im-ellipsis">\n        <span>...</span>\n    </div>\n    <div class="col-sm-4 im-range-to">\n        <input type="text"\n               class="form-control im-range-max input im-range-val"\n               value="<%- max %>">\n    </div>\n    <div class="col-sm-3 im-range-buttons">\n        <div class="btn-group pull-right">\n            <button class="btn btn-primary disabled">Apply</button>\n            <button class="btn btn-cancel disabled">Reset</button>\n        </div>\n    </div>\n</div>\n\n<div class="slider"></div>\n\n',
c.list_tag="<%- id %>\n<span class=\"im-remove\" title=\"<%- Messages.getText('lists.RemoveTag') %>\">\n    <%= Icons.icon('Remove') %>\n</span>\n",c.facet_item='<dd>\n    <a href=#>\n        <b class="im-facet-count pull-right">\n            (<%- count %>)\n        </b>\n        <%- item %>\n    </a>\n</dd>\n',c.attribute_value_controls='<div>\n    <input class="form-control im-constraint-value im-value-options im-con-value im-con-value-attr"\n           type="text"\n           placeholder="<%- state.valuePlaceholder %>"\n           value="<%- con.value %>">\n</div>\n',c.table_error="<div class=\"alert alert-error alert-warning\">\n\n  <h2><%= Icons.icon('Bug') %><%- Messages.getText('error.Oops') %></h2>\n\n  <p>\n    <i><%- Messages.getText(error.key || 'error.' + domain + '.Heading') %></i>\n  </p>\n\n  <p><%- Messages.getText('error.' + domain + '.Body') %></p>\n\n  <a class=\"btn btn-primary pull-right\" href=\"mailto:<%= mailto %>\">\n    <%= Icons.icon('Mail') %>\n    <%- Messages.getText('error.EmailHelp') %>\n  </a>\n\n  <button class=\"btn btn-default im-show-query\">\n    <%= Icons.icon('xml') %>\n    <%- Messages.getText('error.ShowQuery') %>\n  </button>\n  <% if (error.message) { %>\n    <button class=\"btn btn-default im-show-error\">\n      <%= Icons.icon('Bug') %>\n      <%- Messages.getText('error.ShowError') %>\n    </button>\n  <% } %>\n\n  <pre class=\"query-xml well im-latent\"><%- indent(query) %></pre>\n\n  <% if (error.message) { %>\n    <pre class=\"error-message well im-latent\"><%- error.message %></pre>\n  <% } %>\n\n</div>\n",c.download_popover='<% /* requires: formats, query, path */ %>\n<ul role="menu" class="im-export-summary">\n    <% _.each(formats, function (icon, param) { %>\n      <li role="presentation">\n        <a role="menuitem"\n            href="<%= query.getExportURI(param) %>&summaryPath=<%= path %>">\n            <%= Icons.icon(icon) %>\n            <%- icon.toUpperCase() %>\n        </a>\n      </li>\n    <% }); %>\n</ul>\n'},{underscore:312}],68:[function(a,b,c){(function(){var b,d,e,f,g;g=a("underscore"),b=a("../options"),d=a("pluralize"),e='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',f=g.template(e,{variable:"data"}),c.select=function(a,b,c,d,e){return null==b&&(b=function(){return!1}),null==c&&(c=""),null==d&&(d=null),null==e&&(e=function(a){return null!=a?a.value:void 0}),f({options:a,selectedTest:b,classes:c,contentHandler:d,key:e})},c.pluralise=function(a,b){return null!=a?d(a,b):a},c.numToString=function(a){var c,d,e,f,h,i,j,k,l,m;if(!(null!=a?a.toFixed:void 0))return a;if(k=b.get("NUM_SEPARATOR"),d=b.get("NUM_CHUNK_SIZE"),j=[],h=0,a>-1&&1>a)return String(a);for(m=a.toFixed(3).split("."),l=m[0],e=m[1],c=l.split(""),i=c.length,f=g(c).groupBy(function(a,b){return Math.floor((i-(b+1))/d).toFixed()});f[h];)j.unshift(f[h].join("")),h++;return j.join(k)+("000"===e?"":"."+e)},c.errorAlert=function(a){var b;switch(b=a.level){case"Error":return"alert-danger";case"Warning":return"alert-warning";case"Info":return"alert-info";case"OK":return"alert-success";default:return"alert-danger"}},c.errorIcon=function(a){var b;return b=a.level,null!=b?b:"Error"}}).call(this)},{"../options":63,pluralize:310,underscore:312}],69:[function(a,b,c){(function(){b.exports={interpolate:/\{\{\{ (.+?) \}\}\}/g,escape:/\{\{ (.+?) \}\}/g,evaluate:/\{\{# (.+?) \}\}/g}}).call(this)},{}],70:[function(a,b,c){(function(){var c,d,e,f,g;d=a("../options"),e=a("es6-promise").Promise,g={},f=function(a){var b;return null!=g[b=a.root]?g[b]:g[b]=new c(a)},b.exports=function(a){return f(a).getBranding()},c=function(){function a(a){this.key=a.root.replace(/\./g,"_"),this.promise=a.get("branding").then(function(a){return function(b){return d.set(["brand",a.key],b.properties)}}(this))}return a.prototype.getBranding=function(){return new e(function(a){return function(b){return a.promise.then(function(){return b(d.get(["brand",a.key]))},function(){return b(null)})}}(this))},a}()}).call(this)},{"../options":63,"es6-promise":281}],71:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};d=a("./create-columns"),g=a("./is-key-field"),e=a("./get-replaced-test"),c=a("../formatting"),h=function(a){return function(b){return!a.findWhere({formatter:b})}},i=function(a,b){return function(c){var d;return d=a(c),b(d)?d:null}},f=function(a){var b,c,d,e,f;for(f=[],b=d=0,e=a.length;e>d;b=++d)c=a[b],f.push(c.index=b);return f},b.exports=function(a,b){return a.service.fetchClassKeys().then(function(k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;for(r=g(k),v={},n={},p=i(c.getFormatter,h(b)),m=d(a),x=0,B=m.length;B>x;x++)if(l=m[x],l.path.isAttribute()&&(o=p(l.path)))for(l.isFormatted=!0,l.formatter=o,t=l.path.getParent(),G=null!=(F=o.replaces)?F:[],y=0,C=G.length;C>y;y++)u=G[y],w=""+t+"."+u,null==v[w]&&(v[w]=l),j.call(a.views,w)>=0&&l.replaces.push(a.makePath(w));for(z=0,D=m.length;D>z;z++)for(l=m[z],H=l.replaces,A=0,E=H.length;E>A;A++)u=H[A],n[u]=l;return q=e(v,n),s=function(){var a,b,c,d;for(d=[],b=0,a=m.length;a>b;b++)l=m[b],q(l)||(l.isFormatted&&(c=l.path,j.call(l.replaces,c)<0&&l.replaces.push(l.path),(r(l.path)||l.replaces.length>1)&&(l.path=l.path.getParent())),d.push(l));return d}(),f(s),s})}}).call(this)},{"../formatting":13,"./create-columns":78,"./get-replaced-test":85,"./is-key-field":89}],72:[function(a,b,c){(function(){b.exports=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(k={},l=0,n=a.length;n>l;l++)if(d=a[l],null!=(null!=(p=d.formatter)?p.replaces:void 0)&&(g=d.model.get("node").toString(),e=d.model.get("column"),h=e.toString(),null!=b&&e.isAttribute()&&d.formatter.replaces.length>1&&(f=b.indexOf(b.get(h)),b.remove(h),i=e.getParent(),c=b.add(i,{at:f}),c.set({replaces:d.formatter.replaces.map(function(a){return i.append(a)})})),!k[h]))for(q=d.formatter.replaces.map(function(a){return g+"."+a}),m=0,o=q.length;o>m;m++)j=q[m],j!==h&&(k[j]=!0,null!=b&&b.remove(j));return k}}).call(this)},{}],73:[function(a,b,c){(function(){var a,c,d,e=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=function(a,b,c){var d,e,f;if(e=a.getOuterJoin(b),!e||e===c)return null;for(f=a.makePath(e),d=f.isCollection()?e:null,f=f.getParent();f&&!f.isRoot();)!function(b){var e;return null!=b&&(e=a.makePath(b)),(null!=e?e.isCollection():void 0)&&b!==c&&(d=b),f=null!=e?e.getParent():void 0}(a.getOuterJoin(f));return d},d=function(a,b){return c(a,b,null)},b.exports=a=function(a){var b,f,g,h,i,j,k,l,m,n,o,p,q;for(k=[],h={},q=a.views,m=0,o=q.length;o>m;m++)if(l=q[m],!h[l])if(j=d(a,l)){for(b=a.views.filter(function(b){return j===d(a,b)}),g={column:j,view:[]},n=0,p=b.length;p>n;n++)f=b[n],i=c(a,f,j),h[f]=g,i?e.call(g.view,i)>=0||g.view.push(i):g.view.push(f);k.push(h[j]=g)}else k.push(h[l]={column:l});return k}}).call(this)},{}],74:[function(a,b,c){(function(){c.bool=function(a){return!!a}}).call(this)},{}],75:[function(a,b,c){(function(){var c,d,e,f,g,h,i;i=a("underscore"),h=a("../models/object-store"),f=a("../models/nested-table"),c=a("../models/cell"),g=a("../models/null-object"),e=a("../models/fast-path-object"),b.exports=d=function(){function a(a,b){this.itemModels=new h(a.root,b)}return a.prototype.getCreator=function(a){var b;if(!a)throw new Error("No query");return b=function(c){return function(d){var e;return e=a.makePath(d.column),i.has(d,"rows")?c._make_sub_table_model(d,e,b):c._make_simple_cell_model(d,e)}}(this)},a.prototype._make_sub_table_model=function(a,b,c){var d;return new f(i.extend({},a,{node:b,column:b,rows:function(){var b,e,f,g;for(f=a.rows,g=[],b=0,e=f.length;e>b;b++)d=f[b],g.push(d.map(function(a){return c(a)}));return g}()}))},a.prototype._make_simple_cell_model=function(a,b){var d,f,h;return h=b.getParent(),f=b.end.name,d=null!=a.id?this.itemModels.get(a,f):null==a["class"]?new g(h.getType().name,f):new e(a,f),new c({entity:d,node:h,column:b,field:f,value:a.value})},a.prototype.destroy=function(){var a;return null!=(a=this.itemModels)&&a.destroy(),delete this.itemModels,this},a}()}).call(this)},{"../models/cell":37,"../models/fast-path-object":43,"../models/nested-table":48,"../models/null-object":49,"../models/object-store":51,underscore:312}],76:[function(a,b,c){(function(){var b;b=a("underscore"),c.createChild=function(a,c,d){var e,f,g;return null==d&&(d={}),e=(null!=(g=c.prototype.parameters)?g:[]).concat(c.prototype.optionalParameters),f=b.extend(b.pick(a,e),d),new c(f)}}).call(this)},{underscore:312}],77:[function(a,b,c){(function(){var a,b;a={},b=function(a){return""+a.service.root+":"+a.service.token+":"+a.toXML()},c.count=function(c){var d;return null!=a[d=b(c)]?a[d]:a[d]=c.count()},c.clearCache=function(){return a={}}}).call(this)},{}],78:[function(a,b,c){(function(){var c,d,e;d=a("./longest-common-prefix"),e=a("./calculate-row-template"),b.exports=c=function(a){return e(a).map(function(b){var c,e,f,g,h;return null!=b.view?(c=d(b.view),e=a.makePath(c),g=function(){var c,d,e,f;for(e=b.view,f=[],c=0,d=e.length;d>c;c++)h=e[c],f.push(a.makePath(h));return f}(),f=function(){var b,d,e,f;for(e=a.views,f=[],b=0,d=e.length;d>b;b++)h=e[b],0===h.indexOf(c)&&f.push(a.makePath(h));return f}()):(e=a.makePath(b.column),g=null,f=[]),{path:e,subview:g,replaces:f}})}}).call(this)},{"./calculate-row-template":73,"./longest-common-prefix":91}],79:[function(a,b,c){(function(){var c,d;d=a("underscore"),b.exports=c=function(){function a(a){this.definitions=a}return a.prototype.activeClasses=function(){var a,b;b=[];for(a in this.definitions)d.result(this.definitions,a)&&b.push(a);return b},a.prototype.toString=function(){return this.activeClasses().join(" ")},a}()}).call(this)},{underscore:312}],80:[function(a,b,c){(function(){var c,d,e;c=a("./fetch-missing-data"),d=a("./has-fields"),e=function(a,b){return b.then(function(b){return a.set(b)})},b.exports=function(a,b){var f,g;return g=c(a,b),f=d(b),function(a,b){return f(a)||e(a,g(b,a.get("id"))),a.toJSON()}}}).call(this)},{"./fetch-missing-data":82,"./has-fields":87}],81:[function(a,b,c){(function(){var b,d;d=a("underscore"),b=a("backbone"),c.ignore=function(a){return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),!1},c.Bus=function(){function a(){}return d.extend(a.prototype,b.Events),a.prototype.destroy=function(){return this.stopListening(),this.off()},a}()}).call(this)},{backbone:232,underscore:312}],82:[function(a,b,c){(function(){var c,d,e,f;f=a("underscore"),c=function(a){return function(b){return b?f.object(f.zip(a,b)):{}}},d=function(a){var b;return f.flatten(function(){var c,d,f;for(f=[],c=0,d=a.length;d>c;c++)b=a[c],~b.indexOf(".")&&f.push(e(b));return f}())},e=function(a){var b,c,d,e,f;for(c=a.split("."),f=[],b=d=1,e=c.length;e>=1?e>d:d>e;b=e>=1?++d:--d)f.push(c.slice(0,b).join("."));return f},b.exports=function(a,b,e){return null==e&&(e={}),function(g,h){var i;return i=g.root+"#"+h,null!=e[i]?e[i]:e[i]=function(){return g.rows({select:b,from:a,where:{id:h},joins:d(b)}).then(f.compose(c(b),f.head))}()}}}).call(this)},{underscore:312}],83:[function(a,b,c){(function(){var a,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b.exports=a=function(b,d){var e,f,g,h,i,j;return j=function(){var a;a=[];for(g in b)f=b[g],null!=f&&c.call(d,g)<0&&a.push(f);return a}(),e=function(){var a,b,c;for(c=[],a=0,b=j.length;b>a;a++)i=j[a],null==i.objectId&&c.push(i);return c}(),h=function(){var a,b,c;for(c=[],a=0,b=j.length;b>a;a++)i=j[a],null!=i.objectId&&c.push(i);return c}(),h.reduce(function(b,c){return b.concat(a(c,d))},e)}}).call(this)},{}],84:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};k=a("underscore"),d=a("es6-promise").Promise,i=k.compose(k.uniq,k.flatten),f=function(a){var b;return null!=(null!=(b=a.getType().fields)?b.organism:void 0)},h=function(a){return"Organism"===a.getEndClass().name||f(a)},g=function(a){var b;return"Organism"===a.getEndClass().name&&("name"===(b=a.end.name)||"shortName"===b)},j=function(a){return null!=a&&/\*/.test(a)},c=["=","==","ONE OF"],b.exports=e=function(a){return new d(function(b,d){var e,m,n,o,p,q,r,s,t;return n=k.compose(b,i),r=function(){return b([])},m=function(){var b,d,f,h,i;for(f=a.constraints,i=[],b=0,d=f.length;d>b;b++)e=f[b],h=e.op,l.call(c,h)>=0&&!j(e.value)&&g(a.makePath(e.path))&&i.push(e.value||e.values);return i}(),s=function(){var b,c,d,g;for(d=a.constraints,g=[],b=0,c=d.length;c>b;b++)e=d[b],"LOOKUP"===e.op&&null!=e.extraValue&&f(a.makePath(e.path))&&g.push(e.extraValue);return g}(),o=k.union(m,s),o.length?n(o):(q=function(){var b,c,d,e;for(d=a.getViewNodes(),e=[],b=0,c=d.length;c>b;b++)p=d[b],h(p)&&(t="Organism"===p.getType().name?p:p.append("organism"),e.push(t.append("shortName")));return e}(),q.length?a.clone().select(k.uniq(q,String)).orderBy([]).rows().then(n,r):r())})}}).call(this)},{"es6-promise":281,underscore:312}],85:[function(a,b,c){(function(){var c,d,e;e=a("../formatting").shouldFormat,d=function(a){return a.isAttribute()&&"id"===a.end.name},b.exports=c=function(a,b){return function(c){var f,g;if(null==c)throw new Error("no column");return f=c.path,e(f)||f in b?(g=a[f],d(f)&&null==g&&(g=a[f.getParent()]),g&&null!=g.formatter&&c!==g):!1}}}).call(this)},{"../formatting":13}],86:[function(a,b,c){(function(){var c,d;c=a("es6-promise").Promise,b.exports=d=function(a){return new c(function(b,c){var d,e,f,g,h;return g=a.getViewNodes(),e=a.model,b((d=e.findCommonType(function(){var a,b,c;for(c=[],a=0,b=g.length;b>a;a++)f=g[a],c.push(f.getType());return c}()))?e.getPathInfo(d).getDisplayName():null!=(h=e.name)?h:"")})}}).call(this)},{"es6-promise":281}],87:[function(a,b,c){(function(){b.exports=function(a){return null==a&&(a=[]),function(b){return a.every(function(a){return b.has(a)})}}}).call(this)},{}],88:[function(a,b,c){(function(){var a;b.exports=a=function(a){var b,c,d,e,f,g,h,i,j;for(h=a.split(/></),c=1,b=[],i=0,j=h.length;j>i;i++)g=h[i],/>$/.test(g)||(g+=">"),/^</.test(g)||(g="<"+g),d=/^<\/\w+\s*>/.test(g),e=/\/>$/.test(g)||!d&&/<\/\w+>$/.test(g),f=!(e||d),d&&c--,b.push(new Array(c).join("  ")+g),f&&c++;return b.join("\n")}}).call(this)},{}],89:[function(a,b,c){(function(){var a,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b.exports=a=function(a){return function(b){var d,e,f,g,h;return b.isAttribute()?(f=b.getParent().getType().name,d=b.end.name,e=null!=(g=null!=a?a[f]:void 0)?g:[],h=""+f+"."+d,c.call(e,h)>=0):!1}}}).call(this)},{}],90:[function(a,b,c){(function(c){(function(){var d,e,f;d=a("jquery"),f=a("es6-promise").Promise,e=a("../options"),b.exports=function(a,b){return c[b]?f.resolve(c[b]):f.resolve(d.ajax({url:e.get(a),cache:!0,dataType:"script"})).then(function(){return c[b]})}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../options":63,"es6-promise":281,jquery:309}],91:[function(a,b,c){(function(){var c,d,e,f=[].slice;e=a("underscore"),d=function(a){return function(b){return e.all(a,function(a){return 0===a.indexOf(b)})}},b.exports=c=function(a){var b,c,e,g,h,i,j,k,l;if(b=a[0],i=2<=a.length?f.call(a,1):[],null==b)throw new Error("Empty list");if(!i.length)return b;for(g=b.split(/\./),j=d(i),h=g[0],k=0,l=g.length;l>k;k++)e=g[k],j(c=""+h+"."+e)&&(h=c);return h}}).call(this)},{underscore:312}],92:[function(a,b,c){(function(){c.href=function(a,b,c){var d,e;return d=[["subject",b],["body",c]],e=d.map(function(a){var b,c;return b=a[0],c=a[1],""+b+"="+encodeURIComponent(c)}).join("&"),a+"?"+e}}).call(this)},{}],93:[function(a,b,c){(function(){var a;b.exports=a=function(a){return a.map(function(a){return"change:"+a}).join(" ")}}).call(this)},{}],94:[function(a,b,c){(function(){var a;b.exports=a=function(a,b,c){var d,e,f,g,h;e=document.createElement("form"),e.method="POST",e.style.display="none",e.action=a,e.target=b+(new Date).getTime();for(g in c)f=document.createElement("input"),f.type="hidden",f.name=g,f.value=c[g],e.appendChild(f);d=document.querySelector("body"),d.appendChild(e),h=window.open("somenonexistantpathtonowhere",b),e.submit(),d.removeChild(e),h.close()}}).call(this)},{}],95:[function(a,b,c){(function(){var c,d;d=a("underscore"),c=function(a){var b;return d.object(function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.split("=").map(decodeURIComponent));return e}())},b.exports=function(a){var b,d,e,f,g;return g=a.split("?"),b=g[0],f=g[1],d=f.split("&"),e=c(d),{URL:b,params:e}}}).call(this)},{underscore:312}],96:[function(a,b,c){(function(){var c,d;d=a("underscore"),c=function(a,b){return a.toLowerCase().indexOf(b)>=0},b.exports=function(a){return function(b,e){var f,g,h,i,j;return g=null!=(i=null!=b&&null!=(j=b.toLowerCase())?j.split(" "):void 0)?i:[],f=function(a){var b,e,f;return f=a.path,b=a.item,e=a.name,d.all(g,function(a){return null==f&&(f=b),c(f.toString(),a)||c(e,a)})},e(null!=a.each?a.map(function(a){return a.toJSON()}).filter(f):function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)h=a[b],f(h)&&d.push(h);return d}())}}}).call(this)},{underscore:312}],97:[function(a,b,c){(function(){var c,d,e,f,g;g=a("underscore"),d=a("es6-promise").Promise,c={},f=function(a){return function(b){var c,d,e,f,h,i,j;for(h=g.zip(a,b),j=[],e=0,f=h.length;f>e;e++)i=h[e],d=i[0],c=i[1],j.push({path:d,name:c});return j}},b.exports=e=function(a,b){var e,g,h,i;return e=""+a.service.root+":"+a.root+":"+b,e in c?c[e]:(i=function(){var c,d,e,f;for(e=a.getPossiblePaths(b),f=[],c=0,d=e.length;d>c;c++)h=e[c],f.push(a.makePath(h));return f}(),i=i.filter(function(a){var b;return!("id"===(null!=(b=a.end)?b.name:void 0))}),g=function(){var a,b,c;for(c=[],a=0,b=i.length;b>a;a++)h=i[a],c.push(h.getDisplayName());return c}(),null!=c[e]?c[e]:c[e]=d.all(g).then(f(i)))}}).call(this)},{"es6-promise":281,underscore:312}],98:[function(a,b,c){(function(){var a,c;c=function(){function a(a){this.wrapped=a,this.root=this.wrapped.root,this._foundById={},this._counts={}}return a.prototype.fetchModel=function(){return this.wrapped.fetchModel()},a.prototype.findById=function(a,b,c){var d,e;return null!=(d=this._foundById)[e=""+a+":"+b+":"+c]?d[e]:d[e]=this.wrapped.findById(a,b,c)},a.prototype.count=function(a){var b,c;return null!=(b=this._counts)[c=JSON.stringify(a)]?b[c]:b[c]=this.wrapped.count(a)},a.prototype.destroy=function(){return this._foundById={},this._counts={},delete this.wrapped},a}(),b.exports=a=function(){function a(a,b){this.Preview=b,this.service=new c(a)}return a.prototype.get=function(a){var b,c,d,e;return b=this.Preview,d=this.service,e=a.get("classes"),c=a.get("id"),new b({service:d,model:{types:e,id:c}})},a.prototype.destroy=function(){return this.service.destroy(),delete this.service},a}()}).call(this)},{}],99:[function(a,b,c){(function(){c.fromPairs=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.map(encodeURIComponent).join("="));return e}().join("&")}}).call(this)},{}],100:[function(a,b,c){(function(){var c,d,e,f,g;c=a("jquery"),e=a("es6-promise").Promise,d=a("../options"),g=a("./load-resource"),f=function(){return g("Destination.Dropbox.Library","Dropbox")},b.exports=function(a,b,c){return f().then(function(f){return new e(function(e,g){return f.appKey=d.get("auth.dropbox"),f.save({files:[{url:a,filename:b}],success:e,progress:c,cancel:g,error:g})})})}}).call(this)},{"../options":63,"./load-resource":90,"es6-promise":281,jquery:309}],101:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m;m=a("underscore"),e=a("es6-promise").Promise,d=a("../options"),c=a("../messages"),g=a("./get-organisms"),f=a("./branding"),i=a("./get-result-class"),j=a("./open-window-with-post"),k=a("./parse-url"),b.exports=l=function(a,b,c){var k,l,n,o,p,q;return k=d.get("Destination.Galaxy"),p=null!=(q=k.Current)?q:k.Main,/tool_runner$/.test(p)||(p+="/tool_runner"),l=f(this.query.service),o=i(this.query),n=g(this.query),e.all([o,n,l]).then(h(a,this.query,this.model.format.ext)).then(m.partial(j,p,"Upload"))},h=function(a,b,e){return function(f){var g,h,i,j,l,n,o,p,q,r,s,t,u,v;return j=f[0],s=f[1],h=f[2],v=k(a),g=v.URL,t=v.params,p=function(){var a,c,d,e;for(d=b.constraints,e=[],a=0,c=d.length;c>a;a++)i=d[a],"IN"===i.op&&e.push(i.value);return e}(),n="tsv"===e?"tabular":e,l=window.location.toString().replace(/\?.*$/,""),u=d.get("Destination.Galaxy.Tool"),q=c.getText("export.galaxy.name",{cls:j,orgs:s,branding:h}),o=c.getText("export.galaxy.info",{query:b,lists:p,orgs:s,currentLocation:l}),null!=s&&(r=s.join(", ")),m.extend(t,{tool_id:u,URL:g,name:q,info:o,data_type:n,organism:r,URL_method:"post"})}},l.after=function(){var a;return a=d.get("Destination.Galaxy"),a.Current&&a.Save?this.query.service.whoami().then(function(b){return b.preferences["galaxy-url"]!==a.Current?b.setPreference("galaxy-url",a.Current):void 0}):e.resolve(null)}}).call(this)},{"../messages":16,"../options":63,"./branding":70,"./get-organisms":84,"./get-result-class":86,"./open-window-with-post":94,"./parse-url":95,"es6-promise":281,underscore:312}],102:[function(a,b,c){(function(){var c,d,e,f,g,h;h=a("underscore"),d=a("es6-promise").Promise,c=a("../options"),e=a("./query-string").fromPairs,f=function(a,b){var d,f,g;return d=c.get("Destination.GenomeSpace"),f=[["uploadUrl",a],["fileName",b]],g=e(f),""+d.Upload+"?"+g},g=function(a,b){return new d(function(c,d){var e;return e=window.open(f(a,b)),e.setCallbackOnGSUploadComplete=function(a){return c(a)},e.setCallbackOnGSUploadError=function(a){return console.log("GSERR",arguments),d(new Error("Could not save to "+a))},e.addEventListener("unload",function(){return d(new Error("Upload cancelled"))}),e.focus()})},b.exports=g}).call(this)},{"../options":63,"./query-string":99,"es6-promise":281,underscore:312}],103:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;c=a("jquery"),x=a("underscore"),p=a("es6-promise").Promise,o=a("../options"),u=a("./load-resource"),y=null,l="Destination.Drive.Library",d="-------314159265358979323846",f="\r\n--"+d+"\r\n",e="\r\n--"+d+"--",t="v2",s="https://www.googleapis.com/auth/drive.file",i="No configuration available for Google Drive",m="Content-Type: application/json\r\n\r\n",j="Content-Type: text/tab-separated-values\r\n\r\n",q='multipart/mixed; boundary="'+d+'"',h="/upload/drive/v2/files",g="POST",r={path:h,method:g,params:{uploadType:"multipart"},headers:{"Content-Type":q}},w=function(){return null!=y?y:y=u(l,"gapi").then(function(a){return new k(a)})},b.exports=v=function(a,b,c){return w().then(function(d){return c(1),d.upload(a,b)})},n=function(){function a(a){this.title=a}return a.prototype.mimetype="text/plain",a.prototype.toString=function(){return JSON.stringify({title:this.title,mimetype:this.mimetype})},a}(),k=function(){function a(a){if(this.gapi=a,!this.gapi)throw new Error("No api");if(!o.get("auth.drive"))throw new Error(i);console.log(this.gapi)}return a.prototype.authorize=function(){return new p(function(a){return function(b,c){var d,e,f,g,h,i;f=a.gapi,i=null,h={client_id:o.get("auth.drive"),scope:s,immediate:!1},g=function(){return f.auth.authorize(h,function(a){return null==a?c(new Error("Not authorized")):a.error?c(new Error(a.error)):b()})},d=function(){return clearTimeout(i),c(new Error("timed out"))},e=function(){var a;return clearTimeout(i),(null!=(a=f.auth)?a.authorize:void 0)?g():i=setTimeout(e,50)},e(),setTimeout(d,5e3)}}(this))},a.prototype.loadClient=function(){return new p(function(a){return function(b,c){return a.gapi.client.load("drive",t,b)}}(this))},a.prototype.makeRequestBody=function(a,b){return f+m+String(a)+f+j+b+e},a.prototype.makeRequest=function(a){return this.gapi.client.request(x.extend({body:a},r))},a.prototype.upload=function(a,b){return this.authorize().then(function(a){return function(){return a.loadClient()}}(this)).then(function(){return p.resolve(c.get(a))}).then(function(a){return function(c){return a.makeRequestBody(new n(b),c)}}(this)).then(function(a){return function(b){return a.makeRequest(b)}}(this)).then(function(a){return a.result.alternateLink})},a}()}).call(this)},{"../options":63,"./load-resource":90,"es6-promise":281,jquery:309,underscore:312}],104:[function(a,b,c){(function(){var c,d,e,f,g,h=[].slice;g=a("underscore"),d=g.compose,e=g.escape,f=a("./ensure-required-data"),c=function(a){return function(){var b,c;return c=arguments[0],b=2<=arguments.length?h.call(arguments,1):[],a.apply(null,b)}},b.exports=function(a,b,g,h){return{classes:h,target:a,replaces:b,call:c(d(e,g,f(a,b)))}}}).call(this)},{"./ensure-required-data":80,underscore:312}],105:[function(a,b,c){(function(){var a,c;a={ASC:"DESC",DESC:"ASC",NONE:"ASC"},b.exports=c=function(b,c){var d,e,f;return d=null!=(f=b.getSortDirection(c))?f:"NONE",e=a[d],b.orderBy([{path:c,direction:e}])}}).call(this)},{}],106:[function(a,b,c){(function(){var a;b.exports=a=function(a){return null!=a?(a=a.replace(/\n\s*\n/g,"\n\n"),a.replace(/(^\s*|\s*$)/g,"")):void 0}}).call(this)},{}],107:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){return function(){return a.apply(b,arguments)}};j=a("underscore"),e=a("../options"),d=a("../messages"),c=a("../icons"),h=a("../templates/mustache-settings"),g="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",i=j.template(g,h),b.exports=f=function(){function a(a,b){var f;this.suggestions=a,this.total=b,this.suggest=k(this.suggest,this),f=e.get("MaxSuggestions"),this.total>f&&(this.tooMany=i({icons:c,messages:d,extra:b-f}))}return a.prototype.tooMany="<span></span>",a.prototype.suggest=function(a,b){var c,d,e,f,g;return null==a||""===a?b(function(){var a,b,c,d;for(c=this.suggestions.slice(0,10),d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(e);return d}.call(this)):(d=null!=(f=null!=a&&null!=(g=a.toLowerCase())?g.split(" "):void 0)?f:[],c=function(a){var b;return b=a.item,null==b&&(b=""),j.all(d,function(a){return b.toLowerCase().indexOf(a)>=0})},b(function(){var a,b,d,f;for(d=this.suggestions,f=[],a=0,b=d.length;b>a;a++)e=d[a],c(e)&&f.push(e);return f}.call(this)))},a}()}).call(this)},{"../icons":14,"../messages":16,"../options":63,"../templates/mustache-settings":69,underscore:312}],108:[function(a,b,c){(function(){var b,d,e,f,g,h,i=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};g=a("es6-promise").Promise,e=a("../options"),f=a("../models/page"),d={},b=g.resolve(!0),c.getCache=function(a){var b,c,e;return c=a.toXML(),b=a.service.root,null!=d[e=b+":"+c]?d[e]:d[e]=new h(a)},c.onListChange=function(a){var b,c;for(c in d)b=d[c],i.call(listNamesFor(b.query),a)>=0&&b.dropRows();return!1},h=function(){function a(a){this.query=a.clone()}return a.prototype.offset=0,a.prototype.rows=null,a.prototype.toString=function(){var a;return(null!=(a=this.rows)?a.length:void 0)?"ResultCache("+this.offset+" .. "+(this.offset+this.rows.length)+")":"ResultCache(EMPTY)"},a.prototype.fetchRows=function(a,b){var c,d;return null==a&&(a=0),null==b&&(b=null),c=new f(a,b),d=this.updateCache(c),d.then(function(a){return function(){return a.getRows(c)}}(this))},a.prototype.updateCache=function(a){var c;return this.contains(a)?b:(c=this.getRequestPage(a),this.query.tableRows({start:c.start,size:c.size}).then(this.addRowsToCache(c)))},a.prototype.contains=function(a){var b,c;return b=this.rows,(null!=b?b.length:void 0)?(c=this.offset+b.length,!a.all()&&a.start>=this.offset&&a.end()<=c):!1},a.prototype.dropRows=function(){return this.rows=null,this.offset=0},a.prototype.getRequestPage=function(a){var b,c,d,g,h,i,j,k;return b=this.rows,c=e.get("TableResults.CacheFactor"),g=e.get("TableResults.RequestLimit"),i=a.all()?a.size:a.size*c,null==b?new f(a.start,i):(k=this.offset+b.length,j=a.all()||a.start>=this.offset?a.start:Math.max(0,a.start-i),h=new f(j,i),h.isBefore(this.offset)?(d=h.rightGap(this.offset),d+h.size>g?this.dropRows():h.size+=d):h.isAfter(k)&&(d=h.leftGap(k),d+h.size>g?this.dropRows():(h.size+=d,h.start=k)),h)},a.prototype.addRowsToCache=function(a){return function(b){return function(c){var d,e,f;if(d=b.rows,e=b.offset,null!=d){if(f=b.offset+d.length,a.start<e){if(a.end()<e)throw new Error("Cannot add "+a+" to "+b+" - non contiguous");d=a.all()||a.end()>f?c.slice():c.concat(d.slice(a.end()-e))}else{if(a.start>f)throw new Error("Cannot add "+a+" to "+b+" - non contiguous");a.all()||f<a.end()?d=d.slice(0,a.start-e).concat(c):console.error("Useless cache add - we already had these rows: "+a)}e=Math.min(e,a.start)}else d=c.slice(),e=a.start;return b.offset=e,b.rows=d,!0}}(this)},a.prototype.getRows=function(a){var b,c,d;if(d=a.start,c=a.size,null==this.rows)throw new Error("Cache has not been updated");return b=this.rows.slice(),b.splice(0,d-this.offset),null!=c&&c>0&&b.splice(c,b.length),b},a}(),c.ResultCache=h}).call(this)},{"../models/page":54,"../options":63,"es6-promise":281}],109:[function(a,b,c){(function(){var a;b.exports=a=function(a){return a.getDisplayName().then(function(b){return{path:a.toString(),name:b}})}}).call(this)},{}],110:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};f=a("es6-promise").Promise,d=a("../cdn"),e={},g=function(a,b){return i.call(c,b)>=0?f.resolve(c[b]):d.load(a).then(function(){return c[b]},console.error.bind(console))},b.exports=h=function(a,b,c){return(null!=e[a]?e[a]:e[a]=g(a,b)).then(c)}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../cdn":1,"es6-promise":281}],111:[function(a,b,c){b.exports="2.0.0-beta-42"},{}],112:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},v={}.hasOwnProperty,w=function(a,b){function c(){this.constructor=a}for(var d in b)v.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};s=a("underscore"),c=a("jquery"),m=a("es6-promise").Promise,t=a("imjs"),n=t.Query,k=t.Model,h=a("../core-model"),j=a("../messages"),o=a("../templates"),i=a("../icons"),l=a("../options"),p=a("../core-view"),g=a("./constraint-summary"),e=a("./constraint-editor"),j.setWithPrefix("conbuilder",{Add:"Add constraint",Update:"Update",Cancel:"Cancel",Remove:"Remove",EditCon:"Edit filter",NotEditable:"This constraint is not editable",ValuePlaceholder:"David*",ExtraPlaceholder:"Wernham-Hogg",ExtraLabel:"in",IsA:"is a",NoValue:"No value selected. Please enter a value.",NoOperator:"No operator selected. Please choose an operator.",BadLoop:"The selected path is not in the query.",NaN:"The value provided is not a number.",Duplicate:"This constraint is already on the query",TooManySuggestions:"We cannot show you all the possible values",NoSuitableLists:"No lists of this type are available",NoSuitableLoops:"No suitable loop paths were found"}),q=function(a,b){var c,d,e;return a||b?a&&b?(e=s.sortBy([a,b],function(a){return a.length}),d=e[0],c=e[1],s.all(c,function(a){return u.call(d,a)>=0})):!1:!0},r=function(a,b){var c,d,e,f,g,h,i,j,k;if(!a||!b)return a===b;for(d=s.union.apply(s,[a,b].map(s.keys)),e=!0,i=0,j=d.length;j>i;i++)c=d[i],k=function(){var d,e,f,g;for(f=[a,b],g=[],d=0,e=f.length;e>d;d++)h=f[d],g.push(h[c]);return g}(),f=k[0],g=k[1],e&&(e=s.isArray(f)?q(f,g):f===g);return e},f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return w(b,a),b.prototype.defaults=function(){
return{code:null}},b.prototype.isTypeConstraint=function(){return null==this.get("op")},b}(h),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var c;return w(b,a),b.prototype.Model=f,b.prototype.tagName="div",b.prototype.className="im-constraint row-fluid",b.prototype.parameters=["query","constraint"],b.prototype.optionalParameters=["buttonDelegate"],b.prototype.initialize=function(){var a;b.__super__.initialize.apply(this,arguments),this.model.set(this.constraint),this.state.set({editing:!1}),this.listenTo(this.state,"change:editing",this.toggleEditor),this.listenTo(this.model,"change:type",this.setTypeName),this.listenTo(this.model,"change:path",this.setDisplayName),this.listenTo(j,"change",this.reRender),this.listenTo(this.model,"cancel",this.cancelEditing),this.listenTo(this.model,"apply",this.applyChanges);try{this.model.set({path:this.query.makePath(this.constraint.path)})}catch(c){a=c,this.model.set({error:a}),this.state.set({editing:!0})}return this.setTypeName()},b.prototype.setDisplayName=function(){return this.model.get("path").getDisplayName(function(a){return function(b,c){return a.model.set({error:b,displayName:c}),null!=b?a.listenToOnce(a.query,"change:constraints",function(){return a.model.set({path:a.query.getPathInfo(a.constraint.path)}),a.setDisplayName()}):void 0}}(this))},b.prototype.cancelEditing=function(){return this.state.set({editing:!1}),this.model.set(s.omit(this.constraint,"path")),this.model.set({error:null})},b.prototype.toggleEditing=function(){return this.state.get("editing")?this.cancelEditing():this.state.set({editing:!0})},b.prototype.setTypeName=function(){var a,b;if(b=this.model.get("type"),null==b)return this.model.unset("typeName");try{return this.query.model.makePath(b).getDisplayName(function(a){return function(b,c){return a.model.set({error:b,typeName:c})}}(this))}catch(c){return a=c,this.model.set({error:a,typeName:b})}},b.prototype.events=function(){return{"click .im-edit":"toggleEditing","click .im-remove-constraint":"removeConstraint"}},c=/^\s*$/,b.prototype.getLoopProblem=function(a){var b,c;return c=function(){try{return this.query.getPathInfo(a.value),null}catch(c){return b=c,"BadLoop"}}.call(this)},b.prototype.getValueProblem=function(a){var b,d,e,f;return d=a.path,b=a.op,e=a.value,null==e||c.test(e)?"NoValue":(f=d.getType(),u.call(k.NUMERIC_TYPES,f)>=0&&s.isNaN(1*e)?"NaN":null)},b.prototype.getProblem=function(a){var b,d;return null!=a.type?null:!a.op||c.test(a.op)?"NoOperator":!a.path.isReference()||"="!==(b=a.op)&&"!="!==b?(d=a.op,u.call(n.ATTRIBUTE_VALUE_OPS.concat(n.REFERENCE_OPS),d)>=0?this.getValueProblem(a):this.isDuplicate(a)?"Duplicate":null):this.getLoopProblem(a)},b.prototype.isDuplicate=function(a){return s.any(this.query.constraints,s.partial(r,a))},b.prototype.setError=function(a){var b;return b=j.get("conbuilder."+a),this.model.set({error:b})},b.prototype.applyChanges=function(a){var b,c;return b=this.getProblem(a),null!=b?this.setError(b):(this.state.set({editing:!1}),this.removeConstraint(null,c=!0),null==a.values||a.values.length?(a.path=a.path.toString(),this.query.addConstraint(a),this.constraint=a,this.model.unset("new")):this.query.trigger("change:constraints"))},b.prototype.removeConstraint=function(a,b){return null==b&&(b=!1),null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.model.get("new")||this.query.removeConstraint(this.constraint,b),null!=a?this.remove():void 0},b.prototype.getData=function(){var a,b,c;return c=j,b=i,a=this.model.toJSON(),{icons:b,messages:c,con:a}},b.prototype.template=o.template("active-constraint",{variable:"data"}),b.prototype.toggleEditor=function(){var a;return this.state.get("editing")&&this.rendered?(a={model:this.model,query:this.query,buttonDelegate:this.buttonDelegate},this.renderChild("editor",new e(a),this.$(".im-constraint-editor"))):this.removeChild("editor")},b.prototype.renderSummary=function(){var a;return a={model:this.model},this.renderChild("summary",new g(a),this.$(".im-con-overview"))},b.prototype.postRender=function(){return this.renderSummary(),this.toggleEditor(),this.$("[title]").tooltip()},b}(p)}).call(this)},{"../core-model":2,"../core-view":3,"../icons":14,"../messages":16,"../options":63,"../templates":67,"./constraint-editor":129,"./constraint-summary":130,"es6-promise":281,imjs:290,jquery:309,underscore:312}],113:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)y.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},A=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};c=a("jquery"),v=a("underscore"),m=a("es6-promise").Promise,i=a("../messages"),p=a("../templates"),e=a("../core-view"),l=a("../options"),k=a("../core/nested-model"),q=a("../utils/branding"),h=a("../patterns").IS_BLANK,f=a("../mixins/has-typeaheads"),o=a("../utils/suggestion-source"),w=a("imjs"),x=w.Model,g=x.INTEGRAL_TYPES,j=x.NUMERIC_TYPES,n=w.Query,t=p.template("attribute_value_select"),u=function(a){return String(a).replace(/^\s+/,"").replace(/\s+$/,"")},s=function(a){return 1*u(a)},r=a("../templates/helpers").numToString,i.set({"constraintvalue.NoValues":"There are no possible values. This query returns no results","constraintvalue.OneValue":"There is only one possible value: <%- value %>. You might want to remove this constraint"}),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return z(b,a),b.include(f),b.prototype.className="im-attribute-value-controls",b.prototype.template=p.template("attribute_value_controls"),b.prototype.getData=function(){return v.extend(this.getBaseData(),{messages:i,con:this.model.toJSON()})},b.prototype.initialize=function(a){var c;return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.sliders=[],this.branding=new k,this.cast=(c=this.model.get("path").getType(),A.call(j,c)>=0?s:u),this.listenTo(i,"change",this.reRender),this.state.set({valuePlaceholder:i.getText("conbuilder.ValuePlaceholder")}),this.listenTo(this.branding,"change:defaults.value",function(){return this.state.set({valuePlaceholder:this.branding.get("defaults.value")})}),null!=this.query?(this.listenTo(this.query,"change:constraints",this.clearCachedData),this.listenTo(this.query,"change:constraints",this.reRender),q(this.query.service).then(function(a){return function(b){return a.branding.set(b)}}(this))):void 0},b.prototype.modelEvents=function(){return{destroy:function(){return this.stopListening()},"change:value":this.onChangeValue,"change:op":this.onChangeOp}},b.prototype.stateEvents=function(){return{"change:valuePlaceholder":this.reRender}},b.prototype.onChangeOp=function(){var a;return a=this.model.get("op"),null!=this.model.get("value")&&A.call(n.MULTIVALUE_OPS,a)>=0&&this.model.set({value:null,values:[this.model.get("value")]}),this.reRender()},b.prototype.onChangeValue=function(){return this.reRender()},b.prototype.removeAllChildren=function(){return this.removeTypeAheads(),this.removeSliders(),b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.removeSliders=function(){var a,b;for(b=[];a=this.sliders.pop();)try{a.slider("destroy"),b.push(a.remove())}catch(c){}return b},b.prototype.events=function(){return{"change .im-con-value-attr":"setAttributeValue"}},b.prototype.updateInput=function(){var a,b;return a=null!=(b=this.lastTypeahead())?b:this.$(".im-con-value-attr"),a.val(this.model.get("value"))},b.prototype.readAttrValue=function(){var a,b,c;b=(null!=(c=this.lastTypeahead())?c:this.$(".im-con-value-attr")).val();try{return null==b||h.test(b)?null:this.cast(b)}catch(d){return a=d,this.model.set({error:new Error(""+b+" might not be a legal value for "+this.path)}),b}},b.prototype.setAttributeValue=function(){return this.model.set({value:this.readAttrValue()})},b.prototype.postRender=function(){return this.provideSuggestions().then(null,function(a){return function(b){return a.model.set({error:b})}}(this)),this.$(".im-con-value-attr").focus()},b.prototype.provideSuggestions=function(){return this.getSuggestions().then(function(a){return function(b){var c,d,e;return e=b.stats,d=b.results,0===e.uniqueValues?(c=i.getText("constraintvalue.NoValues"),a.model.set({error:{message:c,level:"warning"}})):1===e.uniqueValues?(c=i.getText("constraintvalue.OneValue",{value:d[0].item}),a.model.set({error:{message:c,level:"warning"}})):null!=e.max?a.handleNumericSummary(e):null!=d[0].item?a.handleSummary(d,e.uniqueValues):void 0}}(this))},b.prototype.clearCachedData=function(){return delete this.__suggestions,this.model.unset("error")},b.prototype.getSuggestions=function(){return null!=this.__suggestions?this.__suggestions:this.__suggestions=function(a){return function(){var b,c,d,e,f;return a.model.get("path")?(c=a.query.clone(),f=a.model.get("value"),e=String(a.model.get("path")),d=l.get("MaxSuggestions"),c.constraints=function(){var a,d,g,h;for(g=c.constraints,h=[],a=0,d=g.length;d>a;a++)b=g[a],(b.path!==e||b.value!==f)&&h.push(b);return h}(),c.summarise(e,d)):m.reject(new Error("no path"))}}(this)()},b.prototype.replaceInputWithSelect=function(a){var b;return this.model.has("value")?(b=this.model.get("value"),null==b||v.any(a,function(a){var c;return c=a.item,c===b})||a.push({item:b})):this.model.set({value:a[0].item}),this.$el.html(t({Messages:i,items:a,value:b}))},b.prototype.handleSummary=function(a,b){var c,d,e,f,g,h;return("="===(h=this.model.get("op"))||"!="===h)&&a.length<l.get("DropdownMax")?this.replaceInputWithSelect(a):(e=this.$(".im-con-value-attr"),g=new o(a,b),f={minLength:0,highlight:!0},c={name:"summary_suggestions",source:g.suggest,displayKey:"item",templates:{footer:g.tooMany}},this.removeTypeAheads(),d=function(a){return function(b,c){return a.model.set({value:c.item})}}(this),this.activateTypeahead(e,f,c,a[0].item,d,function(a){return function(){return a.setAttributeValue()}}(this)))},b.prototype.clearer='<div class="" style="clear:both;">',b.prototype.getMarkers=function(a,b,c){var d,e,f,g,h,i,j,k;for(g=b-a,f=function(b){var d;return d=b*g+a,c?Math.round(d):d},e=function(a){return Math.round(100*a)},j=[0,.5,1],k=[],h=0,i=j.length;i>h;h++)d=j[h],k.push({percent:e(d),value:r(f(d))});return k},b.prototype.makeSlider=p.template("slider",{variable:"markers"}),b.prototype.handleNumericSummary=function(a){var b,d,e,f,h,i,j,k,l,m,n,o;return l=a.min,k=a.max,d=a.average,m=this.model.get("path"),o=m.getType(),i=A.call(g,o)>=0,n=i?1:k-l/100,e=i?function(a){return parseInt(a,10)}:parseFloat,f=this.$el,h=this.$("input"),f.append(this.clearer),j=this.getMarkers(l,k,i),this.removeSliders(),h.off("change.slider"),b=c(this.makeSlider(j)),b.appendTo(f).slider({min:l,max:k,value:this.model.has("value")?this.model.get("value"):e(d),step:n,slide:function(a,b){return h.val(b.value).change()}}),h.attr({placeholder:e(d)}),f.append(this.clearer),h.on("change.slider",function(a){return b.slider("value",e(h.val()))}),this.sliders.push(b)},b.prototype.remove=function(){return b.__super__.remove.apply(this,arguments),this.removeTypeAheads()},b}(e)}).call(this)},{"../core-view":3,"../core/nested-model":8,"../messages":16,"../mixins/has-typeaheads":32,"../options":63,"../patterns":64,"../templates":67,"../templates/helpers":68,"../utils/branding":70,"../utils/suggestion-source":107,"es6-promise":281,imjs:290,jquery:309,underscore:312}],114:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),d=a("../messages"),f=a("../core-view"),e=a("../options"),h=a("../templates/mustache-settings"),g="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.className="im-value-options btn-group",b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.getData=function(){return i.extend({value:null},b.__super__.getData.apply(this,arguments))},b.prototype.template=i.template(g,h),b.prototype.events=function(){return{"click .im-true":"setValueTrue","click .im-false":"setValueFalse"}},b.prototype.setValueTrue=function(){return this.model.set({value:!0})},b.prototype.setValueFalse=function(){return this.model.set({value:!1})},b}(f)}).call(this)},{"../core-view":3,"../messages":16,"../options":63,"../templates/mustache-settings":69,underscore:312}],115:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("../core-view"),h=a("../messages"),i=a("../options"),j=a("../templates"),d=a("../models/code-gen"),f=a("./code-gen-dialogue"),a("../messages/code-gen"),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.modelEvents=function(){return{"change:lang":this.reRender}},b.prototype.template=j.template("code-gen-button-main"),b}(e),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query","tableState"],b.prototype.Model=d,b.prototype.template=j.template("code-gen-button"),b.prototype.getData=function(){return k.extend(b.__super__.getData.apply(this,arguments),{options:i.get("CodeGen")})},b.prototype.renderChildren=function(){return this.renderChildAt(".im-show-code-gen-dialogue",new g({model:this.model}))},b.prototype.events=function(){return{"click .dropdown-menu.im-code-gen-langs li":"chooseLang","click .im-show-code-gen-dialogue":"showDialogue"}},b.prototype.chooseLang=function(a){var b;return b=this.$(a.target).closest("li").data("lang"),this.model.set({lang:b}),this.showDialogue()},b.prototype.showDialogue=function(){var a,b;return b=this.tableState.pick("start","size"),a=new f({query:this.query,model:this.model,page:b}),this.renderChild("dialogue",a),a.show()},b}(e)}).call(this)},{"../core-view":3,"../messages":16,"../messages/code-gen":18,"../models/code-gen":38,"../options":63,"../templates":67,"./code-gen-dialogue":116,underscore:312}],116:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},C={}.hasOwnProperty,D=function(a,b){function c(){this.constructor=a}for(var d in b)C.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};A=a("underscore"),p=a("es6-promise").Promise,m=a("./modal"),l=a("../messages"),o=a("../options"),q=a("../templates"),h=a("../models/code-gen"),f=a("../core/checkbox"),a("../messages/code-gen"),u=a("../utils/indent-xml"),w=a("../utils/strip-extra-whitespace"),z=a("../utils/with-cdn-resource"),n=/\s*#.*$/gm,e=/\/\*(\*(?!\/)|[^*])*\*\//gm,r="application/xml;charset=utf8",j="text/javascript;charset=utf8",i="text/html;charset=utf8",d={level:"Info",key:"codegen.CannotExportXML"},k={js:j,xml:r,html:i},y=A.partial(z,"prettify","prettyPrintOne"),x=A.partial(z,"filesaver","saveAs"),s=p.reject("Requirements not met"),v=function(a){var b,c;return A.object(function(){var d;d=[];for(b in a)c=a[b],c&&0!==c.length&&d.push([b,c]);return d}())},t=function(){var a;return a=!1,B.call(c,a)>=0?s:x(A.identity)},b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.Model=h,b.prototype.parameters=["query"],b.prototype.optionalParameters=["page"],b.prototype.page={start:0,size:o.get("DefaultPageSize")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.generateCode(),this.setExportLink()},b.prototype.modalSize=function(){return"lg"},b.prototype.title=function(){return l.getText("codegen.DialogueTitle",{query:this.query,lang:this.model.get("lang")})},b.prototype.primaryIcon=function(){return"Download"},b.prototype.primaryAction=function(){return l.getText("codegen.PrimaryAction")},b.prototype.body=q.template("code_gen_body"),b.prototype.invariants=function(){return{hasQuery:"No query"}},b.prototype.hasQuery=function(){return null!=this.query},b.prototype.modelEvents=function(){return{change:this.onChangeLang,"change:showBoilerPlate":this.reRenderBody,"change:highlightSyntax":this.reRenderBody}},b.prototype.stateEvents=function(){return{"change:generatedCode":this.reRenderBody}},b.prototype.events=function(){return A.extend(b.__super__.events.apply(this,arguments),{"click .dropdown-menu.im-code-gen-langs li":"chooseLang"})},b.prototype.getBoilerPlateRegex=function(){if(!this.model.get("showBoilerPlate"))switch(this.model.get("lang")){case"pl":case"py":case"rb":return n;case"java":case"js":return e;default:return null}},b.prototype.act=function(){var a,b,c,d;return c=this.model.get("lang"),"js"===c&&this.model.get("extrajs")&&(c="html"),a=new Blob([this.state.get("generatedCode")],{type:k[c]}),b=""+(null!=(d=this.query.name)?d:"name")+"."+c,x(function(c){return function(c){return c(a,b)}}(this))},b.prototype.onChangeLang=function(){var a;return a=this.model.get("lang"),this.$(".im-current-lang").text(l.getText("codegen.Lang",{lang:a})),this.$(".modal-title").text(this.title()),"js"===a||"xml"===a?t().then(function(a){return function(){return a.state.unset("error")}}(this)).then(null,function(a){return function(){return a.state.set({error:d})}}(this)):this.state.unset("error"),this.generateCode(),this.setExportLink()},b.prototype.generateCode=function(){var a;switch(a=this.model.get("lang")){case"xml":return this.state.set({generatedCode:this.generateXML()});case"js":return this.state.set({generatedCode:this.generateJS()});default:return this.getCodeFromCache(a)}},b.prototype.getCodeFromCache=function(a){var b,c;return null==this.cache&&(this.cache={}),null!=(null!=(c=this.cache)?c[a]:void 0)?this.state.set({generatedCode:this.cache[a]}):(b={query:this.query.toXML(),lang:a,date:Date.now()},this.query.service.post("query/code?cachebuster="+Date.now(),b).then(function(b){return function(c){return b.cache[a]=c.code,b.state.set({generatedCode:c.code})}}(this)))},b.prototype.generateXML=function(){return u(this.query.toXML())},b.prototype.generateJS=function(){var a,b,c,d;return d=q.template("code-gen-js"),c=v(this.query.toJSON()),a=o.get("CDN.server")+o.get(["CDN","imtables"]),b={service:this.query.service,query:c,page:this.page,asHTML:this.model.get("extrajs"),imtablesJS:a+"imtables.js",imtablesCSS:a+"main.sandboxed.css"},d(b)},b.prototype.setExportLink=function(){var a;switch(a=this.model.get("lang")){case"xml":case"js":return this.state.set({exportLink:null});default:return this.state.set({exportLink:this.query.getCodeURI(a)})}},b.prototype.reRenderBody=function(){return this.rendered?(this.$(".modal-body").html(this.body(this.getData())),this.trigger("rendered",this.rendered)):void 0},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.addCheckboxes(),this.highlightCode(),this.setMaxHeight()},b.prototype.setMaxHeight=function(){var a;return a=Math.max(250,this.$el.closest(".modal").height()-200),this.$(".im-generated-code").css({"max-height":a})},b.prototype.addCheckboxes=function(){var a;return this.renderChildAt(".im-show-boilerplate",new f({model:this.model,attr:"showBoilerPlate",label:"codegen.ShowBoilerPlate"})),this.renderChildAt(".im-highlight-syntax",new f({model:this.model,attr:"highlightSyntax",label:"codegen.HighlightSyntax"})),(a=o.get(["CodeGen","Extra",this.model.get("lang")]))?this.renderChildAt(".im-extra-options",new f({model:this.model,attr:"extra"+this.model.get("lang"),label:a})):void 0},b.prototype.highlightCode=function(){var a,b,c;if(this.model.get("highlightSyntax")){if(b=this.model.get("lang"),c=this.$(".im-generated-code"),a=this.getCode(),null==a)return;return y(function(b){return c.html(b(A.escape(a)))})}},b.prototype.getData=function(){return A.extend(b.__super__.getData.apply(this,arguments),{options:o.get("CodeGen"),generatedCode:this.getCode()})},b.prototype.getCode=function(){var a,b;return a=this.state.get("generatedCode"),b=this.getBoilerPlateRegex(),b?w(null!=a?a.replace(b,""):void 0):a},b.prototype.toggleShowBoilerPlate=function(){return this.model.toggle("showBoilerPlate")},b.prototype.toggleHighlightSyntax=function(){return this.model.toggle("highlightSyntax")},b.prototype.chooseLang=function(a){var b;return a.stopPropagation(),b=this.$(a.target).closest("li").data("lang"),this.model.set({lang:b})},b}(m)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/checkbox":4,"../messages":16,"../messages/code-gen":18,"../models/code-gen":38,"../options":63,"../templates":67,"../utils/indent-xml":88,"../utils/strip-extra-whitespace":106,"../utils/with-cdn-resource":110,"./modal":197,"es6-promise":281,underscore:312}],117:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=function(a,b){return function(){return a.apply(b,arguments)}},s={}.hasOwnProperty,t=function(a,b){function c(){this.constructor=a}for(var d in b)s.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};q=a("underscore"),i=a("./modal"),p=a("../templates"),h=a("../messages"),d=a("../core/collection"),l=a("../models/path"),f=a("./column-manager/tabs"),n=a("./column-manager/select-list"),o=a("./column-manager/sort-order"),c=a("../models/available-columns"),k=a("../models/order-element"),a("../messages/columns"),g=function(a){function b(){this.model=r(this.model,this),b.__super__.constructor.apply(this,arguments),this.listenTo(this,"change:index",function(){return q.defer(function(a){return function(){return a.sort()}}(this))})}return t(b,a),b.prototype.comparator="index",b.prototype.add=function(){return b.__super__.add.apply(this,arguments)},b.prototype.modelFactory=d.prototype.model,b.prototype.model=function(a){var b,c;return b=this.size(),c=new this.modelFactory(a),c.collection=this,c.set({index:b}),c},b}(d),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.modelFactory=l,b}(g),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.modelFactory=k,b}(g),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.parameters=["query"],b.prototype.modalSize=function(){return"lg"},b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-column-manager"},b.prototype.title=function(){return h.getText("columns.DialogueTitle")},b.prototype.primaryAction=function(){return h.getText("columns.ApplyChanges")},b.prototype.dismissAction=function(){return h.getText("Cancel")},b.prototype.act=function(){var a,b,c,d;return this.state.get("disabled")?void 0:(d=this.state.pick("viewChanged","orderChanged"),c=d.viewChanged,b=d.orderChanged,c&&!b?this.query.select(this.getCurrentView()):b&&!c?this.query.orderBy(this.getCurrentSortOrder()):(a={silent:!0,events:[]},this.query.select(this.getCurrentView(),a),this.query.orderBy(this.getCurrentSortOrder(),a),this.query.trigger(a.events.join(" "))),this.resolve("changed"))},b.prototype.stateEvents=function(){return{"change:currentTab":this.renderTabContent,"change:adding":this.setDisabled}},b.prototype.initialize=function(){var a,d,e,f,g,h,i,k,l,n,o,p,q;for(b.__super__.initialize.apply(this,arguments),this.selectList=new m,this.rubbishBin=new m,this.sortOrder=new j,this.availableColumns=new c,n=this.query.views,f=0,i=n.length;i>f;f++)e=n[f],this.selectList.add(this.query.makePath(e));for(o=this.query.sortOrder,g=0,k=o.length;k>g;g++)p=o[g],d=p.path,a=p.direction,this.sortOrder.add({direction:a,path:this.query.makePath(d)});for(q=this.getRelevantPaths(),h=0,l=q.length;l>h;h++)d=q[h],this.sortOrder.get(d.toString())||this.availableColumns.add(d,{sort:!1});return this.availableColumns.sort(),this.listenTo(this.selectList,"sort add remove",this.setDisabled),this.listenTo(this.sortOrder,"sort add remove",this.setDisabled)},b.prototype.getRelevantPaths=function(){return q.chain(this.query.getQueryNodes()).filter(function(a){return function(b){return!a.query.isOuterJoined(b)}}(this)).map(function(a){var b,c,d,e,f;for(e=a.getChildNodes(),f=[],c=0,d=e.length;d>c;c++)b=e[c],b.isAttribute()&&"id"!==b.end.name&&f.push(b);return f}).flatten().value()},b.prototype.getCurrentView=function(){return this.selectList.pluck("path")},b.prototype.getCurrentSortOrder=function(){return this.sortOrder.map(function(a){return a.asOrderElement()})},b.prototype.setDisabled=function(){var a,b,c,d,e,f;return this.state.get("adding")?this.state.set({disabled:!0}):(b=this.getCurrentView().join(" "),d=this.query.views.join(" "),a=this.sortOrder.map(function(a){return a.toOrderString()}).join(" "),c=this.query.getSorting(),f=b===d,e=a===c,this.state.set({viewChanged:!f,orderChanged:!e,disabled:f&&e}))},b.prototype.initState=function(){return this.state.set({disabledReason:"columns.NoChangesToApply",disabled:!0,currentTab:f.TABS[0]})},b.prototype.renderTabs=function(){return this.renderChild("tabs",new f({state:this.state}),this.$(".modal-body"))},b.prototype.renderTabContent=function(){var a;return this.rendered?(a=function(){switch(this.state.get("currentTab")){case"view":return new n({state:this.state,query:this.query,rubbishBin:this.rubbishBin,collection:this.selectList});case"sortorder":return new o({query:this.query,availableColumns:this.availableColumns,collection:this.sortOrder});default:throw new Error("Cannot render "+this.state.get("currentTab"))}}.call(this),this.renderChild("main",a,this.$(".modal-body"))):void 0},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.renderTabs(),this.renderTabContent()},b.prototype.remove=function(){return this.selectList.close(),this.rubbishBin.close(),this.sortOrder.close(),this.availableColumns.close(),b.__super__.remove.apply(this,arguments)},b}(i)}).call(this)},{"../core/collection":5,"../messages":16,"../messages/columns":19,"../models/available-columns":36,"../models/order-element":53,"../models/path":56,"../templates":67,"./column-manager/select-list":122,"./column-manager/sort-order":124,"./column-manager/tabs":125,"./modal":197,underscore:312}],118:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),e=a("./unselected-column"),d=900,b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.parameters=["findActives"],b.prototype.restoreTitle="columns.AddColumnToSortOrder",b.prototype.events=function(){return f.extend(b.__super__.events.apply(this,arguments),{mousedown:"onMouseDown",dragstart:"onDragStart",dragstop:"onDragStop"})},b.prototype.onMouseDown=function(){return this.fixAppendTo()},b.prototype.fixAppendTo=function(){var a,b;return this.$el.draggable("option","appendTo",this.$el.closest(".well")),a=this.$el.closest(".modal").width(),b=a>=d,this.$el.draggable("option","axis",b?null:"y")},b.prototype.onDragStart=function(){return this.state.set({dragged:this.model.get("path")}),this.$el.addClass("ui-dragging")},b.prototype.onDragStop=function(){return this.state.unset("dragged"),this.$el.removeClass("ui-dragging")},b.prototype.postRender=function(){var a,b,c;return b=this.$el.closest(".modal").width(),c=b>=d,a=this.model.collection.indexOf(this.model),this.$el.draggable({axis:c?null:"y",connectToSortable:this.findActives(),helper:"clone",revert:"invalid",opacity:.8,cancel:"i,a,button",zIndex:1e3}),this.$("[title]").tooltip({placement:0===a?"bottom":"top"})},b}(e)}).call(this)},{"./unselected-column":126,underscore:312}],119:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../query-dialogue-button"),c=a("../column-manager"),a("../../messages/columns"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-column-manager-button",b.prototype.longLabel="columns.ManageColumns",b.prototype.shortLabel="columns.ManageColumnsShort",b.prototype.icon="Columns",b.prototype.Dialogue=c,b}(e)}).call(this)},{"../../messages/columns":19,"../column-manager":117,"../query-dialogue-button":206}],120:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("./selected-column"),f=a("../../templates"),e=["column-manager-position-controls","column-manager-order-direction","column-manager-path-name","column-manager-path-remover"],g=function(a){return"ASC"===a?"DESC":"ASC"},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.removeTitle="columns.RemoveOrderElement",b.prototype.template=f.templateFromParts(e),b.prototype.modelEvents=function(){return h.extend(b.__super__.modelEvents.apply(this,arguments),{"change:direction":this.reRender})},b.prototype.events=function(){return h.extend(b.__super__.events.apply(this,arguments),{"click .im-change-direction":"changeDirection"})},b.prototype.changeDirection=function(){return this.model.swap("direction",g)},b}(d)}).call(this)},{"../../templates":67,"./selected-column":123,underscore:312}],121:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../../core-view"),j=a("../../templates"),g=a("../../options"),i=a("../../models/path-set"),f=a("../../models/open-nodes"),h=a("../path-chooser"),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["collection","selectList"],b.prototype.template=j.template("column-manager-path-chooser-buttons"),b.prototype.collectionEvents=function(){return{"add remove reset":"reRender"}},b.prototype.events=function(){return{"click .im-add-column":"addColumn","click .im-rearrange-columns":"cancel"}},b.prototype.cancel=function(){return this.trigger("done")},b.prototype.addColumn=function(){var a,b;return b=this.selectList,a=this.collection.paths(),this.cancel(),b.add(a)},b}(e),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["query","collection"],b.prototype.template=j.template("column-manager-path-chooser"),b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),this.chosenPaths=new i,this.view=new i(function(){var b,c,d,e;for(d=this.collection.pluck("path"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.query.makePath(a));return e}.call(this)),this.openNodes=new f(this.query.getViewNodes())},b.prototype.initState=function(){return this.query.makePath(this.query.root).getDisplayName().then(function(a){return function(b){return a.state.set({rootName:b})}}(this))},b.prototype.stateEvents=function(){return{"change:rootName":"reRender"}},b.prototype.postRender=function(){return this.renderButtons(),this.openPathChooser()},b.prototype.renderButtons=function(){var a;return a=new c({state:this.state,collection:this.chosenPaths,
selectList:this.collection}),this.listenTo(a,"done",function(a){return function(){return a.trigger("done")}}(this)),this.renderChildAt(".btn-group",a)},b.prototype.openPathChooser=function(){var a,b;return a={dontSelectView:!0,multiSelect:g.get("ColumnManager.SelectColumn.Multi")},b=new h({model:a,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.renderChild("pathChooser",b),this.setPathChooserHeight()},b.prototype.setPathChooserHeight=function(){return this.$(".im-path-chooser").css({"max-height":this.$el.closest(".modal").height()-350})},b.prototype.remove=function(){return this.chosenPaths.close(),this.view.close(),this.openNodes.close(),b.__super__.remove.apply(this,arguments)},b}(e)}).call(this)},{"../../core-view":3,"../../models/open-nodes":52,"../../models/path-set":55,"../../options":63,"../../templates":67,"../path-chooser":201}],122:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};n=a("underscore"),e=a("../../core-view"),i=a("../../templates"),c=a("../../core/collection"),f=a("../../mixins/handles-dom-resort"),h=a("./selected-column"),j=a("./unselected-column"),d=a("./path-chooser"),l=function(a){return"path_"+a.get("id")},k=function(a){return"expath_"+a.get("id")},m=function(a){return a+1},b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.include(f),b.prototype.parameters=["query","collection","rubbishBin"],b.prototype.className="im-select-list-editor",b.prototype.template=i.template("column-manager-select-list"),b.prototype.getData=function(){return n.extend(b.__super__.getData.apply(this,arguments),{hasRubbish:this.rubbishBin.size()})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.rubbishBin,"remove",this.restoreView)},b.prototype.initState=function(){return this.state.set({adding:!1})},b.prototype.collectionEvents=function(){return{remove:"moveToBin","add remove":"reRender"}},b.prototype.events=function(){return{"drop .im-rubbish-bin":"onDragToBin","sortupdate .im-active-view":"onOrderChanged","click .im-add-view-path":"setAddingTrue"}},b.prototype.stateEvents=function(){return{"change:adding":"onChangeMode"}},b.prototype.setAddingTrue=function(){return this.state.set({adding:!0})},b.prototype.onDragToBin=function(a,b){return b.draggable.trigger("binned")},b.prototype.moveToBin=function(a){return this.rubbishBin.add(this.query.makePath(a.get("path"))),this.reIndexFrom(a.get("index"))},b.prototype.reIndexFrom=function(a){var b,c,d,e,f;for(f=[],b=c=a,d=this.collection.size();d>=a?d>=c:c>=d;b=d>=a?++c:--c)f.push(null!=(e=this.collection.at(b))?e.set({index:b}):void 0);return f},b.prototype.restoreView=function(a){return this.collection.add(this.query.makePath(a.get("path")))},b.prototype.onChangeMode=function(){return this.rendered?this.state.get("adding")?(this.$(".im-removal-and-rearrangement").hide(),this.$(".im-addition").show(),this.renderPathChooser()):(this.$(".im-removal-and-rearrangement").show(),this.$(".im-addition").hide(),this.removeChild("columnChooser")):void 0},b.prototype.renderPathChooser=function(){var a;return a=new d({query:this.query,collection:this.collection}),this.listenTo(a,"done",function(a){return function(){return a.state.set({adding:!1})}}(this)),this.renderChild("columnChooser",a,this.$(".im-addition"))},b.prototype.onOrderChanged=function(a,b){return null!=b.sender?this.restoreFromBin(b.item):this.onDOMResort()},b.prototype.getInsertPoint=function(a){var b,c,d;return b=a.prev(),c=this.children,d=this.collection.find(function(a){var d;return d=c[l(a)],d.el===b[0]}),null==d?0:d.get("index")+1},b.prototype.getRestoredModel=function(a){return this.rubbishBin.find(function(b){return function(c){var d;return d=b.children[k(c)],(null!=d?d.el:void 0)===a[0]}}(this))},b.prototype.restoreFromBin=function(a){var b,c,d,e,f,g,h,i,j,k;if(e=this.children,g=this.collection.size(),c=this.getInsertPoint(a),i=this.getRestoredModel(a),null==i)return void console.error("could not find model for:",a);if(i.destroy(),c!==g){for(h=function(){var a,b;for(b=[],d=a=c;g>=c?g>a:a>g;d=g>=c?++a:--a)b.push(this.collection.at(d));return b}.call(this),b=this.collection.last(),j=0,k=h.length;k>j;j++)f=h[j],f.swap("index",m);return b.set({index:c}),e[l(b)].$el.insertBefore(e[l(h[0])].el)}},b.prototype.onDOMResort=function(){return this.setChildIndices(l)},b.prototype.postRender=function(){var a,b,c,d,e;return b=this.$(".im-active-view"),a=this.$(".im-removed-view"),c=900,d=this.$el.closest(".modal").width(),e=d>=c,this.collection.each(function(a){return function(b){return b.collection=a.collection}}(this)),this.rubbishBin.each(function(a){return function(b){return b.collection=a.rubbishBin}}(this)),this.collection.each(function(a){return function(c){return a.renderChild(l(c),new h({model:c}),b)}}(this)),this.rubbishBin.each(function(b){return function(c){return b.renderChild(k(c),new j({model:c}),a)}}(this)),b.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:e?null:"y",appendTo:this.el}),this.$(".im-removed-view").sortable({placeholder:"im-view-list-placeholder",connectWith:b,opacity:.6,cancel:"i,a,button",axis:e?null:"y",appendTo:this.el}),this.$(".im-rubbish-bin").droppable({accept:".im-selected-column",activeClass:"im-can-remove-column",hoverClass:"im-will-remove-column"}),this.onChangeMode()},b.prototype.removeAllChildren=function(){return this.rendered&&(this.$(".im-active-view").sortable("destroy"),this.$(".im-removed-view").sortable("destroy"),this.$(".im-rubbish-bin").droppable("destroy")),b.__super__.removeAllChildren.apply(this,arguments)},b}(e)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../mixins/handles-dom-resort":31,"../../templates":67,"./path-chooser":121,"./selected-column":123,"./unselected-column":126,underscore:312}],123:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),d=a("../../core-view"),c=a("../../core/collection"),h=a("../../templates"),e=a("../../models/path"),j=a("../../utils/events").ignore,i=function(a){return a-1},k=function(a){return a+1},g=["column-manager-path-remover","column-manager-position-controls","column-manager-path-name"],b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.Model=e,b.prototype.tagName="li",b.prototype.className="list-group-item im-selected-column",b.prototype.template=h.templateFromParts(g),b.prototype.removeTitle="columns.RemoveColumn",b.prototype.getData=function(){var a;return a=this.model===this.model.collection.last(),l.extend(b.__super__.getData.apply(this,arguments),{removeTitle:this.removeTitle,isLast:a,parts:this.parts.pluck("part")})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.parts=new c,this.listenTo(this.parts,"add remove reset",this.reRender),this.resetParts(),this.listenTo(this.model.collection,"sort",this.onCollectionSorted)},b.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:parts":this.resetParts}},b.prototype.stateEvents=function(){return{"change:fullPath":this.setFullPathClass}},b.prototype.onCollectionSorted=function(){return this.reRender()},b.prototype.resetParts=function(){var a,b;return this.parts.reset(function(){var c,d,e,f;for(e=this.model.get("parts"),f=[],a=c=0,d=e.length;d>c;a=++c)b=e[a],f.push({part:b,id:a});return f}.call(this))},b.prototype.postRender=function(){return this.$("[title]").tooltip({container:this.$el})},b.prototype.events=function(){return{"click .im-remove-view":"removeView","click .im-move-up":"moveUp","click .im-move-down":"moveDown",click:"toggleFullPath",binned:"removeView"}},b.prototype.toggleFullPath=function(){return this.state.toggle("fullPath")},b.prototype.moveDown=function(a){var b;return j(a),b=this.model.collection.at(k(this.model.get("index"))),b.swap("index",i),this.model.swap("index",k),this.$el.insertAfter(this.$el.next())},b.prototype.moveUp=function(a){var b;return j(a),b=this.model.collection.at(i(this.model.get("index"))),b.swap("index",k),this.model.swap("index",i),this.$el.insertBefore(this.$el.prev())},b.prototype.setFullPathClass=function(){return this.$el.toggleClass("im-full-path",this.state.get("fullPath"))},b.prototype.removeView=function(a){return j(a),this.model.collection.remove(this.model),this.model.destroy()},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../models/path":56,"../../templates":67,"../../utils/events":81,underscore:312}],124:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),f=a("../../core-view"),e=a("../../core-model"),j=a("../../templates"),g=a("../../mixins/handles-dom-resort"),d=a("./available-path"),h=a("./order-element"),k=function(a){return"active_"+a.get("id")},l=function(a){return"inactive_"+a.get("id")},b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.include(g),b.prototype.parameters=["collection","query","availableColumns"],b.prototype.className="im-sort-order-editor",b.prototype.template=j.template("column-manager-sort-order-editor"),b.prototype.getData=function(){return m.extend(b.__super__.getData.apply(this,arguments),{available:this.availableColumns.size()})},b.prototype.collectionEvents=function(){return{"add remove":this.reRender,sort:this.resortSortOrder,remove:this.makeAvailable}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.dragState=new e,this.listenTo(this.availableColumns,"sort add remove",this.resortAvailable),this.listenTo(this.availableColumns,"remove",this.addToSortOrder)},b.prototype.currentSortOrder=function(){return this.collection.map(function(a){return""+a.get("path")+" "+a.get("direction")}).join(" ")},b.prototype.postRender=function(){return this.resortSortOrder(),this.activateSortables(),this.resortAvailable(),this.setAvailableHeight()},b.prototype.activateSortables=function(){var a,b,c,d;return a=this.$(".im-active-oes"),b=900,c=this.$el.closest(".modal").width(),d=c>=b,this.collection.size()?this.$actives=a.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:d?null:"y",appendTo:this.el}):this.$droppable=this.$(".im-empty-collection").droppable({accept:".im-selected-column",activeClass:"im-can-add-column",hoverClass:"im-will-add-column"})},b.prototype.removeAllChildren=function(){var a,c;return null!=(a=this.$actives)&&a.sortable("destroy"),null!=(c=this.$droppable)&&c.droppable("destroy"),this.$droppable=null,this.$actives=null,b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.events=function(){return{"drop .im-empty-collection":"addSortElement","sortupdate .im-active-oes":"onDOMResort"}},b.prototype.onDOMResort=function(a,b){var c,d,e;return(e=this.dragState.get("dragged"))?(d=this.availableColumns.findWhere({path:e}),c=b.item.prevAll().length,this.addToSortOrder(d,c),this.dragState.unset("dragged")):this.setChildIndices(k)},b.prototype.makeAvailable=function(a){return this.availableColumns.add(this.query.makePath(a.get("path")))},b.prototype.findAvailable=function(a){return this.availableColumns.find(function(b){return function(c){var d;return(null!=(d=b.children[l(c)])?d.el:void 0)===a}}(this))},b.prototype.addSortElement=function(a,b){var c,d;return c=b.draggable,d=this.findAvailable(c[0]),this.addToSortOrder(d)},b.prototype.addToSortOrder=function(a,b){var c,d,e,f,g,h,i,j;if(f=this.query.makePath(a.get("path")),e={id:String(f),path:f},g=this.collection.size(),a.destroy(),this.collection.add(e),null!=b&&g>b){for(h=this.collection.filter(function(a){return a.get("index")>=b}),c=this.collection.last(),i=0,j=h.length;j>i;i++)d=h[i],d.swap("index",function(a){return a+1});return c.set({index:b})}},b.prototype.resortAvailable=function(){var a;return this.rendered?(a=c.document.createDocumentFragment(),this.availableColumns.each(function(b){return function(c){return b._renderAvailable(c,a)}}(this)),this.$(".im-available-oes").html(a)):void 0},b.prototype._renderAvailable=function(a,b){var c,e,f;return e=l(a),c=function(a){return function(){return a.$actives}}(this),f=new d({model:a,findActives:c,state:this.dragState}),this.renderChild(e,f,b)},b.prototype.resortSortOrder=function(){var a;return this.rendered?(a=c.document.createDocumentFragment(),this.collection.each(function(b){return function(c){return b.renderChild(k(c),new h({model:c}),a)}}(this)),this.$(".im-active-oes").html(a)):void 0},b.prototype.setAvailableHeight=function(){return this.$(".im-rubbish-bin").css({"max-height":Math.max(200,this.$el.closest(".modal").height()-450)})},b.prototype.remove=function(){return this.dragState.destroy(),b.__super__.remove.apply(this,arguments)},b}(f)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-model":2,"../../core-view":3,"../../mixins/handles-dom-resort":31,"../../templates":67,"./available-path":118,"./order-element":120,underscore:312}],125:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),e=a("../../core-view"),f=a("../../templates"),c=a("../../utils/css-class-set"),g=function(a,b){var d;return d={active:function(){return b.get("currentTab")===a}},d["im-"+a+"-tab"]=!0,new c(d)},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.TABS=["view","sortorder"],b.prototype.template=f.template("column-manager-tabs"),b.prototype.className="im-column-manager-tabs",b.prototype.getData=function(){return h.extend(b.__super__.getData.apply(this,arguments),{classes:this.classSets})},b.prototype.initState=function(){return this.state.set({currentTab:b.TABS[0]})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.initClassSets()},b.prototype.stateEvents=function(){return{"change:currentTab":this.reRender}},b.prototype.events=function(){return{"click .im-view-tab":"selectViewTab","click .im-sortorder-tab":"selectSortOrderTab"}},b.prototype.selectViewTab=function(){return this.state.set({currentTab:"view"})},b.prototype.selectSortOrderTab=function(){return this.state.set({currentTab:"sortorder"})},b.prototype.initClassSets=function(){var a,b,c,d,e;for(this.classSets={},d=["view","sortorder"],e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(function(a){return function(b){return a.classSets[b]=g(b,a.state)}}(this)(a));return e},b}(e)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/css-class-set":79,underscore:312}],126:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("./selected-column"),e=a("../../templates"),d=["column-manager-path-name","column-manager-restore-path"],b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.template=e.templateFromParts(d),b.prototype.events=function(){return{"click .im-restore-view":"removeView",click:"toggleFullPath"}},b.prototype.restoreTitle="columns.RestoreColumn",b.prototype.getData=function(){return g.extend(b.__super__.getData.apply(this,arguments),{restoreTitle:this.restoreTitle})},b}(c)}).call(this)},{"../../templates":67,"./selected-column":123,underscore:312}],127:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n=[].slice,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),g=a("es6-promise").Promise,i=a("../core-view"),f=a("../options"),h=a("../templates"),d=a("../mixins/has-typeaheads"),e=a("../patterns").IS_BLANK,k=a("../utils/path-suggester"),j=a("../utils/path-suggestions"),l=function(a){var b,c,d,e,f,g;return b=a.split(" > "),b.length>3?(c=4<=b.length?n.call(b,0,g=b.length-3):(g=0,[]),d=b[g++],e=b[g++],f=b[g++],"..."+d+" > "+e+" > "+f):a},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.include(d),b.prototype.className="row",b.prototype.initialize=function(a){return this.query=a.query,this.openNodes=a.openNodes,this.chosenPaths=a.chosenPaths,b.__super__.initialize.apply(this,arguments),this.state.set({chosen:[]}),this.listenTo(this.openNodes,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.setChosen),this.setChosen(),this.generatePathSuggestions()},b.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:showTree change:allowRevRefs":this.reRender}},b.prototype.stateEvents=function(){return{"change:chosen change:suggestions":this.reRender}},b.prototype.pathAcceptable=function(a){var b;return"id"===(null!=(b=a.end)?b.name:void 0)?!1:this.model.get("canSelectReferences")?!0:a.isAttribute()},b.prototype.generatePathSuggestions=function(){var a;return a=f.get("SuggestionDepth"),j(this.query,a).then(function(a){return function(b){return a.state.set({suggestions:b.filter(function(b){return a.pathAcceptable(b.path)})})}}(this))},b.prototype.getData=function(){var a,c;return c=this.openNodes.size(),a=this.chosenPaths.size(),m.extend({anyNodesOpen:c,anyNodeChosen:a},this.state.toJSON(),b.__super__.getData.apply(this,arguments))},b.prototype.template=h.template("constraint_adder_options"),b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.state.has("suggestions")&&this.installTypeahead(),this},b.prototype.installTypeahead=function(){var a,b,c,d,e;return this.removeTypeAheads(),b=this.$(".im-tree-filter"),e=this.state.get("suggestions"),d=k(e),c={minLength:3,highlight:!0},a={name:"path_suggestions",source:d,displayKey:"name"},this.activateTypeahead(b,c,a,e[0].name,function(a){return function(b,c){var d;return d=c.path,a.openNodes.add(d),a.model.get("multiSelect")?a.chosenPaths.add(d):a.chosenPaths.reset([d])}}(this))},b.prototype.events=function(){return{"click .im-collapser":"collapseBranches","change .im-allow-rev-ref":"toggleReverseRefs","change .im-tree-filter":"setFilter","click .im-choose":"toggleShowTree","click .im-approve":"triggerApproval","click .im-clear-filter":"clearFilter"}},b.prototype.triggerApproval=function(){return this.model.trigger("approved")},b.prototype.remove=function(){return this.removeTypeAheads(),b.__super__.remove.apply(this,arguments)},b.prototype.clearFilter=function(){return this.model.set({filter:null}),this.reRender()},b.prototype.setFilter=function(a){var b;return b=a.target.value,this.model.set({filter:e.test(b)?null:b})},b.prototype.collapseBranches=function(){return this.openNodes.reset()},b.prototype.toggleShowTree=function(){return this.model.toggle("showTree")},b.prototype.toggleReverseRefs=function(){return this.model.toggle("allowRevRefs")},b.prototype.setConstraint=function(){return this.model.trigger("approved")},b.prototype.setChosen=function(){var a,b,c;return c=this.chosenPaths.toJSON(),a=g.all(function(){var a,d,e;for(e=[],a=0,d=c.length;d>a;a++)b=c[a],e.push(b.getDisplayName());return e}()),a.then(function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(l(b));return e}).then(function(a){return function(b){return a.state.set({chosen:b})}}(this),function(a){return console.error(a)})},b}(i)}).call(this)},{"../core-view":3,"../mixins/has-typeaheads":32,"../options":63,"../patterns":64,"../templates":67,"../utils/path-suggester":96,"../utils/path-suggestions":97,"es6-promise":281,underscore:312}],128:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p={}.hasOwnProperty,q=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},r=function(a,b){return function(){return a.apply(b,arguments)}};o=a("underscore"),g=a("../messages"),m=a("../templates"),n=a("../core-view"),f=a("../core-model"),l=a("../models/path-set"),j=a("../models/open-nodes"),e=a("./constraint-adder-options"),h=a("./new-constraint"),k=a("./path-chooser"),g.set({"constraints.BrowseForColumn":"Browse for Column","constraints.AddANewFilter":"Add a new filter","constraints.Choose":"Choose","constraints.Filter":"Filter","columns.CollapseAll":"Collapse columns","columns.AllowRevRef":"Allow reverse references"}),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.defaults=function(){return{filter:null,showTree:!0,allowRevRefs:!1,canSelectReferences:!0,multiSelect:!1}},b}(f),i=".im-constraint-adder-options",b.exports=c=function(a){function b(){return this.showTree=r(this.showTree,this),b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.tagName="div",b.prototype.className="im-constraint-adder row-fluid",b.prototype.Model=d,b.prototype.initialize=function(a){var c;return this.query=a.query,this.buttonDelegate=a.buttonDelegate,b.__super__.initialize.apply(this,arguments),this.model.set({root:this.query.getPathInfo(this.query.root)}),this.chosenPaths=new l,this.view=new l(function(){var a,b,d,e;for(d=this.query.views,e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(this.query.makePath(c));return e}.call(this)),this.openNodes=new j(this.query.getViewNodes()),this.listenTo(this.query,"change:constraints",this.remove)},b.prototype.modelEvents=function(){return{approved:this.handleApproval,"change:showTree":this.toggleTree,"change:constraint":this.onChangeConstraint}},b.prototype.getTreeRoot=function(){return this.model.get("root")},b.prototype.handleApproval=function(){var a,b,c,d;return a=this.chosenPaths.toJSON()[0],null!=a?(c=this.model.get("constraint"),d=a.toString(),(null!=c?c.path:void 0)!==d?(b={path:d},this.model.set({constraint:b}),this.query.trigger("editing-constraint",b)):this.onChangeConstraint()):(console.debug("nothing chosen"),this.model.unset("constraint"))},b.prototype.renderConstraintEditor=function(){var a,b;return a=this.model.get("constraint"),b=new h({buttonDelegate:this.buttonDelegate,query:this.query,constraint:a}),this.renderChild("con",b,this.$(".im-new-constraint")),this.listenTo(b,"remove",function(){return this.model.set({showTree:!0})})},b.prototype.onChangeConstraint=function(){return this.rendered?this.model.get("constraint")?(this.model.set({showTree:!1}),this.renderConstraintEditor()):this.removeChild("con"):void 0},b.prototype.toggleTree=function(){return this.model.get("showTree")?this.showTree():this.hideTree()},b.prototype.hideTree=function(){return this.trigger("resetting:tree"),this.$(".im-path-finder").removeClass("open"),this.removeChild("tree")},b.prototype.showTree=function(a){var b;return this.trigger("showing:tree"),this.removeChild("con"),b=new k({model:this.model,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.$(".im-path-finder").addClass("open"),this.renderChild("tree",b,this.$(".im-path-finder"))},b.prototype.template=m.template("constraint_adder"),b.prototype.renderOptions=function(){var a;return a={model:this.model,openNodes:this.openNodes,chosenPaths:this.chosenPaths,query:this.query},this.renderChild("opts",new e(a),this.$(i))},b.prototype.postRender=function(){return this.renderOptions(),this.toggleTree()},b}(n)}).call(this)},{"../core-model":2,"../core-view":3,"../messages":16,"../models/open-nodes":52,"../models/path-set":55,"../templates":67,"./constraint-adder-options":127,"./new-constraint":199,"./path-chooser":201,underscore:312}],129:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},G={}.hasOwnProperty,H=function(a,b){function c(){this.constructor=a}for(var d in b)G.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};D=a("underscore"),r=a("../messages"),l=a("../icons"),j=a("../core-view"),A=a("./type-value-controls"),e=a("./attribute-value-controls"),t=a("./multi-value-controls"),h=a("./boolean-value-controls"),o=a("./lookup-value-controls"),p=a("./loop-value-controls"),n=a("./list-value-controls"),k=a("./error-message"),E=a("imjs"),x=E.Query,s=E.Model,y=x.REFERENCE_OPS,m=x.LIST_OPS,q=x.MULTIVALUE_OPS,v=x.NULL_OPS,c=x.ATTRIBUTE_OPS,d=x.ATTRIBUTE_VALUE_OPS,w=s.NUMERIC_TYPES,g=s.BOOLEAN_TYPES,f=d.concat(v),B='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',z=D.template(B,{variable:"data"}),u=function(){},C=function(a){var b,d;if(b=a.path,!(null!=b?b.isReference:void 0))throw new Error("No path or wrong type");return b.isRoot()&&y.concat(x.RANGE_OPS),b.isReference()?y.concat(x.RANGE_OPS).concat(a["new"]?["ISA"]:[]):(d=b.getType(),F.call(g,d)>=0?["=","!="].concat(v):c)},b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return H(b,a),b.prototype.tagName="div",b.prototype.className="form",b.prototype.parameters=["query","model"],b.prototype.optionalParameters=["buttonDelegate"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.path=this.model.get("path")},b.prototype.invariants=function(){return{modelHasPath:"No path found on model"}},b.prototype.modelHasPath=function(){return this.model.get("path")},b.prototype.getType=function(){return this.model.get("path").getType()},b.prototype.modelEvents=function(){return{"change:op change:displayName":this.reRender,destroy:this.stopListening}},b.prototype.events=function(){return{submit:function(a){return a.preventDefault(),a.stopPropagation()},"click .btn-cancel":"cancelEditing","click .btn-primary":"applyChanges","change .im-ops":"setOperator"}},b.prototype.delegateButtonEvents=function(){return this.buttonDelegate.off("click.constraint-editor"),this.buttonDelegate.on("click.constraint-editor",".btn-cancel",function(a){return function(){return a.cancelEditing()}}(this)),this.buttonDelegate.on("click.constraint-editor",".btn-primary",function(a){return function(){return a.applyChanges()}}(this))},b.prototype.setOperator=function(){return this.model.set({op:this.$(".im-ops").val()})},b.prototype.cancelEditing=function(){return this.model.trigger("cancel")},b.prototype.applyChanges=function(a){return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.model.trigger("apply",this.getConstraint())},b.prototype.getConstraint=function(){var a,b,c;return a=this.model.pick(["path","op","value","values","code","type"]),b=a.op,F.call(q.concat(v),b)>=0&&delete a.value,c=a.op,F.call(d.concat(v),c)>=0&&delete a.values,"ISA"===a.op&&delete a.op,a},b.prototype.getValueControls=function(){return null==this.path?null:this.isNullConstraint()?null:this.isTypeConstraint()?new A({model:this.model,query:this.query}):this.isMultiValueConstraint()?new t({model:this.model,query:this.query}):this.isListConstraint()?new n({model:this.model,query:this.query}):this.isBooleanConstraint()?new h({model:this.model,query:this.query}):this.isLoopConstraint()?new p({model:this.model,query:this.query}):this.isLookupConstraint()?new o({model:this.model,query:this.query}):this.isRangeConstraint()?new t({model:this.model,query:this.query}):this.path.isAttribute()?new e({model:this.model,query:this.query}):(this.model.set({error:new Error("cannot handle this constaint type")}),null)},b.prototype.isNullConstraint=function(){var a;return a=this.model.get("op"),F.call(v,a)>=0},b.prototype.isLoopConstraint=function(){var a;return this.path.isClass()&&("="===(a=this.model.get("op"))||"!="===a)},b.prototype.isTypeConstraint=function(){return this.path.isReference()&&(!this.model.get("op")||"ISA"===this.model.get("op"))},b.prototype.isBooleanConstraint=function(){var a,b;return a=this.path.getType(),F.call(g,a)>=0&&(b=this.model.get("op"),!(F.call(v,b)>=0))},b.prototype.isMultiValueConstraint=function(){var a;return this.path.isAttribute()&&(a=this.model.get("op"),F.call(q,a)>=0)},b.prototype.isListConstraint=function(){var a;return this.path.isClass()&&(a=this.model.get("op"),F.call(m,a)>=0)},b.prototype.isLookupConstraint=function(){var a;return this.path.isClass()&&(a=this.model.get("op"),F.call(x.TERNARY_OPS,a)>=0)},b.prototype.isRangeConstraint=function(){var a;return this.path.isReference()&&(a=this.model.get("op"),F.call(x.RANGE_OPS,a)>=0)},b.prototype.getOtherOperators=function(){return D.without(C(this.model.pick("new","path")),this.model.get("op"))},b.prototype.buttons=function(){var a;return null!=this.buttonDelegate?[]:(a=[{key:"conbuilder.Update",classes:"im-update"},{key:"conbuilder.Cancel",classes:"btn-cancel"}],this.model.get("new")?(a[0].key="conbuilder.Add",a[1].classes="im-remove-constraint"):a.push({key:"conbuilder.Remove",classes:"btn btn-default im-remove-constraint"}),a)},b.prototype.getData=function(){var a,b,c,d,e;return a=this.buttons(),d=r,c=l,e=this.getOtherOperators(),b=this.model.toJSON(),{buttons:a,icons:c,messages:d,icons:c,otherOperators:e,con:b}},b.prototype.template=z,b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.renderChild("valuecontrols",this.getValueControls(),this.$(".im-value-options")),this.renderChild("error",new k({model:this.model})),null!=this.buttonDelegate&&this.delegateButtonEvents(),this},b.prototype.remove=function(){var a;return null!=(a=this.buttonDelegate)&&a.off("click.constraint-editor"),this.$el.slideUp({always:function(a){return function(){return b.__super__.remove.call(a)}}(this)})},b}(j)}).call(this)},{"../core-view":3,"../icons":14,"../messages":16,"./attribute-value-controls":113,"./boolean-value-controls":114,"./error-message":137,"./list-value-controls":193,"./lookup-value-controls":194,"./loop-value-controls":195,"./multi-value-controls":198,"./type-value-controls":228,imjs:290,underscore:312}],130:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},o=[].slice;j=a("underscore"),f=a("../messages"),i=a("../templates"),d=a("../core-view"),e=a("../patterns").IS_BLANK,k=a("imjs"),h=k.Query,g=k.Model,f.set({"consummary.IsA":"is a","consummary.NoValue":"no value"}),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments);
}return m(b,a),b.prototype.tagName="ol",b.prototype.className="constraint-summary breadcrumb",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(f,"change",this.reRender)},b.prototype.getData=function(){return j.extend(b.__super__.getData.apply(this,arguments),{labels:this.getSummary()})},b.prototype.template=i.template("constraint-summary"),b.prototype.getTitleOp=function(){return this.model.get("op")||f.getText("consummary.IsA")},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{"click .label-path":function(){return this.state.toggle("showFullPath")}}},b.prototype.stateEvents=function(){return{"change:showFullPath":this.toggleFullPath}},b.prototype.toggleFullPath=function(){return this.$(".label-path").toggleClass("im-show-full-path",!!this.state.get("showFullPath"))},b.prototype.postRender=function(){return this.toggleFullPath()},b.prototype.getTitleVal=function(){var a,b,c,d,e,f;return this.model.has("values")&&(e=this.model.get("op"),n.call(h.MULTIVALUE_OPS.concat(h.RANGE_OPS),e)>=0)?(c=this.model.get("values"))?1===c.length?c[0]:0===c.length?"[ ]":c.length>5?c.length+" values":(a=2<=c.length?o.call(c,0,d=c.length-1):(d=0,[]),b=c[d++],""+a.join(", ")+" and "+b):void 0:this.model.has("value")?this.model.get("value"):null!=(f=this.model.get("typeName"))?f:this.model.get("type")},b.prototype.isLookup=function(){return"LOOKUP"===this.model.get("op")},b.prototype.getPathLabel=function(){var a,b,c,d,e;return d=this.model.toJSON(),c=d.title,a=d.displayName,b=d.path,{content:String(null!=(e=null!=c?c:a)?e:b),type:"path"}},b.prototype.getSummary=function(){var a,b,c,d,f;return a=[],a.push(this.getPathLabel()),(c=this.getTitleOp())&&a.push({content:c,type:"op"}),f=this.model.get("op"),n.call(h.NULL_OPS,f)<0&&(d=this.getTitleVal(),null==d||e.test(d)?(b=this.model.get("new")?"warning":"error",a.push({content:"NoValue",type:b})):a.push({content:d,type:"value"}),this.isLookup()&&this.model.has("extraValue")&&a.push({content:this.model.get("extraValue"),type:"extra",icon:"ExtraValue"})),a},b}(d)}).call(this)},{"../core-view":3,"../messages":16,"../patterns":64,"../templates":67,imjs:290,underscore:312}],131:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),f=a("../core-view"),g=a("../templates"),d=a("./constraint-adder"),c=a("./active-constraint"),a("../messages/constraints"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.className="im-constraints",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.reRender)},b.prototype.getData=function(){return h.extend(b.__super__.getData.apply(this,arguments),{constraints:this.getConstraints()})},b.prototype.events=function(){return{click:function(a){return null!=a?a.stopPropagation():void 0}}},b.prototype.template=g.templateFromParts(["constraints-heading","active-constraints"]),b.prototype.postRender=function(){var a,b,d,e,f,g;for(b=this.$(".im-active-constraints"),g=this.getConstraints(),d=e=0,f=g.length;f>e;d=++e)a=g[d],this.renderChild("con_"+d,new c({query:this.query,constraint:a}),b);return this.renderChild("conAdder",this.getConAdder())},b.prototype.getConstraints=function(){return this.query.constraints.slice()},b.prototype.getConAdder=function(){return new d({query:this.query})},b}(f)}).call(this)},{"../core-view":3,"../messages/constraints":21,"../templates":67,"./active-constraint":112,"./constraint-adder":128,underscore:312}],132:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),d=a("../../core-view"),e=a("../../messages"),f=a("../../models/path"),a("../../messages/constraints"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.Model=f,b.prototype.tagName="button",b.prototype.className="btn btn-primary im-add-constraint",b.prototype.optionalParameters=["hideType"],b.prototype.hideType=!1,b.prototype.template=function(a){return g.escape(e.getText("constraints.AddConFor",a))},b.prototype.getData=function(){return g.extend(b.__super__.getData.apply(this,arguments),{hideType:this.hideType})},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{click:function(){return this.trigger("chosen",this.model.get("path"))}}},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,underscore:312}],133:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},q=[].slice;n=a("underscore"),f=a("../../core-view"),k=a("../../models/path"),l=a("../../templates"),h=a("../../messages"),e=a("../constraint-adder"),c=a("./column-adder-button"),a("../../messages/constraints"),i=".im-constraint-adder-options",g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.className="btn-group",b.prototype.parameters=["main","options"],b.prototype.initState=function(){return this.state.set({open:!1})},b.prototype.stateEvents=function(){return{"change:open":this.toggleOpen}},b.prototype.toggleOpen=function(){return this.$el.toggleClass("open",this.state.get("open"))},b.prototype.ICONS="NONE",b.prototype.postRender=function(){var a,b,c,d,e,f;for(this.toggleOpen(),this.renderChild("main",this.main),this.renderChild("toggle",new m({state:this.state})),c=document.createElement("ul"),c.className="dropdown-menu",f=this.options,a=d=0,e=f.length;e>d;a=++d)b=f[a],this.renderChild(a,b,c);return this.$el.append(c)},b}(f),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.tagName="button",b.prototype.className="btn btn-primary dropdown-toggle",b.prototype.ICONS="NONE",b.prototype.template=n.template('<span class="caret"></span>\n<span class="sr-only"><%- Messages.getText(\'constraints.OtherPaths\') %></span>'),b.prototype.events=function(){return{click:function(){return this.state.toggle("open")}}},b}(f),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.tagName="li",b.prototype.className="",b.prototype.template=function(){return"<a>"+b.__super__.template.apply(this,arguments)+"</a>"},b}(c),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.parameters=["query","paths"],b.prototype.onChosen=function(a){return this.model.set({constraint:{path:a}})},b.prototype.renderOptions=function(){},b.prototype.showTree=function(){var a,b,d,e,f,h,l,m,n,o,p;for(o=this.paths,f=o[0],l=2<=o.length?q.call(o,1):[],d=new c({hideType:!0,model:new k(f)}),e=function(){var a,b,c;for(c=[],a=0,b=l.length;b>a;a++)h=l[a],c.push(new j({hideType:!0,model:new k(h)}));return c}(),b=new g({main:d,options:e}),p=[d].concat(q.call(e)),m=0,n=p.length;n>m;m++)a=p[m],this.listenTo(a,"chosen",this.onChosen);return this.renderChild("tree",b,this.$(i))},b}(e)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,"../../templates":67,"../constraint-adder":128,"./column-adder-button":132,underscore:312}],134:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("../../core-view"),h=a("../../models/path"),j=a("../../templates"),f=a("../../messages"),d=a("../constraint-adder"),c=a("./column-adder-button"),a("../../messages/constraints"),g=".im-constraint-adder-options",b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query","path"],b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),a={path:this.path},this.model.set({constraint:a})},b.prototype.events=function(){return{"click .im-add-constraint":this.act}},b.prototype.act=function(){return this.hideTree(),this.renderConstraintEditor()},b.prototype.renderOptions=function(){},b.prototype.showTree=function(){var a,b;return b=new h(this.query.makePath(this.path)),a=new c({model:b}),this.renderChild("tree",new c({model:b}),this.$(g))},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/constraints":21,"../../models/path":56,"../../templates":67,"../constraint-adder":128,"./column-adder-button":132,underscore:312}],135:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../constraints"),e=a("./single-column-adder"),c=a("./composed-column-adder"),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.getConAdder=function(){var a,b,d,f,g;return this.shouldShowAdder()?(g=this.model.attributes,f=g.replaces,a=g.isComposed,b=g.outerJoined,d=this.model.pathInfo(),a&&f.length>1?new c({query:this.query,paths:f}):b?new c({query:this.query,paths:[d].concat(f)}):new e({query:this.query,path:d})):void 0},b.prototype.shouldShowAdder=function(){var a,b,c,d;return d=this.model.attributes,b=d.numeric,a=d.isComposed,c=d.outerJoined,b||a||c||!this.getConstraints().length},b.prototype.getConstraints=function(){var a,b,c,d,e,f;for(b=this.model.get("path"),e=this.query.constraints,f=[],c=0,d=e.length;d>c;c++)a=e[c],a.path.match(b)&&f.push(a);return f},b}(d)}).call(this)},{"../constraints":131,"./composed-column-adder":133,"./single-column-adder":134}],136:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p={}.hasOwnProperty,q=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o=a("underscore"),f=a("../core-view"),i=a("../models/history"),m=a("../models/table"),k=a("../models/selected-objects"),c=a("../utils/events").Bus,e=a("../utils/children"),n=a("../core/type-assertions"),l=a("./table"),j=a("./query-tools"),h="Bad arguments to Dashboard - {query :: imjs.Query} is required",d="consumerContainer provided as selector - but no matching element was found",b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.tagName="div",b.prototype.className="imtables-dashboard container-fluid",b.prototype.Model=m,b.prototype.optionalParameters=["consumerContainer","consumerBtnClass"],b.prototype.initialize=function(a){var e;if(e=a.query,!n.Query.test(e)&&null==e)throw new Error(h);return b.__super__.initialize.apply(this,arguments),this.history=new i,this.bus=new c,this.history.setInitialState(e),this.selectedObjects=new k(e.service),null!=this.consumerContainer&&o.isString(this.consumerContainer)&&(this.consumerContainer=document.querySelector(this.consumerContainer),!this.consumerContainer)?console.log(d):void 0},b.prototype.renderChildren=function(){return this.renderQueryTools(),this.renderTable()},b.prototype.renderTable=function(){var a;return a=e.createChild(this,l),this.renderChild("table",a)},b.prototype.renderQueryTools=function(){var a;return a=e.createChild(this,j,{tableState:this.model}),this.renderChild("tools",a)},b.prototype.remove=function(){return this.bus.destroy(),this.history.close(),b.__super__.remove.apply(this,arguments)},b}(f)}).call(this)},{"../core-view":3,"../core/type-assertions":10,"../models/history":45,"../models/selected-objects":58,"../models/table":61,"../utils/children":76,"../utils/events":81,"./query-tools":208,"./table":209,underscore:312}],137:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("fs"),c=a("../core-view"),e=a("../icons"),f=a("../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.className="im-error-message",b.prototype.modelEvents=function(){return{"change:error":this.reRender}},b.prototype.getData=function(){return{icons:e,error:this.model.get("error")}},b.prototype.logError=function(){var a;return(a=this.model.get("error"))?console.error(a,a.stack):void 0},b.prototype.template=f.template("error-message"),b}(c)}).call(this)},{"../core-view":3,"../icons":14,"../templates":67,fs:246,underscore:312}],138:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H={}.hasOwnProperty,I=function(a,b){function c(){this.constructor=a}for(var d in b)H.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},J=function(a,b){return function(){return a.apply(b,arguments)}};G=a("underscore"),c=a("jquery"),t=a("../core-model"),s=a("./modal"),f=a("./constraint-adder"),r=a("../messages"),y=a("../templates"),u=a("../options"),n=a("../models/export-formats"),x=a("../mixins/runs-query"),q=a("./export-dialogue/tab-menu"),m=a("./export-dialogue/format-controls"),w=a("./export-dialogue/row-controls"),d=a("./export-dialogue/column-controls"),e=a("./export-dialogue/compression-controls"),l=a("./export-dialogue/flat-file-options"),p=a("./export-dialogue/json-options"),k=a("./export-dialogue/fasta-options"),g=a("./export-dialogue/destination-options"),v=a("./export-dialogue/preview"),B=a("../utils/open-window-with-post"),C=a("../utils/send-to-dropbox"),F=a("../utils/send-to-google-drive"),D=a("../utils/send-to-galaxy"),E=a("../utils/send-to-genomespace"),o={doneness:null,tab:"dest",dest:"download",linkToFile:null},j=["progress_bar","modal_error","export_dialogue_footer"],z=function(){function a(a){this.key="export.error."+a,this.message=r.get(this.key)}return a.prototype.cannotDismiss=!0,a}(),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return I(b,a),b.prototype.defaults=function(){return{filename:"results",format:n.getFormat("tab"),tablePage:null,start:0,columns:[],size:null,max:null,compress:!1,compression:"gzip",headers:!1,jsonFormat:"rows",fastaExtension:null,headerType:"friendly"}},b}(t),A=function(a){return function(b){return b.isa(a)}},b.exports=h=function(a){function b(){return this.onUploadError=J(this.onUploadError,this),this.onUploadProgress=J(this.onUploadProgress,this),this.onUploadComplete=J(this.onUploadComplete,this),b.__super__.constructor.apply(this,arguments)}return I(b,a),b.include(x),b.prototype.Model=i,b.prototype.className=function(){return"im-export-dialogue "+b.__super__.className.apply(this,arguments)},b.prototype.parameters=["query"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.has("format")&&!this.model.get("format").ext&&this.model.set({format:n.getFormat(this.model.get("format"))}),this.state.set(o),this.listenTo(this.state,"change:tab",this.renderMain),this.listenTo(this.model,"change",this.updateState),this.listenTo(this.model,"change:columns",this.setMax),this.listenTo(this.model,"change:format",this.onChangeFormat),this.categoriseQuery(),this.model.set({columns:this.query.views}),null!=this.query.name&&this.model.set({filename:this.query.name.replace(/\s+/g,"_")}),this.updateState(),this.setMax(),this.readUserPreferences()},b.prototype.onChangeFormat=function(){return G.defer(function(a){return function(){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(d=a.model.get("format"),b=a.model.get("columns"),null!=(m=d.needs)?m.length:void 0){for(h=b.slice(),f=[],n=a.query.views,k=0,l=n.length;l>k;k++)j=n[k],i=a.query.makePath(j).getParent(),G.any(d.needs,function(a){return i.isa(a)})&&f.push(i.append("id").toString());return g=G.uniq(f),a.model.set({nodecolumns:g}),e=d.maxColumns,c=e?G.first(g,e):g.slice(),a.model.set({columns:c}),a.model.once("change:format",function(){return a.model.set({columns:h}),a.model.unset("nodecolumns")})}}}(this))},b.prototype.readUserPreferences=function(){return this.query.service.whoami().then(function(a){return function(a){var b;if(a.hasPreferences)return(b=a.preferences["galaxy-url"])?u.set("Destination.Galaxy.Current",b):void 0}}(this))},b.prototype.setMax=function(){return this.getEstimatedSize().then(function(a){return function(b){return a.model.set({max:b})}}(this))},b.prototype.categoriseQuery=function(){var a,b,c,d,e;d=this.query.getViewNodes(),a={},e=this.query.model.classes;for(c in e)b=e[c],a[c]=G.any(d,A(c));return this.model.set({has:a})},b.prototype.title=function(){return r.getText("ExportTitle",{name:this.query.name})},b.prototype.modalSize="lg",b.prototype.primaryAction=function(){return r.getText(this.state.get("dest"))},b.prototype.primaryIcon=function(){return this.state.get("dest")},b.prototype.body=y.template("export_dialogue"),b.prototype.footer=y.templateFromParts(j),b.prototype.updateState=function(){var a,b,c,d,e,f,g,h,i,j,k;return k=this.model.toJSON(),c=k.compress,d=k.compression,j=k.start,i=k.size,g=k.max,f=k.format,b=k.columns,a=G.isEqual(b,this.query.views)?r.get("All"):b.length,h=this.getRowCount(),e=0===b.length?new z("NoColumnsSelected"):j>=g?new z("OffsetOutOfBounds"):null,this.state.set(this.model.pick("headers","headerType","jsonFormat","fastaExtension")),this.state.set({error:e,format:f,max:g,exportURI:this.getExportURI(),rowCount:this.getRowCount(),compression:c?d:null,columns:a})},b.prototype.getRowCount=function(){var a,b,c,d;return d=this.model.pick("start","size","max"),c=d.start,b=d.size,a=d.max,null==c&&(c=0),a-=null!=c?c:0,b=null!=b&&b>0?b:a,Math.min(a,b)},b.prototype.getMain=function(){switch(this.state.get("tab")){case"format":return m;case"columns":return d;case"compression":return e;case"column-headers":return l;case"opts-json":return p;case"opts-fasta":return k;case"dest":return g;case"rows":return w;case"preview":return v;default:return m}},b.prototype.onUploadComplete=function(a){return this.state.set({doneness:null,linkToFile:a})},b.prototype.onUploadProgress=function(a){return this.state.set({doneness:a})},b.prototype.onUploadError=function(a){return this.state.set({doneness:null,error:a}),console.error(a)},b.prototype.act=function(){var a,b,c,d,e,f,g,h,i,j;return this.onUploadProgress(0),b=this.getExporter(),e=this.model,i=this.state,h=this.query,a={model:e.toJSON(),state:i.toJSON(),query:h.clone()},j=this.getExportURI(),d=this.getFileName(),f=this.onUploadProgress,c=b.call(a,j,d,f),c.then(this.onUploadComplete,this.onUploadError),null!=b.after?(g=b.after.bind(a),c.then(g,g).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))):void 0},b.prototype.getExporter=function(){switch(this.state.get("dest")){case"download":return function(){return Promise.resolve(null)};case"Dropbox":return C;case"Drive":return F;case"Galaxy":return D;case"GenomeSpace":return E;default:throw new Error("Cannot export to "+this.state.get("dest"))}},b.prototype.events=function(){var a;return a=b.__super__.events.apply(this,arguments),a.keyup="handleKeyup",a},b.prototype.handleKeyup=function(a){var b,c;if(!this.$(a.target).is("input"))switch(a.which){case 40:return null!=(b=this.children.menu)?b.next():void 0;case 38:return null!=(c=this.children.menu)?c.prev():void 0}},b.prototype.renderMain=function(){var a;return a=this.getMain(),this.renderChild("main",new a({model:this.model,query:this.query,state:this.state}),this.$("div.main"))},b.prototype.postRender=function(){return this.renderChild("menu",new q({model:this.state}),this.$("nav.menu")),this.renderMain(),this.$el.focus(),b.__super__.postRender.apply(this,arguments)},b}(s)}).call(this)},{"../core-model":2,"../messages":16,"../mixins/runs-query":33,"../models/export-formats":42,"../options":63,"../templates":67,"../utils/open-window-with-post":94,"../utils/send-to-dropbox":100,"../utils/send-to-galaxy":101,"../utils/send-to-genomespace":102,"../utils/send-to-google-drive":103,"./constraint-adder":128,"./export-dialogue/column-controls":140,"./export-dialogue/compression-controls":141,"./export-dialogue/destination-options":142,"./export-dialogue/fasta-options":143,"./export-dialogue/flat-file-options":144,"./export-dialogue/format-controls":145,"./export-dialogue/json-options":146,"./export-dialogue/preview":148,"./export-dialogue/row-controls":149,"./export-dialogue/tab-menu":150,"./modal":197,jquery:309,underscore:312}],139:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),f=a("../query-dialogue-button"),d=a("../export-dialogue"),c=a("../../utils/count-executor"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.className="im-export-dialogue-button",b.prototype.longLabel="export.ExportQuery",b.prototype.shortLabel="export.Export",b.prototype.icon="Download",b.prototype.optionalParameters=["tableState"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),c.count(this.query).then(function(a){return function(b){return a.state.set({disabled:0===b})}}(this)).then(null,function(a){return function(b){return a.state.set({disabled:!0,error:b})}}(this))},b.prototype.initState=function(){return this.state.set({name:this.query.name})},b.prototype.dialogueOptions=function(){var a,b;return a=null!=(b=this.tableState)?b.pick("start","size"):void 0,{query:this.query,model:{tablePage:a}}},b.prototype.Dialogue=d,b}(f)}).call(this)},{"../../utils/count-executor":77,"../export-dialogue":138,"../query-dialogue-button":206,underscore:312}],140:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p={}.hasOwnProperty,q=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},r=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};o=a("underscore"),m=a("../../core-view"),j=a("../../models/path-set"),h=a("../label-view"),i=a("../../messages"),l=a("../../templates"),f=a("../../mixins/has-typeaheads"),n=a("../../utils/path-suggester"),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.template=o.partial(i.getText,"export.category.Columns"),b}(h),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.include(f),b.prototype.initialize=function(a){return this.columns=a.columns,this.query=a.query,b.__super__.initialize.apply(this,arguments),this.initSuggestions()},b.prototype.addSuggestion=function(a){var b;return this.columns.contains(a)?void 0:(this.suggestions.add(a),b=this.suggestions.get(a),a.getDisplayName(function(a,c){return b.set({error:a,name:c})}))},b.prototype.initSuggestions=function(){var a,b,c,d,e,f;for(this.suggestions=new j,c=this.query.getQueryNodes(),f=[],d=0,e=c.length;e>d;d++)b=c[d],f.push(function(){var c,d,e,f;for(e=b.getChildNodes(),f=[],c=0,d=e.length;d>c;c++)a=e[c],a.isAttribute()&&(this.columns.contains(a)?f.push(void 0):f.push(this.addSuggestion(a)));return f}.call(this));return f},b.prototype.postRender=function(){var a,b,c;return b=this.$("input"),c={minLength:1,highlight:!0},a={name:"view_suggestions",source:n(this.suggestions),displayKey:"name"},this.activateTypeahead(b,c,a,"Additional paths",function(a){return function(b,c){var d;return d=c.item,a.columns.add(d,{active:!0})}}(this)),this.$(".im-help").tooltip()},b.prototype.className="col-sm-8",b.prototype.template=l.template("export_add_column_control"),b}(m),k=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.className="col-sm-4",b.prototype.RERENDER_EVENT="change:isAll",b.prototype.initialize=function(a){return this.query=a.query,this.columns=a.columns,b.__super__.initialize.apply(this,arguments),this.setIsAll(),this.listenTo(this.columns,"change:active",this.setIsAll)},b.prototype.setIsAll=function(){var a,b,c;return c=this.query.views,b=function(){var b,c,d,e;for(d=this.columns.where({active:!0}),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.get("item").toString());return e}.call(this),this.model.set({isAll:o.isEqual(c,b)})},b.prototype.template=l.template("reset_button"),b.prototype.events=function(){return{"click button":"reset"}},b.prototype.reset=function(){var a;return a=this.query.views,this.columns.each(function(b){var c;return c=b.get("item").toString(),b.set({active:o.any(a,function(a){return a===c})})})},b}(m),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.initialize=function(){var a,c;return b.__super__.initialize.apply(this,arguments),this.model.has("active")||this.model.set({active:!0}),this.model.has("name")?void 0:(this.model.set({name:null}),a=this.model.get("item"),"id"===(null!=(c=this.model.get("item").end)?c.name:void 0)&&(a=a.getParent()),a.getDisplayName(function(a){return function(b,c){return a.model.set({error:b,name:c})}}(this)))},b.prototype.className="list-group-item",b.prototype.events=function(){return{"click .im-active-state":function(a){return function(){return a.model.toggle("active")}}(this)}},b.prototype.tagName="li",b.prototype.template=l.template("export_column_control"),b}(m),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return q(b,a),b.prototype.className="container-fluid",b.prototype.initialize=function(a){var c,d,e,f,g,h,i,k,l,m,n,p,q,r,s;if(this.query=a.query,b.__super__.initialize.apply(this,arguments),this.columns=new j,e=this.model.get("format"),c=this.model.get("columns"),!(null!=(r=e.needs)?r.length:void 0))for(s=this.query.views,k=0,n=s.length;n>k;k++)i=s[k],h=this.query.makePath(i),this.columns.add(h,{active:o.any(c,function(a){return a===i})});for(l=0,p=c.length;p>l;l++)d=c[l],this.columns.add(this.query.makePath(d),{active:!0});if(g=this.model.get("nodecolumns"))for(m=0,q=g.length;q>m;m++)f=g[m],this.columns.add(this.query.makePath(f),{active:!1});return this.listenTo(this.columns,"add remove reset change:active",this.setColumns),this.listenTo(this.columns,"add remove reset",this.reRender)},b.prototype.setColumns=function(a){var b,c,d,e,f;return c=function(){var a,c,d,e;for(d=this.columns.where({active:!0}),e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.get("item").toString());return e}.call(this),(d=this.model.get("format").maxColumns)&&null!=a&&c.length>d&&(e=a.get("item").toString(),f=function(){var a,d,f;for(f=[],a=0,d=c.length;d>a;a++)b=c[a],b!==e&&f.push(b);return f}(),c=[e].concat(o.first(f,d-1)),o.defer(function(a){return function(){var d,e,f,g,h;for(f=a.columns.where({active:!0}),h=[],d=0,e=f.length;e>d;d++)b=f[d],h.push(b.set({active:(g=b.get("item").toString(),r.call(c,g)>=0)}));return h}}(this))),this.model.set({columns:c})},b.prototype.tagName="form",b.prototype.template=l.template("export_column_controls"),b.prototype.postRender=function(){var a,b;return b=this.$("ul"),a=this.$(".controls"),this.columns.each(function(a){return function(c,d){return a.renderChild(d,new e({model:c}),b)}}(this)),this.renderChild("reset",new k({query:this.query,columns:this.columns}),a),this.renderChild("add",new c({query:this.query,columns:this.columns}),a)},b}(m)}).call(this)},{"../../core-view":3,"../../messages":16,"../../mixins/has-typeaheads":32,"../../models/path-set":55,"../../templates":67,"../../utils/path-suggester":96,"../label-view":179,underscore:312}],141:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("./main"),e=a("../../templates"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=e.template("export_compression_controls"),b.prototype.setCompression=function(a){return function(b){return function(){return b.model.set({compression:a})}}(this)},b.prototype.events=function(){return{"click .im-compress":function(a){return function(){return a.model.toggle("compress")}}(this),"click input[name=gzip]":this.setCompression("gzip"),"click input[name=zip]":this.setCompression("zip")}},b}(d)}).call(this)},{"../../templates":67,"./main":147,underscore:312}],142:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),c=a("../../core-view"),i=a("../../templates"),g=a("../../options"),f=a("../../models/export-formats"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.RERENDER_EVENT="change:dest",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(g,"change:Destination.Galaxy.*",this.reRender)},b.prototype.getData=function(){return j.extend(b.__super__.getData.apply(this,arguments),{Galaxy:g.get("Destination.Galaxy")})},b.prototype.getTemplate=function(){switch(this.model.get("dest")){case"Galaxy":return this.galaxyTemplate;default:return function(){return""}}},b.prototype.galaxyTemplate=i.template("export_destination_galaxy_options"),b.prototype.template=function(a){return this.getTemplate()(a)},b.prototype.events=function(){return{"change .im-galaxy-uri-param":"setGalaxyUri","change .im-save-galaxy input":"toggleSaveGalaxy"}},b.prototype.setGalaxyUri=function(a){var b;return b=a.target,g.set("Destination.Galaxy.Current",b.value)},b.prototype.toggleSaveGalaxy=function(){var a,b;return b="Destination.Galaxy.Save",a=g.get(b),g.set(b,!a)},b}(c),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.RERENDER_EVENT="change:dest",b.prototype.destinations=function(){var a,b,c,d,e;for(d=g.get("Destinations"),e=[],b=0,c=d.length;c>b;b++)a=d[b],g.get(["Destination",a,"Enabled"])&&e.push(a);return e},b.prototype.getData=function(){return j.extend({destinations:this.destinations()},b.__super__.getData.apply(this,arguments))},b.prototype.template=i.template("export_destination_radios"),b.prototype.setDest=function(a){return function(b){return function(){return b.model.set({dest:a})}}(this)},b.prototype.events=function(){var a;return j.object(function(){var b,c,d,e;for(d=this.destinations(),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(["click .im-dest-"+a,this.setDest(a)]);return e}.call(this))},b}(c),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.RERENDER_EVENT="change:format",b.prototype.getData=function(){var a,c;return c=this.model.get("has"),a=f.getFormats(c),j.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.template=i.template("export_destination_options"),b.prototype.postRender=function(){return this.renderChildAt(".im-param-dest",new h({model:this.state})),this.renderChildAt(".im-dest-opts",new e({model:this.state}))},b.prototype.events=function(){var a,b,c,d,e,g;for(a={".change .im-param-name input":"setName"
},c=this.model.get("has"),g=f.getFormats(c),d=0,e=g.length;e>d;d++)b=g[d],a["click .im-fmt-"+b.id]=this.setFormat.bind(this,b);return a},b.prototype.setName=function(a){return this.model.set({filename:a.target.value})},b.prototype.setFormat=function(a){return this.model.set({format:a})},b}(c)}).call(this)},{"../../core-view":3,"../../models/export-formats":42,"../../options":63,"../../templates":67,underscore:312}],143:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("../../core-view"),d=a("../label-view"),e=a("../../messages"),f=a("../../templates"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=f.template("export_fasta_options"),b.prototype.setFastaExtension=function(a){return this.model.set({fastaExtension:a})},b.prototype.events=function(){return{"change .im-fasta-ext":function(a){return function(b){return a.setFastaExtension(b.target.value)}}(this)}},b}(g)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:312}],144:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),e=a("../../core-view"),d=a("../../templates"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=d.template("export_flat_file_options"),b.prototype.setHeaderType=function(a){return function(b){return function(){return b.model.set({headerType:a})}}(this)},b.prototype.events=function(){return{"click .im-headers":function(a){return function(){return a.model.toggle("headers")}}(this),"click input[name=hdrs-friendly]":this.setHeaderType("friendly"),"click input[name=hdrs-path]":this.setHeaderType("path")}},b}(e)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:312}],145:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),i=a("../../core-view"),g=a("../../messages"),h=a("../../templates"),f=a("../label-view"),d=a("../../models/export-formats"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.template=j.partial(g.getText,"export.category.Format"),b}(f),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.tagName="form",b.prototype.template=h.template("export_format_controls"),b.prototype.getData=function(){var a,c;return c=this.model.get("has"),a=d.getFormats(c),j.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"change input:radio":"onChangeFormat"}},b.prototype.onChangeFormat=function(){return this.model.set({format:this.$("input:radio:checked").val()})},b.prototype.postRender=function(){return this.renderChild("heading",new e({model:this.model}),this.$(".im-title"))},b}(i)}).call(this)},{"../../core-view":3,"../../messages":16,"../../models/export-formats":42,"../../templates":67,"../label-view":179,underscore:312}],146:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("../../core-view"),d=a("../label-view"),e=a("../../messages"),f=a("../../templates"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="form",b.prototype.template=f.template("export_json_options"),b.prototype.setJSONFormat=function(a){return function(b){return function(){return b.model.set({jsonFormat:a})}}(this)},b.prototype.events=function(){return{"click input[name=rows]":this.setJSONFormat("rows"),"click input[name=objects]":this.setJSONFormat("objects")}},b}(g)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:312}],147:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../core-view"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments)},b}(d)}).call(this)},{"../../core-view":3}],148:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),c=a("../../core-view"),e=a("../../messages"),i=a("../../templates"),d=a("../../models/export-formats"),h=a("../../mixins/runs-query"),f={compress:null,size:3},b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.include(h),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.state.set({preview:""}),this.setPreview(),this.listenTo(this.state,"change:preview",this.reRender),this.listenTo(this.model,"change:format",this.setPreview)},b.prototype.setPreview=function(){var a;return a=this.model.get("format"),"bio"===a.group?this.state.set({preview:"Previews are not supported for bio-informatics formats"}):this.runQuery(f).then(function(a){return function(b){return j.isString(b)?a.state.set({preview:b}):a.state.set({preview:JSON.stringify(b,null,2)})}}(this))},b.prototype.template=i.template("export_preview"),b.prototype.getData=function(){var a,c;return c=this.model.get("has"),a=d.getFormats(c),j.extend({formats:a},b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"change .im-export-formats select":"setFormat"}},b.prototype.setFormat=function(a){return this.model.set({format:d.getFormat(a.target.value)})},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,"../../mixins/runs-query":33,"../../models/export-formats":42,"../../templates":67,underscore:312}],149:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),k=a("../../core-view"),d=a("../label-view"),e=a("../../messages"),j=a("../../templates"),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.getData=function(){return{size:this.model.get("size")||e.getText("rows.All")}},b.prototype.template=l.partial(e.getText,"export.param.Size"),b}(d),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.template=l.partial(e.getText,"export.param.Start"),b}(d),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.template=l.partial(e.getText,"export.category.Rows"),b}(d),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.getData=function(){return l.extend(b.__super__.getData.apply(this,arguments),{isAll:!(this.model.get("start")||this.model.get("size"))})},b.prototype.template=j.template("export_rows_reset_button"),b.prototype.events=function(){return{"click .btn-reset":"reset","click .im-set-table-page":"setTablePage"}},b.prototype.reset=function(){return this.model.set({start:0,size:null})},b.prototype.setTablePage=function(){return this.model.set(this.model.get("tablePage"))},b}(k),b.exports=h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.RERENDER_EVENT="change:max",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.has("max")||this.model.set({max:null}),this.listenTo(this.model,"change:size",this.updateLabels),this.listenTo(this.model,"change:size change:start",this.updateInputs)},b.prototype.tagName="form",b.prototype.template=j.template("export_row_controls"),b.prototype.events=function(){return{"input input[name=size]":"onChangeSize","input input[name=start]":"onChangeStart"}},b.prototype.updateInputs=function(){var a,b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,a=d.max,this.$("input[name=size]").val(b||a),this.$("input[name=start]").val(c)},b.prototype.onChangeSize=function(){var a;return a=parseInt(this.$("input[name=size]").val(),10),a&&a!==this.model.get("max")?this.model.set({size:a}):this.model.set({size:null})},b.prototype.onChangeStart=function(){return this.model.set({start:parseInt(this.$("input[name=start]").val(),10)})},b.prototype.postRender=function(){return this.renderChild("heading",new c({model:this.state}),this.$(".im-title")),this.renderChild("size",new i({model:this.model}),this.$(".size-label")),this.renderChild("start",new f({model:this.model}),this.$(".start-label")),this.renderChild("reset",new g({model:this.model}),this.$(".im-reset"))},b}(k)}).call(this)},{"../../core-view":3,"../../messages":16,"../../templates":67,"../label-view":179,underscore:312}],150:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),h=a("../../core-view"),c=a("../../options"),g=a("../../templates"),e=function(){function a(a,b,c,d){this.ident=a,this.formats=null!=c?c:[],this.groups=null!=d?d:null,this.key="export.category."+b}return a.prototype.isFor=function(a){var b;return this.formats.length?(b=a.ext,j.call(this.formats,b)>=0):null!=this.groups?this.groups[a.group]:!0},a}(),d=[new e("dest","Destination"),new e("opts-json","JsonFormat",["json"]),new e("opts-fasta","FastaFormat",["fasta"]),new e("columns","Columns"),new e("rows","Rows",[],{flat:!0,machine:!0}),new e("compression","Compression"),new e("column-headers","ColumnHeaders",["tsv","csv"]),new e("preview","Preview")],b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.tagName="ul",b.prototype.RERENDER_EVENT="change",b.prototype.className="nav nav-pills nav-stacked im-export-tab-menu",b.prototype.template=g.template("export_tab_menu",{variable:"data"}),b.prototype.getTabs=function(){var a,b,c,e;for(e=[],b=0,c=d.length;c>b;b++)a=d[b],a.isFor(this.model.get("format"))&&e.push(a);return e},b.prototype.getData=function(){var a;return a=this.getTabs(),i.extend({tabs:a},b.__super__.getData.apply(this,arguments))},b.prototype.setTab=function(a){return function(b){return function(){return b.state.get("pinned")?void 0:b.model.set({tab:a})}}(this)},b.prototype.setPinned=function(a){return function(b){return function(){return b.state.get("pinned")===a?b.state.set({pinned:!1}):b.state.set({pinned:a}),b.model.set({tab:a})}}(this)},b.prototype.next=function(){var a,b,c,d;return d=function(){var a,b,d,e;for(d=this.getTabs(),e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(c.ident);return e}.call(this),a=i.indexOf(d,this.model.get("tab")),b=a+1,b===d.length&&(b=0),this.model.set({tab:d[b]})},b.prototype.prev=function(){var a,b,c,d;return d=function(){var a,b,d,e;for(d=this.getTabs(),e=[],a=0,b=d.length;b>a;a++)c=d[a],e.push(c.ident);return e}.call(this),a=i.indexOf(d,this.model.get("tab")),b=0===a?d.length-1:a-1,this.model.set({tab:d[b]})},b.prototype.events=function(){var a,b,e;return b=c.get("Events.ActivateTab"),a=i.object(function(){var a,c,f;for(f=[],a=0,c=d.length;c>a;a++)e=d[a].ident,f.push([""+b+" .im-tab-"+e,this.setTab(e)]);return f}.call(this)),"mouseenter"===b&&i.extend(a,i.object(function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)e=d[a].ident,c.push(["click .im-tab-"+e,this.setPinned(e)]);return c}.call(this))),a},b}(h)}).call(this)},{"../../core-view":3,"../../options":63,"../../templates":67,underscore:312}],151:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n=function(a,b){return function(){return a.apply(b,arguments)}},o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../event"),c=a("../../core-view"),i=a("../../options"),k=a("../../mixins/sets-path-names"),m=a("../../models/summary-items"),h=a("../../models/numeric-range"),l=a("./summary-heading"),e=a("./items"),j=a("./selected-count"),g=a("./visualisation"),b.exports=f=function(a){function b(){return this.Model=n(this.Model,this),b.__super__.constructor.apply(this,arguments)}return p(b,a),b.include(k),b.prototype.className=function(){return"im-facet-view"},b.prototype.modelEvents=function(){return{"change:min change:max":this.setLimits}},b.prototype.stateEvents=function(){return{"change:open":this.honourOpenness}},b.prototype.parameters=["query","view"],b.prototype.optionalParameters=["noTitle"],b.prototype.Model=function(){return new m({query:this.query,view:this.view})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.range=new h,this.setPathNames(),this.setLimits()},b.prototype.initState=function(){return this.state.has("open")?void 0:this.state.set({open:i.get("Facets.Initally.Open")})},b.prototype.setLimits=function(){return this.model.get("numeric")?this.range.setLimits(this.model.pick("min","max")):void 0},b.prototype.invariants=function(){return{hasQuery:"No query",hasAttrView:"The view is not an attribute: "+this.view,modelIsSummaryItemsModel:"The model is not a summary items model: "+this.model}},b.prototype.modelIsSummaryItemsModel=function(){return this.model instanceof m},b.prototype.hasQuery=function(){return null!=this.query},b.prototype.hasAttrView=function(){var a;return null!=(a=this.view)&&"function"==typeof a.isAttribute?a.isAttribute():void 0},b.prototype.postRender=function(){return this.renderTitle(),this.renderVisualisation(),this.renderSelectedCount(),this.renderItems(),this.honourOpenness()},b.prototype.renderTitle=function(){return this.noTitle?void 0:this.renderChild("title",new l({model:this.model,state:this.state}))},b.prototype.renderVisualisation=function(){return this.renderChild("viz",new g({model:this.model,state:this.state,range:this.range}))},b.prototype.renderSelectedCount=function(){return this.renderChild("count",new j({model:this.model,range:this.range}))},b.prototype.renderItems=function(){return this.renderChild("facet",new e({model:this.model,state:this.state,range:this.range}))},b.prototype.honourOpenness=function(){var a,b,c;return b=this.state.get("open"),c=this.state.previous("open"),a=this.$("dd.im-facet"),b?(a.slideDown(),this.trigger("opened",this)):(a.slideUp(),this.trigger("closed",this)),null!=c&&b!==c?this.trigger("toggled",this):void 0},b.prototype.events=function(){return{"click .im-summary-heading":"toggle"}},b.prototype.toggle=function(){return this.state.toggle("open")},b.prototype.close=function(){return this.state.set({open:!1})},b.prototype.open=function(){return this.state.set({open:!0})},b}(c)}).call(this)},{"../../core-view":3,"../../event":11,"../../mixins/sets-path-names":34,"../../models/numeric-range":50,"../../models/summary-items":60,"../../options":63,"./items":153,"./selected-count":160,"./summary-heading":161,"./visualisation":166}],152:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("d3-browserify"),j=a("underscore"),e=a("../../options"),d=a("../../messages"),f=a("./visualisation-base"),a("../../messages/summary"),g=a("../../utils/casts").bool,i=function(a,b){return h.scale.linear().domain(a).range(b)},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.className="im-summary-histogram",b.prototype.chartHeight=50,b.prototype.leftMargin=25,b.prototype.rightMargin=25,b.prototype.bottomMargin=.5,b.prototype.stepWidth=0,b.prototype.allCountsAreOne=function(){return 1===this.model.get("maxCount")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add remove change:selected",function(a){return function(){return a.updateChart()}}(this))},b.prototype.invariants=function(){return{hasItems:"No items, or not the right thing: "+this.model.items}},b.prototype.hasItems=function(){var a,b;return null!=(null!=(a=this.model)&&null!=(b=a.items)?b.models:void 0)},b.prototype.initChart=function(){return b.__super__.initChart.apply(this,arguments),this.stepWidth=(this.chartWidth-(this.leftMargin+this.rightMargin+1))/this.model.items.size()},b.prototype.shouldNotDrawChart=function(){return this.allCountsAreOne()},b.prototype.getScales=function(){var a,b,c,d,e,f;return b=[0,this.model.items.size()],a=[0,this.model.get("maxCount")],f=[0,this.chartHeight-this.bottomMargin],d=[this.leftMargin,this.chartWidth-this.rightMargin],c=i(b,d),e=i(a,f),{x:c,y:e}},b.prototype.selectNodes=function(a){return a.selectAll("rect")},b.prototype.getChartData=function(a){return this.model.items.models.slice()},b.prototype.enter=function(a,b){return a.append("rect").classed("im-item-bar",!0).classed("squashed",this.stepWidth<4).attr("width",this.stepWidth).attr("y",this.chartHeight).attr("height",0).attr("x",function(a,c){return b.x(c)}).on("click",function(a){return a.toggle("selected")}).on("mouseover",function(a){return a.mousein()}).on("mouseout",function(a){return a.mouseout()})},b.prototype.update=function(a,b){var c,d,f,g,h;return h=e.get("D3.Transition"),c=h.Duration,d=h.Easing,f=this.chartHeight-this.bottomMargin,g=function(a){return b.y(a.get("count"))},a.classed("selected",function(a){return a.get("selected")}),a.transition().duration(c).ease(d).attr("height",g).attr("y",function(a){return f-g(a)})},b.prototype.drawAxes=function(a,b){var c;return c=this.chartHeight-this.bottomMargin,a.append("line").classed("x-axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",c).attr("y2",c)},b}(f)}).call(this)},{"../../messages":16,"../../messages/summary":27,"../../options":63,"../../utils/casts":74,"./visualisation-base":165,"d3-browserify":280,underscore:312}],153:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),c=a("../../core-view"),j=a("../../templates"),i=a("./summary-stats"),h=a("./summary-items"),f=a("./only-one-item"),e=a("./no-results"),g=["error","initialized"],b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.className="im-facet-items",b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments)},b.prototype.invariants=function(){return{modelHasRequiredAttrs:"Model only has the following attributes: "+k.keys(this.model.attributes)}},b.prototype.modelHasRequiredAttrs=function(){return 2===k.intersection(g,k.keys(this.model.attributes)).length},b.prototype.modelEvents=function(){return{destroy:this.stopListening}},b.prototype.template=j.template("facet_frequency"),b.prototype.RERENDER_EVENT="change:error change:numeric change:uniqueValues change:initialized",b.prototype.postRender=function(){return this.model.get("initialized")?this.renderChild("items",this.getItems()):void 0},b.prototype.getItems=function(){switch(!1){case!this.model.get("numeric"):return new i({model:this.model,range:this.range});case!(this.model.get("uniqueValues")>1):return new h({model:this.model});case 1!==this.model.get("uniqueValues"):return new f({model:this.model,state:this.state});default:return new e({model:this.state})}},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,"./no-results":154,"./only-one-item":156,"./summary-items":163,"./summary-stats":164,underscore:312}],154:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),e=a("../../templates"),a("../../messages/summary"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-no-results",b.prototype.stateEvents=function(){return{"change:pathName":this.reRender}},b.prototype.renderRequires=["pathName"],b.prototype.template=e.template("summary_no_results"),b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67}],155:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("d3-browserify"),c=a("jquery"),m=a("underscore"),g=a("../../options"),d=a("../../messages"),a("../../messages/summary"),h=a("./visualisation-base"),e=25,l=function(a,b){return j.scale.linear().domain(a).range(b)},i=function(a,b){var c,d,e,f;return f=function(){var d,e,f,g;for(f=[0,1],g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(a(b+c));return g}(),e=f[0],d=f[1],{min:e,max:d}},k=function(a,b){return function(c){return a>c?a:c>b?b:c}},b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="im-numeric-distribution",b.prototype.leftMargin=25,b.prototype.bottomMargin=18,b.prototype.rightMargin=14,b.prototype.chartHeight=70,b.prototype.__selecting_paths=!1,b.prototype.selection=null,b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change reset",this.onChangeRange)},b.prototype.invariants=function(){return{hasRange:"No range",hasHistogramModel:"Wrong model: "+this.model}},b.prototype.hasRange=function(){return null!=this.range},b.prototype.hasHistogramModel=function(){var a;return null!=(null!=(a=this.model)?a.getHistogram:void 0)},b.prototype.selectNodes=function(a){return a.selectAll("rect")},b.prototype.getChartData=function(a){var b,c,d,e,f,g;for(null==a&&(a=this.getScales()),f=this.model.getHistogram(),g=[],c=d=0,e=f.length;e>d;c=++d)b=f[c],g.push({count:b,bucket:c+1,range:i(a.bucketToVal,c+1)});return g},b.prototype.initChart=function(){return b.__super__.initChart.apply(this,arguments),this.bucketWidth=(this.model.get("max")-this.model.get("min"))/this.model.get("buckets"),this.stepWidth=(this.chartWidth-(this.leftMargin+1))/this.model.get("buckets")},b.prototype.getScales=function(){var a,b,c,d,e,f,g,h,i,n,o,p,q;return q=this.model.pick("min","max"),e=q.min,d=q.max,g=this.model.get("buckets"),c=this.model.getHistogram(),f=j.max(c),b=[0,f],n=[e,d],a=[1,g+1],o=[this.leftMargin,this.chartWidth-this.rightMargin],p=[0,this.chartHeight-this.bottomMargin],i=function(a){return m.compose(k(e,d),l(a,n))},h={x:l(a,o),y:l(b,p),valToX:l(n,o),xToVal:i(o),bucketToVal:i(a)}},b.prototype.isIntish=function(){var a;return"int"===(a=this.model.get("type"))||"Integer"===a||"long"===a||"Long"===a||"short"===a||"Short"===a},b.prototype.getRounder=function(){return this.isIntish()?Math.round:m.identity},b.prototype.enter=function(a,b){var e,f,g,h,i;return null==b&&(b=this.getScales()),f=this.el,i=this.getRounder(),h=this.chartHeight,e=function(a){return function(b,c){return b.count>0?a.range.set(b.range):a.range.nullify()}}(this),g=function(a){var b,c,e,f;return f=a.range,e=f.min,c=f.max,b=a.count,d.getText("summary.Bucket",{count:b,range:{min:i(e),max:i(c)}})},a.append("rect").attr("x",function(a,c){return b.x(a.bucket)}).attr("width",function(a){return Math.max(0,b.x(a.bucket+1)-b.x(a.bucket))}).attr("y",h-this.bottomMargin).attr("height",0).classed("im-bucket",!0).classed("im-null-bucket",function(a){return null===a.bucket}).on("click",e).each(function(a){return c(this).tooltip({container:f,title:g(a)})})},b.prototype.update=function(a,b){var c,d,e,f,h,i;return null==b&&(b=this.getScales()),f=this.chartHeight,e=this.bottomMargin,i=g.get("D3.Transition"),c=i.Duration,d=i.Easing,h=function(a){return b.y(a.count)},a.transition().duration(c).ease(d).attr("height",h).attr("y",function(a){return f-e-h(a)-.5})},b.prototype.drawAxes=function(a,b){var e,f,h,i;return null==a&&(a=this.getCanvas()),null==b&&(b=this.getScales()),f=this.chartHeight-this.bottomMargin-.5,h=this.el,g.get("Facets.DrawAverageLine")&&a.append("line").classed("average",!0).attr("x1",b.valToX(this.model.get("average"))).attr("x2",b.valToX(this.model.get("average"))).attr("y1",0).attr("y2",f).each(function(){return c(this).tooltip({container:h,title:d.getText("summary.Average")})}),a.append("line").classed("axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",f).attr("y2",f),e=a.append("svg:g"),i=b.x.ticks(this.model.get("buckets")),e.selectAll("line").data(i).enter().append("svg:line").classed("tick-line",!0).attr("x1",b.x).attr("x2",b.x).attr("y1",this.chartHeight-.75*this.bottomMargin).attr("y2",this.chartHeight-this.bottomMargin)},b.prototype.events=function(){return{mouseout:function(a){return function(){return a.__selecting_paths=!1}}(this)}},b.prototype.drawSelection=function(a,b){return null==a||0>=a||b>=this.chartWidth?this.removeSelection():(null==this.selection&&(this.selection=this.getCanvas().append("svg:rect").attr("y",0).attr("height",.9*this.chartHeight).classed("rubberband-selection",!0)),this.selection.attr("x",a).attr("width",b))},b.prototype.onChangeRange=function(){var a,b,c,d,e,f;return this.shouldDrawBox()?(c=this.getScales(),f=this.range.toJSON(),b=f.min,a=f.max,d=c.valToX(b),e=c.valToX(a)-d,this.drawSelection(d,e)):this.removeSelection()},b.prototype.removeSelection=function(){var a;return null!=(a=this.selection)&&a.remove(),this.selection=null},b.prototype.shouldDrawBox=function(){return this.range.isNotAll()},b.prototype.remove=function(){var a;return this.removeSelection(),null!=(a=this.paper)&&a.remove(),b.__super__.remove.apply(this,arguments)},b}(h)}).call(this)},{"../../messages":16,"../../messages/summary":27,"../../options":63,"./visualisation-base":165,"d3-browserify":280,jquery:309,underscore:312}],156:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),e=a("../../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-only-one",b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.template=e.template("only_one_item"),b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],157:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s={}.hasOwnProperty,t=function(a,b){function c(){this.constructor=a}for(var d in b)s.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};r=a("underscore"),c=a("jquery"),j=a("d3-browserify"),f=a("../../options"),i=a("./visualisation-base"),e=function(a){return a.data.get("id")},d=j.layout.pie().value(function(a){return a.get("count")}),h={startAngle:0,endAngle:0},m=function(){var a,b;return a=f.get("PieColors"),b=r.isFunction(a)?a:j.scale[a](),function(a){return b(a.data.get("id"))}},o=function(a){var b;return null!=(b=a.get("currentPieCoords"))?b:h},q=function(a){return a.data.get("visible")?1:.25},n=function(a,b,c){return{startAngle:a,endAngle:b,selected:c.get("selected")?1:0}},l=function(a){return function(b){var c,d,e,f,g,h,i;return i=b.startAngle,e=b.endAngle,c=b.data,g=c,h=o(g),d=n(i,e,g),f=j.interpolateObject(h,d),g.set({currentPieCoords:f(1)}),function(b){return a(f(b))}}},p=function(a){return(a.endAngle+a.startAngle)/2>Math.PI},k=function(a,b,c){return j.svg.arc().startAngle(function(a){return a.startAngle}).endAngle(function(a){return a.endAngle}).innerRadius(function(a){return b+a.selected*c}).outerRadius(function(b){return a+b.selected*c})},b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.chartWidth=120,b.prototype.chartHeight=120,b.prototype.className="im-pie-chart",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected change:visible",this.update),this.listenTo(f,"change:PieColors",this.onChangePalette),this.onChangePalette()},b.prototype.onChangePalette=function(){return this.colour=m(),this.update()},b.prototype._drawD3Chart=function(){var a,b,c,d,e,f,g,h,i;return c=this.chartHeight,h=this.$el.closest(":visible").width(),f=.4*c,d=.1*c,g=.08*c,b=j.select(this.el).append("svg").attr("class","chart").attr("height",c).attr("width",h),this.arc=k(f,d,g),this.arc_group=b.append("svg:g").attr("class","arc").attr("transform","translate("+h/2+","+c/2+")"),a=b.append("svg:g").attr("class","center_group").attr("transform","translate("+h/2+","+c/2+")"),e=b.append("svg:g").attr("class","label_group").attr("transform","translate("+h/2+","+c/2+")"),i=a.append("svg:circle").attr("fill","white").attr("r",d),this.update()},b.prototype.enter=function(a){var b,d,e,f;return d=this.el,f=this.model.items.reduce(function(a,b){return a+b.get("count")},0),e=function(a){return(a.data.get("count")/f*100).toFixed(1)},b=function(a){var b,f,g;return b=c(this),g=""+a.data.get("item")+": "+e(a)+"%",f=p(a)?"left":"right",b.tooltip({title:g,placement:f,container:d})},a.append("svg:path").attr("class","donut-arc").on("click",function(a){return a.data.toggle("selected")}).on("mouseover",function(a){return a.data.mousein()}).on("mouseout",function(a){return a.data.mouseout()}).each(b)},b.prototype.exit=function(a){return a.remove()},b.prototype.getChartData=function(){return this.model.items.models.slice()},b.prototype.update=function(){var a,b,c,g;if(null!=this.arc_group)return c=this.arc_group.selectAll("path").data(d(this.getChartData()),e),this.exit(c.exit()),this.enter(c.enter()),g=f.get("D3.Transition"),a=g.DurationShort,b=g.Easing,c.attr("fill",this.colour),c.transition().duration(a).ease(b).style("opacity",q).attrTween("d",l(this.arc))},b}(i)}).call(this)},{"../../options":63,"./visualisation-base":165,"d3-browserify":280,jquery:309,underscore:312}],158:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-facet-surrogate",b.prototype.initialize=function(a){return this.above=a.above,b.__super__.initialize.apply(this,arguments)},b.prototype.template=e.template("row_surrogate"),b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),{
above:this.above})},b.prototype.postRender=function(){return this.$el.addClass(this.above?"above":"below")},b.prototype.remove=function(){return this.$el.fadeOut("fast",function(a){return function(){return b.__super__.remove.call(a)}}(this))},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:312}],159:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),d=a("../../core-view"),g=a("../../templates"),c=a("../../core/checkbox"),f=a("./row-surrogate"),a("../../messages/summary"),h=function(a){return!!a},b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.RERENDER_EVENT="change:count change:item change:symbol change:share",b.prototype.tagName="tr",b.prototype.className="im-facet-row",b.prototype.modelEvents=function(){return{"change:visible":this.onChangeVisibility,"change:hover":this.onChangeHover,"change:selected":this.onChangeSelected}},b.prototype.invariants=function(){return{modelHasCollection:"No collection on model"}},b.prototype.modelHasCollection=function(){var a;return null!=(null!=(a=this.model)?a.collection:void 0)},b.prototype.template=g.template("facet_row"),b.prototype.getData=function(){var a,c,d,e;return a=this.model.collection.getMaxCount(),e=this.model.get("count")/a,c=(e/2+.5).toFixed(),d=(100*e).toFixed(),i.extend(b.__super__.getData.apply(this,arguments),{percent:d,opacity:c,max:a})},b.prototype.onRenderError=function(a){return console.error(a)},b.prototype.postRender=function(){return this.addCheckbox(),this.onChangeVisibility(),this.onChangeHover(),this.onChangeSelected()},b.prototype.addCheckbox=function(){return this.renderChildAt(".checkbox",new c({model:this.model,attr:"selected"}))},b.prototype.onChangeVisibility=function(){return this.$el.toggleClass("im-hidden",!this.model.get("visible"))},b.prototype.onChangeHover=function(){var a;return a=h(this.model.get("hover")),this.$el.toggleClass("hover",a),a?this.showSurrogateUnlessVisible():this.removeSurrogate()},b.prototype.onChangeSelected=function(){return this.$el.toggleClass("im-selected",this.model.get("selected"))},b.prototype.removeSurrogate=function(){return this.removeChild("surrogate")},b.prototype.showSurrogateUnlessVisible=function(){var a,b,c,d,e;return this.removeSurrogate(),this.isVisible()?void 0:(b=this.isAbove(),d=new f({model:this.model,above:b}),a=d.$el,e=this.getTable(),this.renderChild("surrogate",d,e),c=b?a.css({top:e.scrollTop()}):a.css({bottom:0-e.scrollTop()}))},b.prototype.getTable=function(){return this.$el.closest(".im-item-table")},b.prototype.events=function(){return{click:"handleClick"}},b.prototype.handleClick=function(a){return a.stopPropagation(),this.model.toggle("selected")},b.prototype.isBelow=function(){var a;return a=this.getTable(),this.$el.offset().top+this.$el.outerHeight()>a.offset().top+a.outerHeight()},b.prototype.isAbove=function(){var a;return a=this.getTable(),this.$el.offset().top<a.offset().top},b.prototype.isVisible=function(){return!(this.isAbove()||this.isBelow())},b}(d)}).call(this)},{"../../core-view":3,"../../core/checkbox":4,"../../messages/summary":27,"../../templates":67,"./row-surrogate":158,underscore:312}],160:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),c=a("../../core-view"),e=a("../../templates"),a("../../messages/summary"),j=function(a,b){return null==a&&(a=m.identity),m.reduce(b,function(b,c){return b+a(c)},0)},k=m.partial(j,function(a){return a.count}),l=function(a,b,c){return j(m.partial(h,a,b),c)},f=function(a,b,c){var d,e;return a?(e=a.max-a.min,d=a.min<b?Math.min(a.max,c)-b:c-Math.max(a.min,b),d/e):0},g=function(a,b){return function(c){return c.min>=a&&c.max<=b}},i=function(a,b){return function(c){return c.min<a&&c.max>a||c.max>b&&c.min<b}},h=function(a,b,c){return c.count*f(c,a,b)},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="im-summary-selected-count",b.prototype.template=e.template("summary-selected-count"),b.prototype.stateEvents=function(){return{"change:selectedCount change:isApprox":this.reRender}},b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.estimateSelectionSize),this.listenTo(this.range,"change",this.estimateSelectionSize)},b.prototype.estimateSelectionSize=function(){return this.model.get("initialized")?this.model.get("numeric")?this.estimateSelectedInRange():this.sumSelectedItems():void 0},b.prototype.preRender=function(){return this.rendered?this.state.get("selectedCount")?void 0:this.$el.slideUp():this.$el.hide()},b.prototype.postRender=function(){return this.state.get("selectedCount")?this.$el.slideDown():void 0},b.prototype.sumSelectedItems=function(){var a,b;return b=this.model.items.where({selected:!0}),a=j(function(a){return a.get("count")},b),this.state.set({isApprox:!1,selectedCount:a})},b.prototype.estimateSelectedInRange=function(){var a,b,c,d,e,f,h;return this.range.isAll()?this.state.unset("selectedCount"):(h=this.range.toJSON(),e=h.min,d=h.max,c=this.getHistogram(),b=c.filter(g(e,d)),f=c.filter(i(e,d)),a=Math.round(k(b)+l(e,d,f)),this.state.set({isApprox:!0,selectedCount:a}))},b.prototype.getHistogram=function(){var a,b,c,d,e,f,g,h,i;for(a=this.model.getHistogram(),d=this.model.get("max"),e=this.model.get("min"),f=(d-e)/a.length,i=[],c=g=0,h=a.length;h>g;c=++g)b=a[c],i.push({count:b,min:e+c*f,max:e+f+c*f});return i},b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67,underscore:312}],161:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../templates"),a("../../messages/summary"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-summary-heading",b.prototype.modelEvents=function(){return{change:this.reRender,destroy:this.stopListening}},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.renderRequires=["numeric","available","got","uniqueValues"],b.prototype.template=e.template("summary_heading"),b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),{filtered:null!=this.model.get("filteredCount")})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/summary":27,"../../templates":67,underscore:312}],162:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),d=a("../../core-view"),j=a("../../templates"),g=a("../../messages"),a("../../messages/summary"),k=function(a){return!!a},l=function(a){var b;return b={},b.multi="ONE OF"===a.multi?"NONE OF":"ONE OF",b.single="=="===a.single?"!=":"==",b.absent="IS NULL"===a.absent?"IS NOT NULL":"IS NULL",b},e=function(a){return null!=a?(a.preventDefault(),a.stopPropagation()):void 0},c={single:"==",multi:"ONE OF",absent:"IS NULL"},h={tab:"tsv",csv:"csv",xml:"xml",json:"json"},f=10,b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.RERENDER_EVT="change",b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.reRender)},b.prototype.invariants=function(){return{viewIsAttribute:"No view, or view not Attribute: "+this.view,hasCollection:"No collection"}},b.prototype.viewIsAttribute=function(){var a,b;return null!=(a=this.model)&&null!=(b=a.view)&&"function"==typeof b.isAttribute?b.isAttribute():void 0},b.prototype.hasCollection=function(){var a;return null!=(null!=(a=this.model)?a.items:void 0)},b.prototype.template=j.template("summary_items_controls"),b.prototype.getData=function(){var a;return a=k(this.model.items.findWhere({selected:!0})),m.extend(b.__super__.getData.apply(this,arguments),{anyItemSelected:a})},b.prototype.postRender=function(){return this.activateTooltips(),this.activatePopovers()},b.prototype.activateTooltips=function(){return this.$btns=this.$(".btn[title]").tooltip({placement:"top",container:this.el})},b.prototype.activatePopovers=function(){return this.$(".im-download").popover({placement:"top",html:!0,container:this.el,title:g.getText("summary.DownloadFormat"),content:this.getDownloadPopover(),trigger:"manual"})},b.prototype.downloadPopoverTemplate=j.template("download_popover"),b.prototype.getDownloadPopover=function(){return this.downloadPopoverTemplate(m.extend(this.getBaseData(),{query:this.model.query,path:this.model.view.toString(),formats:h}))},b.prototype.events=function(){return{"click .im-export-summary":"exportSummary",click:"hideTooltips","click .btn-cancel":"unsetSelection","click .btn-toggle-selection":"toggleSelection","click .im-filter-group .dropdown-toggle":"toggleDropdown","click .im-download":"toggleDownloadPopover","click .im-filter-in":m.bind(this.addConstraint,this,c),"click .im-filter-out":m.bind(this.addConstraint,this,l(c))}},b.prototype.exportSummary=function(a){return a.stopImmediatePropagation(),!0},b.prototype.hideTooltips=function(){var a;return null!=(a=this.$btns)?a.tooltip("hide"):void 0},b.prototype.unsetSelection=function(a){return this.changeSelection(function(a){return a.set({selected:!1})})},b.prototype.toggleSelection=function(a){return this.changeSelection(function(a){return a.get("visible")?a.toggle("selected"):void 0})},b.prototype.toggleDropdown=function(){return this.$(".im-filter-group").toggleClass("open")},b.prototype.toggleDownloadPopover=function(){return this.$(".im-download").popover("toggle")},b.prototype.addConstraint=function(a,b){var c,d,g,h,i;return e(b),h=function(){var a,b,c,e;for(c=this.model.items.where({selected:!0}),e=[],a=0,b=c.length;b>a;a++)d=c[a],e.push(d.get("item"));return e}.call(this),g=this.model.items.where({selected:!1}),0===g.length?this.model.set({error:new Error("All items are selected")}):(c=m.any(h,function(a){return null==a}),!c&&this.model.hasAll()&&f>(i=h.length)&&i>g.length?this.constrainTo(l(a),function(){var a,b,c;for(c=[],a=0,b=g.length;b>a;a++)d=g[a],c.push(d.get("item"));return c}()):this.constrainTo(a,h))},b.prototype.constrainTo=function(a,b){var c,d,e,f,g;return(null!=b?b.length:void 0)?(f=this.model.query,e=this.model.view.toString(),g=b[0],d=function(){switch(!1){case!(b.length>1):return{op:a.multi,values:b};case null==g:return{op:a.single,value:String(g)};default:return{op:a.absent}}}(),!/or/.test(f.constraintLogic)&&"ONE OF"===d.op&&(c=m.findWhere(f.constraints,{path:e,op:"ONE OF"}))?(c.values=d.values,f.trigger("change:constraints",f.constraints)):f.addConstraint(m.extend(d,{path:e}))):this.model.set({error:new Error("No values are selected")})},b.prototype.changeSelection=function(a){return this.model.items.each(function(b){return m.defer(a,b)})},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/summary":27,"../../templates":67,underscore:312}],163:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n=function(a,b){return function(){return a.apply(b,arguments)}},o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),c=a("backbone"),d=a("../../core-view"),k=a("../../templates"),g=a("../../messages"),h=a("../../mixins/sets-path-names"),j=a("./summary-items-controls"),e=a("./row"),a("../../messages/summary"),f=function(a){return null!=a?(a.preventDefault(),a.stopPropagation()):void 0},l=function(a){return"row_"+a.get("id")},b.exports=i=function(a){function b(){return this.filterItems=n(this.filterItems,this),b.__super__.constructor.apply(this,arguments)}return p(b,a),b.include(h),b.prototype.tagName="div",b.prototype.className="im-summary-items",b.prototype.stateEvents=function(){return{"change:error":this.setErrOnModel}},b.prototype.setErrOnModel=function(){return this.model.set(this.state.pick("error"))},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add",this.addItem),this.listenTo(this.model.items,"remove",this.removeItem),this.listenTo(this.state,"change:typeName change:endName",this.reRender),this.setPathNames()},b.prototype.invariants=function(){return{modelHasItems:"expected a SummaryItems model, got: "+this.model,modelCanHasMore:"expected the correct model methods, got: "+this.model}},b.prototype.modelHasItems=function(){var a;return(null!=(a=this.model)?a.items:void 0)instanceof c.Collection},b.prototype.modelCanHasMore=function(){var a;return m.isFunction(null!=(a=this.model)?a.hasMore:void 0)},b.prototype.template=k.template("summary_items"),b.prototype.getData=function(){return m.extend(b.__super__.getData.apply(this,arguments),{hasMore:this.model.hasMore(),colClasses:m.result(this,"colClasses"),colHeaders:m.result(this,"colHeaders")})},b.prototype.colClasses=["im-item-selector","im-item-value","im-item-count"],b.prototype.colHeaders=function(){var a;return a=this.state.has("typeName")?""+this.state.get("typeName")+" "+this.state.get("endName"):g.getText("summary.Item"),[" ",a,g.getText("summary.Count")]},b.prototype.postRender=function(){if(this.tbody=this.$(".im-item-table tbody"),!this.tbody.length)throw new Error("Could not find table");return this.addControls(),this.addItems()},b.prototype.addControls=function(){return this.renderChildAt(".im-summary-controls",new j({model:this.model}))},b.prototype.addItems=function(a){var b;return null==a&&(a=0),this.rendered&&a<this.model.items.length?(b=a+100,m.defer(function(c){return function(){var d;return d=document.createDocumentFragment(),c.model.items.slice(a,b).forEach(function(a){return c.addItem(a,d)}),c.tbody.append(d),c.addItems(b)}}(this))):void 0},b.prototype.addItem=function(a,b){return this.rendered?this.renderChild(l(a),new e({model:a}),null!=b?b:this.tbody):void 0},b.prototype.removeItem=function(a){return this.removeChild(l(a))},b.prototype.events=function(){return{"click .im-load-more":"loadMoreItems","click .im-clear-value-filter":"clearValueFilter","keyup .im-filter-values":m.throttle(this.filterItems,250,{leading:!1}),submit:f,click:f}},b.prototype.loadMoreItems=function(){return this.model.get("loading")?void 0:this.model.increaseLimit(2)},b.prototype.clearValueFilter=function(){var a;return a=this.$(".im-filter-values"),a.val(null),this.model.setFilterTerm(null)},b.prototype.filterItems=function(a){var b,c;return b=this.$(".im-filter-values"),c=b.val(),this.model.setFilterTerm(b.val())},b}(d)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/summary":27,"../../mixins/sets-path-names":34,"../../templates":67,"./row":159,"./summary-items-controls":162,backbone:232,underscore:312}],164:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),c=a("../../core-view"),g=a("../../templates"),d=40,h=38,e={min:0,max:0,average:0,stdev:0},b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.className="im-summary-stats",b.prototype.template=g.template("summary_stats"),b.prototype.getData=function(){return i.extend({},e,b.__super__.getData.apply(this,arguments))},b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change",this.setSliderValues),this.listenTo(this.range,"change",this.setButtonDisabledness),this.listenTo(this.range,"change:min",this.onChangeMin),this.listenTo(this.range,"change:max",this.onChangeMax),this.listenForChange(this.model,this.initType,"integral","min","max"),this.initType()},b.prototype.invariants=function(){return{hasRange:"No range"}},b.prototype.hasRange=function(){return null!=this.range},b.prototype.setSliderValues=function(){var a,b,c,d;return c=this.range.toJSON(),b=c.min,a=c.max,null!=(d=this.$slider)?d.slider("option","values",[b,a]):void 0},b.prototype.onChangeMin=function(){var a;return a=this.range.get("min"),this.$("input.im-range-min").val(a),null!=this.$slider&&this.$slider.slider("values",0)!==a?this.$slider.slider("values",0,a):void 0},b.prototype.onChangeMax=function(){var a;return a=this.range.get("max"),this.$("input.im-range-max").val(a),null!=this.$slider&&this.$slider.slider("values",1)!==a?this.$slider.slider("values",1,a):void 0},b.prototype.setButtonDisabledness=function(){var a;return a=this.range.isNotAll(),this.$(".btn").toggleClass("disabled",!a)},b.prototype.events=function(){return{click:function(a){return a.stopPropagation()},"keyup input.im-range-min":"maybeIncrementMin","keyup input.im-range-max":"maybeIncrementMax","change input.im-range-min":"setRangeMin","change input.im-range-max":"setRangeMax","click .btn-primary":"changeConstraints","click .btn-cancel":"clearRange"}},b.prototype.clearRange=function(){return this.range.set(this.model.pick("min","max"))},b.prototype.maybeIncrementMin=function(a){return this.maybeIncrement("min",a)},b.prototype.maybeIncrementMax=function(a){return this.maybeIncrement("max",a)},b.prototype.maybeIncrement=function(a,b){var c;switch(c=this.range.get(a),b.keyCode){case d:c-=this.step;break;case h:c+=this.step}return this.range.set(a,c)},b.prototype.setRangeMin=function(){return this.range.set({min:this.parse(this.$(".im-range-min").val())})},b.prototype.setRangeMax=function(){return this.range.set({max:this.parse(this.$(".im-range-max").val())})},b.prototype.changeConstraints=function(a){var b,c,d,e,f,g,h;for(a.preventDefault(),a.stopPropagation(),e=this.model.view.toString(),f=this.model.query,c=i.where(f.constraints,{path:e}),d=this.range.nulled?[{path:e,op:"IS NULL"}]:[{path:e,op:">=",value:this.range.get("min")},{path:e,op:"<=",value:this.range.get("max")}],g=0,h=c.length;h>g;g++)b=c[g],f.removeConstraint(b,{silent:!0});return f.addConstraints(d)},b.prototype.postRender=function(){return this.drawSlider()},b.prototype.parse=function(a){var b;try{return 1===this.step?parseInt(a,10):parseFloat(a)}catch(c){return b=c,this.model.set({error:new Error("Could not parse '"+a+"' as a number")}),null}},b.prototype.initType=function(){var a,b,c,d;return d=this.model.toJSON(),a=d.integral,c=d.min,b=d.max,this.step=a?1:Math.abs((b-c)/100),this.round=a?Math.round:i.identity},b.prototype.drawSlider=function(){var a,b,c;return c=this.model.pick("min","max"),a=c.max,b=c.min,this.activateSlider({range:!0,min:b,max:a,values:[b,a],step:this.step,slide:function(a){return function(b,c){var d;return null!=(d=a.range)?d.set({min:c.values[0],max:c.values[1]}):void 0}}(this)})},b.prototype.reRender=function(){return this.destroySlider(),b.__super__.reRender.apply(this,arguments)},b.prototype.activateSlider=function(a){return this.destroySlider(),this.$slider=this.$(".slider"),this.$slider.slider(a)},b.prototype.destroySlider=function(){return null!=this.$slider?(this.$slider.slider("destroy"),this.$slider=null):void 0},b.prototype.remove=function(){return this.destroySlider(),b.__super__.remove.apply(this,arguments)},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67,underscore:312}],165:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("d3-browserify"),f=a("underscore"),c=a("../../core-view"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.chartHeight=0,b.prototype.chartWidth=0,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"change:loading",this.reRender)},b.prototype.postRender=function(){return this.model.get("loading")?void 0:this.addChart()},b.prototype.addChart=function(){return f.defer(function(a){return function(){var b;try{return a._drawD3Chart()}catch(c){return b=c,a.model.set({error:b})}}}(this))},b.prototype.getScales=function(){throw new Error("Not implemented")},b.prototype.selectNodes=function(a){throw new Error("not implemented")},b.prototype.getChartData=function(a){throw new Error("not implemented")},b.prototype.exit=function(a){return a.remove()},b.prototype.enter=function(a,b){throw new Error("not implemented")},b.prototype.update=function(a,b){throw new Error("not implemented")},b.prototype.drawAxes=function(a,b){},b.prototype.shouldNotDrawChart=function(){return!1},b.prototype._drawD3Chart=function(){var a,b;if(!this.shouldNotDrawChart())return this.initChart(),b=this.getScales(),a=this.getCanvas(),this.updateChart(a,b),this.drawAxes(a,b)},b.prototype.updateChart=function(a,b){var c;if(!this.shouldNotDrawChart())return null==a&&(a=this.getCanvas()),null==b&&(b=this.getScales()),c=this.selectNodes(a).data(this.getChartData(b)),this.exit(c.exit()),this.enter(c.enter(),b),this.update(c,b)},b.prototype.initChart=function(){return this.chartWidth=this.$el.closest(":visible").width()},b.prototype.getCanvas=function(){return null!=this.paper?this.paper:this.paper=e.select(this.el).append("svg").attr("class","im-summary-chart").attr("width",this.chartWidth).attr("height",this.chartHeight)},b}(c)}).call(this)},{"../../core-view":3,"d3-browserify":280,underscore:312}],166:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("../../options"),c=a("../../core-view"),f=a("./numeric"),h=a("./pie"),e=a("./histogram"),i=a("./summary-items"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.className="im-facet-vis",b.prototype.initialize=function(a){return this.range=a.range,b.__super__.initialize.apply(this,arguments)},b.prototype.RERENDER_EVENT="change:loading change:numeric change:canHaveMultipleValues",b.prototype.postRender=function(){return this.model.get("initialized")?this.renderChild("vis",this.getVisualization()):void 0},b.prototype.getVisualization=function(a){var b,c,d,i,j,k;switch(k=this.model.toJSON(),j=k.uniqueValues,d=k.numeric,b=k.canHaveMultipleValues,i=k.type,c=k.got,!1){case!d:return new f({model:this.model,range:this.range});case 1!==j:return null;case!b:return new e({model:this.model});case!(j>0&&j<=g.get("MAX_PIE_SLICES")):return new h({model:this.model});case!c:return new e({model:this.model});default:return null}},b}(c)}).call(this)},{"../../core-view":3,"../../options":63,"./histogram":152,"./numeric":155,"./pie":157,"./summary-items":163}],167:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("../core-view"),i=a("./modal"),h=a("../messages"),j=a("../templates"),d=a("./constraints"),a("../messages/constraints"),a("../messages/logic"),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.className="form im-evenly-spaced im-constraint-logic",b.prototype.tagName="form",b.prototype.template=j.template("logic-manager-body"),b.prototype.parameters=["query"],b.prototype.initialize=function(){var a,c;return b.__super__.initialize.apply(this,arguments),c=function(){var b,c,d,e;for(d=this.query.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.code&&e.push(a.code);return e}.call(this),this.model.set({logic:this.query.constraintLogic}),this.state.set({disabled:!0,defaultLogic:c.join(" and ")})},b.prototype.events=function(){return{"change .im-logic":this.setLogic,submit:this.applyChanges}},b.prototype.modelEvents=function(){return{"change:logic":this.setDisabled}},b.prototype.stateEvents=function(){return{"change:disabled":this.reRender}},b.prototype.setDisabled=function(){var a,b;return b=this.model.get("logic"),a=this.query.constraintLogic,this.state.set({disabled:b===a})},b.prototype.setLogic=function(a){return this.model.set({logic:a.target.value})},b.prototype.applyChanges=function(a){var b;return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.state.get("disabled")?void 0:(b=this.model.get("logic"),this.query.constraintLogic=b,this.query.trigger("change:logic",b))},b}(e),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}var c;return m(b,a),b.prototype.template=j.template("active-constraints"),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.assignCodes()},b.prototype.stateEvents=function(){return{"change:adding":this.reRender}},c="ABCDEFGHIJKLMNOPQRSTUVWXYZ",b.prototype.assignCodes=function(){var a,b,d,e,f,g,h;if(e=function(){var b,c,d,e;for(d=this.query.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],null!=a.op&&e.push(a);return e}.call(this),!(e.length<2)){for(d=c.split(""),h=[],f=0,g=e.length;g>f;f++)a=e[f],null==a.code&&h.push(function(){var c;for(c=[];null==a.code&&(b=d.shift());)k.any(e,function(a){return a.code===b})?c.push(void 0):c.push(a.code=b);return c}());return h}},b.prototype.postRender=function(){var a,c;return b.__super__.postRender.apply(this,arguments),a=this.getConstraints(),a.length>1&&this.renderChild("logic",new g({query:this.query})),c=this.state.get("adding")?"slideUp":"slideDown",this.$(".im-current-constraints")[c](400)},b.prototype.getConAdder=function(){return this.state.get("adding")?b.__super__.getConAdder.apply(this,arguments):void 0},b}(d),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query"],b.prototype.modalSize=function(){return"lg"},b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-filter-manager"},b.prototype.title=function(){return h.getText("constraints.Heading",{n:this.query.constraints.length})},b.prototype.initState=function(){return this.state.set({adding:!1,disabled:!1})},b.prototype.act=function(){return this.state.set({adding:!0,disabled:!0})},b.prototype.dismissAction=function(){return h.getText("Cancel")},b.prototype.primaryAction=function(){return h.getText("constraints.DefineNew")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this,"shown",this.renderBodyContent),this.listenTo(this.query,"change:constraints",this.onChangeConstraints)},b.prototype.onChangeConstraints=function(){return this.initState(),this.renderTitle()},b.prototype.renderBodyContent=function(){var a;return this.shown?(a=this.$(".modal-body"),k.defer(function(b){return function(){return b.renderChild("cons",new c({state:b.state,query:b.query}),a)}}(this))):void 0},b}(i)}).call(this)},{"../core-view":3,"../messages":16,"../messages/constraints":21,"../messages/logic":25,"../templates":67,"./constraints":131,"./modal":197,underscore:312}],168:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../query-dialogue-button"),c=a("../filter-dialogue"),a("../../messages/constraints"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-filter-dialogue-button",b.prototype.longLabel="constraints.ManageFilters",b.prototype.shortLabel="constraints.ManageFiltersShort",b.prototype.icon="Filter",b.prototype.Dialogue=c,b}(e)}).call(this)},{"../../messages/constraints":21,"../filter-dialogue":167,"../query-dialogue-button":206}],169:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../core-view"),f=a("../templates"),e=a("./formatted/sorting-path"),g=a("../utils/sort-query-by-path"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.className="im-col-sort-menu no-margins",b.prototype.tagName="ul",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.setPathNames()},b.prototype.modelEvents=function(){return{"change:displayName":this.initState,"change:replaces":this.setPathNames}},b.prototype.initState=function(){return this.state.set({group:this.model.get("displayName")})},b.prototype.setPathNames=function(){var a,b,c,d,e;for(d=this.getPaths(),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(function(a){return function(b){var c;return c=b.toString(),a.state.has(c)||a.state.set(c,""),b.getDisplayName().then(function(b){return a.state.set(c,b)})}}(this)(a));return e},b.prototype.getPaths=function(){var a;return a=this.model.get("replaces"),a.length?a.slice():[this.query.makePath(this.model.get("path"))]},b.prototype.preRender=function(a){var b,c;return b=(c=this.getPaths())[0],1===c.length?(a.cancel(),g(this.query,b)):void 0},b.prototype.postRender=function(){var a,b,c,d,f,g;for(f=this.getPaths(),g=[],a=c=0,d=f.length;d>c;a=++c)b=f[a],g.push(this.renderChild(a,new e({model:this.model,state:this.state,query:this.query,path:b})));return g},b}(c)}).call(this)},{"../core-view":3,"../templates":67,"../utils/sort-query-by-path":105,"./formatted/sorting-path":170}],170:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),g=a("../../templates"),e=a("../../icons"),h=a("../../utils/sort-query-by-path"),d=/^\s*>\s*/,b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.tagName="li",b.prototype.className="im-formatted-path im-subpath",b.prototype.parameters=["query","path"],b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.getData=function(){var a,b,c,f;return c=this.state.toJSON(),b=null!=(f=c[this.path])?f.replace(c.group,"").replace(d,""):void 0,a=this.query.getSortDirection(this.path),{Icons:e,name:b,direction:a}},b.prototype.template=g.template("formatted_sorting"),b.prototype.events=function(){return{click:"sortByPath"}},b.prototype.sortByPath=function(){return h(this.query,this.path)},b}(c)}).call(this)},{"../../core-view":3,"../../icons":14,"../../templates":67,"../../utils/sort-query-by-path":105}],171:[function(a,b,c){(function(){c.openDialogue=function(a){return this.renderChild("__dialogue__",a),a.show()},c.getDialogue=function(){var a;return null!=(a=this.children)?a.__dialogue__:void 0}}).call(this)},{}],172:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C={}.hasOwnProperty,D=function(a,b){function c(){this.constructor=a}for(var d in b)C.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},E=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1;
},F=function(a,b){return function(){return a.apply(b,arguments)}};B=a("underscore"),p=a("es6-promise").Promise,u=a("../templates"),f=a("../core-view"),e=a("../core-model"),l=a("../options"),d=a("../core/collection"),m=a("../models/path"),A=a("../core/type-assertions"),z=a("../utils/get-leaves"),k=a("./item-preview/details"),r=a("./item-preview/reference-counts"),g=a("./item-preview/counts-title"),x=function(a,b){return"Could not determine origin of "+a+" from ["+b.join(", ")+"]"},h=function(a){function b(a){b.__super__.constructor.call(this,a.path),this.set(B.omit(a,"path"))}return D(b,a),b}(m),c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.defaults=function(){return B.extend(b.__super__.defaults.apply(this,arguments),{fieldType:"ATTR",valueOverspill:null,tooLong:!1,value:null})},b}(h),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.defaults=function(){return B.extend(b.__super__.defaults.apply(this,arguments),{fieldType:"REF",values:[]})},b}(h),t=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.comparator="displayName",b.prototype.initialize=function(){return this.listenTo(this,"change:displayName",this.sort)},b}(d),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.defaults=function(){return{types:[],id:null,error:null,phase:"FETCHING"}},b}(e),i=u.template("cell-preview-error"),j=["class","objectId"],y=function(a,b){return a.concat(b)},v=function(){return function(a,b){return null!=b&&!b.objectId&&E.call(j,a)<0}},w=function(){return function(a,b){return null!=b?b.objectId:void 0}},s=new A.Structure("ServiceType",{root:A.String,count:A.Function,findById:A.Function,fetchModel:A.Function}),b.exports=n=function(a){function b(){return this.handleItem=F(this.handleItem,this),b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.Model=o,b.prototype.className="im-cell-preview-inner",b.prototype.parameters=["service"],b.prototype.parameterTypes={service:s},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.fieldDetails=new t,this.referenceFields=new t},b.prototype.modelEvents=function(){return{"change:phase":this.reRender,"change:error":this.reRender}},b.prototype.remove=function(){return this.removeAllChildren(),this.fieldDetails.close(),this.referenceFields.close(),delete this.fieldDetails,delete this.referenceFields,b.__super__.remove.apply(this,arguments)},b.prototype.fetching=null,b.prototype.template=function(a){var b,c;switch(c=a.phase,b=a.error,c){case"FETCHING":return this.helpers().IndeterminateProgressBar;case"ERROR":return i(b);default:return null}},b.prototype.preRender=function(){var a;return a=this.model,null==this.fetching&&(this.fetching=this.fetchData()),this.fetching.then(function(){return a.set({phase:"SUCCESS"})},function(b){return console.error(b),a.set({phase:"ERROR",error:b})})},b.prototype.postRender=function(){var a,b,c,d,e;if("SUCCESS"===this.model.get("phase")){for(d=this.model.get("types"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.$el.addClass(a));return e}},b.prototype.renderChildren=function(){var a,b,c;return b=new k({collection:this.fieldDetails}),this.renderChild("details",b),a=new g({collection:this.referenceFields}),this.renderChild("counttitle",a),c=new r({collection:this.referenceFields}),this.renderChild("counts",c),this.$el.append(u.clear)},b.prototype.fetchData=function(){return this.service.fetchModel().then(function(a){return function(b){var c,d;return a.schema=b,d=a.getAllDetails(),l.get("ItemDetails.ShowReferenceCounts")?(c=a.getRelationCounts(),p.all(d.concat(c))):p.all(d)}}(this))},b.prototype.getAllDetails=function(){var a,b,c,d,e;for(d=this.model.get("types"),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.getDetails(a));return e},b.prototype.getDetails=function(a){var b,c;return c=this.model.get("id"),b=l.get(["ItemDetails","Fields",this.schema.name,a]),this.service.findById(a,c,b).then(this.handleItem)},b.prototype.handleItem=function(a){var b,c,d,e,f,g,h;c=this.fieldDetails,f=v(c),g=w(c),b=function(){var a,b,c,d;for(c=this.model.get("types"),d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(this.schema.classes[e]);return d}.call(this);for(d in a)h=a[d],f(d,h)&&this.handleAttribute(a,b,d,h);for(d in a)h=a[d],g(d,h)&&this.handleSubObj(a,b,d,h);return null},b.prototype.getPathForField=function(a,b){var c,d;if(c=B.find(a,function(a){return null!=a.fields[b]}),null==c)throw new Error(x(b,B.pick(a,"name")));return d=this.schema.makePath(""+c.name+"."+b)},b.prototype.handleSubObj=function(a,b,c,d){var e,f,g;return f=this.getPathForField(b,c),g=z(d,j),e={path:f,field:c,values:g},this.fieldDetails.add(new q(e))},b.prototype.handleAttribute=function(a,b,d,e){var f,g,h,i,j,k;return h=this.getPathForField(b,d),g={path:h,field:d,value:e},(null!=e&&"String"===h.getType()||/Clob/.test(h.getType()))&&(f=l.get("CellCutoff"),k=String(e),j=e.length>f,j&&(i=k.indexOf(" ",.9*f),-1===i&&(i=f),g.tooLong=!0,g.valueOverspill=k.substring(i),g.value=k.substring(0,i))),this.fieldDetails.add(new c(g))},b.prototype.getRelationCounts=function(){var a,b,c,d,e,f,g,h;return A=this.model.get("types"),e=this.service.root,d=null!=(h=l.get(["ItemDetails","Count",e]))?h:{},c=function(){var c,e,h;for(h=[],c=0,e=A.length;e>c;c++)g=A[c],b=this.schema.classes[g],h.push(function(){var c,e,h,i,j;for(i=null!=(h=d[g])?h:function(){var c;c=[];for(a in b.collections)c.push(a);return c}(),j=[],c=0,e=i.length;e>c;c++)f=i[c],j.push(this.getRelationCount(f,g));return j}.call(this));return h}.call(this),c.reduce(y,[])},b.prototype.getRelationCount=function(a,b){var c,d,f,g,i,j,k;if(f=this.model.get("id"),B.isObject(a))j=a.query,g=a.label,c=j(f),d=function(a){return new e({parts:[g],id:g,displayName:g,count:a})};else{if(i=this.schema.makePath(""+b+"."+a),!(null!=(k=i.getType())?k.attributes.id:void 0))return p.resolve(!0);c={select:[a+".id"],from:b,where:{id:f}},d=function(a){return new h({path:i,count:a})}}return this.service.count(c).then(d).then(function(a){return function(b){return b.get("count")?a.referenceFields.add(b):void 0}}(this))},b}(f)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../core/type-assertions":10,"../models/path":56,"../options":63,"../templates":67,"../utils/get-leaves":83,"./item-preview/counts-title":173,"./item-preview/details":174,"./item-preview/reference-counts":175,"es6-promise":281,underscore:312}],173:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../messages"),e.setWithPrefix("preview",{RelatedItemsHeading:"Related Items"}),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.tagName="h4",b.prototype.collectionEvents=function(){return{"add remove reset":this.setVisibility}},b.prototype.setVisibility=function(){return this.$el.toggleClass("im-hidden",this.collection.isEmpty())},b.prototype.template=function(){return f.escape(e.getText("preview.RelatedItemsHeading"))},b.prototype.postRender=function(){return this.setVisibility()},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,underscore:312}],174:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),h=a("../../templates"),d=a("../../core-view"),i=a("../../utils/events").ignore,e=h.template("cell-preview-items"),g=h.template("cell-preview-reference"),c=h.template("cell-preview-attribute"),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.tagName="table",b.prototype.className="im-item-details table table-condensed table-bordered",b.prototype.template=e,b.prototype.collectionEvents=function(){return{sort:this.reRender,add:this.addDetail}},b.prototype.events=function(){return{"click .im-too-long":this.revealLongField}},b.prototype.postRender=function(){return this.collection.each(function(a){return function(b){return a.addDetail(b)}}(this))},b.prototype.addDetail=function(a){return this.$el.append(this["render"+a.get("fieldType")](a.toJSON()))},b.prototype.renderATTR=function(a){return c(j.extend(this.getBaseData(),a))},b.prototype.renderREF=g,b.prototype.revealLongField=function(a){var b,c;return i(a),c=this.$(".im-too-long"),b=this.$(".im-overspill"),c.remove(),b.slideDown(250)},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/events":81,underscore:312}],175:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../../templates"),c=a("../../core-view"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-related-counts",b.prototype.tagName="ul",b.prototype.collectionEvents=function(){return{"add change sort":this.reRender}},b.prototype.template=e.template("cell-preview-reference-relation"),b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],176:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),d=a("../core-view"),g=a("../messages"),h=a("./modal"),c=a("./join-manager/body"),f=a("../models/joins"),a("../messages/joins"),i=function(a,b){return a.length===b.length&&j.all(a,function(a,c){return a===b[c]})},b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.parameters=["query"],b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-join-manager"},b.prototype.title=function(){return g.getText("joins.Heading")},b.prototype.dismissAction=function(){return g.getText("Cancel")},b.prototype.primaryAction=function(){return g.getText("modal.ApplyChanges")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.joins=f.fromQuery(this.query),this.listenTo(this.joins,"change:style",this.setDisabled)},b.prototype.initState=function(){return this.state.set({disabled:!0})},b.prototype.act=function(){var a;return this.state.get("disabled")?void 0:(a=this.joins.getJoins(),this.query.joins=a,this.query.trigger("change:joins",a),this.resolve(a))},b.prototype.setDisabled=function(){var a,b,c,d;return a=j.keys(this.joins.getJoins()),b=function(){var a,b;a=this.query.joins,b=[];for(c in a)d=a[c],"OUTER"===d&&b.push(c);return b}.call(this),a.sort(),b.sort(),this.state.set({disabled:i(a,b)})},b.prototype.postRender=function(){var a;return b.__super__.postRender.apply(this,arguments),a=this.$(".modal-body"),this.renderChild("cons",new c({collection:this.joins}),a)},b}(h)}).call(this)},{"../core-view":3,"../messages":16,"../messages/joins":23,"../models/joins":47,"./join-manager/body":177,"./modal":197,underscore:312}],177:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("../../core-view"),i=a("../../templates"),d=a("../../utils/css-class-set"),a("../../messages/joins"),h=["join-style","column-manager-path-name","clear"],c=function(a){function b(a,c){b.__super__.constructor.call(this,{"btn btn-default":!0,active:function(){return c===a.get("style")}})}return m(b,a),b}(d),j=function(a){switch(a){case"INNER":return"OUTER";case"OUTER":return"INNER";default:return"INNER"}},f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.tagName="li",b.prototype.className="list-group-item",b.prototype.template=i.templateFromParts(h),b.prototype.modelEvents=function(){return{"change:style change:parts":this.reRender}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.classSets={innerJoinBtn:new c(this.model,"INNER"),outerJoinBtn:new c(this.model,"OUTER")}},b.prototype.getData=function(){return k.extend(b.__super__.getData.apply(this,arguments),this.classSets)},b.prototype.events=function(){return{"click button":this.onButtonClick}},b.prototype.onButtonClick=function(a){return/active/.test(a.target.className)?void 0:this.model.swap("style",j)},b}(e),b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.template=i.template("join-manager-body"),b.prototype.initState=function(){return this.state.set({explaining:!1})},b.prototype.postRender=function(){return this.$group=this.$(".list-group"),this.collection.each(function(a){return function(b){return a.addJoin(b)}}(this))},b.prototype.addJoin=function(a){return this.rendered?this.renderChild(a.id,new f({model:a}),this.$group):void 0},b.prototype.removeJoin=function(a){return this.removeChild(a.id)},b.prototype.events=function(){return{"click .alert-info strong":function(){return this.state.toggle("explaining")}}},b.prototype.stateEvents=function(){return{"change:explaining":this.onChangeExplaining}},b.prototype.collectionEvents=function(){return{add:this.addJoin,remove:this.removeJoin,sort:this.reRender}},b.prototype.onChangeExplaining=function(){var a,b;return this.rendered?(b=this.$(".alert-info p"),a=this.state.get("explaining")?"slideDown":"slideUp",b[a]()):void 0},b}(e)}).call(this)},{"../../core-view":3,"../../messages/joins":23,"../../templates":67,"../../utils/css-class-set":79,underscore:312}],178:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("../query-dialogue-button"),c=a("../join-manager"),a("../../messages/joins"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-join-manager-button",b.prototype.longLabel="joins.Manage",b.prototype.shortLabel="joins.ManageShort",b.prototype.icon="Joins",b.prototype.Dialogue=c,b}(e)}).call(this)},{"../../messages/joins":23,"../join-manager":176,"../query-dialogue-button":206}],179:[function(a,b,c){(function(){var c,d,e={}.hasOwnProperty,f=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-view"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return f(b,a),b.prototype.RERENDER_EVENT="change",b.prototype.tagName="span",b}(d)}).call(this)},{"../core-view":3}],180:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("es6-promise").Promise,d=a("./base-append-dialogue"),e=a("./from-path-mixin"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.include(e(d)),b}(d)}).call(this)},{"./base-append-dialogue":183,"./from-path-mixin":189,"es6-promise":281}],181:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("es6-promise").Promise,d=a("./base-append-dialogue"),e=a("../../mixins/floating-dialogue"),f=a("./from-selection-mixin"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.include(e),b.include(f(d)),b}(d)}).call(this)},{"../../mixins/floating-dialogue":30,"./base-append-dialogue":183,"./from-selection-mixin":190,"es6-promise":281}],182:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),d=a("../../core-view"),g=a("../../templates"),e=a("../../messages"),f=a("../../core/select-with-label"),a("../../messages/lists"),b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.parameters=["model","collection"],b.prototype.postRender=function(){return this.renderListSelector()},b.prototype.renderListSelector=function(){var a;return a=new f({model:this.model,collection:this.collection,attr:"target",label:"lists.params.Target",optionLabel:"lists.PossibleAppendTarget",helpMessage:"lists.params.help.Target",noOptionsMessage:"lists.append.NoSuitableLists",getProblem:function(a){return!(null!=a?a.length:void 0)}}),this.listenTo(a.state,"change:error",console.error.bind(console)),this.renderChild("list-selector",a)},b}(d)}).call(this)},{"../../core-view":3,"../../core/select-with-label":9,"../../messages":16,"../../messages/lists":24,"../../templates":67,underscore:312}],183:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u={}.hasOwnProperty,v=function(a,b){function c(){this.constructor=a}for(var d in b)u.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};t=a("underscore"),o=a("es6-promise").Promise,g=a("../../core/collection"),h=a("../../core-model"),j=a("../../messages"),f=a("./base-dialogue"),c=a("./append-to-list-body"),d=a("../../models/append-to-list"),k={key:"lists.NoSuitableLists",level:"Warning",cannotDismiss:!0},i={key:"lists.TargetNotCorrectType",level:"Error",cannotDismiss:!0},p={key:"lists.TargetDoesNotExist",level:"Error",cannotDismiss:!0},l={key:"lists.NoTargetSelected",level:"Info",cannotDismiss:!0},r=function(a){return function(b){return a.isa(b.type)?void 0:o.reject(i)}},q=function(a){return t.where(a,{status:"CURRENT"})},s=function(a){var b,c,d,e,f,g,h;for(h=[],e=0,f=a.length;f>e;e++)g=a[e],b=g.name,d=g.type,c=g.size,h.push({name:b,type:d,size:c,id:b});return h},m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.defaults=function(){return{typeName:null,name:null,size:0}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.fetchTypeName()},b.prototype.fetchTypeName=function(){var a,b;return a=this.collection.service,b=this.get("type"),a.fetchModel().then(function(a){return a.makePath(b)}).then(function(a){return a.getDisplayName()}).then(function(a){return function(b){return a.set({typeName:b})}}(this))},b}(h),n=function(a){function b(a){this.service=a.service,b.__super__.constructor.call(this)}return v(b,a),b.prototype.model=m,b}(g),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.Body=c,b.prototype.Model=d,b.prototype.title=function(){return j.getText("lists.AppendToListTitle",this.getData())},b.prototype.primaryAction=function(){return j.getText("lists.Append")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.getPossibleLists(),"remove reset",this.verifyState),this.listenTo(this.getPossibleLists(),"add reset",this.setTargetIfOnlyOne)},b.prototype.getPossibleLists=function(){return null!=this.possibleLists?this.possibleLists:this.possibleLists=new n({service:this.getService()})},b.prototype.processQuery=function(a){return a.appendToList(this.model.get("target"))},b.prototype.modelEvents=function(){return t.extend(b.__super__.modelEvents.apply(this,arguments),{"change:target":"onChangeTarget"})},b.prototype.initState=function(){return b.__super__.initState.apply(this,arguments),this.fetchSuitableLists(),this.verifyState()},b.prototype.checkThereAreLists=function(){return this.getPossibleLists().size()?void 0:this.state.set({error:k})},b.prototype.onChangeTarget=function(){return this.setTitle(),this.verifyState()},b.prototype.verifyState=function(){return this.state.unset("error"),this.checkThereAreLists(),this.verifyTarget(),this.verifyTargetExistsAndIsSuitable()},b.prototype.setTargetIfOnlyOne=function(){var a;return a=this.getPossibleLists(),1===a.length?this.model.set({target:a.at(0).get("name")}):void 0},b.prototype.verifyTarget=function(){return this.model.get("target")?void 0:this.state.set({error:l})},b.prototype.onChangeType=function(){return b.__super__.onChangeType.apply(this,arguments),this.fetchSuitableLists()},b.prototype.getBodyOptions=function(){return t.extend(b.__super__.getBodyOptions.apply(this,arguments),{collection:this.getPossibleLists()})},b.prototype.verifyTargetExistsAndIsSuitable=function(){var a,b,c;return c=this.getType(),null!=c&&(b=this.model.get("target"),null!=b)?(a=c.model.makePath(c.name),this.getService().fetchList(b).then(r(a),function(){return p}).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))):void 0},b.prototype.fetchSuitableLists=function(){var a,b;return b=this.getType(),null==b?this.getPossibleLists().reset():(a=b.model.makePath(b.name),this.getService().fetchLists().then(function(b){return t.filter(b,function(b){return a.isa(b.type)})}).then(q).then(s).then(function(a){return function(b){return a.getPossibleLists().reset(b)}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this)))},b}(f)}).call(this)},{"../../core-model":2,"../../core/collection":5,"../../messages":16,"../../models/append-to-list":35,"./append-to-list-body":182,"./base-dialogue":184,"es6-promise":281,underscore:312}],184:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),h=a("../modal"),g=a("../../messages"),e=a("../../models/create-list"),f=a("./body"),a("../../messages/lists"),c=function(){throw new Error("not implemented")},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.getQuery=c,b.prototype.fetchCount=c,b.prototype.getType=c,b.prototype.getService=function(){return c},b.prototype.Model=e,b.prototype.Body=f,b.prototype.className=function(){return b.__super__.className.apply(this,arguments)+" im-list-dialogue im-create-list"},b.prototype.title=function(){return g.getText("lists.CreateListTitle",this.getData())},b.prototype.primaryAction=function(){return g.getText("lists.Create")},b.prototype.act=function(){return this.getQuery().then(function(a){return function(b){return a.processQuery(b)}}(this)).then(this.resolve,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.verifyState=function(){return this.state.set({error:null})},b.prototype.processQuery=function(a){return a.saveAsList(this.model.toJSON())},b.prototype.modelEvents=function(){return{"change:type":"onChangeType"}},b.prototype.onChangeType=function(){return this.setTypeName()},b.prototype.stateEvents=function(){return{"change:typeName change:count":"setTitle","change:typeName":"setListName","change:error":function(){return console.log(this.state.get("error"))}}},b.prototype.setTitle=function(){return this.$(".modal-title").text(this.title())},b.prototype.setListName=function(){return this.model.set({name:g.getText("lists.DefaultName",this.state.toJSON())})},b.prototype.initState=function(){return this.state.set({existingLists:{},minimised:i.result(this,"initiallyMinimised")}),this.setTypeName(),this.setCount(),this.checkAuth(),this.getService().fetchLists().then(function(a){return i.where(a,{authorized:!0})}).then(function(a){return i.groupBy(a,"name")}).then(function(a){return function(b){return a.state.set({existingLists:b})}}(this))},b.prototype.setCount=function(){return this.fetchCount().then(function(a){return function(b){return a.state.set({count:b})}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this))},b.prototype.setTypeName=function(){var a;return null!=(a=this.getType())?a.getDisplayName().then(function(a){return function(b){return a.state.set({typeName:b})}}(this)).then(null,function(a){return function(b){return a.state.set({error:b})}}(this)):void 0},b.prototype.checkAuth=function(){return this.getService().whoami().then(null,function(a){return function(){return a.state.set({error:{level:"Error",key:"lists.error.MustBeLoggedIn"}})}}(this))},b.prototype.getBodyOptions=function(){return{model:this.model,state:this.state}},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.renderChild("body",new this.Body(this.getBodyOptions()),this.$(".modal-body"))},b}(h)}).call(this)},{"../../messages":16,"../../messages/lists":24,"../../models/create-list":41,"../modal":197,"./body":185,underscore:312}],185:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};l=a("underscore"),c=a("../../core-view"),k=a("../../templates"),i=a("../../messages"),d=a("../../models/create-list"),f=a("../../core/input-with-label"),e=a("../../core/input-with-button"),h=a("./tag"),j=a("./tags-apology"),a("../../messages/lists"),b.exports=g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.Model=d,b.prototype.template=k.template("list-dialogue-body"),b.prototype.getData=function(){return l.extend(b.__super__.getData.apply(this,arguments))},b.prototype.modelEvents=function(){return{"add:tag":"addTag"}},b.prototype.stateEvents=function(){return{"change:minimised":"toggleOptionalAttributes"}},b.prototype.events=function(){return{"click .im-more-options":function(a){return function(){return a.state.toggle("minimised")}}(this)}},b.prototype.$tags=null,b.prototype.postRender=function(){return this.renderListNameInput(),this.renderListDescInput(),this.renderTags()},b.prototype.renderTags=function(){return this.$tags=this.$(".im-active-tags"),this.addTags(),this.renderApology(),this.renderTagAdder()},b.prototype.renderTagAdder=function(){var a;return a=new e({model:this.model,placeholder:"lists.AddTag",button:"lists.AddTagBtn",sets:"nextTag"}),this.listenTo(a,"act",this.addNextTag),this.renderChildAt(".im-next-tag",a)},b.prototype.addTags=function(){return this.model.tags.each(function(a){return function(b){return a.addTag(b)}}(this))},b.prototype.addTag=function(a){return this.rendered?this.renderChild("tag-"+a.get("id"),new h({model:a}),this.$tags):void 0},b.prototype.toggleOptionalAttributes=function(){var a,b,c;return c=this.state.toJSON(),a=this.$(".im-optional-attributes"),c.minimised?a.slideUp():a.slideDown(),b=i.getText("lists.ShowExtraOptions",c),this.$(".im-more-options .msg").text(b)},b.prototype.renderApology=function(){return this.renderChildAt(".im-apology",new j({collection:this.model.tags}))},b.prototype.renderListNameInput=function(){var a;return a=new f({model:this.model,attr:"name",label:"lists.params.Name",helpMessage:"lists.params.help.Name",placeholder:"lists.params.NamePlaceholder",getProblem:function(a){return function(b){return a.validateName(b)}}(this)}),this.listenTo(a.state,"change:problem",function(){var b;return b=a.state.get("problem"),this.state.set({disabled:!!b})}),this.renderChildAt(".im-list-name",a)},b.prototype.validateName=function(a){var b;return b=null!=a?a.replace(/(^\s+|\s+$)/g,""):void 0,!b||this.state.get("existingLists")[b]},b.prototype.renderListDescInput=function(){return this.renderChildAt(".im-list-desc",new f({model:this.model,attr:"description",label:"lists.params.Desc",placeholder:"lists.params.DescPlaceholder"}))},b.prototype.addNextTag=function(){return this.model.addTag()},b}(c)}).call(this)},{"../../core-view":3,"../../core/input-with-button":6,"../../core/input-with-label":7,"../../messages":16,"../../messages/lists":24,"../../models/create-list":41,"../../templates":67,"./tag":191,"./tags-apology":192,underscore:312}],186:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var d in b)r.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};q=a("underscore"),h=a("../../core-view"),g=a("../../core-model"),f=a("../../core/collection"),p=a("../../templates"),e=a("../../utils/css-class-set"),i=a("../../utils/count-executor"),m=a("../../models/path"),d=a("./append-from-selection"),k=a("./create-from-selection"),c=a("./append-from-path"),j=a("./create-from-path"),a("../../messages/lists"),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.model=m,b}(f),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.parameters=["query","model","showDialogue","highLight"],b.prototype.tagName="li",b.prototype.modelEvents=function(){return{"change:displayName change:typeName":this.reRender}},b.prototype.stateEvents=function(){return{"change:count":this.reRender}},b.prototype.Model=m,b.prototype.template=p.template("list-dialogue-button-node"),b.prototype.events=function(){return{click:this.openDialogue,"mouseenter a":function(){return q.defer(function(a){return function(){return a.highLight(a.model.get("path"))}}(this))},"mouseout a":function(){return this.highLight(null)}}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.query.summarise(this.model.get("id")).then(function(a){return function(b){var c;return c=b.stats,a.state.set({count:c.uniqueValues})}}(this))},b.prototype.openDialogue=function(){var a;return a={query:this.query,path:this.model.get("id")},this.showDialogue(a)},b}(h),b.exports=l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.tagName="div",b.prototype.className="btn-group list-dialogue-button",b.prototype.template=p.template("list-dialogue-button"),b.prototype.parameters=["query","selected"],b.prototype.optionalParameters=["tableState"],b.prototype.tableState=new g,b.prototype.initState=function(){return this.state.set({action:"create",authenticated:!1,disabled:!1})},b.prototype.stateEvents=function(){return{"change:action":this.setActionButtonState,"change:authenticated":this.setVisible,"change:disabled":this.onChangeDisabled}},b.prototype.events=function(){return{"click .im-create-action":this.setActionIsCreate,"click .im-append-action":this.setActionIsAppend,"click .im-pick-items":this.startPicking}},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.initBtnClasses(),this.paths=new n,this.query.getQueryNodes().reverse().forEach(function(a){return function(b){return a.paths.add(new m(b))}}(this)),this.query.service.whoami().then(function(a){return function(b){return a.state.set({authenticated:!!b})}}(this)),i.count(this.query).then(function(a){return function(b){return a.state.set({disabled:0===b})}}(this)).then(null,function(a){return function(b){return a.state.set({disabled:!0,error:b})}}(this))},b.prototype.getData=function(){return q.extend(b.__super__.getData.apply(this,arguments),this.classSets,{paths:this.paths.toJSON()})},b.prototype.postRender=function(){var a,b,c;return this.setVisible(),this.onChangeDisabled(),b=this.$(".dropdown-menu"),a=function(a){return function(b){return a.tableState.set({highlitNode:b
})}}(this),c=function(a){return function(b){return a.showPathDialogue(b)}}(this),this.paths.each(function(d){return function(e,f){var g;return g=new o({query:d.query,model:e,showDialogue:c,highLight:a}),d.renderChild("path-"+f,g,b,"prepend")}}(this))},b.prototype.onChangeDisabled=function(){return this.$(".btn").toggleClass("disabled",this.state.get("disabled"))},b.prototype.setVisible=function(){return this.$el.toggleClass("im-hidden",!this.state.get("authenticated"))},b.prototype.setActionIsCreate=function(a){return a.stopPropagation(),a.preventDefault(),this.state.set({action:"create"})},b.prototype.setActionIsAppend=function(a){return a.stopPropagation(),a.preventDefault(),this.state.set({action:"append"})},b.prototype.showDialogue=function(a,b){var c,d,e;return d=new a(b),this.renderChild("dialogue",d),c=this.state.get("action"),e=function(a){return function(b){return function(d){return a.trigger(""+b+":"+c,d),a.trigger(b,c,d)}}}(this),d.show().then(e("success"),e("failure"))},b.prototype.showPathDialogue=function(a){var b,d;return d=this.state.get("action"),b=function(){switch(d){case"append":return c;case"create":return j;default:throw new Error("Unknown action: "+d)}}(),this.showDialogue(b,a)},b.prototype.startPicking=function(){var a,b,c,e;return b=this.state.get("action"),c={collection:this.selected,service:this.query.service},a=function(){switch(b){case"append":return d;case"create":return k;default:throw new Error("Unknown action: "+b)}}(),this.tableState.set({selecting:!0}),e=function(a){return function(){return a.tableState.set({selecting:!1}),a.selected.reset()}}(this),this.showDialogue(a,c).then(e,e)},b.prototype.setActionButtonState=function(){var a;return a=this.state.get("action"),this.$(".im-create-action").toggleClass("active","create"===a),this.$(".im-append-action").toggleClass("active","append"===a)},b.prototype.initBtnClasses=function(){return this.classSets={},this.classSets.createBtnClasses=new e({"im-create-action":!0,"btn btn-default":!0,active:function(a){return function(){return"create"===a.state.get("action")}}(this)}),this.classSets.appendBtnClasses=new e({"im-append-action":!0,"btn btn-default":!0,active:function(a){return function(){return"append"===a.state.get("action")}}(this)})},b}(h)}).call(this)},{"../../core-model":2,"../../core-view":3,"../../core/collection":5,"../../messages/lists":24,"../../models/path":56,"../../templates":67,"../../utils/count-executor":77,"../../utils/css-class-set":79,"./append-from-path":180,"./append-from-selection":181,"./create-from-path":187,"./create-from-selection":188,underscore:312}],187:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("es6-promise").Promise,c=a("./base-dialogue"),e=a("./from-path-mixin"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.include(e(c)),b}(c)}).call(this)},{"./base-dialogue":184,"./from-path-mixin":189,"es6-promise":281}],188:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),g=a("es6-promise").Promise,c=a("./base-dialogue"),e=a("../../mixins/floating-dialogue"),f=a("./from-selection-mixin"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.include(e),b.include(f(c)),b}(c)}).call(this)},{"../../mixins/floating-dialogue":30,"./base-dialogue":184,"./from-selection-mixin":190,"es6-promise":281,underscore:312}],189:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=function(a){return{parameters:["query","path"],className:function(){return a.prototype.className.call(this)+" im-from-path"},getQuery:function(){return c.resolve(this.query.selectPreservingImpliedConstraints([this.path]))},fetchCount:function(){return this.query.summarise(this.path).then(function(a){var b;return b=a.stats.uniqueValues})},getType:function(){return this.query.makePath(this.path).getParent().getType()},getService:function(){return this.query.service}}}}).call(this)},{"es6-promise":281}],190:[function(a,b,c){(function(){var c,d,e,f;e=a("../../models/selected-objects"),f=a("../../core/type-assertions"),c={level:"Error",key:"lists.NoCommonType",cannotDismiss:!0},d={level:"Info",key:"lists.NoObjectsSelected",cannotDismiss:!0},b.exports=function(a){return{parameters:["service","collection"],parameterTypes:{collection:f.InstanceOf(e,"SelectedObjects")},className:function(){return a.prototype.className.call(this)+" im-list-picker"},getQuery:function(){return this.service.query({from:this.model.get("type"),select:["id"],where:[{path:this.model.get("type"),op:"IN",ids:this.getIds()}]})},fetchCount:function(){return Promise.resolve(this.collection.size())},getType:function(){var a;return this.model.get("type")&&null!=(a=this.schema)?a.makePath(this.model.get("type")).getType():void 0},getService:function(){return this.service},collectionEvents:function(){return{"change:commonType change:typeName":this.setType,"add remove":this.setCount}},initiallyMinimised:!0,getIds:function(){return this.collection.map(function(a){return a.get("id")})},onChangeType:function(){return a.prototype.onChangeType.call(this),this.verifyState()},verifyState:function(){var b;return null!=(b=a.prototype.verifyState)&&b.call(this),this.collection.size()?this.model.get("type")?void 0:this.state.set({error:c}):this.state.set({error:d})},setType:function(){return this.model.set({type:this.collection.state.get("commonType")}),this.state.set({typeName:this.collection.state.get("typeName")})}}}}).call(this)},{"../../core/type-assertions":10,"../../models/selected-objects":58}],191:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),e=a("../../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-list-tag label label-primary",b.prototype.template=e.template("list-tag"),b.prototype.events=function(){return{"click .im-remove":"removeAndDestroy"}},b.prototype.postRender=function(){return this.activateTooltip()},b.prototype.activateTooltip=function(){return this.$("[title]").tooltip()},b.prototype.removeAndDestroy=function(){return this.model.collection.remove(this.model),this.model.destroy(),this.$el.fadeOut(400,function(a){return function(){return a.remove()}}(this))},b}(c)}).call(this)},{"../../core-view":3,"../../templates":67}],192:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../templates"),a("../../messages/lists"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.collectionEvents=function(){return{"add remove reset":this.reRender}},b.prototype.template=e.template("list-tags-apology"),b.prototype.getData=function(){return f.extend(b.__super__.getData.apply(this,arguments),{hasTags:this.collection.size()})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/lists":24,"../../templates":67,underscore:312}],193:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};n=a("underscore"),e=a("es6-promise").Promise,d=a("../messages"),f=a("../core-view"),d.set({"convalue.BadType":"<%- name %> is of the wrong type (<%- type %>).","convalue.EmptyList":"<%- name %> is empty. This query will always return 0 results","convalue.BadList":'You do not have access to list called "<%- name %>". Choose one from the list.'}),i=a("../templates/helpers"),k=a("../templates/mustache-settings"),j="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",l=n.template(j),h=function(a){return a.name},g=function(a){return a.size?""+a.name+" ("+a.size+" "+a.typeName+"s)":a.name},m=function(a){return function(b){var c;return c=a.makePath(b.type),c.getDisplayName().then(function(a){return n.extend(b,{typeName:a})})}},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return p(b,a),b.prototype.className="im-list-value-controls",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.initialValue=this.model.get("value"),this.path=this.model.get("path"),this.setSuitableLists(),this.listenTo(this.model,"change",this.reRender),this.listenTo(this.model,"change:value",this.checkCurrentValue),this.checkCurrentValue()},b.prototype.checkCurrentValue=function(){var a,b,c;return c=this.model.get("value"),a=function(a){return function(b){return a.model.set({error:new Error(d.getText("convalue.BadList",{name:c}))}),a.listenToOnce(a.model,"change:value",function(){return a.model.unset("error")})}}(this),b=function(a){var b;return b=a.size?this.path.isa(a.type)?void 0:"convalue.BadType":"convalue.EmptyList",null!=b?(this.model.set({error:new Error(d.getText(b,a))}),this.listenToOnce(this.model,"change:value",function(a){return function(){return a.model.unset("error")}}(this))):void 0},this.query.service.fetchList(c).then(b,a)},b.prototype.events=function(){return{"change select":"setList"}},b.prototype.setList=function(){return this.model.set({value:this.$("select").val()})},b.prototype.setSuitableLists=function(){var a,b;return this.model.has("suitableLists")?void 0:(b=function(a){return function(b){return a.model.set({suitableLists:b})}}(this),a=function(a){return function(b){return a.model.set({error:b})}}(this),this.fetchSuitableLists().then(b,a))},b.prototype.fetchSuitableLists=function(){return null!=this.__suitable_lists?this.__suitable_lists:this.__suitable_lists=this.query.service.fetchLists().then(function(a){return function(b){var c,d;return d=function(){var a,d,e;for(e=[],a=0,d=b.length;d>a;a++)c=b[a],c.size&&this.path.isa(c.type)&&e.push(c);return e}.call(a),e.all(d.map(m(a.query.model)))}}(this))},b.prototype.getSuitableLists=function(){var a,b,c;return a={name:this.initialValue},c=this.model.get("suitableLists")||[],b=n.findWhere(c,a),null==b&&(b=a),n.uniq([b].concat(c),!1,"name")},b.prototype.template=function(a){return a=n.extend({formatList:g,getOptionValue:h,messages:d},i,a),l(a)},b.prototype.getData=function(){var a,b,c;return a=this.model.get("value"),c=this.getSuitableLists(),b=function(b){return b.name===a},{suitableLists:c,isSelected:b}},b}(f)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../templates/mustache-settings":69,"es6-promise":281,underscore:312}],194:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),f=a("es6-promise").Promise,g=a("../utils/suggestion-source"),e=a("../messages"),c=a("./attribute-value-controls"),h='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',i=j.template(h),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.state.set({extraPlaceholder:e.get("conbuilder.ExtraPlaceholder")}),this.listenTo(this.branding,"change:defaults.extraValue.path",this.reRender),this.listenTo(this.branding,"change:defaults.extraValue.value",function(){return this.state.set({extraPlaceholder:this.branding.get("defaults.extraValue.value")})}),this.listenTo(this.model,"change",this.reRender)},b.prototype.stateEvents=function(){return j.extend(b.__super__.stateEvents.apply(this,arguments),{"change:extraPlaceholder":this.reRender})},b.prototype.template=function(a){var c;return c=b.__super__.template.apply(this,arguments),c+i(a)},b.prototype.events=function(){return{"change .im-con-value-attr":"setValue","change .im-extra-value":"setExtraValue"}},b.prototype.setExtraValue=function(){var a,b;return a=this.$("input.im-extra-value.tt-input"),a.length||(a=this.$("input.im-extra-value")),b=a.val(),b?this.model.set({extraValue:b}):this.model.unset("extraValue")},b.prototype.setBoth=function(){return this.setValue(),this.setExtraValue()},b.prototype.suggestExtra=function(){var a,b,c,d,e,g;return b=this.branding.get("defaults.extraValue.path"),g=this.branding.get("defaults.extraValue.extraFor"),d=null!=b&&this.model.get("path").isa(g)?(e=""+this.model.get("path")+"."+b,c=null!=this.__extra_suggestions?this.__extra_suggestions:this.__extra_suggestions=this.query.summarise(e),a=this.handleSuggestionSet.bind(this,this.$("input.im-extra-value"),"extraValue"),c.then(function(a){var b;return b=a.results}).then(a)):f.resolve(!0)},b.prototype.suggestValue=function(){var a,b,c,d,e;return d=this.model.get("path"),e=this.query.service,a=d.getEndClass().name,b=e.fetchClassKeys().then(function(b){return b[a]}),null==this.__value_suggestions&&(this.__value_suggestions=b.then(function(a){return function(b){var c,e;return(null!=b?b.length:void 0)?(e=function(){var a,e,f;for(f=[],a=0,e=b.length;e>a;a++)c=b[a],f.push(this.query.summarise(d+c.replace(/^[^\.]+/,"")));return f}.call(a),f.all(e).then(function(a){return a.reduce(function(a,b){return a.concat(b.results)},[])})):[]}}(this))),c=this.handleSuggestionSet.bind(this,this.$("input.im-con-value-attr"),"value"),this.__value_suggestions.then(c)},b.prototype.handleSuggestionSet=function(a,b,c){var d,e,f,h,i,j;return j=c.length,0!==j?(i=new g(c,j),h={minLength:0,highlight:!0},d={name:""+b+"_suggestions",source:i.suggest,displayKey:"item",templates:{footer:i.tooMany}},e=function(a){return function(c){return function(c,d){return a.model.set(b,d.item)}}}(this),f=c[0].item,this.activateTypeahead(a,h,d,f,e(a),function(a){return function(){return a.setBoth()}}(this))):void 0},b.prototype.provideSuggestions=function(){var a,b;return this.removeTypeAheads(),b=this.suggestValue(),a=this.suggestExtra(),f.all([a,b])},b.prototype.remove=function(){return b.__super__.remove.apply(this,arguments),this.branding.destroy()},b}(c)}).call(this)},{"../messages":16,"../utils/suggestion-source":107,"./attribute-value-controls":113,"es6-promise":281,underscore:312}],195:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),e=a("es6-promise").Promise,d=a("../messages"),f=a("../core-view"),g=a("../templates/helpers"),i=a("../templates/mustache-settings"),k=a("../utils/to-named-path"),h="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",j=m.template(h),l=function(a){var b,c;return c=a.path,b=a.name,{value:c.toString(),text:b}},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.path=this.model.get("path"),this.type=this.path.getType(),this.setCandidateLoops(),this.listenTo(this.model,"change",this.reRender)},b.prototype.events=function(){return{"change select":"setLoop"}},b.prototype.setLoop=function(){return this.model.set({value:this.$("select").val()})},b.prototype.setCandidateLoops=function(){return this.model.has("candidateLoops")?void 0:this.getCandidateLoops().then(function(a){return function(b){return a.model.set({candidateLoops:b})}}(this))},b.prototype.isSuitable=function(a){return(a.isa(this.type)||this.path.isa(a.getType()))&&this.path.toString()!==a.toString()},b.prototype.getCandidateLoops=function(){return null!=this.__candidate_loops?this.__candidate_loops:this.__candidate_loops=function(a){return function(){var b,c;return b=function(){var a,b,d,e;for(d=this.query.getQueryNodes(),e=[],a=0,b=d.length;b>a;a++)c=d[a],this.isSuitable(c)&&e.push(c);return e}.call(a),e.all(b.map(k))}}(this)()},b.prototype.template=function(a){return j(m.extend({messages:d},g,a))},b.prototype.getData=function(){var a,b,c,d;return c=this.model.get("value"),b=function(){var b,c,d,e;for(d=this.model.get("candidateLoops")||[],e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(l(a));return e}.call(this),d=function(a){return a.value===c},{candidateLoops:b,isSelected:d}},b}(f)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../templates/mustache-settings":69,"../utils/to-named-path":109,"es6-promise":281,underscore:312}],196:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("../core-view"),e=a("../templates"),f=function(){return{error:null,exportLink:null,disabled:!1,disabledReason:null}},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.tagName="div",b.prototype.className="modal-footer",b.prototype.RERENDER_EVENT="change:error change:exportLink",b.prototype.parameters=["template","actionNames","actionIcons"],b.prototype.getData=function(){return g.extend(f(),this.actionNames,this.actionIcons,b.__super__.getData.apply(this,arguments))},b.prototype.postRender=function(){return this.$("[title]").tooltip()},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:312}],197:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("es6-promise").Promise,j=a("underscore"),h=a("../core-view"),c=a("../messages"),g=a("../templates"),i=g.template("modal_base"),e=a("./modal-footer"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.className=function(){return"modal fade"},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this._promise=new f(function(a){return function(b,c){a.resolve=b,a.reject=c}}(this)),this.listenTo(this.state,"change",this.renderFooter)},b.prototype.resolve=function(){throw new Error("resolved before initialisation")},b.prototype.reject=function(){throw new Error("rejected before initialisation")},b.prototype.dismissError=function(){return this.$(".modal-footer .alert").slideUp(250,function(a){return function(){return a.state.set({error:null})}}(this))},b.prototype.events=function(){return{"click .modal-footer .alert .dismiss":"dismissError","click .modal-footer .btn-cancel":"hide","click .modal-footer button.btn-primary":"act","hidden.bs.modal":"onHidden","click .close":"hide"}},b.prototype.promise=function(){return this._promise},b.prototype.hide=function(){return this.resolve("dismiss")},b.prototype.act=function(){throw new Error("Not implemented.")},b.prototype.primaryIcon=function(){return null},b.prototype.Footer=e,b.prototype.renderFooter=function(){var a,b,c,d;if(this.rendered)return a=j.result(this,"dismissAction"),c=j.result(this,"primaryAction"),d=j.result(this,"primaryIcon"),b={template:this.footer,model:this.state,actionNames:{dismissAction:a,primaryAction:c},actionIcons:{primaryIcon:d}},this.renderChild("footer",new this.Footer(b),this.$(".modal-content"))},b.prototype.postRender=function(){return this.renderFooter()},b.prototype.onHidden=function(a){return null!=a&&a.target!==this.el?!1:(this.resolve("dismiss"),this.shown=!1,this.remove())},b.prototype.remove=function(){return this.reject(new Error("unresolved before removal")),this.shown?this._hideModal():b.__super__.remove.call(this)},b.prototype.title=function(){return c.getText("modal.DefaultTitle")},b.prototype.dismissAction=function(){return c.getText("modal.Dismiss")},b.prototype.primaryAction=function(){return c.getText("modal.OK")},b.prototype.modalSize=function(){},b.prototype.body=function(){},b.prototype.renderTitle=function(){return this.rendered?this.$(".modal-title").text(j.result(this,"title")):void 0},b.prototype.footer=g.templateFromParts(["modal_error","modal_footer"]),b.prototype.template=function(a){var b,c,d;return d=j.result(this,"title"),b=this.body(a),c="modal-"+j.result(this,"modalSize"),i({title:d,body:b,modalSize:c})},b.prototype.shown=!1,b.prototype.show=function(){var a,b;b=this.promise(),b.then(function(a){return function(){return a.remove()}}(this),function(a){return function(){return a.remove()}}(this));try{this._showModal(),this.trigger("shown",this.shown=!0)}catch(c){a=c,this.reject(a)}return b},b.prototype._showModal=function(){return this.$el.modal().modal("show")},b.prototype._hideModal=function(){return this.$el.modal("hide")},b}(h)}).call(this)},{"../core-view":3,"../messages":16,"../templates":67,"./modal-footer":196,"es6-promise":281,underscore:312}],198:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s={}.hasOwnProperty,t=function(a,b){function c(){this.constructor=a}for(var d in b)s.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};r=a("underscore"),c=a("backbone").Collection,f=a("../messages"),j=a("../templates"),e=a("../icons"),o=a("../core-view"),g=a("../core-model"),c=a("../core/collection"),i=a("../options"),d=a("../patterns").IS_BLANK,p=a("../utils/events").ignore,f.setWithPrefix("multivalue",{AddValue:"Add value",AddValueShort:"+",SaveValue:"Save changes"}),q=a("../templates/mustache-settings"),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.defaults=function(){return{editing:!1,scratch:null,selected:!0}},b.prototype.idAttribute="value",b}(g),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.model=l,b}(c),k=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.Model=l,b.prototype.tagName="tr",b.prototype.initialize=function(){return this.model.set({editing:!1,scratch:this.model.get("value")}),this.listenTo(this.model,"change:editing change:value change:selected",this.reRender)},b.prototype.events=function(){return{"click .input-group":function(a){return null!=a?a.stopPropagation():void 0},"click .im-edit":"editValue","keyup input":"updateScratch","change input":"updateScratch","click .im-save":"saveValue","click .im-cancel":"cancelEditing",click:"toggleSelected"}},b.prototype.updateScratch=function(a){return p(a),this.model.set({scratch:a.target.value})},b.prototype.saveValue=function(a){return p(a),this.model.set({editing:!1,value:this.model.get("scratch")})},b.prototype.cancelEditing=function(a){return p(a),this.model.set({editing:!1,scratch:this.model.get("value")})},b.prototype.editValue=function(a){return p(a),this.model.toggle("editing")},b.prototype.toggleSelected=function(a){return p(a),this.model.toggle("selected")},b.prototype.getData=function(){return r.extend({icons:e,messages:f},this.model.toJSON())},b.prototype.template=j.template("value-control-row",q),b}(o),b.exports=h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return t(b,a),b.prototype.className="im-value-options im-multi-value-table",b.prototype.initialize=function(){var a,c,d,e;for(b.__super__.initialize.apply(this,arguments),this.values=new n,e=this.model.get("values")||[],c=0,d=e.length;d>c;c++)a=e[c],this.values.add({value:a});return this.listenTo(this.values,"change:selected change:value add",this.updateModel),this.listenTo(this.values,"add",this.renderValue),this.listenTo(this.values,"remove",this.removeValue)},b.prototype.stateEvents=function(){return{"change:value":this.onChangeNewValue}},b.prototype.modelEvents=function(){return{"change:op":this.onChangeOp,"change:values":this.onChangeValues}},b.prototype.onChangeValues=function(){var a,b;if(null==this.model.previous("values"))return a=this.model.get("values"),this.values.set(function(){var c,d,e,f;for(e=null!=a?a:[],f=[],c=0,d=e.length;d>c;c++)b=e[c],f.push({value:b});return f}())},b.prototype.onChangeOp=function(){var a;return a=this.model.get("op"),"="!==a&&"!="!==a||this.model.has("value")?void 0:this.model.set({values:null,value:this.values.first().get("value")})},b.prototype.events=function(){return{"keyup .im-new-multi-value":this.updateNewValue,"click .im-add":this.addValue}},b.prototype.onChangeNewValue=function(){return this.$(".im-new-multi-value").val(this.state.get("value"))},b.prototype.updateNewValue=function(){return this.state.set({value:this.$(".im-new-multi-value").val()})},b.prototype.addValue=function(a){var b;return p(a),b=this.state.get("value"),null==b||d.test(b)?(this.model.set({error:new Error("please enter a value")}),this.listenToOnce(this.state,"change:value",function(a){return function(){return a.model.unset("error")}}(this))):(this.values.add({value:b}),this.state.unset("value"))},b.prototype.updateModel=function(){var a;return this.model.set({values:function(){var b,c,d,e;for(d=this.values.where({selected:!0}),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.get("value"));return e}.call(this)})},b.prototype.getData=function(){return{messages:f}},b.prototype.template=j.template("add-value-control"),b.prototype.postRender=function(){return this.$table=this.$("table"),this.renderRows()},b.prototype.renderRows=function(){return this.values.each(function(a){return function(b){return a.renderValue(b)}}(this))},b.prototype.removeValue=function(){return this.removeChild(m.id)},b.prototype.renderValue=function(a){return this.renderChild(a.id,new k({model:a}),this.$table)},b.prototype.remove=function(){return this.values.close(),b.__super__.remove.apply(this,arguments)},b}(o)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../icons":14,"../messages":16,"../options":63,"../patterns":64,"../templates":67,"../templates/mustache-settings":69,"../utils/events":81,backbone:232,underscore:312}],199:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../messages"),c=a("./active-constraint"),d.set({"conbuilder.Apply":"Apply"}),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.set({"new":!0,op:this.model.get("path").isAttribute()?"=":"LOOKUP"}),this.state.set({editing:!0})},b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.addClass("im-new"),this},b}(c)}).call(this)},{"../messages":16,"./active-constraint":112}],200:[function(a,b,c){(function(){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("underscore"),e=a("./modal"),c=a("./constraint-adder"),g=a("../templates"),d=a("../messages"),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype.className=function(){return"im-constraint-dialogue "+b.__super__.className.apply(this,arguments)},b.prototype.modalSize="lg",b.prototype.initialize=function(a){return this.query=a.query,b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.resolve),this.listenTo(this.query,"editing-constraint",function(a){return function(){return a.$(".im-add-constraint").removeClass("disabled")}}(this))},b.prototype.events=function(){return h.extend(b.__super__.events.apply(this,arguments),{"click .im-add-constraint":"addConstraint",childremoved:function(a){return function(b,d){return d instanceof c?a.hide():void 0}}(this)})},b.prototype.title=function(){return d.getText("constraints.AddNewFilter")},b.prototype.primaryAction=function(){return d.getText("constraints.AddFilter")},b.prototype.postRender=function(){var a,d;return d=this.$(".modal-footer"),a=this.$(".modal-body"),this.renderChild("adder",new c({buttonDelegate:d,query:this.query}),a),b.__super__.postRender.apply(this,arguments)},b}(e)}).call(this)},{"../messages":16,"../templates":67,"./constraint-adder":128,"./modal":197,underscore:312}],201:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=function(a,b){return function(){return a.apply(b,arguments)}},m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),e=a("../options"),d=a("../core-view"),c=a("./pathtree/attribute"),i=a("./pathtree/root"),g=a("./pathtree/reference"),h=a("./pathtree/reverse-reference"),j=function(a,b){return a.append(b)},b.exports=f=function(a){function b(){return this.createSubFinder=l(this.createSubFinder,this),b.__super__.constructor.apply(this,arguments)}return n(b,a),b.prototype.parameters=["model","query","chosenPaths","openNodes","view","trail"],b.prototype.tagName="ul",b.prototype.className="im-path-chooser",b.prototype.initialize=function(){var a,c,d,e,f,g,h;for(b.__super__.initialize.apply(this,arguments),this.path=k.last(this.trail)||this.model.get("root")||this.query.makePath(this.query.root),this.cd=this.path.getEndClass(),e=j.bind(null,this.path),h=["attributes","references","collections"],f=0,g=h.length;g>f;f++)c=h[f],this[c]=function(){var b,f;b=this.cd[c],f=[];for(d in b)a=b[d],f.push(e(a));return f}.call(this);return this.listenTo(this.model,"change:allowRevRefs",this.render),this.listenTo(this.openNodes,"reset",this.render)},b.prototype.getDepth=function(){return this.trail.length},b.prototype.showRoot=function(){return 0===this.getDepth()&&this.model.get("canSelectReferences")},b.prototype.events=function(){return{scroll:this.onScroll}},b.prototype.onScroll=function(){var a,b;return this.state.get("ignoreScroll")?void 0:(b=this.el.scrollTop,a=this.state.has("scroll")?Math.abs(this.state.get("scroll")-b):0,0!==b||50>a?this.state.set({scroll:b}):k.defer(function(a){return function(){return a.el.scrollTop=a.state.get("scroll")}}(this)))},b.prototype.startIgnoringScroll=function(){return this.state.set({ignoreScroll:!0})},b.prototype.startListeningForScroll=function(){return this.state.has("scroll")&&(this.el.scrollTop=this.state.get("scroll")),this.state.set({ignoreScroll:!1})},b.prototype.preRender=function(){return this.startIgnoringScroll()},b.prototype.postRender=function(){var a,b,c,d,f,g,h,i,j,k,l;for(f=e.get("ShowId"),this.showRoot()&&(d=this.createRoot(),this.renderChild("root",d)),k=this.attributes,g=0,i=k.length;i>g;g++)b=k[g],(f||"id"!==b.end.name)&&(a=this.createAttribute(b),this.renderChild(b.toString(),a));for(l=this.references.concat(this.collections),h=0,j=l.length;j>h;h++)b=l[h],c=this.createReference(b),
this.renderChild(b.toString(),c);return this.startListeningForScroll()},b.prototype.createRoot=function(){return new i({query:this.query,model:this.model,chosenPaths:this.chosenPaths,openNodes:this.openNodes,cd:this.cd})},b.prototype.createAttribute=function(a){return new c({model:this.model,chosenPaths:this.chosenPaths,view:this.view,query:this.query,trail:this.trail,path:a})},b.prototype.createReference=function(a){var b,c,d;return d=this.isLoop(a),c=this.model.get("allowRevRefs"),new(b=d&&!c?h:g)({model:this.model,chosenPaths:this.chosenPaths,query:this.query,trail:this.trail,path:a,view:this.view,openNodes:this.openNodes,createSubFinder:this.createSubFinder})},b.prototype.createSubFinder=function(a){return new b(k.extend({model:this.model,query:this.query,chosenPaths:this.chosenPaths,view:this.view,openNodes:this.openNodes},a))},b.prototype.isLoop=function(a){return null!=a.end.reverseReference&&this.path.isReference()&&this.path.getParent().isa(a.end.referencedType)&&this.path.end.name===a.end.reverseReference?!0:!1},b}(d)}).call(this)},{"../core-view":3,"../options":63,"./pathtree/attribute":202,"./pathtree/reference":203,"./pathtree/reverse-reference":204,"./pathtree/root":205,underscore:312}],202:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("underscore"),f=a("../../core-view"),e=a("../../options"),d=a("../../icons"),h=function(a){return null!=a&&/\w/.test(a)},i=function(a){return null!=a?a.replace(/^.*\s*>/,""):void 0},g=function(a){return"<strong>"+a+"</strong>"},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.prototype.tagName="li",b.prototype.events=function(){return{"click a":"handleClick"}},b.prototype.initialize=function(a){return this.chosenPaths=a.chosenPaths,this.view=a.view,this.query=a.query,this.path=a.path,this.trail=a.trail,b.__super__.initialize.apply(this,arguments),this.depth=this.trail.length+1,this.state.set({visible:!0,highlitName:null,name:this.path.toString()}),this.listenTo(this.chosenPaths,"add remove reset",this.handleChoice),this.listenTo(this.state,"change:visible",this.onChangeVisible),this.listenTo(this.state,"change:highlitName",this.render),this.listenTo(this.state,"change:displayName",this.render),this.path.getDisplayName().then(function(a){return function(b){return a.state.set({displayName:b,name:i(b)})}}(this))},b.prototype.onChangeVisible=function(){return this.$el.toggle(this.state.get("visible"))},b.prototype.getFilterPatterns=function(){var a,b,c,d,e,f;if(a=this.model.get("filter"),h(a)){for(e=a.split(/\s+/),f=[],c=0,d=e.length;d>c;c++)b=e[c],b&&f.push(new RegExp(b,"i"));return f}return[]},b.prototype.handleClick=function(a){var b;return a.stopPropagation(),a.preventDefault(),this.model.get("dontSelectView")&&(null!=(b=this.view)?b.contains(this.path):void 0)?void 0:this.chosenPaths.contains(this.path)?this.chosenPaths.remove(this.path):this.choose()},b.prototype.choose=function(){return this.model.get("multiSelect")?this.chosenPaths.add(this.path):this.chosenPaths.reset([this.path])},b.prototype.handleChoice=function(){return this.$el.toggleClass("active",this.chosenPaths.contains(this.path))},b.prototype.setHighlitName=function(a){return this.state.has("name")?this.state.set({highlitName:this.getHighlitName(a)}):this.state.once("change:name",function(b){return function(){return b.state.set({highlitName:b.getHighlitName(a)})}}(this))},b.prototype.getHighlitName=function(a){var b,c,d,e,f,h,i;for(c=this.state.get("name"),d=null!=(i=this.path.end)?i.name:void 0,b=c,f=0,h=a.length;h>f;f++)e=a[f],b=b.replace(e,g);return/strong/.test(b)?b:g(b)},b.prototype.getDisabled=function(){return!1},b.prototype.getData=function(){var a,b,c;return c=e.get("ShowId")?""+this.path+" ("+this.path.getType()+")":"",b=this.state.get("highlitName")?this.state.get("highlitName"):this.state.escape("name"),a=d.icon("Attribute"),{icon:a,title:c,name:b}},b.prototype.template=j.template('<a href="#" title="<%- title %>">\n  <%= icon %>\n  <span>\n    <%= name %>\n  </span>\n</a>'),b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.toggleClass("disabled",this.getDisabled()),e.get("ShowId")&&this.$("a").tooltip({placement:"bottom"}),this.handleChoice(),null!=this.view&&this.$el.toggleClass("in-view",this.view.contains(this.path)),this},b}(f)}).call(this)},{"../../core-view":3,"../../icons":14,"../../options":63,underscore:312}],203:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../../icons"),c=a("./attribute"),f=a("../../utils/events").ignore,b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.initialize=function(a){return this.openNodes=a.openNodes,this.createSubFinder=a.createSubFinder,b.__super__.initialize.apply(this,arguments),this.state.set({collapsed:!0}),this.listenTo(this.openNodes,"add remove",this.setCollapsed),this.listenTo(this.state,"change:collapsed",this.onChangeCollapsed),this.setCollapsed()},b.prototype.setCollapsed=function(){var a;return null!=(a=this.state)?a.set({collapsed:!this.openNodes.contains(this.path)}):void 0},b.prototype.handleClick=function(a){return f(a),this.$(a.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.togglePresence(this.path):b.__super__.handleClick.call(this,a)},b.prototype.getData=function(){var a;return a=b.__super__.getData.apply(this,arguments),a.icon=d.icon(this.state.get("collapsed")?"ClosedReference":"OpenReference"),a},b.prototype.postRender=function(){return this.onChangeCollapsed()},b.prototype.onChangeCollapsed=function(){var a,b;return this.state.get("collapsed")?this.removeChild("subfinder"):(b=this.trail.concat([this.path]),a=this.createSubFinder({trail:b}),this.renderChild("subfinder",a))},b}(c)}).call(this)},{"../../icons":14,"../../utils/events":81,"./attribute":202}],204:[function(a,b,c){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../icons"),d=a("./reference"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return g(b,a),b.prototype.className="im-reverse-reference",b.prototype.getData=function(){var a;return a=b.__super__.getData.apply(this,arguments),a.icon+=" "+c.icon("ReverseRef"),a},b.prototype.handleClick=function(a){return a.preventDefault(),a.stopPropagation(),this.$el.tooltip("hide")},b.prototype.render=function(){return b.__super__.render.apply(this,arguments),this.$el.attr({title:"Refers back to "+this.path.getParent().getParent()}).tooltip(),this},b}(d)}).call(this)},{"../../icons":14,"./reference":203}],205:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("../../icons"),c=a("./attribute"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-rootclass",b.prototype.initialize=function(a){var c;return c=a.cd,this.openNodes=a.openNodes,a.trail=[],a.path=a.query.getPathInfo(c.name),b.__super__.initialize.call(this,a)},b.prototype.getData=function(){return f.extend(b.__super__.getData.call(this),{icon:d.icon("RootClass")})},b.prototype.handleClick=function(a){var c,d,e,g,h;return null!=a&&a.preventDefault(),null!=a&&a.stopPropagation(),this.$(a.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.size()?this.openNodes.reset([]):(h=this.path.getType(),c=h.collections,g=h.references,d=function(){var a,b,d,h;for(d=f.values(g).concat(f.values(c)),h=[],a=0,b=d.length;b>a;a++)e=d[a],h.push(this.path.append(e.name));return h}.call(this),this.openNodes.reset(d)):b.__super__.handleClick.call(this,a)},b}(c)}).call(this)},{"../../icons":14,"./attribute":202,underscore:312}],206:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../core-view"),e=a("../templates"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.Dialogue=function(){throw new Error("Not implemented")},b.prototype.longLabel=function(){throw new Error("Not implemented")},b.prototype.shortLabel=function(){throw new Error("Not implemented")},b.prototype.icon=function(){throw new Error("Not implemented")},b.prototype.template=e.template("modal-dialogue-opener"),b.prototype.labels=function(){return{ICON:f.result(this,"icon"),LONG:f.result(this,"longLabel"),SHORT:f.result(this,"shortLabel")}},b.prototype.parameters=["query"],b.prototype.initState=function(){return this.state.set({disabled:!1})},b.prototype.events=function(){return{click:this.onClick}},b.prototype.createDialogue=function(){return new this.Dialogue(this.dialogueOptions())},b.prototype.dialogueOptions=function(){return{query:this.query}},b.prototype.stateEvents=function(){return{"change:disabled":function(){return this.$(".btn.im-open-dialogue").toggleClass("disabled",this.state.get("disabled"))}}},b.prototype.onClick=function(a){var b,c;return this.state.get("disabled")?void 0:(b=this.createDialogue(),this.renderChild("dialogue",b),this.state.set({disabled:!0}),c=function(a){return function(){return a.removeChild("dialogue"),document.body.classList.remove("modal-open"),f.defer(function(){return a.state.set({disabled:!1})})}}(this),b.show().then(c,c))},b}(c)}).call(this)},{"../core-view":3,"../templates":67,underscore:312}],207:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../core-view"),m=k=a("../core/type-assertions"),l=m.UnionOf,h=m.Listenable,j=m.Structure,c=a("./column-manager/button"),e=a("./filter-dialogue/button"),g=a("./join-manager/button"),f=l(h,new j("History",{getCurrentQuery:k.Function})),b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.className="im-query-management",b.prototype.parameters=["history"],b.prototype.parameterTypes={history:f},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.reRender)},b.prototype.renderChildren=function(){var a;return a=this.history.getCurrentQuery(),this.renderChild("cols",new c({query:a})),this.renderChild("cons",new e({query:a})),this.renderChild("joins",new g({query:a}))},b}(d)}).call(this)},{"../core-view":3,"../core/type-assertions":10,"./column-manager/button":119,"./filter-dialogue/button":168,"./join-manager/button":178}],208:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},s=[].slice;p=a("underscore"),c=a("jquery"),f=a("../core-view"),m=a("../templates"),i=a("../options"),j=a("./query-management-tools"),n=a("./undo-history"),h=a("./list-dialogue/button"),e=a("./code-gen-button"),g=a("./export-dialogue/button"),d=a("../utils/events").Bus,l=["im-query-management","im-history","im-query-consumers"],o=function(a){return'<div class="'+a+' clearfix"></div>'},b.exports=k=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.className="im-query-tools",b.prototype.parameters=["tableState","history","selectedObjects"],b.prototype.optionalParameters=["bus","consumerContainer","consumerBtnClass"],b.prototype.bus=new d,b.prototype.template=function(){return l.map(o).join("")},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.renderQueryConsumers)},b.prototype.renderChildren=function(){return this.renderManagementTools(),this.renderUndo(),this.renderQueryConsumers()},b.prototype.renderManagementTools=function(){return this.renderChildAt(".im-query-management",new j({history:this.history}))},b.prototype.renderUndo=function(){var a;return a=this.$(".im-history"),this.renderChild("undo",new n({collection:this.history}),a)},b.prototype.getConsumerContainer=function(){var a;return null!=this.consumerContainer?(this.consumerContainer.classList.add(i.get("StylePrefix")),this.consumerContainer.classList.add("im-query-consumers"),this.$(".im-query-management").addClass("im-has-more-space"),this.$(".im-history").addClass("im-has-more-space"),this.consumerContainer):(a=this.$(".im-query-consumers").empty(),a.length?a:void 0)},b.prototype.renderQueryConsumers=function(){var a,b,c,d,f,i,j,k;if(a=this.getConsumerContainer()){if(d=this.history.getCurrentQuery(),f=this.selectedObjects,c=new h({query:d,tableState:this.tableState,selected:f}),this.listenTo(c,"all",function(a){return function(){var b,c,d,e;return c=arguments[0],b=2<=arguments.length?s.call(arguments,1):[],(d=a.bus).trigger.apply(d,["list-action:"+c].concat(s.call(b))),(e=a.bus).trigger.apply(e,["list-action",c].concat(s.call(b)))}}(this)),this.renderChild("save",new g({query:d,tableState:this.tableState}),a),this.renderChild("code",new e({query:d,tableState:this.tableState}),a),this.renderChild("lists",c,a),this.consumerContainer&&this.consumerBtnClass)for(k=["save","code","lists"],i=0,j=k.length;j>i;i++)b=k[i],this.listenTo(this.children[b],"rendered",this.setButtonStyle);return this.setButtonStyle()}},b.prototype.setButtonStyle=function(){var a,b;return(b=this.consumerContainer)&&(a=this.consumerBtnClass)?c(".btn",b).addClass(a):void 0},b}(f)}).call(this)},{"../core-view":3,"../options":63,"../templates":67,"../utils/events":81,"./code-gen-button":115,"./export-dialogue/button":139,"./list-dialogue/button":186,"./query-management-tools":207,"./undo-history":229,jquery:309,underscore:312}],209:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=function(a,b){return function(){return a.apply(b,arguments)}},A={}.hasOwnProperty,B=function(a,b){function c(){this.constructor=a}for(var d in b)A.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};y=a("underscore"),g=a("../core-view"),k=a("../options"),u=a("../templates"),j=a("../messages"),d=a("../core/collection"),f=a("../core-model"),v=a("../core/type-assertions"),r=a("../models/table"),e=a("../models/column-headers"),x=a("../models/uniq-items"),o=a("../models/rows"),p=a("../models/selected-objects"),i=a("../models/history"),c=a("../utils/cell-model-factory"),s=a("../utils/table-results"),n=a("./table/inner"),h=a("./table/error-notice"),m=a("./table/pagination"),l=a("./table/page-sizer"),t=a("./table/summary"),a("../messages/table"),w={message:"Unknown error",key:"error.Unknown"},b.exports=q=function(a){function b(){return this.canUseFormatter=z(this.canUseFormatter,this),this.unsetSelecting=z(this.unsetSelecting,this),this.setSelecting=z(this.setSelecting,this),b.__super__.constructor.apply(this,arguments)}return B(b,a),b.create=function(a){var c,d,e,f;return e=a.query,d=a.model,v.assertMatch(v.Query,e),null==d&&(d=new r),c=new i,f=new p(e.service),c.setInitialState(e),new b({history:c,model:d,selectedObjects:f})},b.prototype.Model=r,b.prototype.className="im-table-container",b.prototype.parameters=["history","selectedObjects"],b.prototype.optionalParameters=["model","columnHeaders","blacklistedFormatters"],b.prototype.parameterTypes={history:v.InstanceOf(i,"History"),selectedObjects:v.InstanceOf(p,"SelectedObjects")},b.prototype.cellModelFactory=null,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),null==this.columnHeaders&&(this.columnHeaders=new e),null==this.blacklistedFormatters&&(this.blacklistedFormatters=new x),this.rows=new o,this.listenTo(this.history,"changed:current",this.onChangeQuery),this.listenTo(this.blacklistedFormatters,"reset add remove",this.buildColumnHeaders),this.listenTo(this.columnHeaders,"change:minimised",this.onChangeHeaderMinimised),this.onChangeQuery()},b.prototype.onChangeQuery=function(){var a,b,d;return d=this.query=this.history.getCurrentQuery(),b=d.service,a=d.model,null==this.cellModelFactory&&(this.cellModelFactory=new c(b,a)),this.buildColumnHeaders(),this.fetchVersion().then(function(a){return function(){return a.query.count(function(b,c){return a.model.set({error:b,count:c})}),a.setFreshness()}}(this))},b.prototype.fetchVersion=function(){return this.query.service.fetchVersion().then(function(a){return function(b){return a.model.set({version:b})}}(this)).then(null,function(a){return function(a){return onConnectionError(a)}}(this))},b.prototype.onConnectionError=function(a){var b;return b=new Error("Could not connect to server"),b.key="error.ConnectionError",this.model.set({error:b})},b.prototype.modelEvents=function(){return{"change:freshness change:start change:size":this.fillRows,"change:start change:size":this.overlayTable,"change:fill":this.removeOverlay,"change:freshness":this.resetPhase,"change:phase":this.onChangePhase,"change:error":this.onChangeError,"change:count":this.onChangeCount}},b.prototype.onChangePhase=function(){return this.removeOverlay(),this.reRender()},b.prototype.onChangeCount=function(){var a,b,c,d;return d=this.model.pick("start","count","size"),c=d.start,b=d.size,a=d.count,c>=a?this.model.set({start:Math.max(0,a-b)}):void 0},b.prototype.resetPhase=function(){return this.model.set({phase:"FETCHING"})},b.prototype.onChangeError=function(){return this.model.get("error")?this.model.set({phase:"ERROR"}):void 0},b.prototype.remove=function(){return this.cellModelFactory.destroy(),delete this.cellModelFactory,b.__super__.remove.apply(this,arguments)},b.prototype.onChangeHeaderMinimised=function(a){var b,c;return c=this.query.makePath(a.get("path")),b=this.model.get("minimisedColumns"),a.get("minimised")?b.add(c):b.remove(c)},b.prototype.setSelecting=function(){return this.model.set({selecting:!0})},b.prototype.unsetSelecting=function(){return this.model.set({selecting:!1})},b.prototype.canUseFormatter=function(a){return null!=a&&!this.blacklistedFormatters.contains(a)},b.prototype.setFreshness=function(){return this.model.set({freshness:this.query.toXML()})},b.prototype.buildColumnHeaders=function(){var a,b,c;return c={silent:!0},b=this.model.get("minimisedColumns"),a=function(a){return function(c){return b.contains(a.query.makePath(c.get("path")))}}(this),this.columnHeaders.setHeaders(this.query,this.blacklistedFormatters),this.columnHeaders.forEach(function(b){return function(b){return b.set({minimised:a(b)},c)}}(this))},b.prototype.fillRows=function(){var a,b,c,d,e;return e=this.model.pick("start","size"),c=e.start,b=e.size,d=function(a){return function(){return a.model.set({phase:"SUCCESS"})}}(this),a=function(a){return function(b){return null==b&&(b=w),a.model.set({phase:"ERROR",error:b})}}(this),s.getCache(this.query).fetchRows(c,b).then(function(a){return function(b){return a.fillRowsCollection(b)}}(this)).then(d,a).then(this.model.filled,this.model.filled)},b.prototype.fillRowsCollection=function(a){var b,c,d;return b=this.cellModelFactory.getCreator(this.query),d=this.model.get("start"),c=a.map(function(a){return function(c,e){var f;return{id:""+a.query.toXML()+"#"+(d+e),index:d+e,query:a.query.toXML(),cells:function(){var a,d,e;for(e=[],a=0,d=c.length;d>a;a++)f=c[a],e.push(b(f));return e}()}}}(this)),this.rows.set(c)},b.prototype.overlayTable=function(){var a,b,c,d,e;if(null!=(e=this.children.inner)?e.rendered:void 0)return c=this.children.inner.$el,a=this.$el.offset(),d=c.offset(),this.removeOverlay(),this.overlay=document.createElement("div"),this.overlay.className="im-table-overlay im-hidden",b=this.make("h1",{},j.getText("table.OverlayText")),b.style.top=""+c.height()/2+"px",this.overlay.appendChild(b),this.el.appendChild(this.overlay),y.delay(function(a){return function(){var b;return null!=(b=a.overlay)?b.classList.remove("im-hidden"):void 0}}(this),100)},b.prototype.removeOverlay=function(){return null!=this.overlay&&this.el.removeChild(this.overlay),delete this.overlay},b.prototype.template=function(){switch(this.model.get("phase")){case"FETCHING":return this.renderFetching();case"ERROR":return this.renderError();case"SUCCESS":return this.renderTable();default:throw new Error("Unknown phase: "+this.model.get("phase"))}},b.prototype.renderFetching=function(){return u.template("table-building")(this.getBaseData())},b.prototype.renderError=function(){var a;return this.removeChild("error"),this.children.error=a=new h({query:this.query,model:this.model}),a.render().el},b.prototype.renderTable=function(){var a,b;return a=document.createDocumentFragment(),this.renderWidgets(a),b=new n(y.extend(y.pick(this,n.prototype.parameters),{tableState:this.model})),this.renderChild("inner",b,a),a},b.prototype.renderWidgets=function(a){var b,c,d,e,f,g,h;if(null==a&&(a=this.el),f=y.chain(k.get("TableWidgets")).map(function(a,b){var c,d;return c=a.enabled,d=a.index,{name:b,index:d,enabled:c}}).where({enabled:!0}).sortBy("index").pluck("name").value(),f.length){for(d=document.createElement("div"),d.className="im-table-controls",b=document.createElement("div"),b.style.clear="both",g=0,h=f.length;h>g;g++)e=f[g],"place"+e in this&&(c="place"+e,this[c](d));return d.appendChild(b),a.appendChild(d)}},b.prototype.renderWidget=function(a,b,c){var d;return d=new c({model:this.model,getQuery:function(a){return function(){return a.history.getCurrentQuery()}}(this)}),this.renderChild(a,d,b)},b.prototype.placePagination=function(a){return this.renderWidget("pagination",a,m)},b.prototype.placePageSizer=function(a){return this.renderWidget("pagesizer",a,l)},b.prototype.placeTableSummary=function(a){return this.renderWidget("tablesummary",a,t)},b}(g)}).call(this)},{"../core-model":2,"../core-view":3,"../core/collection":5,"../core/type-assertions":10,"../messages":16,"../messages/table":28,"../models/column-headers":39,"../models/history":45,"../models/rows":57,"../models/selected-objects":58,"../models/table":61,"../models/uniq-items":62,"../options":63,"../templates":67,"../utils/cell-model-factory":75,"../utils/table-results":108,"./table/error-notice":214,"./table/inner":217,"./table/page-sizer":220,"./table/pagination":221,"./table/summary":227,underscore:312}],210:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),c=a("../../core-view"),g=a("../../templates"),h=a("../../utils/build-skipset"),a("../../messages/table"),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="tbody",b.prototype.parameters=["makeCell","collection","history"],b.prototype.collectionEvents=function(){return{reset:this.reRender,add:this.onRowAdded,remove:this.onRowRemoved}},b.prototype.template=function(){},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this._skipSets={}},b.prototype.renderChildren=function(){var a;return this.collection.isEmpty()?this.handleEmptyTable():(a=document.createDocumentFragment("tbody"),this.collection.forEach(function(b){return function(c){return b.addRow(c,a)}}(this)),this.el.appendChild(a))},b.prototype.onRowAdded=function(a){return this.removeChild("apology"),this.addRow(a)},b.prototype.onRowRemoved=function(a){return this.removeChild(a.id),this.collection.isEmpty()?this.handleEmptyTable():void 0},b.prototype.addRow=function(a,b){var c,d;return null==b&&(b=this.el),c=this.skipped(a),d=new e({model:a,makeCell:this.makeCell,skipped:c}),this.renderChild(a.id,d,b)},b.prototype.handleEmptyTable=function(){return this.renderChild("apology",new d({history:this.history}))},b.prototype.skipped=function(a){var b,c;return null!=(b=this._skipSets)[c=a.get("query")]?b[c]:b[c]=function(b){return function(){var c,d;return d=a.get("cells").map(b.makeCell),c=h(d),d.forEach(function(a){return a.remove()}),c}}(this)()},b}(c),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="tr",b.prototype.parameters=["makeCell","skipped"],b.prototype.postRender=function(){var a,b,c,d,e,f;for(b=this.model.get("cells").map(this.makeCell),f=[],c=d=0,e=b.length;e>d;c=++d)a=b[c],this.skipped[a.model.get("column")]||f.push(this.renderChild(c,a));return f},b}(c),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return k(b,a),b.prototype.tagName="tr",b.prototype.className="im-empty-apology",b.prototype.template=g.template("no-results"),b.prototype.parameters=["history"],b.prototype.events=function(){return{"click .btn-undo":function(){return this.history.popState()}}},b.prototype.getData=function(){return i.extend(b.__super__.getData.apply(this,arguments),{selectList:this.history.getCurrentQuery().views,canUndo:this.history.length>1})},b}(c)}).call(this)},{"../../core-view":3,"../../messages/table":28,"../../templates":67,"../../utils/build-skipset":72,underscore:312}],211:[function(a,b,c){(function(){var c,d,e;d=a("../../models/nested-table"),e=a("./subtable"),c=a("./cell"),b.exports=function(a,b){var f,g,h;return f=a.root.replace(/\/service\/?$/,""),h=function(a){var c;return c=b.getFormatter(a.get("node"),a.get("column")),null!=c&&b.canUseFormatter(c)?c:null},g=function(f){return f instanceof d?new e({query:b.query,model:f,cellify:g,expandedSubtables:b.expandedSubtables}):new c({model:f,service:a,popovers:b.popoverFactory,selectedObjects:b.selectedObjects,tableState:b.tableState,formatter:h(f)})}}}).call(this)},{"../../models/nested-table":48,"./cell":212,"./subtable":226}],212:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={}.hasOwnProperty,s=function(a,b){function c(){this.constructor=a}for(var d in b)r.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},t=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};p=a("underscore"),d=a("jquery"),g=a("../../core-view"),l=a("../../templates"),j=a("../../options"),i=a("../../messages"),f=a("../../models/cell"),h=a("../../formatting"),i.setWithPrefix("table.cell",{Link:"link",NullEntity:"No <%= type %>",PreviewTitle:function(a){var b;return b=a.types,b.join(j.get("DynamicObjects.NameDelimiter"))}}),k=a("../../models/selected-objects"),o=a("../../core/type-assertions"),n=l.template("classy-popover")({classes:"item-preview"}),q=function(a,b){return null!=b?null!=a.model.findSharedAncestor(a,b):!1},m=p.memoize(q,function(a,b){return""+a+"<"+(null!=b?b:"!")}),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return s(b,a),b.prototype.Model=f,b.prototype.tagName="td",b.prototype.className="im-result-field",b.prototype.id=function(){return p.uniqueId("im_table_cell_")},b.prototype.formatter=h.defaultFormatter,b.prototype.parameters=["model","service","selectedObjects","tableState","popovers"],b.prototype.optionalParameters=["formatter"],b.prototype.parameterTypes={model:o.InstanceOf(f,"models/cell"),selectedObjects:o.InstanceOf(k,"SelectedObjects"),formatter:o.Callable,tableState:o.Model,service:o.Service,popovers:new o.Structure("HasGet",{get:o.Function})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listen()},b.prototype.initState=function(){return this.setSelected(),this.setSelectable(),this.setHighlit(),this.setMinimised()},b.prototype.getPath=function(){return this.model.get("column")},b.prototype.getTypes=function(){var a,b,c,d,e,f;if(c=this.model.get("node"),b=this.model.get("entity").get("classes"),null!=b){for(f=[],d=0,e=b.length;e>d;d++)a=b[d],f.push(c.model.makePath(a));return f}return[c]},b.prototype.listen=function(){return this.listenToEntity(),this.listenToSelectedObjects(),this.listenToOptions(),this.listenToTableState()},b.prototype.listenToOptions=function(){return this.listenTo(j,"change:TableCell.IndicateOffHostLinks",this.reRender),this.listenTo(j,"change:TableCell.ExternalLinkIcons",this.reRender),this.listenTo(j,"change:TableCell.PreviewTrigger",this.onChangeTrigger)},b.prototype.listenToTableState=function(){var a;return a=this.tableState,this.listenTo(a,"change:selecting",this.setInputDisplay),this.listenTo(a,"change:previewOwner",this.closeOwnPreview),this.listenTo(a,"change:highlitNode",this.setHighlit),this.listenTo(a,"change:minimisedColumns",this.setMinimised)},b.prototype.listenToSelectedObjects=function(){var a;return a=this.selectedObjects,this.listenTo(a,"add remove reset",this.setSelected),this.listenTo(a,"add remove reset change:commonType change:node",this.setSelectable)},b.prototype.modelEvents=function(){return{"change:entity":this.onChangeEntity}},b.prototype.stateEvents=function(){return{"change:highlit change:selected":this.setActiveClass,"change:selectable":this.onChangeSelectable,"change:selected":this.setInputChecked,"change:showPreview":this.onChangeShowPreview,"change:minimised":this.reRender}},b.prototype.events=function(){var a,b,c;if(a={"show.bs.popover":this.onShowPreview,"hide.bs.popover":this.onHidePreview,"click a.im-cell-link":this.onClickCellLink},b=j.get("TableCell"),c=b.PreviewTrigger,"hover"===c)a["mouseover .im-cell-link"]=this.showPreview,a["mouseout .im-cell-link"]=this.hidePreview,a.click=this.activateChooser;else{if("click"!==c)throw new Error("Unknown cell preview: "+c);a.click=this.clickTogglePreview}return a},b.prototype.onChangeTrigger=function(){return this.destroyPreview(),this.initPreview(),this.delegateEvents()},b.prototype.onClickCellLink=function(a){var b;return this.tableState.get("selecting")?void a.preventDefault():(b=d.Event("view.im.object"),b.object=this.model.get("entity").toJSON(),this.$el.trigger(b),b.isDefaultPrevented()?a.preventDefault():void 0)},b.prototype.closeOwnPreview=function(){var a,b;return b=this.el.id,a=this.tableState.get("previewOwner"),b!==a?(this.hidePreview(),this._hidePreview()):void 0},b.prototype.listenToEntity=function(){return this.listenTo(this.model.get("entity"),"change",this.updateValue)},b.prototype.onShowPreview=function(){return this.tableState.set({previewOwner:this.el.id})},b.prototype.onHidePreview=function(){var a,b;return b=this.el.id,a=this.tableState.get("previewOwner"),b===a?this.tableState.set({previewOwner:null}):void 0},b.prototype.toggleSelection=function(){var a,b,c,d;if(a=this.model.get("entity"),c=a.get("id"),null!=a){if(b=this.selectedObjects.get(c))return this.selectedObjects.remove(b);if(d=this.getMostSuitableIdentity(),null==d)throw new Error("None of our identities is a compatible");return this.selectedObjects.add(d)}},b.prototype.getMostSuitableIdentity=function(){var a,b,c,d,e,f,g,h;return e=this.model.get("node"),a=e.model.getSubclassesOf(e.getType()),c=this.model.get("entity").get("id"),d=function(){var a,b,d,e;for(d=this.getTypes(),e=[],a=0,b=d.length;b>a;a++)h=d[a],e.push({"class":String(h),id:c});return e}.call(this),this.selectedObjects.isEmpty()?p.find(d,function(b){var c;return c=b["class"],t.call(a,c)>=0}):(b=e.model.makePath(this.selectedObjects.state.get("commonType")),g=p.all(d,function(a){return m(b,a["class"])}),f=p.sortBy(d,function(a){return e.model.getAncestorsOf(a["class"]).length;
}),p.last(f))},b.prototype.setSelected=function(){return this.state.set({selected:null!=this.selectedObjects.get(this.model.get("entity"))})},b.prototype.setSelectable=function(){var a,b,c,d;return a=this.selectedObjects.state.get("commonType"),b=this.selectedObjects.state.get("node"),d=this.selectedObjects.size(),c=(null==b||b===String(this.model.get("node")))&&(0===d||this.isCompatibleWith(a)),this.state.set({selectable:c})},b.prototype.isCompatibleWith=function(a){return this.getTypes().some(function(b){return m(b,a)})},b.prototype.setHighlit=function(){var a,b;return b=this.model.get("node"),a=this.tableState.get("highlitNode"),this.state.set({highlit:null!=a&&String(b)===String(a)})},b.prototype.setMinimised=function(){var a,b;return b=this.model.get("column"),a=this.tableState.get("minimisedColumns").contains(b),this.state.set({minimised:a})},b.prototype.onChangeEntity=function(){var a;return a=this.model.previous("entity"),delete this._has_id,null!=a&&this.stopListening(a),this.listenToEntity()},b.prototype.clickTogglePreview=function(){return this.activateChooser()||this.state.toggle("showPreview")},b.prototype.activateChooser=function(){var a,b;if(this.hasID())return b=this.tableState.get("selecting"),a=this.state.get("selectable"),a&&b?this.toggleSelection():void 0},b.prototype.hasID=function(){return null!=this._has_id?this._has_id:this._has_id=null!=this.model.get("entity").get("id")},b.prototype.showPreview=function(){return this.state.set({showPreview:!0})},b.prototype.hidePreview=function(){return this.state.set({showPreview:!1})},b.prototype._showPreview=function(){var a,b;if(this.rendered){if(this.tableState.get("selecting"))return;return a=j.get("TableCell"),b=function(a){return function(){var b;return a.state.get("showPreview")&&null!=(b=a.children.popover)?b.render():void 0}}(this),"hover"===a.PreviewTrigger?p.delay(b,a.HoverDelay):b()}},b.prototype._hidePreview=function(){var a,b;return(null!=(a=this.children.popover)?a.rendered:void 0)&&null!=(b=this.popoverTarget)?b.popover("hide"):void 0},b.prototype.onChangeShowPreview=function(){return this.state.get("showPreview")?this._showPreview():this._hidePreview()},b.prototype.onChangeSelectable=function(){return this.setDisabledCellClass(),this.setInputDisabled()},b.prototype.updateValue=function(){return p.defer(function(a){return function(){return a.$(".im-displayed-value").html(a.getFormattedValue())}}(this))},b.prototype.setActiveClass=function(){var a,b,c;return c=this.state.pick("highlit","selected"),a=c.highlit,b=c.selected,this.$el.toggleClass("active",a||b)},b.prototype.setInputChecked=function(){return this.$("input").prop({checked:this.getInputState().checked})},b.prototype.setInputDisplay=function(){return this.$("input").css({display:this.getInputState().display})},b.prototype.setDisabledCellClass=function(){return this.$el.toggleClass("im-not-selectable",!this.state.get("selectable"))},b.prototype.setInputDisabled=function(){return this.$("input").prop({disabled:this.getInputState().disabled})},b.prototype.template=l.template("table-cell"),b.prototype.getData=function(){var a,b,d,e,f,g,h;e=j.get("TableCell"),d=e.IndicateOffHostLinks?c.location.host:/.*/,a=this.model.toJSON(),a.formattedValue=this.getFormattedValue(),a.input=this.getInputState(),a.icon=null,a.url=f=a.entity["report:uri"],a.isForeign=f&&!f.match(d),a.target=a.isForeign?"_blank":"",a.NULL_VALUE=l.null_value,h=e.ExternalLinkIcons;for(b in h)g=h[b],(null!=f?f.match(b):void 0)&&null==a.icon&&(a.icon=g);return p.extend(this.getBaseData(),a)},b.prototype.getFormattedValue=function(){var a,b,c;return c=this.model.pick("entity","value"),a=c.entity,b=c.value,null!=b?this.formatter.call(null,a,this.service,b):null},b.prototype.getInputState=function(){var a,b,c,d,e,f,g;return f=this.tableState.get("selecting"),g=this.state.pick("selected","selectable"),e=g.selected,d=g.selectable,a=e,b=!d,c=f?"inline":"none",{checked:a,disabled:b,display:c}},b.prototype.canHavePreview=function(){return this.hasID()&&!this.state.get("minimised")},b.prototype.postRender=function(){return this.setAttrClass(),this.setActiveClass(),this.setMinimisedClass(),this.setDisabledCellClass(),this.setFormatterClasses(),this.initPreview()},b.prototype.setAttrClass=function(){var a,b,c,d,e;if(j.get("TableCell.AddDataClasses")){for(a=this.model.get("column").getType(),this.$el.addClass("im-type-"+a.toLowerCase()),e=this.getTypes(),c=0,d=e.length;d>c;c++)b=e[c],this.$el.addClass(String(b));return this.$el.addClass(this.model.get("column").end.name)}},b.prototype.setMinimisedClass=function(){return this.$el.toggleClass("im-minimised",this.state.get("minimised"))},b.prototype.setFormatterClasses=function(){var a,b;return a=this.formatter.classes,null!=a&&this.$el.addClass(a),b=this.formatter.target,null!=b?this.$el.addClass(b):void 0},b.prototype.getPreviewContainer=function(){var a,b;for(b=[],a=[".im-query-results",".im-table-container",".panel","table","body"];a.length&&0===b.length;)b=this.$el.closest(a.shift());return b},b.prototype.removeAllChildren=function(){return this.destroyPreview(),null!=this.children.popover&&(this.stopListeningTo(this.children.popover),this.children.popover.rendered&&this.$el.popover("destroy")),b.__super__.removeAllChildren.apply(this,arguments)},b.prototype.destroyPreview=function(){var a;return null!=this.children.popover?(this.stopListeningTo(this.children.popover),this.children.popover.rendered&&null!=(a=this.popoverTarget)&&a.popover("destroy"),delete this.popoverTarget,this.removeChild("popover")):void 0},b.prototype.popoverTarget=null,b.prototype.initPreview=function(){var a,b,c;if(null==this.children.popover&&this.canHavePreview())return a=this.popovers.get(this.model.get("entity")),c=j.get("TableCell.PreviewTrigger"),this.popoverTarget="hover"===c?this.$(".im-cell-link"):this.$el,b=i.getText.bind(i,"table.cell.PreviewTitle"),this.listenToOnce(a,"rendered",function(c){return function(){var d;return d=c.getPreviewContainer(),c.popoverTarget.popover({trigger:"manual",template:n,placement:"auto left",container:d,html:!0,title:function(){return b({types:c.model.get("typeNames")})},content:a.el})}}(this)),this.listenTo(a,"rendered",function(a){return function(){return a.popoverTarget.popover("show")}}(this)),this.children.popover=a},b}(g)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":3,"../../core/type-assertions":10,"../../formatting":13,"../../messages":16,"../../models/cell":37,"../../models/selected-objects":58,"../../options":63,"../../templates":67,jquery:309,underscore:312}],213:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("underscore"),e=a("../facets/facet-view"),g=a("../../models/path"),h=a("../../utils/events").ignore,f="No query in call to new DropDownColumnSummary",c="No PathModel in call to new DropDownColumnSummary",b.exports=d=function(a){function b(a){var d,e;if(e=a.query,d=a.model,!e)throw new Error(f);if(!(d instanceof g))throw new Error(c);b.__super__.constructor.call(this,{query:e,view:d.pathInfo()})}return k(b,a),b.prototype.className=function(){return""+b.__super__.className.apply(this,arguments)+" im-dropdown-summary"},b.prototype.events=function(){return i.extend(b.__super__.events.apply(this,arguments),{click:h})},b.prototype.postRender=function(){return b.__super__.postRender.apply(this,arguments),this.$el.addClass(this.className())},b}(e)}).call(this)},{"../../models/path":56,"../../utils/events":81,"../facets/facet-view":151,underscore:312}],214:[function(a,b,c){(function(c){(function(){var d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};p=a("underscore"),k=a("imjs"),g=a("../../options"),d=a("../../core-view"),h=a("../../templates"),f=a("../../messages"),l=a("../../utils/indent-xml"),m=a("../../utils/mailto"),o=a("../../utils/with-cdn-resource"),i=a("../../version"),a("../../messages/error"),n=p.partial(o,"prettify","prettyPrintOne"),j=function(a){return/(Type|Reference)Error/.test(String(a))?"client":"server"},b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.className="im-error-notice",b.prototype.parameters=["model","query"],b.prototype.helpers=function(){return p.extend(b.__super__.helpers.apply(this,arguments),{indent:l})},b.prototype.template=h.template("table-error"),b.prototype.getData=function(){var a,d,e,g,h,l;return e=this.model.get("error"),l=new Date,h=f.getText("error.mail.Subject"),a=this.query.service.help,d=j(e),console.error(e),g=m.href(a,h,"We encountered an error running a query from an\nembedded result table.\n\npage:       "+c.location+"\nservice:    "+this.query.service.root+"\nerror:      "+e+"\ndate-stamp: "+l+"\n\n-------------------------------\nIMJS:       "+k.VERSION+"\n-------------------------------\nIMTABLES:   "+i+"\n-------------------------------\nQUERY:      "+this.query.toXML()+"\n-------------------------------\nSTACK:      "+(null!=e?e.stack:void 0)),p.extend(b.__super__.getData.apply(this,arguments),{domain:d,mailto:g,query:this.query.toXML()})},b.prototype.postRender=function(){var a,b;return b=l(this.query.toXML()),a=this.$(".query-xml"),n(function(c){return a.html(c(p.escape(b)))})},b.prototype.events=function(){return{"click .im-show-query":function(){return this.$(".query-xml").slideToggle(),this.$(".im-show-query").toggleClass("active")},"click .im-show-error":function(){return this.$(".error-message").slideToggle(),this.$(".im-show-error").toggleClass("active")}}},b}(d)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":3,"../../messages":16,"../../messages/error":22,"../../options":63,"../../templates":67,"../../utils/indent-xml":88,"../../utils/mailto":92,"../../utils/with-cdn-resource":110,"../../version":111,imjs:290,underscore:312}],215:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),d=a("../../core-view"),c=a("./header"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.tagName="thead",b.prototype.parameters=["history","expandedSubtables","blacklistedFormatters","columnHeaders"],b.prototype.template=function(){},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.columnHeaders,"add reset sort",this.reRender),this.listenTo(this.columnHeaders,"remove",function(a){return this.removeChild(a.id)}),this},b.prototype.renderChildren=function(){var a,b,c,d;return a=document.createDocumentFragment(),d=document.createElement("tr"),a.appendChild(d),c=this.history.getCurrentQuery(),b={query:c,expandedSubtables:this.expandedSubtables,blacklistedFormatters:this.blacklistedFormatters},this.columnHeaders.each(this.renderHeader(d,b)),this.$el.html(a)},b.prototype.renderHeader=function(a,b){return function(d){return function(e,g){var h;return h=new c(f.extend({model:e},b)),d.renderChild(e.id,h,a)}}(this)},b}(d)}).call(this)},{"../../core-view":3,"./header":216,underscore:312}],216:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=function(a,b){return function(){return a.apply(b,arguments)}},w={}.hasOwnProperty,x=function(a,b){function c(){this.constructor=a}for(var d in b)w.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},y=[].slice;u=a("underscore"),f=a("../../core-view"),d=a("../../core/collection"),o=a("../../templates"),j=a("../../messages"),l=a("../../options"),c=a("../../utils/css-class-set"),t=a("../../utils/sort-query-by-path"),s=a("../../utils/on-change"),i=a("../../models/header"),h=a("../formatted-sorting"),n=a("../constraints/single-column"),g=a("./column-summary"),m=a("./outer-join-summary"),r=a("../../utils/events").ignore,a("../../messages/table"),k=function(a,b){return function(){return a.get(b)}},p=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},q=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},b.exports=e=function(a){function b(){return this.toggleColumnVisibility=v(this.toggleColumnVisibility,this),this.showFilterSummary=v(this.showFilterSummary,this),this.showColumnSummary=v(this.showColumnSummary,this),this.showSummary=v(this.showSummary,this),b.__super__.constructor.apply(this,arguments)}return x(b,a),b.prototype.Model=i,b.prototype.tagName="th",b.prototype.className="im-column-th",b.prototype.RERENDER_EVENT=s(["composed","expanded","minimised","numOfCons","outerJoined","parts","path","sortable","sortDirection"]),b.prototype.template=o.template("column-header"),b.prototype.namePopoverTemplate=o.template("column_name_popover"),b.prototype.parameters=["query"],b.prototype.optionalParameters=["blacklistedFormatters","expandedSubtables"],b.prototype.expandedSubtables=new d,b.prototype.blacklistedFormatters=new d,b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"showing:column-summary",this.removeMySummary),this.listenTo(l,"change:icons",this.reRender),this.createClassSets()},b.prototype.path=function(){return this.model.pathInfo()},b.prototype.createClassSets=function(){return this.classSets={},this.classSets.headerClasses=new c({"im-column-header":!0,"im-minimised-th":k(this.model,"minimised"),"im-is-composed":k(this.model,"composed"),"im-has-constraint":k(this.model,"numOfCons")}),this.classSets.colTitleClasses=new c({"im-col-title":!0,"im-hidden":k(this.model,"minimised")})},b.prototype.removeMySummary=function(a){return a.equals(this.model.pathInfo())?void 0:(this.removeChild("summary"),this.$(".dropdown.open").removeClass("open"))},b.prototype.onSubtableExpanded=function(a){return a.toString().match(this.model.getView())?this.model.set({expanded:!0}):void 0},b.prototype.onSubtableCollapsed=function(a){return a.toString().match(this.model.getView())?this.model.set({expanded:!1}):void 0},b.prototype.getData=function(){var a,d,e,f,g,h,i,j,k;return k=g=this.model.get("parts"),a=3<=k.length?y.call(k,0,j=k.length-2):(j=0,[]),h=k[j++],e=k[j++],d=a.length,f=d?"non-root":"root",i=new c({"im-title-part im-parent":!0,"im-root-parent":!d,"im-non-root-parent":d,"im-last":!e}),u.extend({penultClasses:i,last:e,penult:h},this.classSets,b.__super__.getData.apply(this,arguments))},b.prototype.events=function(){return{"click .im-col-sort":"setSortOrder","click .im-col-minumaximiser":"toggleColumnVisibility","click .im-col-filters":"showFilterSummary","click .im-subtable-expander":this.toggleSubTable,"click .im-col-remover":"removeColumn","hidden.bs.dropdown":function(){return this.removeChild("summary")},"shown.bs.dropdown":"onDropdownShown","toggle .im-th-button":"summaryToggled","click .summary-img":this.showColumnSummary,"click .im-col-composed":this.addFormatterToBlacklist}},b.prototype.postRender=function(){return this.setTitlePopover(),this.announceExpandedState(),this.activateTooltips()},b.prototype.activateTooltips=function(){return this.$(".im-th-button").tooltip({placement:"top",container:this.el})},b.prototype.onDropdownShown=function(a){return u.defer(function(){var b,c;return delete a.target.style.right,b=a.target.getBoundingClientRect(),b.left<0?(c=""+b.left+"px",a.target.style.right=c):void 0})},b.prototype.addFormatterToBlacklist=function(){return this.blacklistedFormatters.add({formatter:this.model.get("formatter")})},b.prototype.announceExpandedState=function(){return this.model.get("expanded")?this.query.trigger("expand:subtables",this.model.get("path")):void 0},b.prototype.setTitlePopover=function(){return l.get("TableHeader.FullPathPopoverEnabled")?this.$(".im-col-title").popover({content:function(a){return function(){return a.namePopoverTemplate(a.getData())}}(this),container:this.el,placement:"bottom",html:!0}):void 0},b.prototype.summaryToggled=function(a,b){return r(a),a.target===a.currentTarget?b?void 0:this.removeChild("summary"):void 0},b.prototype.hideTooltips=function(){return this.$(".im-th-button").tooltip("hide")},b.prototype.removeColumn=function(a){var b,c;return r(a),this.hideTooltips(),c=this.model.getView(),this.query.removeFromSelect(function(){var a,d,e,f;for(e=this.query.views,f=[],a=0,d=e.length;d>a;a++)b=e[a],b.match(c)&&f.push(b);return f}.call(this))},b.prototype.checkHowFarOver=function(a){var b;return b=this.$el.closest(".im-table-container"),a.offset().left+350>=b.offset().left+b.width()?this.$el.addClass("too-far-over"):void 0},b.prototype.showSummary=function(a,b,c){var d,e,f,g,h;if(r(c),e=this.$(a),f=this.path(),e.hasClass("open"))return this.query.trigger("hiding:column-summary",f),e.removeClass("open"),null!=(h=this.children.summary)&&h.$el.hide(),this.removeChild("summary"),!1;if(this.$(".dropdown.open").removeClass("open"),this.query.trigger("showing:column-summary",f),g=new b({query:this.query,model:this.model}),d=this.$(a+" .dropdown-menu"),!d.length)throw new Error(""+a+" not found");return d.empty(),this.renderChild("summary",g,d),e.addClass("open"),this.onDropdownShown({target:d[0]}),!0},b.prototype.ensureDropdownIsWithinTable=function(a,b,c){var d,e,f,g,h;if(null==c&&(c=360),e=a.getBoundingClientRect(),g=this.$el.closest("table")[0],null!=g){if(f=q(),d=this.$(b+" .dropdown-menu"),c>=f)return d.addClass("im-fullwidth-dropdown").css({width:f});if(d.css({width:null}),!(c>=q()))return h=g.getBoundingClientRect(),e.left+c>h.right?this.$(b+" .dropdown-menu").addClass("dropdown-menu-right"):void 0}},b.prototype.showColumnSummary=function(a){var b,c,d;return b=this.model.get("isReference")?m:g,(d=this.showSummary(".im-summary",b,a))?(c=p(),this.$(".im-item-table").css({"max-height":Math.max(350,c/2)}),this.ensureDropdownIsWithinTable(a.target,".im-summary")):void 0},b.prototype.showFilterSummary=function(a){var b;return(b=this.showSummary(".im-filter-summary",n,a))?this.ensureDropdownIsWithinTable(a.target,".im-filter-summary",500):void 0},b.prototype.toggleColumnVisibility=function(a){return r(a),this.model.toggle("minimised")},b.prototype.setSortOrder=function(a){return r(a),this.model.get("replaces").length?this.showSummary(".im-col-sort",h,a):(t(this.query,this.model.getView()),this.$(".im-col-sort").removeClass("open"))},b.prototype.toggleSubTable=function(a){return r(a),this.expandedSubtables.toggle(this.model.pathInfo())},b}(f)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../messages":16,"../../messages/table":28,"../../models/header":44,"../../options":63,"../../templates":67,"../../utils/css-class-set":79,"../../utils/events":81,"../../utils/on-change":93,"../../utils/sort-query-by-path":105,"../constraints/single-column":135,"../formatted-sorting":169,"./column-summary":213,"./outer-join-summary":219,underscore:312}],217:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=function(a,b){return function(){return a.apply(b,arguments)}},u={}.hasOwnProperty,v=function(a,b){function c(){this.constructor=a}for(var d in b)u.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};s=a("underscore"),e=a("../../core-view"),p=a("../../templates"),f=a("../../formatting"),h=a("../../models/path-set"),d=a("../../models/column-headers"),i=a("../../utils/popover-factory"),g=a("../../models/history"),o=a("../../models/table"),l=a("../../models/selected-objects"),j=a("../item-preview"),q=a("../../core/type-assertions"),c=a("./cell-factory"),m=a("./body"),n=a("./head"),r=function(a){return function(b,c){return a(c,b)}},b.exports=k=function(a){function b(){return this.canUseFormatter=t(this.canUseFormatter,this),b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.className="im-results-table table table-striped table-bordered",b.prototype.tagName="table",b.prototype.throbber=p.template("table-throbber"),b.prototype.parameters=["history","columnHeaders","rows","tableState","blacklistedFormatters","selectedObjects"],b.prototype.parameterTypes={history:q.InstanceOf(g,"History"),blacklistedFormatters:q.Collection,rows:q.Collection,tableState:q.InstanceOf(o,"TableModel"),columnHeaders:q.InstanceOf(d,"ColumnHeaders"),selectedObjects:q.InstanceOf(l,"SelectedObjects")},b.prototype.initialize=function(){var a;return b.__super__.initialize.apply(this,arguments),a=(this.query=this.history.getCurrentQuery()).service,this.expandedSubtables=new h,this.popoverFactory=new i(a,j),this.cellFactory=c(a,this),this.listenTo(this.blacklistedFormatters,"reset add remove",this.renderBody),this.listenTo(this.history,"changed:current",this.setQuery)},b.prototype.setQuery=function(){return this.query=this.history.getCurrentQuery()},b.prototype.getFormatter=r(f.getFormatter),b.prototype.canUseFormatter=function(a){return null!=a&&!this.blacklistedFormatters.findWhere({formatter:a})},b.prototype.renderChildren=function(){return this.renderHeaders(),this.renderBody()},b.prototype.renderHeaders=function(){return this.renderChild("head",new n(s.pick(this,n.prototype.parameters)))},b.prototype.renderBody=function(){return this.renderChild("body",new m({collection:this.rows,history:this.history,makeCell:this.cellFactory}))},b.prototype.remove=function(){return this.expandedSubtables.close(),delete this.expandedSubtables,this.popoverFactory.destroy(),delete this.popoverFactory,delete this.cellFactory,b.__super__.remove.apply(this,arguments)},b}(e)}).call(this)},{"../../core-view":3,"../../core/type-assertions":10,"../../formatting":13,"../../models/column-headers":39,"../../models/history":45,"../../models/path-set":55,"../../models/selected-objects":58,"../../models/table":61,"../../templates":67,"../../utils/popover-factory":98,"../item-preview":172,"./body":210,"./cell-factory":211,"./head":215,underscore:312}],218:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),e=a("../modal"),f=a("../../templates").large_table_disuader,c={ACCEPT:"accept",CONSTRAIN:"constrain",BACK:"back",FWD:"forward",EXPORT:"export",DISMISS:"dismiss"},b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.className=function(){return"im-page-size-sanity-check fade "+b.__super__.className.apply(this,arguments)},b.prototype.template=g.template(f),b.prototype.act=function(){return this.resolve("accept")},b.prototype.events=function(){return g.extend(b.__super__.events.apply(this,arguments),{"click .btn-primary":function(a){return function(){return a.resolve(c.ACCEPT)}}(this),"click .add-filter-dialogue":function(a){return function(){return a.resolve(c.CONSTRAIN)}}(this),"click .page-backwards":function(a){return function(){return a.resolve(c.BACK)}}(this),"click .page-forwards":function(a){return function(){return a.resolve(c.FWD)}}(this),"click .download-menu":function(a){return function(){return a.resolve(c.EXPORT)}}(this)})},b}(e)}).call(this)},{"../../templates":67,"../modal":197,underscore:312}],219:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};k=a("underscore"),d=a("../../core-view"),j=a("../../templates"),c=a("../../core/collection"),g=a("../../models/path"),e=a("./column-summary"),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.model=g,b}(c),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["showPathSummary"],b.prototype.className="im-subpath im-outer-joined-path",b.prototype.tagName="li",b.prototype.template=k.template('<a href="#">'+j.column_manager_path_name+"</a>"),b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{click:this.onClick}},b.prototype.onClick=function(a){return a.stopPropagation(),a.preventDefault(),this.showPathSummary(this.model)},b}(d),b.exports=f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query"],b.prototype.className="im-summary-selector",b.prototype.tagName="ul",b.prototype.initialize=function(){var a,c,d,e;for(b.__super__.initialize.apply(this,arguments),this.subColumns=new i,e=this.model.get("replaces"),c=0,d=e.length;d>c;c++)a=e[c],this.subColumns.add(this.query.makePath(a));return this.path=new g(this.query.makePath(this.model.get("path")))},b.prototype.getSubpaths=function(){return this.subColumns},b.prototype.postRender=function(){var a,b;return a=this.getSubpaths(),1===a.length?this.showPathSummary(a.first()):(b=function(a){return function(b){return a.showPathSummary(b)}}(this),this.getSubpaths().each(function(a){return function(c,d){return a.renderChild(d,new h({model:c,showPathSummary:b}))}}(this)))},b.prototype.showPathSummary=function(a){var b;return this.undelegateEvents(),this.removeAllChildren(),b=new e({query:this.query,model:a}),this.children.summ=b,b.setElement(this.el),b.render()},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../models/path":56,"../../templates":67,"./column-summary":213,underscore:312}],220:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};l=a("underscore"),j=a("./paging"),f=a("../has-dialogues"),c=a("../../core-view"),k=a("../../templates"),d=a("../../events"),h=a("../new-filter-dialogue"),e=a("../export-dialogue"),g=a("./large-table-disuader"),b.exports=i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return n(b,a),b.include(j),b.include(f),b.prototype.tagName="form",b.prototype.className="im-page-sizer im-table-control form-inline",b.prototype.sizes=[[10],[25],[50],[100],[250]],b.prototype.parameters=["getQuery"],b.prototype.initialize=function(){var a,c;return b.__super__.initialize.apply(this,arguments),c=this.model.get("size"),null!=c&&o.call(function(){var b,c,d,e;for(d=this.sizes,e=[],b=0,c=d.length;c>b;b++)a=d[b][0],e.push(a);return e}.call(this),c)<0?this.sizes=[[c,c]].concat(this.sizes):void 0},b.prototype.events=function(){return{submit:d.suppress,"change select":"changePageSize"}},b.prototype.modelEvents=function(){return{"change:size":function(a,b){return this.$("select").val(b)},"change:count":this.reRender}},b.prototype.changePageSize=function(a){var b,c,d,f,g;return c=this.$(a.target),g=parseInt(c.val(),10),d=this.model.get("size"),b=function(a){return function(){return a.model.set({size:g})}}(this),this.aboveSizeThreshold(g)?(f=this.whenAcceptable(g).then(function(a){return function(f){if("accept"===f)return b();switch(c.val(d),f){case"back":return a.goBack(1);case"forward":return a.goForward(1);case"constrain":return a.openDialogue(new h({query:a.getQuery()}));case"export":return a.openDialogue(e({query:a.getQuery()}));default:return console.debug("dismissed dialogue",f)}}}(this)),f.then(null,function(a){return console.error("Error handling dialogues",a)})):b()},b.prototype.whenAcceptable=function(a){return this.openDialogue(new g({model:{size:a}}))},b.prototype.template=k.template("page_sizer"),b.prototype.getData=function(){var a,b,c,d,e;return a=this.model.get("count"),d=this.model.get("size"),e=function(){var b,d,e,f;for(e=this.sizes,f=[],b=0,d=e.length;d>b;b++)c=e[b],(null==a||c[0]<a)&&f.push(c);return f}.call(this),e.length&&a<this.sizes[this.sizes.length-1][0]&&(b=l.find(e,function(b){return b[0]===a}),b?b[1]+=b[0]+" (All)":e.push([a,""+a+" (All)"])),{size:d,sizes:e}},b.prototype.pageSizeFeasibilityThreshold=250,b.prototype.aboveSizeThreshold=function(a){var b;return a&&a>=this.pageSizeFeasibilityThreshold?!0:a?!1:(b=this.model.get("count"),b>=this.pageSizeFeasibilityThreshold)},b}(c)}).call(this)},{"../../core-view":3,"../../events":12,"../../templates":67,"../export-dialogue":138,"../has-dialogues":171,"../new-filter-dialogue":200,"./large-table-disuader":218,"./paging":222,underscore:312}],221:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=200,j=a("underscore"),f=a("../../core-view"),d=a("./paging"),h='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',i=function(a){return a.replace(/\s+/g,"")},g=function(a){return"string"==typeof a?parseInt(i(a),10):a},b.exports=c=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return l(b,a),b.include(d),b.prototype.tagName="nav",b.prototype.className="im-table-pagination im-table-control",b.prototype.RERENDER_EVENT="change:start change:count change:size",b.prototype.template=j.template(h),b.prototype.modelEvents=function(){return{"change:count":this.setVisible}},b.prototype.getData=function(){var a,b,c,d,f,g;return g=this.model.toJSON(),f=g.start,d=g.size,a=g.count,c=this.getMaxPage(),b={max:c,min:1,size:d,currentPage:this.getCurrentPage(),gotoStart:0===f?"disabled":void 0,goFiveBack:5*d>f?"disabled":void 0,goOneBack:d>f?"disabled":void 0,gotoEnd:f>=a-d?"disabled":void 0,
goFiveForward:f>=a-6*d?"disabled":void 0,goOneForward:f>=a-d?"disabled":void 0,selected:function(a){return f===a*d},useSelect:e>=c}},b.prototype.postRender=function(){return this.$("li").tooltip({placement:"top"}),this.setVisible()},b.prototype.setVisible=function(){var a;return a=this.getMaxPage(),this.$el.toggleClass("im-hidden",2>a)},b.prototype.events=function(){return{"submit .im-page-form":"pageFormSubmit","click .im-current-page a":"clickCurrentPage","change .im-page-form select":"goToChosenPage","blur .im-page-form input":"pageFormSubmit","click .im-goto-start":function(a){return function(){return a.goTo(0)}}(this),"click .im-go-back-5":function(a){return function(){return a.goBack(5)}}(this),"click .im-go-back-1":function(a){return function(){return a.goBack(1)}}(this),"click .im-go-fwd-5":function(a){return function(){return a.goForward(5)}}(this),"click .im-go-fwd-1":function(a){return function(){return a.goForward(1)}}(this),"click .im-goto-end":function(a){return function(){return a.goTo((a.getMaxPage()-1)*a.model.get("size"))}}(this)}},b.prototype.goToChosenPage=function(a){var b;return b=g(this.$(a.target).val()),this.goTo(b)},b.prototype.clickCurrentPage=function(a){var b,c;return b=this.model.get("size"),c=this.model.get("count"),b>=c?void 0:(this.$(a.target).hide(),this.$("form").show().find("input").focus())},b.prototype.pageFormSubmit=function(a){var b,c,d,e;return null!=a&&a.stopPropagation(),null!=a&&a.preventDefault(),e=this.$(".im-page-form"),c=this.$(".im-page-form input"),c.size()?(b=g(c[0].value),b>=1?(d=Math.min(this.getMaxPage(),b),this.goTo((d-1)*this.model.get("size")),this.$(".im-current-page > a").show(),e.hide()):(e.find(".control-group").addClass("error"),inp.val(null))):void 0},b}(f)}).call(this)},{"../../core-view":3,"./paging":222,underscore:312}],222:[function(a,b,c){(function(){c.getCurrentPage=function(){var a,b,c;return c=this.model.toJSON(),b=c.start,a=c.size,Math.floor(b/a)+1},c.getMaxPage=function(){var a,b,c,d;return d=this.model.toJSON(),b=d.count,c=d.size,a=b%c===0?0:1,Math.floor(b/c)+a},c.goTo=function(a){return this.model.set({start:a})},c.goToPage=function(a){return this.model.set({start:(a-1)*this.model.get("size")})},c.goBack=function(a){var b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,this.goTo(Math.max(0,c-a*b))},c.goForward=function(a){var b,c,d;return d=this.model.toJSON(),c=d.start,b=d.size,this.goTo(Math.min(this.getMaxPage()*b,c+a*b))}}).call(this)},{}],223:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),c=a("../../core-view"),f=a("../../templates"),a("../../messages/subtables"),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.tagName="th",b.prototype.parameters=["columnModel","model","query"],b.prototype.template=f.template("table-subtables-header"),b.prototype.getData=function(){return g.extend(b.__super__.getData.apply(this,arguments),this.columnModel.pick("columnName"))},b.prototype.modelEvents=function(){return{"change:displayName":this.reRender}},b.prototype.events=function(){return{"click a":this.removeView}},b.prototype.removeView=function(){var a;return this.query.removeFromSelect(null!=(a=this.model.get("replaces"))?a:this.model.get("path"))},b.prototype.postRender=function(){return this.$("[title]").tooltip()},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.listenTo(this.columnModel,"change:columnName",this.reRender)},b.prototype.remove=function(){return delete this.columnModel,b.__super__.remove.apply(this,arguments)},b}(c),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.tagName="thead",b.prototype.template=function(){return"<tr></tr>"},b.prototype.parameters=["collection","columnModel","query"],b.prototype.collectionEvents=function(){return{"add remove":this.reRender}},b.prototype.renderChildren=function(){var a;return a=this.el.querySelector("tr"),this.collection.forEach(function(b){return function(c,e){return b.renderChild(e,new d({model:c,query:b.query,columnModel:b.columnModel}),a)}}(this))},b.prototype.remove=function(){return delete this.columnModel,b.__super__.remove.apply(this,arguments)},b}(c)}).call(this)},{"../../core-view":3,"../../messages/subtables":26,"../../templates":67,underscore:312}],224:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("./subtable-header"),f=a("../../utils/build-skipset"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.tagName="table",b.prototype.className="im-subtable table table-condensed table-striped",b.prototype.parameters=["query","headers","model","rows","cellify"],b.prototype.render=function(){var a,b,c,d,e,f;for(this.removeAllChildren(),this.rendered&&(this.el.innerHTML=""),this.headers.length>1&&this.renderHead(),c=document.createElement("tbody"),f=this.rows,a=d=0,e=f.length;e>d;a=++d)b=f[a],this.appendRow(b,a,c);return this.el.appendChild(c),this.trigger("rendered",this.rendered=!0),this},b.prototype.renderHead=function(a){var b;return b=new d({query:this.query,collection:this.headers,columnModel:this.model}),this.renderChild("thead",b,a)},b.prototype.buildSkipped=function(a){return null!=this._skipped?this._skipped:this._skipped=f(a,this.headers)},b.prototype.appendRow=function(a,b,c){var d,e,f,g,h,i,j,k,l;for(i=document.createElement("tr"),c.appendChild(i),f=function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)d=a[b],e.push(this.cellify(d));return e}.call(this),h=this.buildSkipped(f),l=[],g=j=0,k=f.length;k>j;g=++j)e=f[g],h[e.model.get("column")]||l.push(this.renderChild("cell-"+b+"-"+g,e,i));return l},b}(c)}).call(this)},{"../../core-view":3,"../../utils/build-skipset":72,"./subtable-header":223}],225:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};c=a("../../core-view"),d=a("../../messages"),f=a("../../templates"),a("../../messages/subtables"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-subtable-summary",b.prototype.tagName="span",b.prototype.template=f.template("table-subtable-summary"),b.prototype.parameters=["model","state"],b.prototype.modelEvents=function(){return{"change:contentName":this.reRender}},b.prototype.events=function(){return{click:this.onClick}},b.prototype.onClick=function(a){return null!=a&&a.stopPropagation(),this.$el.tooltip("hide"),this.state.toggle("open")},b.prototype.postRender=function(){return this.$el.tooltip({title:this.model.get("rows").length?d.getText("subtables.OpenHint"):void 0,placement:"auto right"})},b}(c)}).call(this)},{"../../core-view":3,"../../messages":16,"../../messages/subtables":26,"../../templates":67}],226:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};p=a("underscore"),d=a("../../core-view"),g=a("../../options"),c=a("../../core/collection"),m=a("../../templates"),n=a("../../core/type-assertions"),f=a("../../models/nested-table"),i=a("../../models/path"),l=a("./subtable-summary"),k=a("./subtable-inner"),o=a("../../utils/events").ignore,h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.model=i,b}(c),e="Subtables.Initially.expanded",b.exports=j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return r(b,a),b.prototype.tagName="td",b.prototype.className="im-result-subtable",b.prototype.Model=f,b.prototype.parameters=["query","cellify","expandedSubtables"],b.prototype.parameterTypes={query:n.Query,cellify:n.Function,expandedSubtables:n.Collection},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.headers=new h,this.listenTo(this.expandedSubtables,"add remove reset",this.onChangeExpandedSubtables),this.buildHeaders()},b.prototype.getPath=function(){return this.model.get("column")},b.prototype.initState=function(){var a;return a=g.get(e)||this.expandedSubtables.contains(this.getPath()),this.state.set({open:a})},b.prototype.stateEvents=function(){return{"change:open":this.onChangeOpen}},b.prototype.onChangeOpen=function(){var a;return a=this.el.querySelector(".im-table-wrapper"),this.state.get("open")?this.renderTable(a)?this.$(a).slideDown():void 0:this.$(a).slideUp()},b.prototype.onChangeExpandedSubtables=function(){return this.state.set({open:this.expandedSubtables.contains(this.getPath())})},b.prototype.template=m.template("table-subtable"),b.prototype.renderChildren=function(){return this.renderChildAt(".im-subtable-summary",new l({model:this.model,state:this.state})),this.onChangeOpen()},b.prototype.tableRendered=!1,b.prototype.renderTable=function(a){var b,c;return c=this.model.get("rows"),this.tableRendered||0===c.length?this.tableRendered:(b=new k(p.extend({rows:c},p.pick(this,k.prototype.parameters))),this.renderChild("inner",b,a),this.tableRendered=!0)},b.prototype.buildHeaders=function(){var a,b;return b=this.model.get("rows")[0],null!=b?this.headers.set(function(){var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(new i(a.get("column")));return e}()):void 0},b}(d)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../core/type-assertions":10,"../../models/nested-table":48,"../../models/path":56,"../../options":63,"../../templates":67,"../../utils/events":81,"./subtable-inner":224,"./subtable-summary":225,underscore:312}],227:[function(a,b,c){(function(){var c,d,e,f,g={}.hasOwnProperty,h=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("underscore"),c=a("../../core-view"),e=a("../../templates"),a("../../messages/table"),b.exports=d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return h(b,a),b.prototype.className="im-table-summary hidden-phone",b.prototype.RERENDER_EVENT="change:start change:size change:count",b.prototype.getData=function(){var a,c,d,e,g;return g=c=b.__super__.getData.apply(this,arguments),e=g.start,d=g.size,a=g.count,f.extend(c,{page:{count:a,first:e+1,last:0===d?0:Math.min(e+d,a)}})},b.prototype.template=e.template("count_summary"),b}(c)}).call(this)},{"../../core-view":3,"../../messages/table":28,"../../templates":67,underscore:312}],228:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l={}.hasOwnProperty,m=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},n=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};k=a("underscore"),d=a("es6-promise").Promise,c=a("../messages"),f=a("../core-view"),c.set({"typeconstraints.BadType":"<%- type %> is not a legal value for this constraint. Choose another from the list.","typeconstraints.OneClass":"<%- name %> is the only legal value this constraint can have. You can always remove it though."}),j=a("../utils/to-named-path"),h=a("../templates/helpers"),i="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",g=function(a){var b,c;return c=a.path,b=a.name,{value:c,text:b}},b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return m(b,a),b.prototype.parameters=["query","model"],b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.model.swap("type",function(a){return function(b){return null!=b?b:a.model.get("path").getType().name}}(this)),this.listenTo(c,"change",this.reRender),this.listenTo(this.state,"change:subclasses",this.reRender),this.setSubclasses()},b.prototype.getData=function(){var a,b,d;return d=this.model.get("type"),a={select:h.select,messages:c,subclasses:function(){var a,c,d,e,f;for(e=null!=(d=this.state.get("subclasses"))?d:[],f=[],a=0,c=e.length;c>a;a++)b=e[a],f.push(g(b));return f}.call(this),isSelected:function(a){return d===a.value}}},b.prototype.events=function(){return{"change .im-value-type":"setType"}},b.prototype.setType=function(){return this.model.set({type:this.$(".im-value-type").val()})},b.prototype.template=k.template(i),b.prototype.setSubclasses=function(){return this.model.has("subclasses")?void 0:this.getPossibleTypes().then(function(a){return function(b){var d;return 1===b.length&&(d=c.getText("typeconstraints.OneClass",b[0]),a.model.set({error:{message:d,level:"warning"}})),a.state.set({subclasses:b})}}(this))},b.prototype.getPossibleTypes=function(){var a,b,e,f,g,h,i,k,l,m;return m=this.model.toJSON(),b=m.path,l=m.type,h=this.query.getSubclasses(),g=this.query.model,delete h[b],a=g.getPathInfo(b.toString(),h).getType(),i=function(){var b,c,d,e;for(d=g.getSubclassesOf(a),e=[],b=0,c=d.length;c>b;b++)k=d[b],k!==a.name&&e.push(k);return e}(),e=function(){var a,b,c;for(c=[],a=0,b=i.length;b>a;a++)k=i[a],c.push(g.makePath(k));return c}(),f=e.map(j),n.call(i,l)<0&&(this.model.set({error:new Error(c.getText("typeconstraints.BadType",this.model.toJSON()))}),f.push(d.resolve({path:l,name:this.model.get("typeName")}))),d.all(f)},b}(f)}).call(this)},{"../core-view":3,"../messages":16,"../templates/helpers":68,"../utils/to-named-path":109,"es6-promise":281,underscore:312}],229:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};m=a("underscore"),c=a("../core-view"),i=a("../templates"),f=a("../messages"),g=a("../options"),h=a("./undo-history/step"),k=function(a){return"state-"+a.get("revision")},d=-1,a("../messages/undo"),e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.parameters=["more"],b.prototype.tagName="li",b.prototype.className="im-step im-ellipsis",b.prototype.template=function(){return m.escape(""+f.getText("undo.MoreSteps",{more:this.more})+" ...")},b.prototype.attributes=function(){return{title:f.getText("undo.ShowAllStates",{n:this.more})}},b.prototype.postRender=function(){return this.$el.tooltip({placement:"right"})},b.prototype.events=function(){return{click:function(a){return a.preventDefault(),a.stopPropagation(),this.state.toggle("showAll")}}},b}(c),l=function(a,b,c){var d;return d=c[b-1],0===b||b===c.length-1||a.get("count")!==d.get("count")},b.exports=j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return o(b,a),b.prototype.parameters=["collection"],b.prototype.className="btn-group im-undo-history",b.prototype.template=i.template("undo-history"),b.prototype.events=function(){return{"click .btn.im-undo":"revertToPreviousState","click .im-toggle-trivial":"toggleTrivial"}},b.prototype.initState=function(){return this.state.set({showAll:!1,hideTrivial:!1})},b.prototype.stateEvents=function(){return{"change:showAll":this.reRender,"change:hideTrivial":this.reRender}},b.prototype.collectionEvents=function(){return{remove:this.removeStep,"add remove":this.reRender,"change:count":this.reRenderIfHidingTrivial}},b.prototype.toggleTrivial=function(a){return a.preventDefault(),a.stopPropagation(),this.state.toggle("hideTrivial")},b.prototype.revertToPreviousState=function(){return this.collection.popState()},b.prototype.reRenderIfHidingTrivial=function(){return this.state.get("hideTrivial")?this.reRender():void 0},b.prototype.postRender=function(){return this.$(".im-toggle-trivial").tooltip({placement:"right"}),this.$list=this.$(".im-state-list"),this.renderStates(),this.$el.toggleClass("im-has-history",this.collection.size()>1),this.$el.toggleClass("im-hidden",this.collection.size()<=1)},b.prototype.renderStates=function(){var a,b,c,e,f,h,i,j,k,m,n,o,p,q,r,s;for(n=this.state.toJSON(),i=n.showAll,c=n.hideTrivial,a=this.collection,f=c?a.filter(l):a.models.slice(),j=f.length,b=g.get("UndoHistory.ShowAllStatesCutOff"),h=i||b>=j?function(){q=[];for(var a=o=j-1;0>=o?0>=a:a>=0;0>=o?a++:a--)q.push(a);return q}.apply(this):function(){r=[];for(var a=p=j-1,c=j-(b-1);c>=p?c>=a:a>=c;c>=p?a++:a--)r.push(a);return r}.apply(this).concat([d,0]),s=[],k=0,m=h.length;m>k;k++)e=h[k],e===d?s.push(this.renderEllipsis(j-b)):s.push(this.renderState(f[e]));return s},b.prototype.renderEllipsis=function(a){return this.renderChild("...",new e({more:a,state:this.state}),this.$list)},b.prototype.renderState=function(a){return this.renderChild(k(a),new h({model:a}),this.$list)},b.prototype.removeStep=function(a){return this.removeChild(k(a))},b}(c)}).call(this)},{"../core-view":3,"../messages":16,"../messages/undo":29,"../options":63,"../templates":67,"./undo-history/step":231,underscore:312}],230:[function(a,b,c){(function(){var c,d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};g=a("underscore"),d=a("../../core-view"),f=a("../../templates"),c=a("../../utils/css-class-set"),b.exports=e=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype.template=f.template("undo-history-step-section"),b.prototype.labelContent=function(){throw new Error("NOT IMPLEMENTED")},b.prototype.summaryLabel=function(){return thow(new Error("NOT IMPLEMENTED"))},b.prototype.initState=function(){return this.state.set({open:!1})},b.prototype.initialize=function(){return b.__super__.initialize.apply(this,arguments),this.collectionClasses=new c({"well well-sm":!0,"im-hidden":function(a){return function(){return!a.state.get("open")}}(this)})},b.prototype.getData=function(){var a,c;return c=g.result(this,"summaryLabel"),a=this.collection.where({removed:!1}).length,g.extend(b.__super__.getData.apply(this,arguments),{count:a,summaryLabel:c,labelContent:this.labelContent,collectionClasses:this.collectionClasses})},b.prototype.events=function(){return{"click .im-section-summary":"toggleOpen"}},b.prototype.stateEvents=function(){return{"change:open":this.reRender}},b.prototype.collectionEvents=function(){return{change:this.reRender}},b.prototype.toggleOpen=function(a){return a.stopPropagation(),a.preventDefault(),this.state.toggle("open")},b}(d)}).call(this)},{"../../core-view":3,"../../templates":67,"../../utils/css-class-set":79,underscore:312}],231:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x={}.hasOwnProperty,y=function(a,b){function c(){this.constructor=a}for(var d in b)x.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},z=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};w=a("underscore"),g=a("../../core-view"),c=a("../../core/collection"),p=a("../../templates"),h=a("../../messages"),k=a("../../models/path"),e=a("../../models/constraint"),j=a("../../models/order-element"),l=a("./query-property-section"),a("../../messages/undo"),a("../../messages/constraints"),v=function(a){var b;return b=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.defaults=function(){return w.extend(b.__super__.defaults.apply(this,arguments),{added:!1,removed:!1})},b}(a)},i=function(a){function b(a){var c;c=a.path,b.__super__.constructor.call(this,c)}return y(b,a),b}(k),r=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.model=v(i),b}(c),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.model=v(e),b}(c),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.model=v(j),b}(c),t=function(a){return function(b){var c;return b=w.isString(b)?{path:b}:b,c={path:a.makePath(b.path)},b.type&&(c.type=a.model.makePath(b.type)),w.extend(c,w.omit(b,"path","type"))}},b.exports=q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.className="im-step",b.prototype.tagName="li",b.prototype.template=p.template("undo-history-step"),b.prototype.getData=function(){return w.extend(b.__super__.getData.apply(this,arguments),{diff:this.getCountDiff()})},b.prototype.getCountDiff=function(){return this.state.has("prevCount")?this.model.get("count")-this.state.get("prevCount"):null},b.prototype.initialize=function(){var a,c,e,f;if(b.__super__.initialize.apply(this,arguments),c=this.model.get("query"),this.initPrevCount(),a=t(c),this.listenTo(this.model.collection,"add remove",this.setCurrent),this.views=new r(c.views.map(a)),this.constraints=new d(c.constraints.map(a)),this.sortOrder=new n(c.sortOrder.map(a)),e=this.model.get("title"),"Added"===(f=e.verb)||"Removed"===f||"Changed"===f)switch(e.label){case"column":return this.diffView();case"sort order element":return this.diffSortOrder();case"filter":return this.diffConstraints();case"Initial":return null;default:return console.error("Cannot diff",e.label)}},b.prototype.initPrevCount=function(){var a;return(a=this.getPrevModel())?(this.state.set({prevCount:a.get("count")}),this.listenTo(a,"change:count",function(b){return function(){return b.state.set({prevCount:a.get("count")})}}(this))):void 0},b.prototype.getPrevModel=function(){var a;return a=this.model.collection.indexOf(this.model),0===a?null:this.model.collection.at(a-1)},b.prototype.diff=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p;for(h=this.getPrevModel(),d=this.model.get("query"),i=h.get("query"),n=d[a],f=j=0,l=n.length;l>j;f=++j)e=n[f],c(e,i)&&b.at(f).set({added:!0});for(g=t(i),o=i[a],p=[],f=k=0,m=o.length;m>k;f=++k)e=o[f],c(e,d)&&p.push(b.add(g(e),{at:f}).set({removed:!0}));return p},b.prototype.diffView=function(){return this.diff("views",this.views,function(a,b){var c;return c=b.views,z.call(c,a)<0})},b.prototype.diffSortOrder=function(){return this.diff("sortOrder",this.sortOrder,function(a,b){return!w.findWhere(b.sortOrder,a)})},b.prototype.diffConstraints=function(){return this.diff("constraints",this.constraints,function(a,b){return!w.findWhere(b.constraints,a)})},b.prototype.initState=function(){return this.setCurrent()},b.prototype.setCurrent=function(){var a,b,c;if(null!=(c=this.model)?c.collection:void 0)return a=this.model.collection.indexOf(this.model),b=this.model.collection.size(),this.state.set({current:a===b-1})},b.prototype.stateEvents=function(){return{change:this.reRender}},b.prototype.modelEvents=function(){return{change:this.reRender}},b.prototype.events=function(){return{"click .btn.im-state-revert":"revertToState",click:function(a){return a.preventDefault(),a.stopPropagation()}}},b.prototype.revertToState=function(){return this.model.collection.revertTo(this.model)},b.prototype.postRender=function(){var a;if(this.$details=this.$(".im-step-details"),this.$el.toggleClass("im-current-state",this.state.get("current")),this.$(".btn[title]").tooltip({placement:"right"}),this.state.get("current"))return this.renderAllSections();switch(a=this.model.get("title"),a.label){case"column":return this.renderViews();case"filter":return this.renderConstraints();case"sort order element":return this.renderSortOrder();case"Initial":return null;default:return console.error("Cannot render",a.label)}},b.prototype.renderAllSections=function(){return this.renderViews(),this.renderConstraints(),this.renderSortOrder()},b.prototype.renderViews=function(){return this.renderChild("views",new m({collection:this.views}),this.$details)},b.prototype.renderSortOrder=function(){return this.renderChild("so",new o({collection:this.sortOrder}),this.$details)},b.prototype.renderConstraints=function(){return this.renderChild("cons",new f({collection:this.constraints}),this.$details)},b}(g),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.summaryLabel="undo.ViewCount",b.prototype.labelContent=function(a){return a.displayName},b}(l),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.summaryLabel="undo.OrderElemCount",b.prototype.labelContent=function(a){return""+a.displayName+" "+a.direction},b}(l),u=function(a){return h.getText("constraints.NoOfValues",{n:a.values.length})},s=function(a){return h.getText("constraints.NoOfIds",{n:a.ids.length})},f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return y(b,a),b.prototype.summaryLabel="undo.ConstraintCount",b.prototype.labelContent=function(a){var b;return b=function(){switch(a.CONSTRAINT_TYPE){case"MULTI_VALUE":return[a.displayName,a.op,a.values.length,u(a)];case"TYPE":return[a.displayName,h.getText("constraints.ISA"),a.typeName];case"IDS":return[a.displayName,a.op,s(a)];case"LOOKUP":return[a.displayName,a.op,a.value,h.getText("constraints.LookupIn"),a.extraValue];default:return[a.displayName,a.op,a.value]}}(),b.join(" ")},b}(l)}).call(this)},{"../../core-view":3,"../../core/collection":5,"../../messages":16,"../../messages/constraints":21,"../../messages/undo":29,"../../models/constraint":40,"../../models/order-element":53,"../../models/path":56,"../../templates":67,"./query-property-section":230,underscore:312}],232:[function(b,c,d){(function(c){!function(e){var f="object"==typeof self&&self.self==self&&self||"object"==typeof c&&c.global==c&&c;if("function"==typeof a&&a.amd)a(["underscore","jquery","exports"],function(a,b,c){f.Backbone=e(f,c,a,b)});else if("undefined"!=typeof d){var g,h=b("underscore");try{g=b("jquery")}catch(i){}e(f,d,h,g)}else f.Backbone=e(f,{},f._,f.jQuery||f.Zepto||f.ender||f.$)}(function(a,b,c,d){var e=a.Backbone,f=[].slice;b.VERSION="1.2.1",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var g=function(a,b,d){switch(a){case 1:return function(){return c[b](this[d])};case 2:return function(a){return c[b](this[d],a)};case 3:return function(a,e){return c[b](this[d],a,e)};case 4:return function(a,e,f){return c[b](this[d],a,e,f)};default:return function(){var a=f.call(arguments);return a.unshift(this[d]),c[b].apply(c,a)}}},h=function(a,b,d){c.each(b,function(b,e){c[e]&&(a.prototype[e]=g(b,e,d))})},i=b.Events={},j=/\s+/,k=function(a,b,d,e,f){var g,h=0;if(d&&"object"==typeof d){void 0!==e&&"context"in f&&void 0===f.context&&(f.context=e);for(g=c.keys(d);h<g.length;h++)b=a(b,g[h],d[g[h]],f)}else if(d&&j.test(d))for(g=d.split(j);h<g.length;h++)b=a(b,g[h],e,f);else b=a(b,d,e,f);return b};i.on=function(a,b,c){return l(this,a,b,c)};var l=function(a,b,c,d,e){if(a._events=k(m,a._events||{},b,c,{context:d,ctx:a,listening:e}),e){var f=a._listeners||(a._listeners={});f[e.id]=e}return a};i.listenTo=function(a,b,d){if(!a)return this;var e=a._listenId||(a._listenId=c.uniqueId("l")),f=this._listeningTo||(this._listeningTo={}),g=f[e];if(!g){var h=this._listenId||(this._listenId=c.uniqueId("l"));g=f[e]={obj:a,objId:e,id:h,listeningTo:f,count:0}}return l(a,b,d,this,g),this};var m=function(a,b,c,d){if(c){var e=a[b]||(a[b]=[]),f=d.context,g=d.ctx,h=d.listening;h&&h.count++,e.push({callback:c,context:f,ctx:f||g,listening:h})}return a};i.off=function(a,b,c){return this._events?(this._events=k(n,this._events,a,b,{context:c,listeners:this._listeners}),this):this},i.stopListening=function(a,b,d){var e=this._listeningTo;if(!e)return this;for(var f=a?[a._listenId]:c.keys(e),g=0;g<f.length;g++){var h=e[f[g]];if(!h)break;h.obj.off(b,d,this)}return c.isEmpty(e)&&(this._listeningTo=void 0),this};var n=function(a,b,d,e){if(a){var f,g=0,h=e.context,i=e.listeners;if(b||d||h){for(var j=b?[b]:c.keys(a);g<j.length;g++){b=j[g];var k=a[b];if(!k)break;for(var l=[],m=0;m<k.length;m++){var n=k[m];d&&d!==n.callback&&d!==n.callback._callback||h&&h!==n.context?l.push(n):(f=n.listening,f&&0===--f.count&&(delete i[f.id],delete f.listeningTo[f.objId]))}l.length?a[b]=l:delete a[b]}return c.size(a)?a:void 0}for(var o=c.keys(i);g<o.length;g++)f=i[o[g]],delete i[f.id],delete f.listeningTo[f.objId]}};i.once=function(a,b,d){var e=k(o,{},a,b,c.bind(this.off,this));return this.on(e,void 0,d)},i.listenToOnce=function(a,b,d){var e=k(o,{},b,d,c.bind(this.stopListening,this,a));return this.listenTo(a,e)};var o=function(a,b,d,e){if(d){var f=a[b]=c.once(function(){e(b,f),d.apply(this,arguments)});f._callback=d}return a};i.trigger=function(a){if(!this._events)return this;for(var b=Math.max(0,arguments.length-1),c=Array(b),d=0;b>d;d++)c[d]=arguments[d+1];return k(p,this._events,a,void 0,c),this};var p=function(a,b,c,d){if(a){var e=a[b],f=a.all;e&&f&&(f=f.slice()),e&&q(e,d),f&&q(f,[b].concat(d))}return a},q=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}};i.bind=i.on,i.unbind=i.off,c.extend(b,i);var r=b.Model=function(a,b){var d=a||{};b||(b={}),this.cid=c.uniqueId(this.cidPrefix),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{}),d=c.defaults({},d,c.result(this,"defaults")),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(r.prototype,i,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},matches:function(a){return!!c.iteratee(a,this)(this.attributes)},set:function(a,b,d){if(null==a)return this;var e;if("object"==typeof a?(e=a,d=b):(e={})[a]=b,d||(d={}),!this._validate(e,d))return!1;var f=d.unset,g=d.silent,h=[],i=this._changing;this._changing=!0,i||(this._previousAttributes=c.clone(this.attributes),this.changed={});var j=this.attributes,k=this.changed,l=this._previousAttributes;this.idAttribute in e&&(this.id=e[this.idAttribute]);for(var m in e)b=e[m],c.isEqual(j[m],b)||h.push(m),c.isEqual(l[m],b)?delete k[m]:k[m]=b,f?delete j[m]:j[m]=b;if(!g){h.length&&(this._pending=d);for(var n=0;n<h.length;n++)this.trigger("change:"+h[n],this,j[h[n]],d)}if(i)return this;if(!g)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b=this._changing?this._previousAttributes:this.attributes,d={};for(var e in a){var f=a[e];c.isEqual(b[e],f)||(d[e]=f)}return c.size(d)?d:!1},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=c.extend({
parse:!0},a);var b=this,d=a.success;return a.success=function(c){var e=a.parse?b.parse(c,a):c;return b.set(e,a)?(d&&d.call(a.context,b,c,a),void b.trigger("sync",b,c,a)):!1},N(this,a),this.sync("read",this,a)},save:function(a,b,d){var e;null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0,parse:!0},d);var f=d.wait;if(e&&!f){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;var g=this,h=d.success,i=this.attributes;d.success=function(a){g.attributes=i;var b=d.parse?g.parse(a,d):a;return f&&(b=c.extend({},e,b)),b&&!g.set(b,d)?!1:(h&&h.call(d.context,g,a,d),void g.trigger("sync",g,a,d))},N(this,d),e&&f&&(this.attributes=c.extend({},i,e));var j=this.isNew()?"create":d.patch?"patch":"update";"patch"!==j||d.attrs||(d.attrs=e);var k=this.sync(j,this,d);return this.attributes=i,k},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=a.wait,f=function(){b.stopListening(),b.trigger("destroy",b,b.collection,a)};a.success=function(c){e&&f(),d&&d.call(a.context,b,c,a),b.isNew()||b.trigger("sync",b,c,a)};var g=!1;return this.isNew()?c.defer(a.success):(N(this,a),g=this.sync("delete",this,a)),e||f(),g},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||M();if(this.isNew())return a;var b=this.get(this.idAttribute);return a.replace(/[^\/]$/,"$&/")+encodeURIComponent(b)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.defaults({validate:!0},a))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return d?(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1):!0}});var s={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};h(r,s,"attributes");var t=b.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},u={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};c.extend(t.prototype,i,{model:r,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,v))},remove:function(a,b){b=c.extend({},b);var d=!c.isArray(a);a=d?[a]:c.clone(a);var e=this._removeModels(a,b);return!b.silent&&e&&this.trigger("update",this,b),d?e[0]:e},set:function(a,b){b=c.defaults({},b,u),b.parse&&!this._isModel(a)&&(a=this.parse(a,b));var d=!c.isArray(a);a=d?a?[a]:[]:a.slice();var e,f,g,h,i,j=b.at;null!=j&&(j=+j),0>j&&(j+=this.length+1);for(var k=this.comparator&&null==j&&b.sort!==!1,l=c.isString(this.comparator)?this.comparator:null,m=[],n=[],o={},p=b.add,q=b.merge,r=b.remove,s=!k&&p&&r?[]:!1,t=!1,v=0;v<a.length;v++){if(g=a[v],h=this.get(g))r&&(o[h.cid]=!0),q&&g!==h&&(g=this._isModel(g)?g.attributes:g,b.parse&&(g=h.parse(g,b)),h.set(g,b),k&&!i&&h.hasChanged(l)&&(i=!0)),a[v]=h;else if(p){if(f=a[v]=this._prepareModel(g,b),!f)continue;m.push(f),this._addReference(f,b)}f=h||f,f&&(e=this.modelId(f.attributes),!s||!f.isNew()&&o[e]||(s.push(f),t=t||!this.models[v]||f.cid!==this.models[v].cid),o[e]=!0)}if(r){for(var v=0;v<this.length;v++)o[(f=this.models[v]).cid]||n.push(f);n.length&&this._removeModels(n,b)}if(m.length||t)if(k&&(i=!0),this.length+=m.length,null!=j)for(var v=0;v<m.length;v++)this.models.splice(j+v,0,m[v]);else{s&&(this.models.length=0);for(var w=s||m,v=0;v<w.length;v++)this.models.push(w[v])}if(i&&this.sort({silent:!0}),!b.silent){for(var x=null!=j?c.clone(b):b,v=0;v<m.length;v++)null!=j&&(x.index=j+v),(f=m[v]).trigger("add",f,this,x);(i||t)&&this.trigger("sort",this,b),(m.length||n.length)&&this.trigger("update",this,b)}return d?a[0]:a},reset:function(a,b){b=b?c.clone(b):{};for(var d=0;d<this.models.length;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a)},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a)},slice:function(){return f.apply(this.models,arguments)},get:function(a){if(null==a)return void 0;var b=this.modelId(this._isModel(a)?a.attributes:a);return this._byId[a]||this._byId[b]||this._byId[a.cid]},at:function(a){return 0>a&&(a+=this.length),this.models[a]},where:function(a,b){var d=c.matches(a);return this[b?"find":"filter"](function(a){return d(a.attributes)})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){a=c.extend({parse:!0},a);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b.call(a.context,d,c,a),d.trigger("sync",d,c,a)},N(this,a),this.sync("read",this,a)},create:function(a,b){b=b?c.clone(b):{};var d=b.wait;if(a=this._prepareModel(a,b),!a)return!1;d||this.add(a,b);var e=this,f=b.success;return b.success=function(a,b,c){d&&e.add(a,c),f&&f.call(c.context,a,b,c)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(a){return a[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(this._isModel(a))return a.collection||(a.collection=this),a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_removeModels:function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.get(a[d]);if(e){var f=this.indexOf(e);this.models.splice(f,1),this.length--,b.silent||(b.index=f,e.trigger("remove",e,this,b)),c.push(e),this._removeReference(e,b)}}return c.length?c:!1},_isModel:function(a){return a instanceof r},_addReference:function(a,b){this._byId[a.cid]=a;var c=this.modelId(a.attributes);null!=c&&(this._byId[c]=a),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){delete this._byId[a.cid];var c=this.modelId(a.attributes);null!=c&&delete this._byId[c],this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if("add"!==a&&"remove"!==a||c===this){if("destroy"===a&&this.remove(b,d),"change"===a){var e=this.modelId(b.previousAttributes()),f=this.modelId(b.attributes);e!==f&&(null!=e&&delete this._byId[e],null!=f&&(this._byId[f]=b))}this.trigger.apply(this,arguments)}}});var w={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:2,contains:2,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3};h(t,w,"models");var x=["groupBy","countBy","sortBy","indexBy"];c.each(x,function(a){c[a]&&(t.prototype[a]=function(b,d){var e=c.isFunction(b)?b:function(a){return a.get(b)};return c[a](this.models,e,d)})});var y=b.View=function(a){this.cid=c.uniqueId("view"),c.extend(this,c.pick(a,A)),this._ensureElement(),this.initialize.apply(this,arguments)},z=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];c.extend(y.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(a){return this.undelegateEvents(),this._setElement(a),this.delegateEvents(),this},_setElement:function(a){this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0]},delegateEvents:function(a){if(a||(a=c.result(this,"events")),!a)return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[d]),d){var e=b.match(z);this.delegate(e[1],e[2],c.bind(d,this))}}return this},delegate:function(a,b,c){return this.$el.on(a+".delegateEvents"+this.cid,b,c),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(a,b,c){return this.$el.off(a+".delegateEvents"+this.cid,b,c),this},_createElement:function(a){return document.createElement(a)},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"));else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a["class"]=c.result(this,"className")),this.setElement(this._createElement(c.result(this,"tagName"))),this._setAttributes(a)}},_setAttributes:function(a){this.$el.attr(a)}}),b.sync=function(a,d,e){var f=B[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||M()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),h?h.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1);var i=e.error;e.error=function(a,b,c){e.textStatus=b,e.errorThrown=c,i&&i.call(e.context,a,b,c)};var j=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,j,e),j};var B={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var C=b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},D=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,F=/\*\w+/g,G=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(C.prototype,i,{initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);f.execute(e,g,d)!==!1&&(f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g))}),this},execute:function(a,b,c){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(G,"\\$&").replace(D,"(?:$1)?").replace(E,function(a,b){return b?a:"([^/?]+)"}).replace(F,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var H=b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,J=/^\/+|\/+$/g,K=/#.*$/;H.started=!1,c.extend(H.prototype,i,{interval:50,atRoot:function(){var a=this.location.pathname.replace(/[^\/]$/,"$&/");return a===this.root&&!this.getSearch()},matchRoot:function(){var a=this.decodeFragment(this.location.pathname),b=a.slice(0,this.root.length-1)+"/";return b===this.root},decodeFragment:function(a){return decodeURI(a.replace(/%25/g,"%2525"))},getSearch:function(){var a=this.location.href.replace(/#.*/,"").match(/\?.+/);return a?a[0]:""},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getPath:function(){var a=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===a.charAt(0)?a.slice(1):a},getFragment:function(a){return null==a&&(a=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),a.replace(I,"")},start:function(a){if(H.started)throw new Error("Backbone.history has already been started");if(H.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window,this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(J,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var b=this.root.slice(0,-1)||"/";return this.location.replace(b+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var d=document.body,e=d.insertBefore(this.iframe,d.firstChild).contentWindow;e.document.open(),e.document.close(),e.location.hash="#"+this.fragment}var f=window.addEventListener||function(a,b){return attachEvent("on"+a,b)};return this._usePushState?f("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?f("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var a=window.removeEventListener||function(a,b){return detachEvent("on"+a,b)};this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&a("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),H.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getHash(this.iframe.contentWindow)),b===this.fragment?!1:(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return this.matchRoot()?(a=this.fragment=this.getFragment(a),c.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})):!1},navigate:function(a,b){if(!H.started)return!1;b&&b!==!0||(b={trigger:!!b}),a=this.getFragment(a||"");var c=this.root;(""===a||"?"===a.charAt(0))&&(c=c.slice(0,-1)||"/");var d=c+a;if(a=this.decodeFragment(a.replace(K,"")),this.fragment!==a){if(this.fragment=a,this._usePushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,d);else{if(!this._wantsHashChange)return this.location.assign(d);if(this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getHash(this.iframe.contentWindow)){var e=this.iframe.contentWindow;b.replace||(e.document.open(),e.document.close()),this._updateHash(e.location,a,b.replace)}}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new H;var L=function(a,b){var d,e=this;d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&c.extend(d.prototype,a),d.__super__=e.prototype,d};r.extend=t.extend=C.extend=y.extend=H.extend=L;var M=function(){throw new Error('A "url" property or function must be specified')},N=function(a,b){var c=b.error;b.error=function(d){c&&c.call(b.context,a,d,b),a.trigger("error",a,d,b)}};return b})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{jquery:309,underscore:312}],233:[function(a,b,c){a("../../js/transition.js"),a("../../js/alert.js"),a("../../js/button.js"),a("../../js/carousel.js"),a("../../js/collapse.js"),a("../../js/dropdown.js"),a("../../js/modal.js"),a("../../js/tooltip.js"),a("../../js/popover.js"),a("../../js/scrollspy.js"),a("../../js/tab.js"),a("../../js/affix.js")},{"../../js/affix.js":234,"../../js/alert.js":235,"../../js/button.js":236,"../../js/carousel.js":237,"../../js/collapse.js":238,"../../js/dropdown.js":239,"../../js/modal.js":240,"../../js/popover.js":241,"../../js/scrollspy.js":242,"../../js/tab.js":243,"../../js/tooltip.js":244,"../../js/transition.js":245}],234:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.4",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return c>e?"top":!1;if("bottom"==this.affixed)return null!=c?e+this.unpin<=f.top?!1:"bottom":a-d>=e+g?!1:"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&c>=e?"top":null!=d&&i+j>=a-d?"bottom":!1},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=a(document.body).height();"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery)},{}],235:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.4",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery)},{}],236:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.4",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?a=!1:b.find(".active").removeClass("active")),a&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));a&&this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target);d.hasClass("btn")||(d=d.closest(".btn")),b.call(d,"toggle"),c.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery)},{}],237:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.4",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery)},{}],238:[function(a,b,c){+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.4",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery)},{}],239:[function(a,b,c){+function(a){"use strict";function b(b){b&&3===b.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=c(d),f={relatedTarget:this};e.hasClass("open")&&(e.trigger(b=a.Event("hide.bs.dropdown",f)),b.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f)))}))}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.4",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(b){if(/(38|40|27|32)/.test(b.which)&&!/input|textarea/i.test(b.target.tagName)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var e=c(d),g=e.hasClass("open");if(!g&&27!=b.which||g&&27==b.which)return 27==b.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find('[role="menu"]'+h+', [role="listbox"]'+h);if(i.length){var j=i.index(b.target);38==b.which&&j>0&&j--,40==b.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',g.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',g.prototype.keydown)}(jQuery)},{}],240:[function(a,b,c){+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){
this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.4",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in").attr("aria-hidden",!1),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a('<div class="modal-backdrop '+e+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery)},{}],241:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.4",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery)},{}],242:[function(a,b,c){+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.4",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery)},{}],243:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.4",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery)},{}],244:[function(a,b,c){+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.init("tooltip",a,b)};c.VERSION="3.3.4",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(this.options.viewport.selector||this.options.viewport),this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c&&c.$tip&&c.$tip.is(":visible")?void(c.hoverState="in"):(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.options.container?a(this.options.container):this.$element.parent(),p=this.getPosition(o);h="bottom"==h&&k.bottom+m>p.bottom?"top":"top"==h&&k.top-m<p.top?"bottom":"right"==h&&k.right+l>p.width?"left":"left"==h&&k.left-l<p.left?"right":h,f.removeClass(n).addClass(h)}var q=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(q,h);var r=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",r).emulateTransitionEnd(c.TRANSITION_DURATION):r()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top=b.top+g,b.left=b.left+h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.width&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type)})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery)},{}],245:[function(a,b,c){+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery)},{}],246:[function(a,b,c){},{}],247:[function(a,b,c){b.exports=a(246)},{"/home/josh/src/im-tables/node_modules/browserify/lib/_empty.js":246}],248:[function(a,b,c){function d(a){return this instanceof d?(this.length=0,this.parent=void 0,"number"==typeof a?e(this,a):"string"==typeof a?f(this,a,arguments.length>1?arguments[1]:"utf8"):g(this,a)):arguments.length>1?new d(a,arguments[1]):new d(a)}function e(a,b){if(a=m(a,0>b?0:0|n(b)),!d.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function f(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|p(b,c);return a=m(a,d),a.write(b,c),a}function g(a,b){if(d.isBuffer(b))return h(a,b);if(U(b))return i(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&b.buffer instanceof ArrayBuffer?j(a,b):b.length?k(a,b):l(a,b)}function h(a,b){var c=0|n(b.length);return a=m(a,c),b.copy(a,0,0,c),a}function i(a,b){var c=0|n(b.length);a=m(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function j(a,b){var c=0|n(b.length);a=m(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function k(a,b){var c=0|n(b.length);a=m(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){var c,d=0;"Buffer"===b.type&&U(b.data)&&(c=b.data,d=0|n(c.length)),a=m(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function m(a,b){d.TYPED_ARRAY_SUPPORT?a=d._augment(new Uint8Array(b)):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=d.poolSize>>>1;return c&&(a.parent=W),a}function n(a){if(a>=V)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+V.toString(16)+" bytes");return 0|a}function o(a,b){if(!(this instanceof o))return new o(a,b);var c=new d(a,b);return delete c.parent,c}function p(a,b){if("string"!=typeof a&&(a=String(a)),0===a.length)return 0;switch(b||"utf8"){case"ascii":case"binary":case"raw":return a.length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a.length;case"hex":return a.length>>>1;case"utf8":case"utf-8":return M(a).length;case"base64":return P(a).length;default:return a.length}}function q(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function r(a,b,c,d){return Q(M(b,a.length-c),a,c,d)}function s(a,b,c,d){return Q(N(b),a,c,d)}function t(a,b,c,d){return s(a,b,c,d)}function u(a,b,c,d){return Q(P(b),a,c,d)}function v(a,b,c,d){return Q(O(b,a.length-c),a,c,d)}function w(a,b,c){return 0===b&&c===a.length?S.fromByteArray(a):S.fromByteArray(a.slice(b,c))}function x(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=R(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+R(e)}function y(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function z(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function A(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=L(a[f]);return e}function B(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function C(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function D(a,b,c,e,f,g){if(!d.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new RangeError("value is out of bounds");if(c+e>a.length)throw new RangeError("index out of range")}function E(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function F(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function G(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function H(a,b,c,d,e){return e||G(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),T.write(a,b,c,d,23,4),c+4}function I(a,b,c,d,e){return e||G(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),T.write(a,b,c,d,52,8),c+8}function J(a){if(a=K(a).replace(Y,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function K(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function L(a){return 16>a?"0"+a.toString(16):a.toString(16)}function M(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536,e=null}else e&&((b-=3)>-1&&f.push(239,191,189),e=null);if(128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(2097152>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function N(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function O(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function P(a){return S.toByteArray(J(a))}function Q(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function R(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}var S=a("base64-js"),T=a("ieee754"),U=a("is-array");c.Buffer=d,c.SlowBuffer=o,c.INSPECT_MAX_BYTES=50,d.poolSize=8192;var V=1073741823,W={};d.TYPED_ARRAY_SUPPORT=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(c){return!1}}(),d.isBuffer=function(a){return!(null==a||!a._isBuffer)},d.compare=function(a,b){if(!d.isBuffer(a)||!d.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,e=b.length,f=0,g=Math.min(c,e);g>f&&a[f]===b[f];)++f;return f!==g&&(c=a[f],e=b[f]),e>c?-1:c>e?1:0},d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(a,b){if(!U(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new d(0);if(1===a.length)return a[0];var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.byteLength=p,d.prototype.length=void 0,d.prototype.parent=void 0,d.prototype.toString=function(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return A(this,b,c);case"utf8":case"utf-8":return x(this,b,c);case"ascii":return y(this,b,c);case"binary":return z(this,b,c);case"base64":return w(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}},d.prototype.equals=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===d.compare(this,a)},d.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},d.prototype.compare=function(a){if(!d.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:d.compare(this,a)},d.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(d.isBuffer(a))return c(this,a,b);if("number"==typeof a)return d.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return q(this,a,b,c);case"utf8":case"utf-8":return r(this,a,b,c);case"ascii":return s(this,a,b,c);case"binary":return t(this,a,b,c);case"base64":return u(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var e;if(d.TYPED_ARRAY_SUPPORT)e=d._augment(this.subarray(a,b));else{var f=b-a;e=new d(f,void 0);for(var g=0;f>g;g++)e[g]=this[g+a]}return e.length&&(e.parent=this.parent||this),e},d.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||C(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},d.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||C(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},d.prototype.readUInt8=function(a,b){return b||C(a,1,this.length),this[a]},d.prototype.readUInt16LE=function(a,b){return b||C(a,2,this.length),this[a]|this[a+1]<<8},d.prototype.readUInt16BE=function(a,b){return b||C(a,2,this.length),this[a]<<8|this[a+1]},d.prototype.readUInt32LE=function(a,b){return b||C(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},d.prototype.readUInt32BE=function(a,b){return b||C(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},d.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||C(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},d.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||C(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},d.prototype.readInt8=function(a,b){return b||C(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},d.prototype.readInt16LE=function(a,b){b||C(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c;
},d.prototype.readInt16BE=function(a,b){b||C(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},d.prototype.readInt32LE=function(a,b){return b||C(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},d.prototype.readInt32BE=function(a,b){return b||C(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},d.prototype.readFloatLE=function(a,b){return b||C(a,4,this.length),T.read(this,a,!0,23,4)},d.prototype.readFloatBE=function(a,b){return b||C(a,4,this.length),T.read(this,a,!1,23,4)},d.prototype.readDoubleLE=function(a,b){return b||C(a,8,this.length),T.read(this,a,!0,52,8)},d.prototype.readDoubleBE=function(a,b){return b||C(a,8,this.length),T.read(this,a,!1,52,8)},d.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||D(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},d.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||D(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},d.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,1,255,0),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},d.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):E(this,a,b,!0),b+2},d.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):E(this,a,b,!1),b+2},d.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):F(this,a,b,!0),b+4},d.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):F(this,a,b,!1),b+4},d.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);D(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},d.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);D(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},d.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,1,127,-128),d.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},d.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):E(this,a,b,!0),b+2},d.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):E(this,a,b,!1),b+2},d.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):F(this,a,b,!0),b+4},d.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||D(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),d.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):F(this,a,b,!1),b+4},d.prototype.writeFloatLE=function(a,b,c){return H(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){return H(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){return I(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){return I(this,a,b,!1,c)},d.prototype.copy=function(a,b,c,e){if(c||(c=0),e||0===e||(e=this.length),b>=a.length&&(b=a.length),b||(b=0),e>0&&c>e&&(e=c),e===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>e)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);var f=e-c;if(1e3>f||!d.TYPED_ARRAY_SUPPORT)for(var g=0;f>g;g++)a[g+b]=this[g+c];else a._set(this.subarray(c,c+f),b);return f},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=M(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d.TYPED_ARRAY_SUPPORT)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var X=d.prototype;d._augment=function(a){return a.constructor=d,a._isBuffer=!0,a._set=a.set,a.get=X.get,a.set=X.set,a.write=X.write,a.toString=X.toString,a.toLocaleString=X.toString,a.toJSON=X.toJSON,a.equals=X.equals,a.compare=X.compare,a.indexOf=X.indexOf,a.copy=X.copy,a.slice=X.slice,a.readUIntLE=X.readUIntLE,a.readUIntBE=X.readUIntBE,a.readUInt8=X.readUInt8,a.readUInt16LE=X.readUInt16LE,a.readUInt16BE=X.readUInt16BE,a.readUInt32LE=X.readUInt32LE,a.readUInt32BE=X.readUInt32BE,a.readIntLE=X.readIntLE,a.readIntBE=X.readIntBE,a.readInt8=X.readInt8,a.readInt16LE=X.readInt16LE,a.readInt16BE=X.readInt16BE,a.readInt32LE=X.readInt32LE,a.readInt32BE=X.readInt32BE,a.readFloatLE=X.readFloatLE,a.readFloatBE=X.readFloatBE,a.readDoubleLE=X.readDoubleLE,a.readDoubleBE=X.readDoubleBE,a.writeUInt8=X.writeUInt8,a.writeUIntLE=X.writeUIntLE,a.writeUIntBE=X.writeUIntBE,a.writeUInt16LE=X.writeUInt16LE,a.writeUInt16BE=X.writeUInt16BE,a.writeUInt32LE=X.writeUInt32LE,a.writeUInt32BE=X.writeUInt32BE,a.writeIntLE=X.writeIntLE,a.writeIntBE=X.writeIntBE,a.writeInt8=X.writeInt8,a.writeInt16LE=X.writeInt16LE,a.writeInt16BE=X.writeInt16BE,a.writeInt32LE=X.writeInt32LE,a.writeInt32BE=X.writeInt32BE,a.writeFloatLE=X.writeFloatLE,a.writeFloatBE=X.writeFloatBE,a.writeDoubleLE=X.writeDoubleLE,a.writeDoubleBE=X.writeDoubleBE,a.fill=X.fill,a.inspect=X.inspect,a.toArrayBuffer=X.toArrayBuffer,a};var Y=/[^+\/0-9A-z\-]/g},{"base64-js":249,ieee754:250,"is-array":251}],249:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],250:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],251:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],252:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],253:[function(a,b,c){var d=b.exports,e=(a("events").EventEmitter,a("./lib/request")),f=a("url");d.request=function(a,b){"string"==typeof a&&(a=f.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.protocol||(a.scheme?a.protocol=a.scheme+":":a.protocol=window.location.protocol),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https:"==a.protocol?443:80);var c=new e(new g,a);return b&&c.on("response",b),c},d.get=function(a,b){a.method="GET";var c=d.request(a,b);return c.end(),c},d.Agent=function(){},d.Agent.defaultMaxSockets=4;var g=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();d.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":254,events:252,url:277}],254:[function(a,b,c){var d=a("stream"),e=a("./response"),f=a("Base64"),g=a("inherits"),h=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.protocol||"http:")+"//"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),"undefined"==typeof b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(d){}if(b.responseType)try{a.responseType=b.responseType}catch(d){}if(a.open(b.method||"GET",c.uri,!0),a.onerror=function(a){c.emit("error",new Error("Network error"))},c._headers={},b.headers)for(var g=i(b.headers),h=0;h<g.length;h++){var j=g[h];if(c.isSafeRequestHeader(j)){var k=b.headers[j];c.setHeader(j,k)}}b.auth&&this.setHeader("Authorization","Basic "+f.btoa(b.auth));var l=new e;l.on("close",function(){c.emit("close")}),l.on("ready",function(){c.emit("response",l)}),l.on("error",function(a){c.emit("error",a)}),a.onreadystatechange=function(){a.__aborted||l.handle(a)}};g(h,d),h.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},h.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},h.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},h.prototype.write=function(a){this.body.push(a)},h.prototype.destroy=function(a){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},h.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=i(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(j(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(j(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var h=0,c=0;c<this.body.length;c++)h+=this.body[c].length;for(var g=new this.body[0].constructor(h),k=0,c=0;c<this.body.length;c++)for(var m=this.body[c],f=0;f<m.length;f++)g[k++]=m[f];this.xhr.send(g)}else if(l(this.body[0]))this.xhr.send(this.body[0]);else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},h.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],h.prototype.isSafeRequestHeader=function(a){return a?-1===k(h.unsafeHeaders,a.toLowerCase()):!1};var i=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},l=function(a){return"undefined"!=typeof Blob&&a instanceof Blob?!0:"undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer?!0:"undefined"!=typeof FormData&&a instanceof FormData?!0:void 0}},{"./response":255,Base64:256,inherits:257,stream:275}],255:[function(a,b,c){function d(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),h=f[2];void 0!==c[g]?i(c[g])?c[g].push(h):c[g]=[c[g],h]:c[g]=h}else c[e]=!0}}return c}var e=a("stream"),f=a("util"),g=b.exports=function(a){this.offset=0,this.readable=!0};f.inherits(g,e);var h={streaming:!0,status2:!0};g.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},g.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},g.prototype.handle=function(a){if(2===a.readyState&&h.status2){try{this.statusCode=a.status,this.headers=d(a)}catch(b){h.status2=!1}h.status2&&this.emit("ready")}else if(h.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=d(a),this.emit("ready"))}catch(b){}try{this._emitData(a)}catch(b){h.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},g.prototype._emitData=function(a){var b=this.getResponse(a);return b.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength)):void(b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length))};var i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:275,util:279}],256:[function(a,b,c){!function(){function a(a){this.message=a}var b="undefined"!=typeof c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],257:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],258:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],259:[function(a,b,c){function d(){}var e=b.exports={};e.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.binding=function(a){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],260:[function(b,c,d){(function(b){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function h(a,b){return g(a.split(H),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d,s="object"==typeof c&&c&&c.exports==r&&c,t="object"==typeof b&&b;(t.global===t||t.window===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.2.4",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&!r.nodeType)if(s)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],261:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],262:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],263:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":261,"./encode":262}],264:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":265}],265:[function(a,b,c){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("_process"))},{"./_stream_readable":267,"./_stream_writable":269,_process:259,"core-util-is":270,inherits:257}],266:[function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":268,"core-util-is":270,inherits:257}],267:[function(a,b,c){(function(c){function d(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.readableObjectMode),this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(b){a("./_stream_duplex");return this instanceof e?(this._readableState=new d(b,this),this.readable=!0,void A.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(B.isNullOrUndefined(c))b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=E)a=E;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||B.isNull(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||B.isString(b)||B.isNullOrUndefined(b)||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(D("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){D("emit readable"),a.emit("readable"),s(a)}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(D("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;D("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&z.listenerCount(a,"data")&&(b.flowing=!0,s(a))}}function q(a,b){b.resumeScheduled||(b.resumeScheduled=!0,c.nextTick(function(){r(a,b)}))}function r(a,b){b.resumeScheduled=!1,a.emit("resume"),s(a),b.flowing&&!b.reading&&a.read(0)}function s(a){var b=a._readableState;if(D("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C,D=a("util");D=D&&D.debuglog?D.debuglog("stream"):function(){},B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return B.isString(a)&&!c.objectMode&&(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0);
},e.prototype.setEncoding=function(b){return C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b,this};var E=8388608;e.prototype.read=function(a){D("read",a);var b=this._readableState,c=a;if((!B.isNumber(a)||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return D("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?u(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;D("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,D("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,D("reading or ended",d)),d&&(D("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,B.isNull(e)&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&u(this),B.isNull(e)||this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){D("onunpipe"),a===l&&f()}function e(){D("onend"),a.end()}function f(){D("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){D("ondata");var c=a.write(b);!1===c&&(D("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){D("onerror",b),k(),a.removeListener("error",h),0===z.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){D("onfinish"),a.removeListener("close",i),k()}function k(){D("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,D("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?c.nextTick(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(D("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var d=A.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var e=this._readableState;if(!e.readableListening)if(e.readableListening=!0,e.emittedReadable=!1,e.needReadable=!0,e.reading)e.length&&l(this,e);else{var f=this;c.nextTick(function(){D("readable nexttick read 0"),f.read(0)})}}return d},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(D("resume"),a.flowing=!0,a.reading||(D("resume read 0"),this.read(0)),q(this,a)),this},e.prototype.pause=function(){return D("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(D("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(D("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(D("wrapped data"),b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)B.isFunction(a[e])&&B.isUndefined(this[e])&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){D("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("_process"))},{"./_stream_duplex":265,_process:259,buffer:248,"core-util-is":270,events:252,inherits:257,isarray:258,stream:275,"string_decoder/":276,util:247}],268:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,i.isNullOrUndefined(c)||a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(a,this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){i.isFunction(this._flush)?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;i.isNull(b.writechunk)||!b.writecb||b.transforming?b.needTransform=!0:(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform))}},{"./_stream_duplex":265,"core-util-is":270,inherits:257}],269:[function(a,b,c){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(b,c){var d=a("./_stream_duplex");b=b||{};var e=b.highWaterMark,f=b.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=b.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(c,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void x.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!(w.isBuffer(d)||w.isString(d)||w.isNullOrUndefined(d)||b.objectMode)){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return!a.objectMode&&a.decodeStrings!==!1&&w.isString(b)&&(b=new v(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),w.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing||b.corked?b.buffer.push(new d(c,e,f)):k(a,b,!1,g,c,e,f),h}function k(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){b.pendingcb--,f(e)}):(b.pendingcb--,f(e)),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.corked||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),b.pendingcb--,d(),t(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){if(b.bufferProcessing=!0,a._writev&&b.buffer.length>1){for(var c=[],d=0;d<b.buffer.length;d++)c.push(b.buffer[d].callback);b.pendingcb++,k(a,b,!0,b.length,b.buffer,"",function(a){for(var d=0;d<c.length;d++)b.pendingcb--,c[d](a)}),b.buffer=[]}else{for(var d=0;d<b.buffer.length;d++){var e=b.buffer[d],f=e.chunk,g=e.encoding,h=e.callback,i=b.objectMode?1:f.length;if(k(a,b,!1,i,f,g,h),b.writing){d++;break}}d<b.buffer.length?b.buffer=b.buffer.slice(d):b.buffer.length=0}b.bufferProcessing=!1}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function t(a,b){var c=r(a,b);return c&&(0===b.pendingcb?(s(a,b),b.finished=!0,a.emit("finish")):s(a,b)),c}function u(a,b,d){b.ending=!0,t(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var v=a("buffer").Buffer;f.WritableState=e;var w=a("core-util-is");w.inherits=a("inherits");var x=a("stream");w.inherits(f,x),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return w.isFunction(b)&&(c=b,b=null),w.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),w.isFunction(c)||(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(d.pendingcb++,e=j(this,d,a,b,c)),e},f.prototype.cork=function(){var a=this._writableState;a.corked++},f.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.buffer.length||q(this,a))},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype._writev=null,f.prototype.end=function(a,b,c){var d=this._writableState;w.isFunction(a)?(c=a,a=null,b=null):w.isFunction(b)&&(c=b,b=null),w.isNullOrUndefined(a)||this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||u(this,d,c)}}).call(this,a("_process"))},{"./_stream_duplex":265,_process:259,buffer:248,"core-util-is":270,inherits:257,stream:275}],270:[function(a,b,c){(function(a){function b(a){return Array.isArray(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return l(a)&&"[object RegExp]"===r(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return l(a)&&"[object Date]"===r(a)}function n(a){return l(a)&&("[object Error]"===r(a)||a instanceof Error)}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(b){return a.isBuffer(b)}function r(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=q}).call(this,a("buffer").Buffer)},{buffer:248}],271:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":266}],272:[function(a,b,c){c=b.exports=a("./lib/_stream_readable.js"),c.Stream=a("stream"),c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":265,"./lib/_stream_passthrough.js":266,"./lib/_stream_readable.js":267,"./lib/_stream_transform.js":268,"./lib/_stream_writable.js":269,stream:275}],273:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":268}],274:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":269}],275:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:252,inherits:257,"readable-stream/duplex.js":264,"readable-stream/passthrough.js":271,"readable-stream/readable.js":272,"readable-stream/transform.js":273,"readable-stream/writable.js":274}],276:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:248}],277:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:260,querystring:263}],278:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],279:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":278,_process:259,inherits:257}],280:[function(a,b,c){b.exports=function(){function a(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function b(a){return null!=a&&!isNaN(a)}function c(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function d(a){return a.length}function e(a){for(var b=1;a*b%1;)b*=10;return b}function f(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function g(){}function h(a){return fg+a in this}function i(a){return a=fg+a,a in this&&delete this[a]}function j(){var a=[];return this.forEach(function(b){a.push(b)}),a}function k(){var a=0;for(var b in this)b.charCodeAt(0)===gg&&++a;return a}function l(){for(var a in this)if(a.charCodeAt(0)===gg)return!1;return!0}function m(){}function n(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function o(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.substring(1);for(var c=0,d=hg.length;d>c;++c){var e=hg[c]+b;if(e in a)return e}}function p(){}function q(){}function r(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new g;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function s(){Sf.event.preventDefault()}function t(){for(var a,b=Sf.event;a=b.sourceEvent;)b=a;return b}function u(a){for(var b=new q,c=0,d=arguments.length;++c<d;)b[arguments[c]]=r(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=Sf.event;e.target=a,Sf.event=e,b[e.type].apply(c,d)}finally{Sf.event=f}}},b}function v(a){return jg(a,og),a}function w(a){return"function"==typeof a?a:function(){return kg(a,this)}}function x(a){return"function"==typeof a?a:function(){return lg(a,this)}}function y(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local);
}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=Sf.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function z(a){return a.trim().replace(/\s+/g," ")}function A(a){return new RegExp("(?:^|\\s+)"+Sf.requote(a)+"(?:\\s+|$)","g")}function B(a){return(a+"").trim().split(/^|\s+/)}function C(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=B(a).map(D);var e=a.length;return"function"==typeof b?d:c}function D(a){var b=A(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",z(e+" "+a))):c.setAttribute("class",z(e.replace(b," ")))}}function E(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function F(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function G(a){return"function"==typeof a?a:(a=Sf.ns.qualify(a)).local?function(){return this.ownerDocument.createElementNS(a.space,a.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,a)}}function H(a){return{__data__:a}}function I(a){return function(){return ng(this,a)}}function J(b){return arguments.length||(b=a),function(a,c){return a&&c?b(a.__data__,c.__data__):!a-!c}}function K(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function L(a){return jg(a,qg),a}function M(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function N(){var a=this.__transition__;a&&++a.active}function O(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,Uf(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+Sf.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=P;h>0&&(a=a.substring(0,h));var j=sg.get(a);return j&&(a=j,i=Q),h?b?e:d:b?p:f}function P(a,b){return function(c){var d=Sf.event;Sf.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{Sf.event=d}}}function Q(a,b){var c=P(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function R(){var a=".dragsuppress-"+ ++ug,b="click"+a,c=Sf.select(Xf).on("touchmove"+a,s).on("dragstart"+a,s).on("selectstart"+a,s);if(tg){var d=Wf.style,e=d[tg];d[tg]="none"}return function(f){function g(){c.on(b,null)}c.on(a,null),tg&&(d[tg]=e),f&&(c.on(b,function(){s(),g()},!0),setTimeout(g,0))}}function S(a,b){b.changedTouches&&(b=b.changedTouches[0]);var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(0>vg&&(Xf.scrollX||Xf.scrollY)){c=Sf.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var e=c[0][0].getScreenCTM();vg=!(e.f||e.e),c.remove()}return vg?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function T(){return Sf.event.changedTouches[0].identifier}function U(){return Sf.event.target}function V(){return Xf}function W(a){return a>0?1:0>a?-1:0}function X(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function Y(a){return a>1?0:-1>a?wg:Math.acos(a)}function Z(a){return a>1?yg:-1>a?-yg:Math.asin(a)}function $(a){return((a=Math.exp(a))-1/a)/2}function _(a){return((a=Math.exp(a))+1/a)/2}function aa(a){return((a=Math.exp(2*a))-1)/(a+1)}function ba(a){return(a=Math.sin(a/2))*a}function ca(){}function da(a,b,c){return this instanceof da?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof da?new da(a.h,a.s,a.l):ra(""+a,sa,da):new da(a,b,c)}function ea(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,new na(e(a+120),e(a),e(a-120))}function fa(a,b,c){return this instanceof fa?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof fa?new fa(a.h,a.c,a.l):a instanceof ha?ja(a.l,a.a,a.b):ja((a=ta((a=Sf.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new fa(a,b,c)}function ga(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new ha(c,Math.cos(a*=Bg)*b,Math.sin(a)*b)}function ha(a,b,c){return this instanceof ha?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof ha?new ha(a.l,a.a,a.b):a instanceof fa?ga(a.l,a.c,a.h):ta((a=na(a)).r,a.g,a.b):new ha(a,b,c)}function ia(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=ka(e)*Mg,d=ka(d)*Ng,f=ka(f)*Og,new na(ma(3.2404542*e-1.5371385*d-.4985314*f),ma(-.969266*e+1.8760108*d+.041556*f),ma(.0556434*e-.2040259*d+1.0572252*f))}function ja(a,b,c){return a>0?new fa(Math.atan2(c,b)*Cg,Math.sqrt(b*b+c*c),a):new fa(NaN,NaN,a)}function ka(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function la(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function ma(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function na(a,b,c){return this instanceof na?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof na?new na(a.r,a.g,a.b):ra(""+a,na,ea):new na(a,b,c)}function oa(a){return new na(a>>16,a>>8&255,255&a)}function pa(a){return oa(a)+""}function qa(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function ra(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/i.exec(a))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(va(e[0]),va(e[1]),va(e[2]))}return(f=Rg.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.substring(1),16))||(4===a.length?(g=(3840&f)>>4,g=g>>4|g,h=240&f,h=h>>4|h,i=15&f,i=i<<4|i):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function sa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&1>i?0:d),new da(d,e,i)}function ta(a,b,c){a=ua(a),b=ua(b),c=ua(c);var d=la((.4124564*a+.3575761*b+.1804375*c)/Mg),e=la((.2126729*a+.7151522*b+.072175*c)/Ng),f=la((.0193339*a+.119192*b+.9503041*c)/Og);return ha(116*e-16,500*(d-e),200*(e-f))}function ua(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function va(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function wa(a){return"function"==typeof a?a:function(){return a}}function xa(a){return a}function ya(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),za(b,c,a,d)}}function za(a,b,c,d){function e(){var a,b=i.status;if(!b&&i.responseText||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=Sf.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!Xf.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=Sf.event;Sf.event=a;try{g.progress.call(f,i)}finally{Sf.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(Uf(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},Sf.rebind(f,g,"on"),null==d?f:f.get(Aa(d))}function Aa(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ba(){var a=Ca(),b=Da()-a;b>24?(isFinite(b)&&(clearTimeout(Vg),Vg=setTimeout(Ba,b)),Ug=0):(Ug=1,Xg(Ba))}function Ca(){var a=Date.now();for(Wg=Sg;Wg;)a>=Wg.t&&(Wg.f=Wg.c(a-Wg.t)),Wg=Wg.n;return a}function Da(){for(var a,b=Sg,c=1/0;b;)b.f?b=a?a.n=b.n:Sg=b.n:(b.t<c&&(c=b.t),b=(a=b).n);return Tg=a,c}function Ea(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Fa(a,b){var c=Math.pow(10,3*eg(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function Ga(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d?function(a){for(var b=a.length,e=[],f=0,g=d[0];b>0&&g>0;)e.push(a.substring(b-=g,b+g)),g=d[f=(f+1)%d.length];return e.reverse().join(c)}:xa;return function(a){var c=Zg.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="=",l&&(k-=Math.floor((k-1)/4))),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):("e"==n||"f"==n)&&(m=Math.max(0,Math.min(20,m)))),n=$g.get(n)||Ha;var s=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):h;if(0>o){var i=Sf.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var t=a.lastIndexOf("."),u=0>t?a:a.substring(0,t),v=0>t?"":b+a.substring(t+1);!j&&l&&(u=f(u));var w=p.length+u.length+v.length+(s?0:e.length),x=k>w?new Array(w=k-w+1).join(d):"";return s&&(u=f(x+u)),e+=p,a=u+v,("<"===g?e+a+x:">"===g?x+e+a:"^"===g?x.substring(0,w>>=1)+e+a+x.substring(w):e+(s?a:x+a))+c}}}function Ha(a){return a+""}function Ia(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ja(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new ah(c-1)),1),c}function f(a,c){return b(a=new ah(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{ah=Ia;var d=new Ia;return d._=a,g(d,b,c)}finally{ah=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Ka(a);return i.floor=i,i.round=Ka(d),i.ceil=Ka(e),i.offset=Ka(f),i.range=h,a}function Ka(a){return function(b,c){try{ah=Ia;var d=new Ia;return d._=b,a(d,c)._}finally{ah=Date}}}function La(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.substring(i,h)),null!=(e=ch[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.substring(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=c(d,a,b,0);if(e!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var f=null!=d.Z&&ah!==Ia,g=new(f?Ia:ah);return"j"in d?g.setFullYear(d.y,0,d.j):"w"in d&&("W"in d||"U"in d)?(g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+Math.floor(d.Z/100),d.M+d.Z%100,d.S,d.L),f?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=D[g in ch?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.substring(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.substring(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.substring(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.substring(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.substring(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{ah=Ia;var b=new ah;return b._=a,d(b)}finally{ah=Date}}var d=b(a);return c.parse=function(a){try{ah=Ia;var b=d.parse(a);return b&&b._}finally{ah=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=db;var t=Sf.map(),u=Na(p),v=Oa(p),w=Na(q),x=Oa(q),y=Na(r),z=Oa(r),A=Na(s),B=Oa(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Ma(a.getDate(),b,2)},e:function(a,b){return Ma(a.getDate(),b,2)},H:function(a,b){return Ma(a.getHours(),b,2)},I:function(a,b){return Ma(a.getHours()%12||12,b,2)},j:function(a,b){return Ma(1+_g.dayOfYear(a),b,3)},L:function(a,b){return Ma(a.getMilliseconds(),b,3)},m:function(a,b){return Ma(a.getMonth()+1,b,2)},M:function(a,b){return Ma(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Ma(a.getSeconds(),b,2)},U:function(a,b){return Ma(_g.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ma(_g.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Ma(a.getFullYear()%100,b,2)},Y:function(a,b){return Ma(a.getFullYear()%1e4,b,4)},Z:bb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:Xa,e:Xa,H:Za,I:Za,j:Ya,L:ab,m:Wa,M:$a,p:k,S:_a,U:Qa,w:Pa,W:Ra,x:i,X:j,y:Ta,Y:Sa,Z:Ua,"%":cb};return b}function Ma(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function Na(a){return new RegExp("^(?:"+a.map(Sf.requote).join("|")+")","i")}function Oa(a){for(var b=new g,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Pa(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Qa(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c));return d?(a.U=+d[0],c+d[0].length):-1}function Ra(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c));return d?(a.W=+d[0],c+d[0].length):-1}function Sa(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Ta(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.y=Va(+d[0]),c+d[0].length):-1}function Ua(a,b,c){return/^[+-]\d{4}$/.test(b=b.substring(c,c+5))?(a.Z=-b,c+5):-1}function Va(a){return a+(a>68?1900:2e3)}function Wa(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function Xa(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function Ya(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function Za(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function $a(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function _a(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function ab(a,b,c){dh.lastIndex=0;var d=dh.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function bb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(eg(b)/60),e=eg(b)%60;return c+Ma(d,"0",2)+Ma(e,"0",2)}function cb(a,b,c){eh.lastIndex=0;var d=eh.exec(b.substring(c,c+1));return d?c+d[0].length:-1}function db(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function eb(){}function fb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function gb(a,b){a&&ih.hasOwnProperty(a.type)&&ih[a.type](a,b)}function hb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function ib(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)hb(a[c],b,1);b.polygonEnd()}function jb(){function a(a,b){a*=Bg,b=b*Bg/2+wg/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);kh.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;lh.point=function(g,h){lh.point=a,d=(b=g)*Bg,e=Math.cos(h=(c=h)*Bg/2+wg/4),f=Math.sin(h)},lh.lineEnd=function(){a(b,c)}}function kb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function lb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function mb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function nb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function ob(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function pb(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function qb(a){return[Math.atan2(a[1],a[0]),Z(a[2])]}function rb(a,b){return eg(a[0]-b[0])<zg&&eg(a[1]-b[1])<zg}function sb(a,b){a*=Bg;var c=Math.cos(b*=Bg);tb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function tb(a,b,c){++mh,oh+=(a-oh)/mh,ph+=(b-ph)/mh,qh+=(c-qh)/mh}function ub(){function a(a,e){a*=Bg;var f=Math.cos(e*=Bg),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);nh+=j,rh+=j*(b+(b=g)),sh+=j*(c+(c=h)),th+=j*(d+(d=i)),tb(b,c,d)}var b,c,d;xh.point=function(e,f){e*=Bg;var g=Math.cos(f*=Bg);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),xh.point=a,tb(b,c,d)}}function vb(){xh.point=sb}function wb(){function a(a,b){a*=Bg;var c=Math.cos(b*=Bg),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-Y(n)/m,p=Math.atan2(m,n);uh+=o*j,vh+=o*k,wh+=o*l,nh+=p,rh+=p*(d+(d=g)),sh+=p*(e+(e=h)),th+=p*(f+(f=i)),tb(d,e,f)}var b,c,d,e,f;xh.point=function(g,h){b=g,c=h,xh.point=a,g*=Bg;var i=Math.cos(h*=Bg);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),tb(d,e,f)},xh.lineEnd=function(){a(b,c),xh.lineEnd=vb,xh.point=sb}}function xb(){return!0}function yb(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(rb(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Ab(c,a,null,!0),j=new Ab(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Ab(d,a,null,!1),j=new Ab(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),zb(f),zb(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function zb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Ab(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Bb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Cb))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=Sf.merge(n);var a=Fb(r,o);n.length?(v||(f.polygonStart(),v=!0),yb(n,Eb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Db(),u=b(t),v=!1;return s}}function Cb(a){return a.length>1}function Db(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:p,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Eb(a,b){return((a=a.x)[0]<0?a[1]-yg-zg:yg-a[1])-((b=b.x)[0]<0?b[1]-yg-zg:yg-b[1])}function Fb(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;kh.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+wg/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+wg/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>wg,z=o*t;if(kh.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*xg:v,y^m>=c^r>=c){var A=mb(kb(l),kb(a));pb(A);var B=mb(e,A);pb(B);var C=(y^v>=0?-1:1)*Z(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-zg>f||zg>f&&0>kh)^1&g}function Gb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?wg:-wg,i=eg(f-c);eg(i-wg)<zg?(a.point(c,d=(d+g)/2>0?yg:-yg),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=wg&&(eg(c-e)<zg&&(c-=e*zg),eg(f-h)<zg&&(f-=h*zg),d=Hb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Hb(a,b,c,d){var e,f,g=Math.sin(a-c);return eg(g)>zg?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Ib(a,b,c,d){var e;if(null==a)e=c*yg,d.point(-wg,e),d.point(0,e),d.point(wg,e),d.point(wg,0),d.point(wg,-e),d.point(0,-e),d.point(-wg,-e),d.point(-wg,0),d.point(-wg,e);else if(eg(a[0]-b[0])>zg){var f=a[0]<b[0]?wg:-wg;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Jb(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?wg:-wg),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(rb(c,n)||rb(o,n))&&(o[0]+=zg,o[1]+=zg,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&rb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=kb(a),e=kb(b),g=[1,0,0],h=mb(d,e),i=lb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=mb(g,h),o=ob(g,l),p=ob(h,m);nb(o,p);var q=n,r=lb(o,q),s=lb(q,q),t=r*r-s*(lb(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=ob(q,(-r-u)/s);if(nb(v,o),v=qb(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=eg(B-wg)<zg,D=C||zg>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(eg(v[0]-x)<zg?z:A):z<=v[1]&&v[1]<=A:B>wg^(x<=v[0]&&v[0]<=y)){var E=ob(q,(-r+u)/s);return nb(E,o),[v,qb(E)]}}}function e(b,c){var d=g?a:wg-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=eg(f)>zg,i=jc(a,6*Bg);return Bb(b,c,i,g?[0,-a]:[-wg,a-wg])}function Kb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Lb(a,b,c,d){function e(d,e){return eg(d[0]-a)<zg?e>0?0:3:eg(d[0]-c)<zg?e>0?2:1:eg(d[1]-b)<zg?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];i>g;++g)f=h[g],j[1]<=d?f[1]>d&&X(j,f,a)>0&&++b:f[1]<=d&&X(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0){do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l)}else j.point(h[0],h[1])}function k(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-zh,Math.min(zh,a)),b=Math.max(-zh,Math.min(zh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Db(),C=Kb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=Sf.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&yb(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Mb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function Nb(a){var b=0,c=wg/3,d=bc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*wg/180,c=a[1]*wg/180):[b/wg*180,c/wg*180]},e}function Ob(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,Z((f-(a*a+c*c)*e*e)/(2*e))]},c}function Pb(){function a(a,b){Bh+=e*a-d*b,d=a,e=b}var b,c,d,e;Gh.point=function(f,g){Gh.point=a,b=d=f,c=e=g},Gh.lineEnd=function(){a(b,c)}}function Qb(a,b){Ch>a&&(Ch=a),a>Eh&&(Eh=a),Dh>b&&(Dh=b),b>Fh&&(Fh=b)}function Rb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Sb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Sb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Sb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Tb(a,b){oh+=a,ph+=b,++qh}function Ub(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);rh+=g*(b+a)/2,sh+=g*(c+d)/2,th+=g,Tb(b=a,c=d)}var b,c;Ih.point=function(d,e){Ih.point=a,Tb(b=d,c=e)}}function Vb(){Ih.point=Tb}function Wb(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);rh+=g*(d+a)/2,sh+=g*(e+b)/2,th+=g,g=e*a-d*b,uh+=g*(d+a),vh+=g*(e+b),wh+=3*g,Tb(d=a,e=b)}var b,c,d,e;Ih.point=function(f,g){Ih.point=a,Tb(b=d=f,c=e=g)},Ih.lineEnd=function(){a(b,c)}}function Xb(a){function b(b,c){a.moveTo(b,c),a.arc(b,c,g,0,xg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:p};return h}function Yb(a){function b(a){return(h?d:c)(a)}function c(b){return _b(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=kb([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=eg(eg(x)-1)<zg||eg(d-m)<zg?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||eg((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Bg),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function Zb(a){var b=Yb(function(b,c){return a([b*Cg,c*Cg])});return function(a){return cc(b(a))}}function $b(a){this.stream=a}function _b(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function ac(a){return bc(function(){return a})()}function bc(a){function b(a){return a=h(a[0]*Bg,a[1]*Bg),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Cg,a[1]*Cg]}function d(){h=Mb(g=fc(r,s,t),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=Yb(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,s=0,t=0,u=yh,v=xa,w=null,x=null;return b.stream=function(a){return k&&(k.valid=!1),k=cc(u(g,l(v(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(u=null==a?(w=a,yh):Jb((w=+a)*Bg),e()):w},b.clipExtent=function(a){return arguments.length?(x=a,v=a?Lb(a[0][0],a[0][1],a[1][0],a[1][1]):xa,e()):x},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Bg,q=a[1]%360*Bg,d()):[p*Cg,q*Cg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Bg,s=a[1]%360*Bg,t=a.length>2?a[2]%360*Bg:0,d()):[r*Cg,s*Cg,t*Cg]},Sf.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function cc(a){return _b(a,function(b,c){a.point(b*Bg,c*Bg)})}function dc(a,b){return[a,b]}function ec(a,b){return[a>wg?a-xg:-wg>a?a+xg:a,b]}function fc(a,b,c){return a?b||c?Mb(hc(a),ic(b,c)):hc(a):b||c?ic(b,c):ec}function gc(a){return function(b,c){return b+=a,[b>wg?b-xg:-wg>b?b+xg:b,c]}}function hc(a){var b=gc(a);return b.invert=gc(-a),b}function ic(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),Z(k*f+i*g)];
}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),Z(k*d-h*e)]},c}function jc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=kc(c,e),f=kc(c,f),(g>0?f>e:e>f)&&(e+=g*xg)):(e=a+g*xg,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=qb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function kc(a,b){var c=kb(b);c[0]-=a,pb(c);var d=Y(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-zg)%(2*Math.PI)}function lc(a,b,c){var d=Sf.range(a,b-zg,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function mc(a,b,c){var d=Sf.range(a,b-zg,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function nc(a){return a.source}function oc(a){return a.target}function pc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(ba(d-b)+e*g*ba(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Cg,Math.atan2(g,Math.sqrt(d*d+e*e))*Cg]}:function(){return[a*Cg,b*Cg]};return o.distance=m,o}function qc(){function a(a,e){var f=Math.sin(e*=Bg),g=Math.cos(e),h=eg((a*=Bg)-b),i=Math.cos(h);Jh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Kh.point=function(e,f){b=e*Bg,c=Math.sin(f*=Bg),d=Math.cos(f),Kh.point=a},Kh.lineEnd=function(){Kh.point=Kh.lineEnd=p}}function rc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function sc(a,b){function c(a,b){g>0?-yg+zg>b&&(b=-yg+zg):b>yg-zg&&(b=yg-zg);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(wg/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=W(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-yg]},c):uc}function tc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return eg(e)<zg?dc:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-W(e)*Math.sqrt(a*a+c*c)]},c)}function uc(a,b){return[a,Math.log(Math.tan(wg/4+b/2))]}function vc(a){var b,c=ac(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=wg*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function wc(a,b){return[Math.log(Math.tan(wg/4+b/2)),-a]}function xc(a){return a[0]}function yc(a){return a[1]}function zc(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;d>1&&X(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Ac(a,b){return a[0]-b[0]||a[1]-b[1]}function Bc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Cc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Dc(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Ec(){Zc(this),this.edge=this.site=this.circle=null}function Fc(a){var b=Wh.pop()||new Ec;return b.site=a,b}function Gc(a){Qc(a),Th.remove(a),Wh.push(a),Zc(a)}function Hc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Gc(a);for(var i=f;i.circle&&eg(c-i.circle.x)<zg&&eg(d-i.circle.cy)<zg;)f=i.P,h.unshift(i),Gc(i),i=f;h.unshift(i),Qc(i);for(var j=g;j.circle&&eg(c-j.circle.x)<zg&&eg(d-j.circle.cy)<zg;)g=j.N,h.push(j),Gc(j),j=g;h.push(j),Qc(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],Wc(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Uc(i.site,j.site,null,e),Pc(i),Pc(j)}function Ic(a){for(var b,c,d,e,f=a.x,g=a.y,h=Th._;h;)if(d=Jc(h,g)-f,d>zg)h=h.L;else{if(e=f-Kc(h,g),!(e>zg)){d>-zg?(b=h.P,c=h):e>-zg?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Fc(a);if(Th.insert(b,i),b||c){if(b===c)return Qc(b),c=Fc(b.site),Th.insert(i,c),i.edge=c.edge=Uc(b.site,i.site),Pc(b),void Pc(c);if(!c)return void(i.edge=Uc(b.site,i.site));Qc(b),Qc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};Wc(c.edge,j,o,u),i.edge=Uc(j,a,null,u),c.edge=Uc(a,o,null,u),Pc(b),Pc(c)}}function Jc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Kc(a,b){var c=a.N;if(c)return Jc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Lc(a){this.site=a,this.edges=[]}function Mc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=Sh,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(eg(d-b)>zg||eg(e-c)>zg)&&(h.splice(g,0,new Xc(Vc(f.site,k,eg(d-l)<zg&&o-e>zg?{x:l,y:eg(b-l)<zg?c:o}:eg(e-o)<zg&&m-d>zg?{x:eg(c-o)<zg?b:m,y:o}:eg(d-m)<zg&&e-n>zg?{x:m,y:eg(b-m)<zg?c:n}:eg(e-n)<zg&&d-l>zg?{x:eg(c-n)<zg?b:l,y:n}:null),f.site,null)),++i)}function Nc(a,b){return b.angle-a.angle}function Oc(){Zc(this),this.x=this.y=this.arc=this.site=this.cy=null}function Pc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Ag)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=Xh.pop()||new Oc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=Vh._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}Vh.insert(s,r),s||(Uh=r)}}}}function Qc(a){var b=a.circle;b&&(b.P||(Uh=b.N),Vh.remove(b),Xh.push(b),Zc(b),a.circle=null)}function Rc(a){for(var b,c=Rh,d=Kb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Sc(b,a)||!d(b)||eg(b.a.x-b.b.x)<zg&&eg(b.a.y-b.b.y)<zg)&&(b.a=b.b=null,c.splice(e,1))}function Sc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Tc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Uc(a,b,c,d){var e=new Tc(a,b);return Rh.push(e),c&&Wc(e,a,b,c),d&&Wc(e,b,a,d),Sh[a.i].edges.push(new Xc(e,a,b)),Sh[b.i].edges.push(new Xc(e,b,a)),e}function Vc(a,b,c){var d=new Tc(a,null);return d.a=b,d.b=c,Rh.push(d),d}function Wc(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function Xc(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function Yc(){this._=null}function Zc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function $c(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function _c(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function ad(a){for(;a.L;)a=a.L;return a}function bd(a,b){var c,d,e,f=a.sort(cd).pop();for(Rh=[],Sh=new Array(a.length),Th=new Yc,Vh=new Yc;;)if(e=Uh,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(Sh[f.i]=new Lc(f),Ic(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Hc(e.arc)}b&&(Rc(b),Mc(b));var g={cells:Sh,edges:Rh};return Th=Vh=Rh=Sh=null,g}function cd(a,b){return b.y-a.y||b.x-a.x}function dd(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function ed(a){return a.x}function fd(a){return a.y}function gd(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function hd(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&hd(a,i[0],c,d,g,h),i[1]&&hd(a,i[1],g,d,e,h),i[2]&&hd(a,i[2],c,h,g,f),i[3]&&hd(a,i[3],g,h,e,f)}}function id(a,b){a=Sf.rgb(a),b=Sf.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+qa(Math.round(c+f*a))+qa(Math.round(d+g*a))+qa(Math.round(e+h*a))}}function jd(a,b){var c,d={},e={};for(c in a)c in b?d[c]=md(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function kd(a,b){return b-=a=+a,function(c){return a+b*c}}function ld(a,b){var c,d,e,f=Zh.lastIndex=$h.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=Zh.exec(a))&&(d=$h.exec(b));)(e=d.index)>f&&(e=b.substring(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:kd(c,d)})),f=$h.lastIndex;return f<b.length&&(e=b.substring(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;b>d;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function md(a,b){for(var c,d=Sf.interpolators.length;--d>=0&&!(c=Sf.interpolators[d](a,b)););return c}function nd(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(md(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function od(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function pd(a){return function(b){return 1-a(1-b)}}function qd(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function rd(a){return a*a}function sd(a){return a*a*a}function td(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function ud(a){return function(b){return Math.pow(b,a)}}function vd(a){return 1-Math.cos(a*yg)}function wd(a){return Math.pow(2,10*(a-1))}function xd(a){return 1-Math.sqrt(1-a*a)}function yd(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/xg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*xg/b)}}function zd(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Ad(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Bd(a,b){a=Sf.hcl(a),b=Sf.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ga(c+f*a,d+g*a,e+h*a)+""}}function Cd(a,b){a=Sf.hsl(a),b=Sf.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ea(c+f*a,d+g*a,e+h*a)+""}}function Dd(a,b){a=Sf.lab(a),b=Sf.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Ed(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Fd(a){var b=[a.a,a.b],c=[a.c,a.d],d=Hd(b),e=Gd(b,c),f=Hd(Id(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Cg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Cg:0}function Gd(a,b){return a[0]*b[0]+a[1]*b[1]}function Hd(a){var b=Math.sqrt(Gd(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Id(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Jd(a,b){var c,d=[],e=[],f=Sf.transform(a),g=Sf.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:kd(h[0],i[0])},{i:3,x:kd(h[1],i[1])})):i[0]||i[1]?d.push("translate("+i+")"):d.push(""),j!=k?(j-k>180?k+=360:k-j>180&&(j+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:kd(j,k)})):k&&d.push(d.pop()+"rotate("+k+")"),l!=m?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:kd(l,m)}):m&&d.push(d.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(c=d.push(d.pop()+"scale(",null,",",null,")"),e.push({i:c-4,x:kd(n[0],o[0])},{i:c-2,x:kd(n[1],o[1])})):(1!=o[0]||1!=o[1])&&d.push(d.pop()+"scale("+o+")"),c=e.length,function(a){for(var b,f=-1;++f<c;)d[(b=e[f]).i]=b.x(a);return d.join("")}}function Kd(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function Ld(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function Md(a){for(var b=a.source,c=a.target,d=Od(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Nd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Od(a,b){if(a===b)return a;for(var c=Nd(a),d=Nd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function Pd(a){a.fixed|=2}function Qd(a){a.fixed&=-7}function Rd(a){a.fixed|=4,a.px=a.x,a.py=a.y}function Sd(a){a.fixed&=-5}function Td(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(Td(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function Ud(a,b){return Sf.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=$d,a}function Vd(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function Wd(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function Xd(a){return a.children}function Yd(a){return a.value}function Zd(a,b){return b.value-a.value}function $d(a){return Sf.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function _d(a){return a.x}function ae(a){return a.y}function be(a,b,c){a.y0=b,a.y=c}function ce(a){return Sf.range(a.length)}function de(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function ee(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function fe(a){return a.reduce(ge,0)}function ge(a,b){return a+b[1]}function he(a,b){return ie(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function ie(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function je(a){return[Sf.min(a),Sf.max(a)]}function ke(a,b){return a.value-b.value}function le(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function me(a,b){a._pack_next=b,b._pack_prev=a}function ne(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function oe(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(pe),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],se(d,e,f),b(f),le(d,f),d._pack_prev=f,le(f,e),e=d._pack_next,g=3;j>g;g++){se(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(ne(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!ne(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?me(d,e=h):me(d=i,e),g--):(le(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(qe)}}function pe(a){a._pack_next=a._pack_prev=a}function qe(a){delete a._pack_next,delete a._pack_prev}function re(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)re(e[f],b,c,d)}function se(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function te(a,b){return a.parent==b.parent?1:2}function ue(a){var b=a.children;return b.length?b[0]:a.t}function ve(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function we(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function xe(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function ye(a,b,c){return a.a.parent===b.parent?a.a:c}function ze(a){return 1+Sf.max(a,function(a){return a.y})}function Ae(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Be(a){var b=a.children;return b&&b.length?Be(b[0]):a}function Ce(a){var b,c=a.children;return c&&(b=c.length)?Ce(c[b-1]):a}function De(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Ee(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Fe(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function Ge(a){return a.rangeExtent?a.rangeExtent():Fe(a.range())}function He(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Ie(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Je(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:ji}function Ke(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=Sf.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function Le(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Ke:He,i=d?Ld:Kd;return g=e(a,b,i,c),h=e(b,a,i,md),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Ed)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return Pe(a,b)},f.tickFormat=function(b,c){return Qe(a,b,c)},f.nice=function(b){return Ne(a,b),e()},f.copy=function(){return Le(a,b,c,d)},e()}function Me(a,b){return Sf.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Ne(a,b){return Ie(a,Je(Oe(a,b)[2]))}function Oe(a,b){null==b&&(b=10);var c=Fe(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function Pe(a,b){return Sf.range.apply(Sf,Oe(a,b))}function Qe(a,b,c){var d=Oe(a,b);if(c){var e=Zg.exec(c);if(e.shift(),"s"===e[8]){var f=Sf.formatPrefix(Math.max(eg(d[0]),eg(d[1])));return e[7]||(e[7]="."+Re(f.scale(d[2]))),e[8]="f",c=Sf.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+Se(e[8],d)),c=e.join("")}else c=",."+Re(d[2])+"f";return Sf.format(c)}function Re(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function Se(a,b){var c=Re(b[2]);return a in ki?Math.abs(c-Re(Math.max(eg(b[0]),eg(b[1]))))+ +("e"!==a):c-2*("%"===a)}function Te(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Ie(d.map(e),c?Math:mi);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Fe(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,b){if(!arguments.length)return li;arguments.length<2?b=li:"function"!=typeof b&&(b=Sf.format(b));var d,h=Math.max(.1,a/g.ticks().length),i=c?(d=1e-12,Math.ceil):(d=-1e-12,Math.floor);return function(a){return a/f(i(e(a)+d))<=h?b(a):""}},g.copy=function(){return Te(a.copy(),b,c,d)},Me(g,a)}function Ue(a,b,c){function d(b){return a(e(b))}var e=Ve(b),f=Ve(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return Pe(c,a)},d.tickFormat=function(a,b){return Qe(c,a,b)},d.nice=function(a){return d.domain(Ne(c,a))},d.exponent=function(g){return arguments.length?(e=Ve(b=g),f=Ve(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return Ue(a.copy(),b,c)},Me(d,a)}function Ve(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function We(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return Sf.range(a.length).map(function(a){return b+c*a})}var e,f,h;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new g;for(var f,h=-1,i=d.length;++h<i;)e.has(f=d[h])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,h=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,g){arguments.length<2&&(g=0);var i=e[0],j=e[1],k=(j-i)/(Math.max(1,a.length-1)+g);return f=d(a.length<2?(i+j)/2:i+k*g/2,k),h=0,b={t:"rangePoints",a:arguments},c},c.rangeBands=function(e,g,i){arguments.length<2&&(g=0),arguments.length<3&&(i=g);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-g+2*i);return f=d(k+m*i,m),j&&f.reverse(),h=m*(1-g),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,g,i){arguments.length<2&&(g=0),arguments.length<3&&(i=g);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-g+2*i)),n=l-k-(a.length-g)*m;return f=d(k+Math.round(n/2),m),j&&f.reverse(),h=Math.round(m*(1-g)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return h},c.rangeExtent=function(){return Fe(b.a[0])},c.copy=function(){return We(a,b)},c.domain(a)}function Xe(c,d){function e(){var a=0,b=d.length;for(g=[];++a<b;)g[a-1]=Sf.quantile(c,a/b);return f}function f(a){return isNaN(a=+a)?void 0:d[Sf.bisect(g,a)]}var g;return f.domain=function(d){return arguments.length?(c=d.filter(b).sort(a),e()):c},f.range=function(a){return arguments.length?(d=a,e()):d},f.quantiles=function(){return g},f.invertExtent=function(a){return a=d.indexOf(a),0>a?[NaN,NaN]:[a>0?g[a-1]:c[0],a<g.length?g[a]:c[c.length-1]]},f.copy=function(){return Xe(c,d)},e()}function Ye(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return Ye(a,b,c)},e()}function Ze(a,b){function c(c){return c>=c?b[Sf.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return Ze(a,b)},c}function $e(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return Pe(a,b)},b.tickFormat=function(b,c){return Qe(a,b,c)},b.copy=function(){return $e(a)},b}function _e(a){return a.innerRadius}function af(a){return a.outerRadius}function bf(a){return a.startAngle}function cf(a){return a.endAngle}function df(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=wa(c),o=wa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=xc,d=yc,e=xb,f=ef,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=ti.get(a)||ef).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function ef(a){return a.join("L")}function ff(a){return ef(a)+"Z"}function gf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function hf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function jf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function kf(a,b){return a.length<4?ef(a):a[1]+nf(a.slice(1,a.length-1),of(a,b))}function lf(a,b){return a.length<3?ef(a):a[0]+nf((a.push(a[0]),a),of([a[a.length-2]].concat(a,[a[1]]),b))}function mf(a,b){return a.length<3?ef(a):a[0]+nf(a,of(a,b))}function nf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return ef(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function of(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function pf(a){if(a.length<3)return ef(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",tf(wi,g),",",tf(wi,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),uf(i,g,h);return a.pop(),i.push("L",d),i.join("")}function qf(a){if(a.length<4)return ef(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(tf(wi,f)+","+tf(wi,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),uf(c,f,g);return c.join("")}function rf(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[tf(wi,g),",",tf(wi,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),uf(b,g,h);return b.join("")}function sf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return pf(a)}function tf(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function uf(a,b,c){a.push("C",tf(ui,b),",",tf(ui,c),",",tf(vi,b),",",tf(vi,c),",",tf(wi,b),",",tf(wi,c))}function vf(a,b){return(b[1]-a[1])/(b[0]-a[0])}function wf(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=vf(e,f);++b<c;)d[b]=(g+(g=vf(e=f,f=a[b+1])))/2;return d[b]=g,d}function xf(a){for(var b,c,d,e,f=[],g=wf(a),h=-1,i=a.length-1;++h<i;)b=vf(a[h],a[h+1]),eg(b)<zg?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function yf(a){return a.length<3?ef(a):a[0]+nf(a,xf(a))}function zf(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]+ri,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Af(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=wa(c),v=wa(e),w=c===d?function(){return n}:wa(d),x=e===f?function(){return o}:wa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=xc,d=xc,e=0,f=yc,g=xb,h=ef,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=ti.get(a)||ef).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Bf(a){return a.radius}function Cf(a){return[a.x,a.y]}function Df(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+ri;return[c*Math.cos(d),c*Math.sin(d)]}}function Ef(){return 64}function Ff(){return"circle"}function Gf(a){var b=Math.sqrt(a/wg);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Hf(a,b){return jg(a,Ci),a.id=b,a}function If(a,b,c,d){var e=a.id;return K(a,"function"==typeof c?function(a,f,g){a.__transition__[e].tween.set(b,d(c.call(a,a.__data__,f,g)))}:(c=d(c),function(a){a.__transition__[e].tween.set(b,c)}))}function Jf(a){return null==a&&(a=""),function(){this.textContent=a}}function Kf(a,b,c,d){var e=a.__transition__||(a.__transition__={active:0,count:0}),f=e[c];if(!f){var h=d.time;f=e[c]={tween:new g,time:h,ease:d.ease,delay:d.delay,duration:d.duration},++e.count,Sf.timer(function(d){function g(d){return e.active>c?j():(e.active=c,f.event&&f.event.start.call(a,k,b),f.tween.forEach(function(c,d){(d=d.call(a,k,b))&&p.push(d)}),void Sf.timer(function(){return o.c=i(d||1)?xb:i,1},0,h))}function i(d){if(e.active!==c)return j();for(var g=d/n,h=l(g),i=p.length;i>0;)p[--i].call(a,h);return g>=1?(f.event&&f.event.end.call(a,k,b),j()):void 0}function j(){return--e.count?delete e[c]:delete a.__transition__,1}var k=a.__data__,l=f.ease,m=f.delay,n=f.duration,o=Wg,p=[];return o.t=m+h,d>=m?g(d-m):void(o.c=g)},0,h)}}function Lf(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function Mf(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function Nf(a){return a.toISOString()}function Of(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=Sf.bisect(Li,e);return f==Li.length?[b.year,Oe(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Li[f-1]<Li[f]/e?f-1:f]:[Oi,Oe(a,c)[2]]}return d.invert=function(b){return Pf(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(Pf)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,Pf(+c+1),b).length}var f=d.domain(),g=Fe(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Ie(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=Pf(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=Pf(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Fe(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],Pf(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return Of(a.copy(),b,c)},Me(d,a)}function Pf(a){return new Date(a)}function Qf(a){return JSON.parse(a.responseText)}function Rf(a){var b=Vf.createRange();return b.selectNode(Vf.body),b.createContextualFragment(a.responseText)}var Sf={version:"3.4.11"};Date.now||(Date.now=function(){return+new Date});var Tf=[].slice,Uf=function(a){return Tf.call(a)},Vf=document,Wf=Vf.documentElement,Xf=window;try{Uf(Wf.childNodes)[0].nodeType}catch(Yf){Uf=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}try{Vf.createElement("div").style.setProperty("opacity",0,"")}catch(Zf){var $f=Xf.Element.prototype,_f=$f.setAttribute,ag=$f.setAttributeNS,bg=Xf.CSSStyleDeclaration.prototype,cg=bg.setProperty;$f.setAttribute=function(a,b){_f.call(this,a,b+"");
},$f.setAttributeNS=function(a,b,c){ag.call(this,a,b,c+"")},bg.setProperty=function(a,b,c){cg.call(this,a,b+"",c)}}Sf.ascending=a,Sf.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},Sf.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},Sf.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f&&!(null!=(c=a[e])&&c>=c);)c=void 0;for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f&&!(null!=(c=b.call(a,a[e],e))&&c>=c);)c=void 0;for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},Sf.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(c=e=a[f])&&c>=c);)c=e=void 0;for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g&&!(null!=(c=e=b.call(a,a[f],f))&&c>=c);)c=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},Sf.sum=function(a,b){var c,d=0,e=a.length,f=-1;if(1===arguments.length)for(;++f<e;)isNaN(c=+a[f])||(d+=c);else for(;++f<e;)isNaN(c=+b.call(a,a[f],f))||(d+=c);return d},Sf.mean=function(a,c){var d,e=0,f=a.length,g=-1,h=f;if(1===arguments.length)for(;++g<f;)b(d=a[g])?e+=d:--h;else for(;++g<f;)b(d=c.call(a,a[g],g))?e+=d:--h;return h?e/h:void 0},Sf.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},Sf.median=function(c,d){return arguments.length>1&&(c=c.map(d)),c=c.filter(b),c.length?Sf.quantile(c.sort(a),.5):void 0};var dg=c(a);Sf.bisectLeft=dg.left,Sf.bisect=Sf.bisectRight=dg.right,Sf.bisector=function(b){return c(1===b.length?function(c,d){return a(b(c),d)}:b)},Sf.shuffle=function(a){for(var b,c,d=a.length;d;)c=Math.random()*d--|0,b=a[d],a[d]=a[c],a[c]=b;return a},Sf.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},Sf.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},Sf.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=Sf.min(arguments,d),c=new Array(b);++a<b;)for(var e,f=-1,g=c[a]=new Array(e);++f<e;)g[f]=arguments[f][a];return c},Sf.transpose=function(a){return Sf.zip.apply(Sf,a)},Sf.keys=function(a){var b=[];for(var c in a)b.push(c);return b},Sf.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},Sf.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},Sf.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var eg=Math.abs;Sf.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,f=[],g=e(eg(c)),h=-1;if(a*=g,b*=g,c*=g,0>c)for(;(d=a+c*++h)>b;)f.push(d/g);else for(;(d=a+c*++h)<b;)f.push(d/g);return f},Sf.map=function(a){var b=new g;if(a instanceof g)a.forEach(function(a,c){b.set(a,c)});else for(var c in a)b.set(c,a[c]);return b},f(g,{has:h,get:function(a){return this[fg+a]},set:function(a,b){return this[fg+a]=b},remove:i,keys:j,values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===gg&&a.call(this,b.substring(1),this[b])}});var fg="\x00",gg=fg.charCodeAt(0);Sf.nest=function(){function a(b,h,i){if(i>=f.length)return d?d.call(e,h):c?h.sort(c):h;for(var j,k,l,m,n=-1,o=h.length,p=f[i++],q=new g;++n<o;)(m=q.get(j=p(k=h[n])))?m.push(k):q.set(j,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,i))}):(k={},l=function(c,d){k[c]=a(b,d,i)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=h[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],h=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(Sf.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return h[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},Sf.set=function(a){var b=new m;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},f(m,{has:h,add:function(a){return this[fg+a]=!0,a},remove:function(a){return a=fg+a,a in this&&delete this[a]},values:j,size:k,empty:l,forEach:function(a){for(var b in this)b.charCodeAt(0)===gg&&a.call(this,b.substring(1))}}),Sf.behavior={},Sf.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=n(a,b,b[c]);return a};var hg=["webkit","ms","moz","Moz","o","O"];Sf.dispatch=function(){for(var a=new q,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=r(a);return a},q.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.substring(c+1),a=a.substring(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},Sf.event=null,Sf.requote=function(a){return a.replace(ig,"\\$&")};var ig=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,jg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},kg=function(a,b){return b.querySelector(a)},lg=function(a,b){return b.querySelectorAll(a)},mg=Wf.matches||Wf[o(Wf,"matchesSelector")],ng=function(a,b){return mg.call(a,b)};"function"==typeof Sizzle&&(kg=function(a,b){return Sizzle(a,b)[0]||null},lg=Sizzle,ng=Sizzle.matchesSelector),Sf.selection=function(){return rg};var og=Sf.selection.prototype=[];og.select=function(a){var b,c,d,e,f=[];a=w(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return v(f)},og.selectAll=function(a){var b,c,d=[];a=x(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=Uf(a.call(c,c.__data__,h,e))),b.parentNode=c);return v(d)};var pg={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Sf.ns={prefix:pg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),pg.hasOwnProperty(c)?{space:pg[c],local:a}:a}},og.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=Sf.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(y(b,a[b]));return this}return this.each(y(a,b))},og.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=B(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!A(a[e]).test(b))return!1;return!0}for(b in a)this.each(C(b,a[b]));return this}return this.each(C(a,b))},og.style=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(c in a)this.each(E(c,a[c],b));return this}if(2>d)return Xf.getComputedStyle(this.node(),null).getPropertyValue(a);c=""}return this.each(E(a,b,c))},og.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(F(b,a[b]));return this}return this.each(F(a,b))},og.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},og.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},og.append=function(a){return a=G(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},og.insert=function(a,b){return a=G(a),b=w(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},og.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},og.data=function(a,b){function c(a,c){var d,e,f,h=a.length,l=c.length,m=Math.min(h,l),n=new Array(l),o=new Array(l),p=new Array(h);if(b){var q,r=new g,s=new g,t=[];for(d=-1;++d<h;)q=b.call(e=a[d],e.__data__,d),r.has(q)?p[d]=e:r.set(q,e),t.push(q);for(d=-1;++d<l;)q=b.call(c,f=c[d],d),(e=r.get(q))?(n[d]=e,e.__data__=f):s.has(q)||(o[d]=H(f)),s.set(q,f),r.remove(q);for(d=-1;++d<h;)r.has(t[d])&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=H(f);for(;l>d;++d)o[d]=H(c[d]);for(;h>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,i.push(o),j.push(n),k.push(p)}var d,e,f=-1,h=this.length;if(!arguments.length){for(a=new Array(h=(d=this[0]).length);++f<h;)(e=d[f])&&(a[f]=e.__data__);return a}var i=L([]),j=v([]),k=v([]);if("function"==typeof a)for(;++f<h;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<h;)c(d=this[f],a);return j.enter=function(){return i},j.exit=function(){return k},j},og.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},og.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=I(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return v(e)},og.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},og.sort=function(a){a=J.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},og.each=function(a){return K(this,function(b,c,d){a.call(b,b.__data__,c,d)})},og.call=function(a){var b=Uf(arguments);return a.apply(b[0]=this,b),this},og.empty=function(){return!this.node()},og.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},og.size=function(){var a=0;return this.each(function(){++a}),a};var qg=[];Sf.selection.enter=L,Sf.selection.enter.prototype=qg,qg.append=og.append,qg.empty=og.empty,qg.node=og.node,qg.call=og.call,qg.size=og.size,qg.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return v(g)},qg.insert=function(a,b){return arguments.length<2&&(b=M(this)),og.insert.call(this,a,b)},og.transition=function(){for(var a,b,c=yi||++Di,d=[],e=zi||{time:Date.now(),ease:td,delay:0,duration:250},f=-1,g=this.length;++f<g;){d.push(a=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(b=h[i])&&Kf(b,i,c,e),a.push(b)}return Hf(d,c)},og.interrupt=function(){return this.each(N)},Sf.select=function(a){var b=["string"==typeof a?kg(a,Vf):a];return b.parentNode=Wf,v([b])},Sf.selectAll=function(a){var b=Uf("string"==typeof a?lg(a,Vf):a);return b.parentNode=Wf,v([b])};var rg=Sf.select(Wf);og.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(O(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(O(a,b,c))};var sg=Sf.map({mouseenter:"mouseover",mouseleave:"mouseout"});sg.forEach(function(a){"on"+a in Vf&&sg.remove(a)});var tg="onselectstart"in Vf?null:o(Wf.style,"userSelect"),ug=0;Sf.mouse=function(a){return S(a,t())};var vg=/WebKit/.test(Xf.navigator.userAgent)?-1:0;Sf.touches=function(a,b){return arguments.length<2&&(b=t().touches),b?Uf(b).map(function(b){var c=S(a,b);return c.identifier=b.identifier,c}):[]},Sf.behavior.drag=function(){function a(){this.on("mousedown.drag",e).on("touchstart.drag",f)}function b(a,b,e,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o&&Sf.event.target===l),n({type:"dragend"}))}var j,k=this,l=Sf.event.target,m=k.parentNode,n=c.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=Sf.select(e()).on(f+q,h).on(g+q,i),s=R(),t=b(m,p);d?(j=d.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var c=u(a,"drag","dragstart","dragend"),d=null,e=b(p,Sf.mouse,V,"mousemove","mouseup"),f=b(T,Sf.touch,U,"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},Sf.rebind(a,c,"on")};var wg=Math.PI,xg=2*wg,yg=wg/2,zg=1e-6,Ag=zg*zg,Bg=wg/180,Cg=180/wg,Dg=Math.SQRT2,Eg=2,Fg=4;Sf.interpolateZoom=function(a,b){function c(a){var b=a*s;if(r){var c=_(p),g=f/(Eg*m)*(c*aa(Dg*b+p)-$(p));return[d+g*j,e+g*k,f*c/_(Dg*b+p)]}return[d+a*j,e+a*k,f*Math.exp(Dg*b)]}var d=a[0],e=a[1],f=a[2],g=b[0],h=b[1],i=b[2],j=g-d,k=h-e,l=j*j+k*k,m=Math.sqrt(l),n=(i*i-f*f+Fg*l)/(2*f*Eg*m),o=(i*i-f*f-Fg*l)/(2*i*Eg*m),p=Math.log(Math.sqrt(n*n+1)-n),q=Math.log(Math.sqrt(o*o+1)-o),r=q-p,s=(r||Math.log(i/f))/Dg;return c.duration=1e3*s,c},Sf.behavior.zoom=function(){function a(a){a.on(B,j).on(Ig+".zoom",l).on("dblclick.zoom",m).on(E,k)}function b(a){return[(a[0]-y.x)/y.k,(a[1]-y.y)/y.k]}function c(a){return[a[0]*y.k+y.x,a[1]*y.k+y.y]}function d(a){y.k=Math.max(A[0],Math.min(A[1],a))}function e(a,b){b=c(b),y.x+=a[0]-b[0],y.y+=a[1]-b[1]}function f(){v&&v.domain(t.range().map(function(a){return(a-y.x)/y.k}).map(t.invert)),x&&x.domain(w.range().map(function(a){return(a-y.y)/y.k}).map(w.invert))}function g(a){a({type:"zoomstart"})}function h(a){f(),a({type:"zoom",scale:y.k,translate:[y.x,y.y]})}function i(a){a({type:"zoomend"})}function j(){function a(){k=1,e(Sf.mouse(d),m),h(j)}function c(){l.on(C,null).on(D,null),n(k&&Sf.event.target===f),i(j)}var d=this,f=Sf.event.target,j=F.of(d,arguments),k=0,l=Sf.select(Xf).on(C,a).on(D,c),m=b(Sf.mouse(d)),n=R();N.call(d),g(j)}function k(){function a(){var a=Sf.touches(n);return m=y.k,a.forEach(function(a){a.identifier in p&&(p[a.identifier]=b(a))}),a}function c(){var b=Sf.event.target;Sf.select(b).on(u,f).on(v,l),w.push(b);for(var c=Sf.event.changedTouches,g=0,i=c.length;i>g;++g)p[c[g].identifier]=null;var j=a(),k=Date.now();if(1===j.length){if(500>k-r){var m=j[0],n=p[m.identifier];d(2*y.k),e(m,n),s(),h(o)}r=k}else if(j.length>1){var m=j[0],t=j[1],x=m[0]-t[0],z=m[1]-t[1];q=x*x+z*z}}function f(){for(var a,b,c,f,g=Sf.touches(n),i=0,j=g.length;j>i;++i,f=null)if(c=g[i],f=p[c.identifier]){if(b)break;a=c,b=f}if(f){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=q&&Math.sqrt(k/q);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+f[0])/2,(b[1]+f[1])/2],d(l*m)}r=null,e(a,b),h(o)}function l(){if(Sf.event.touches.length){for(var b=Sf.event.changedTouches,c=0,d=b.length;d>c;++c)delete p[b[c].identifier];for(var e in p)return void a()}Sf.selectAll(w).on(t,null),x.on(B,j).on(E,k),z(),i(o)}var m,n=this,o=F.of(n,arguments),p={},q=0,t=".zoom-"+Sf.event.changedTouches[0].identifier,u="touchmove"+t,v="touchend"+t,w=[],x=Sf.select(n).on(B,null).on(E,c),z=R();N.call(n),c(),g(o)}function l(){var a=F.of(this,arguments);q?clearTimeout(q):(n=b(o=p||Sf.mouse(this)),N.call(this),g(a)),q=setTimeout(function(){q=null,i(a)},50),s(),d(Math.pow(2,.002*Gg())*y.k),e(o,n),h(a)}function m(){var a=F.of(this,arguments),c=Sf.mouse(this),f=b(c),j=Math.log(y.k)/Math.LN2;g(a),d(Math.pow(2,Sf.event.shiftKey?Math.ceil(j)-1:Math.floor(j)+1)),e(c,f),h(a),i(a)}var n,o,p,q,r,t,v,w,x,y={x:0,y:0,k:1},z=[960,500],A=Hg,B="mousedown.zoom",C="mousemove.zoom",D="mouseup.zoom",E="touchstart.zoom",F=u(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=F.of(this,arguments),b=y;yi?Sf.select(this).transition().each("start.zoom",function(){y=this.__chart__||{x:0,y:0,k:1},g(a)}).tween("zoom:zoom",function(){var c=z[0],d=z[1],e=c/2,f=d/2,g=Sf.interpolateZoom([(e-y.x)/y.k,(f-y.y)/y.k,c/y.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),i=c/d[2];this.__chart__=y={x:e-d[0]*i,y:f-d[1]*i,k:i},h(a)}}).each("end.zoom",function(){i(a)}):(this.__chart__=y,g(a),h(a),i(a))})},a.translate=function(b){return arguments.length?(y={x:+b[0],y:+b[1],k:y.k},f(),a):[y.x,y.y]},a.scale=function(b){return arguments.length?(y={x:y.x,y:y.y,k:+b},f(),a):y.k},a.scaleExtent=function(b){return arguments.length?(A=null==b?Hg:[+b[0],+b[1]],a):A},a.center=function(b){return arguments.length?(p=b&&[+b[0],+b[1]],a):p},a.size=function(b){return arguments.length?(z=b&&[+b[0],+b[1]],a):z},a.x=function(b){return arguments.length?(v=b,t=b.copy(),y={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),y={x:0,y:0,k:1},a):x},Sf.rebind(a,F,"on")};var Gg,Hg=[0,1/0],Ig="onwheel"in Vf?(Gg=function(){return-Sf.event.deltaY*(Sf.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Vf?(Gg=function(){return Sf.event.wheelDelta},"mousewheel"):(Gg=function(){return-Sf.event.detail},"MozMousePixelScroll");Sf.color=ca,ca.prototype.toString=function(){return this.rgb()+""},Sf.hsl=da;var Jg=da.prototype=new ca;Jg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,this.l/a)},Jg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new da(this.h,this.s,a*this.l)},Jg.rgb=function(){return ea(this.h,this.s,this.l)},Sf.hcl=fa;var Kg=fa.prototype=new ca;Kg.brighter=function(a){return new fa(this.h,this.c,Math.min(100,this.l+Lg*(arguments.length?a:1)))},Kg.darker=function(a){return new fa(this.h,this.c,Math.max(0,this.l-Lg*(arguments.length?a:1)))},Kg.rgb=function(){return ga(this.h,this.c,this.l).rgb()},Sf.lab=ha;var Lg=18,Mg=.95047,Ng=1,Og=1.08883,Pg=ha.prototype=new ca;Pg.brighter=function(a){return new ha(Math.min(100,this.l+Lg*(arguments.length?a:1)),this.a,this.b)},Pg.darker=function(a){return new ha(Math.max(0,this.l-Lg*(arguments.length?a:1)),this.a,this.b)},Pg.rgb=function(){return ia(this.l,this.a,this.b)},Sf.rgb=na;var Qg=na.prototype=new ca;Qg.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),new na(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new na(e,e,e)},Qg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new na(a*this.r,a*this.g,a*this.b)},Qg.hsl=function(){return sa(this.r,this.g,this.b)},Qg.toString=function(){return"#"+qa(this.r)+qa(this.g)+qa(this.b)};var Rg=Sf.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Rg.forEach(function(a,b){Rg.set(a,oa(b))}),Sf.functor=wa,Sf.xhr=ya(xa),Sf.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=za(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.substring(b+1,c).replace(/""/g,'"')}for(;j>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.substring(b,k-h)}return a.substring(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();(!b||(m=b(m,l++)))&&h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new m,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},Sf.csv=Sf.dsv(",","text/csv"),Sf.tsv=Sf.dsv("	","text/tab-separated-values"),Sf.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=t().changedTouches),b)for(var d,e=0,f=b.length;f>e;++e)if((d=b[e]).identifier===c)return S(a,d)};var Sg,Tg,Ug,Vg,Wg,Xg=Xf[o(Xf,"requestAnimationFrame")]||function(a){setTimeout(a,17)};Sf.timer=function(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,f:!1,n:null};Tg?Tg.n=f:Sg=f,Tg=f,Ug||(Vg=clearTimeout(Vg),Ug=1,Xg(Ba))},Sf.timer.flush=function(){Ca(),Da()},Sf.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var Yg=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Fa);Sf.formatPrefix=function(a,b){var c=0;return a&&(0>a&&(a*=-1),b&&(a=Sf.round(a,Ea(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),Yg[8+c/3]};var Zg=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,$g=Sf.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=Sf.round(a,Ea(a,b))).toFixed(Math.max(0,Math.min(20,Ea(a*(1+1e-15),b))))}}),_g=Sf.time={},ah=Date;Ia.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){bh.setUTCDate.apply(this._,arguments)},setDay:function(){bh.setUTCDay.apply(this._,arguments)},setFullYear:function(){bh.setUTCFullYear.apply(this._,arguments)},setHours:function(){bh.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){bh.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){bh.setUTCMinutes.apply(this._,arguments)},setMonth:function(){bh.setUTCMonth.apply(this._,arguments)},setSeconds:function(){bh.setUTCSeconds.apply(this._,arguments)},setTime:function(){bh.setTime.apply(this._,arguments)}};var bh=Date.prototype;_g.year=Ja(function(a){return a=_g.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),_g.years=_g.year.range,_g.years.utc=_g.year.utc.range,_g.day=Ja(function(a){var b=new ah(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),_g.days=_g.day.range,_g.days.utc=_g.day.utc.range,_g.dayOfYear=function(a){var b=_g.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=_g[a]=Ja(function(a){return(a=_g.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=_g.year(a).getDay();return Math.floor((_g.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});_g[a+"s"]=c.range,_g[a+"s"].utc=c.utc.range,_g[a+"OfYear"]=function(a){var c=_g.year(a).getDay();return Math.floor((_g.dayOfYear(a)+(c+b)%7)/7)}}),_g.week=_g.sunday,_g.weeks=_g.sunday.range,_g.weeks.utc=_g.sunday.utc.range,_g.weekOfYear=_g.sundayOfYear;var ch={"-":"",_:" ",0:"0"},dh=/^\s*\d+/,eh=/^%/;Sf.locale=function(a){return{numberFormat:Ga(a),timeFormat:La(a)}};var fh=Sf.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Sf.format=fh.numberFormat,Sf.geo={},eb.prototype={s:0,t:0,add:function(a){fb(a,this.t,gh),fb(gh.s,this.s,this),this.s?this.t+=gh.t:this.s=gh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var gh=new eb;Sf.geo.stream=function(a,b){a&&hh.hasOwnProperty(a.type)?hh[a.type](a,b):gb(a,b)};var hh={Feature:function(a,b){gb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)gb(c[d].geometry,b)}},ih={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){hb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)hb(c[d],b,0)},Polygon:function(a,b){ib(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)ib(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)gb(c[d],b)}};Sf.geo.area=function(a){return jh=0,Sf.geo.stream(a,lh),jh};var jh,kh=new eb,lh={sphere:function(){jh+=4*wg},point:p,lineStart:p,lineEnd:p,polygonStart:function(){kh.reset(),lh.lineStart=jb},polygonEnd:function(){var a=2*kh;jh+=0>a?4*wg+a:a,lh.lineStart=lh.lineEnd=lh.point=p}};Sf.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=kb([b*Bg,c*Bg]);if(r){var e=mb(r,d),f=[e[1],-e[0],0],g=mb(f,e);pb(g),g=qb(g);var i=b-o,j=i>0?1:-1,p=g[0]*Cg*j,q=eg(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Cg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Cg;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=eg(d)>180?d+(d>0?360:-360):d}else p=a,q=c;lh.point(a,c),b(a,c)}function f(){lh.lineStart()}function g(){e(p,q),lh.lineEnd(),eg(s)>zg&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,lh.polygonStart()},polygonEnd:function(){lh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>kh?(k=-(m=180),l=-(n=90)):s>zg?n=90:-zg>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],Sf.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),Sf.geo.centroid=function(a){mh=nh=oh=ph=qh=rh=sh=th=uh=vh=wh=0,Sf.geo.stream(a,xh);var b=uh,c=vh,d=wh,e=b*b+c*c+d*d;return Ag>e&&(b=rh,c=sh,d=th,zg>nh&&(b=oh,c=ph,d=qh),e=b*b+c*c+d*d,Ag>e)?[NaN,NaN]:[Math.atan2(c,b)*Cg,Z(d/Math.sqrt(e))*Cg]};var mh,nh,oh,ph,qh,rh,sh,th,uh,vh,wh,xh={sphere:p,point:sb,lineStart:ub,lineEnd:vb,polygonStart:function(){xh.lineStart=wb},polygonEnd:function(){xh.lineStart=ub}},yh=Bb(xb,Gb,Ib,[-wg,-wg/2]),zh=1e9;Sf.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Lb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(Sf.geo.conicEqualArea=function(){return Nb(Ob)}).raw=Ob,Sf.geo.albers=function(){return Sf.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Sf.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=Sf.geo.albers(),g=Sf.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=Sf.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd();
}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+zg,l+.12*j+zg],[k-.214*j-zg,l+.234*j-zg]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+zg,l+.166*j+zg],[k-.115*j-zg,l+.234*j-zg]]).stream(i).point,a},a.scale(1070)};var Ah,Bh,Ch,Dh,Eh,Fh,Gh={point:p,lineStart:p,lineEnd:p,polygonStart:function(){Bh=0,Gh.lineStart=Pb},polygonEnd:function(){Gh.lineStart=Gh.lineEnd=Gh.point=p,Ah+=eg(Bh/2)}},Hh={point:Qb,lineStart:p,lineEnd:p,polygonStart:p,polygonEnd:p},Ih={point:Tb,lineStart:Ub,lineEnd:Vb,polygonStart:function(){Ih.lineStart=Wb},polygonEnd:function(){Ih.point=Tb,Ih.lineStart=Ub,Ih.lineEnd=Vb}};Sf.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),Sf.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Ah=0,Sf.geo.stream(a,e(Gh)),Ah},a.centroid=function(a){return oh=ph=qh=rh=sh=th=uh=vh=wh=0,Sf.geo.stream(a,e(Ih)),wh?[uh/wh,vh/wh]:th?[rh/th,sh/th]:qh?[oh/qh,ph/qh]:[NaN,NaN]},a.bounds=function(a){return Eh=Fh=-(Ch=Dh=1/0),Sf.geo.stream(a,e(Hh)),[[Ch,Dh],[Eh,Fh]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||Zb(a):xa,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Rb:new Xb(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(Sf.geo.albersUsa()).context(null)},Sf.geo.transform=function(a){return{stream:function(b){var c=new $b(b);for(var d in a)c[d]=a[d];return c}}},$b.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Sf.geo.projection=ac,Sf.geo.projectionMutator=bc,(Sf.geo.equirectangular=function(){return ac(dc)}).raw=dc.invert=dc,Sf.geo.rotation=function(a){function b(b){return b=a(b[0]*Bg,b[1]*Bg),b[0]*=Cg,b[1]*=Cg,b}return a=fc(a[0]%360*Bg,a[1]*Bg,a.length>2?a[2]*Bg:0),b.invert=function(b){return b=a.invert(b[0]*Bg,b[1]*Bg),b[0]*=Cg,b[1]*=Cg,b},b},ec.invert=dc,Sf.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=fc(-a[0]*Bg,-a[1]*Bg,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Cg,a[1]*=Cg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=jc((b=+d)*Bg,e*Bg),a):b},a.precision=function(d){return arguments.length?(c=jc(b*Bg,(e=+d)*Bg),a):e},a.angle(90)},Sf.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Bg,e=a[1]*Bg,f=b[1]*Bg,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},Sf.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return Sf.range(Math.ceil(f/q)*q,e,q).map(m).concat(Sf.range(Math.ceil(j/r)*r,i,r).map(n)).concat(Sf.range(Math.ceil(d/o)*o,c,o).filter(function(a){return eg(a%q)>zg}).map(k)).concat(Sf.range(Math.ceil(h/p)*p,g,p).filter(function(a){return eg(a%r)>zg}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=lc(h,g,90),l=mc(d,c,s),m=lc(j,i,90),n=mc(f,e,s),a):s},a.majorExtent([[-180,-90+zg],[180,90-zg]]).minorExtent([[-180,-80-zg],[180,80+zg]])},Sf.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=nc,e=oc;return a.distance=function(){return Sf.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},Sf.geo.interpolate=function(a,b){return pc(a[0]*Bg,a[1]*Bg,b[0]*Bg,b[1]*Bg)},Sf.geo.length=function(a){return Jh=0,Sf.geo.stream(a,Kh),Jh};var Jh,Kh={sphere:p,point:p,lineStart:qc,lineEnd:p,polygonStart:p,polygonEnd:p},Lh=rc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(Sf.geo.azimuthalEqualArea=function(){return ac(Lh)}).raw=Lh;var Mh=rc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},xa);(Sf.geo.azimuthalEquidistant=function(){return ac(Mh)}).raw=Mh,(Sf.geo.conicConformal=function(){return Nb(sc)}).raw=sc,(Sf.geo.conicEquidistant=function(){return Nb(tc)}).raw=tc;var Nh=rc(function(a){return 1/a},Math.atan);(Sf.geo.gnomonic=function(){return ac(Nh)}).raw=Nh,uc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-yg]},(Sf.geo.mercator=function(){return vc(uc)}).raw=uc;var Oh=rc(function(){return 1},Math.asin);(Sf.geo.orthographic=function(){return ac(Oh)}).raw=Oh;var Ph=rc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(Sf.geo.stereographic=function(){return ac(Ph)}).raw=Ph,wc.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-yg]},(Sf.geo.transverseMercator=function(){var a=vc(wc),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=wc,Sf.geom={},Sf.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=wa(c),f=wa(d),g=a.length,h=[],i=[];for(b=0;g>b;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Ac),b=0;g>b;b++)i.push([h[b][0],-h[b][1]]);var j=zc(h),k=zc(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=xc,d=yc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},Sf.geom.polygon=function(a){return jg(a,Qh),a};var Qh=Sf.geom.polygon.prototype=[];Qh.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},Qh.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},Qh.clip=function(a){for(var b,c,d,e,f,g,h=Dc(a),i=-1,j=this.length-Dc(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Bc(g,k,e)?(Bc(f,k,e)||a.push(Cc(f,g,k,e)),a.push(g)):Bc(f,k,e)&&a.push(Cc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var Rh,Sh,Th,Uh,Vh,Wh=[],Xh=[];Lc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Nc),b.length},Xc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Yc.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=ad(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&($c(this,c),a=c,c=a.U),c.C=!1,d.C=!0,_c(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(_c(this,c),a=c,c=a.U),c.C=!1,d.C=!0,$c(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?ad(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,$c(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,_c(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,$c(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,_c(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,$c(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,_c(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},Sf.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return bd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/zg)*zg,y:Math.round(g(a,b)/zg)*zg,i:b}})}var d=xc,e=yc,f=d,g=e,h=Yh;return a?b(a):(b.links=function(a){return bd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return bd(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(Nc),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&dd(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=wa(d=a),b):d},b.y=function(a){return arguments.length?(g=wa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?Yh:a,b):h===Yh?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===Yh?null:h&&h[1]},b)};var Yh=[[-1e6,-1e6],[1e6,1e6]];Sf.geom.delaunay=function(a){return Sf.geom.voronoi().triangles(a)},Sf.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(eg(i-c)+eg(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=(m<<1)+l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=gd()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=wa(h),u=wa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=gd();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){hd(a,z,p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=xc,i=yc;return(g=arguments.length)?(h=ed,i=fd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},Sf.interpolateRgb=id,Sf.interpolateObject=jd,Sf.interpolateNumber=kd,Sf.interpolateString=ld;var Zh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$h=new RegExp(Zh.source,"g");Sf.interpolate=md,Sf.interpolators=[function(a,b){var c=typeof b;return("string"===c?Rg.has(b)||/^(#|rgb\(|hsl\()/.test(b)?id:ld:b instanceof ca?id:Array.isArray(b)?nd:"object"===c&&isNaN(b)?jd:kd)(a,b)}],Sf.interpolateArray=nd;var _h=function(){return xa},ai=Sf.map({linear:_h,poly:ud,quad:function(){return rd},cubic:function(){return sd},sin:function(){return vd},exp:function(){return wd},circle:function(){return xd},elastic:yd,back:zd,bounce:function(){return Ad}}),bi=Sf.map({"in":xa,out:pd,"in-out":qd,"out-in":function(a){return qd(pd(a))}});Sf.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=ai.get(c)||_h,d=bi.get(d)||xa,od(d(c.apply(null,Tf.call(arguments,1))))},Sf.interpolateHcl=Bd,Sf.interpolateHsl=Cd,Sf.interpolateLab=Dd,Sf.interpolateRound=Ed,Sf.transform=function(a){var b=Vf.createElementNS(Sf.ns.prefix.svg,"g");return(Sf.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Fd(c?c.matrix:ci)})(a)},Fd.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ci={a:1,b:0,c:0,d:1,e:0,f:0};Sf.interpolateTransform=Jd,Sf.layout={},Sf.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Md(a[c]));return b}},Sf.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=Sf.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(Sf.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(xg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:(j-l)/a},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},Sf.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(i>h*h/q){if(o>i){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&o>i){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=Sf.event.x,a.py=Sf.event.y,h.resume()}var c,d,e,f,g,h={},i=Sf.dispatch("start","tick","end"),j=[1,1],k=.9,l=di,m=ei,n=-30,o=fi,p=.1,q=.64,r=[],s=[];return h.tick=function(){if((d*=.99)<.005)return i.end({type:"end",alpha:d=0}),!0;var b,c,h,l,m,o,q,t,u,v=r.length,w=s.length;for(c=0;w>c;++c)h=s[c],l=h.source,m=h.target,t=m.x-l.x,u=m.y-l.y,(o=t*t+u*u)&&(o=d*f[c]*((o=Math.sqrt(o))-e[c])/o,t*=o,u*=o,m.x-=t*(q=l.weight/(m.weight+l.weight)),m.y-=u*q,l.x+=t*(q=1-q),l.y+=u*q);if((q=d*p)&&(t=j[0]/2,u=j[1]/2,c=-1,q))for(;++c<v;)h=r[c],h.x+=(t-h.x)*q,h.y+=(u-h.y)*q;if(n)for(Td(b=Sf.geom.quadtree(r),d,g),c=-1;++c<v;)(h=r[c]).fixed||b.visit(a(h));for(c=-1;++c<v;)h=r[c],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*k,h.y-=(h.py-(h.py=h.y))*k);i.tick({type:"tick",alpha:d})},h.nodes=function(a){return arguments.length?(r=a,h):r},h.links=function(a){return arguments.length?(s=a,h):s},h.size=function(a){return arguments.length?(j=a,h):j},h.linkDistance=function(a){return arguments.length?(l="function"==typeof a?a:+a,h):l},h.distance=h.linkDistance,h.linkStrength=function(a){return arguments.length?(m="function"==typeof a?a:+a,h):m},h.friction=function(a){return arguments.length?(k=+a,h):k},h.charge=function(a){return arguments.length?(n="function"==typeof a?a:+a,h):n},h.chargeDistance=function(a){return arguments.length?(o=a*a,h):Math.sqrt(o)},h.gravity=function(a){return arguments.length?(p=+a,h):p},h.theta=function(a){return arguments.length?(q=a*a,h):Math.sqrt(q)},h.alpha=function(a){return arguments.length?(a=+a,d?d=a>0?a:0:a>0&&(i.start({type:"start",alpha:d=a}),Sf.timer(h.tick)),h):d},h.start=function(){function a(a,d){if(!c){for(c=new Array(i),h=0;i>h;++h)c[h]=[];for(h=0;j>h;++h){var e=s[h];c[e.source.index].push(e.target),c[e.target.index].push(e.source)}}for(var f,g=c[b],h=-1,j=g.length;++h<j;)if(!isNaN(f=g[h][a]))return f;return Math.random()*d}var b,c,d,i=r.length,k=s.length,o=j[0],p=j[1];for(b=0;i>b;++b)(d=r[b]).index=b,d.weight=0;for(b=0;k>b;++b)d=s[b],"number"==typeof d.source&&(d.source=r[d.source]),"number"==typeof d.target&&(d.target=r[d.target]),++d.source.weight,++d.target.weight;for(b=0;i>b;++b)d=r[b],isNaN(d.x)&&(d.x=a("x",o)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(e=[],"function"==typeof l)for(b=0;k>b;++b)e[b]=+l.call(this,s[b],b);else for(b=0;k>b;++b)e[b]=l;if(f=[],"function"==typeof m)for(b=0;k>b;++b)f[b]=+m.call(this,s[b],b);else for(b=0;k>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;i>b;++b)g[b]=+n.call(this,r[b],b);else for(b=0;i>b;++b)g[b]=n;return h.resume()},h.resume=function(){return h.alpha(.1)},h.stop=function(){return h.alpha(0)},h.drag=function(){return c||(c=Sf.behavior.drag().origin(xa).on("dragstart.force",Pd).on("drag.force",b).on("dragend.force",Qd)),arguments.length?void this.on("mouseover.force",Rd).on("mouseout.force",Sd).call(c):c},Sf.rebind(h,i,"on")};var di=20,ei=1,fi=1/0;Sf.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return Wd(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=Zd,c=Xd,d=Yd;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(Vd(b,function(a){a.children&&(a.value=0)}),Wd(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},Sf.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=Sf.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},Ud(c,d)},Sf.layout.pie=function(){function a(f){var g=f.map(function(c,d){return+b.call(a,c,d)}),h=+("function"==typeof d?d.apply(this,arguments):d),i=(("function"==typeof e?e.apply(this,arguments):e)-h)/Sf.sum(g),j=Sf.range(f.length);null!=c&&j.sort(c===gi?function(a,b){return g[b]-g[a]}:function(a,b){return c(f[a],f[b])});var k=[];return j.forEach(function(a){var b;k[a]={data:f[a],value:b=g[a],startAngle:h,endAngle:h+=b*i}}),k}var b=Number,c=gi,d=0,e=xg;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a};var gi={};Sf.layout.stack=function(){function a(h,i){var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=Sf.permute(j,l),k=Sf.permute(k,l);var m,n,o,p=d.call(a,k,i),q=j.length,r=j[0].length;for(n=0;r>n;++n)for(e.call(a,j[0][n],o=p[n],k[0][n][1]),m=1;q>m;++m)e.call(a,j[m][n],o+=k[m-1][n][1],k[m][n][1]);return h}var b=xa,c=ce,d=de,e=be,f=_d,g=ae;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:hi.get(b)||ce,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:ii.get(b)||de,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var hi=Sf.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(ee),f=a.map(fe),g=Sf.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return Sf.range(a.length).reverse()},"default":ce}),ii=Sf.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:de});Sf.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[Sf.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=je,e=he;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=wa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return ie(a,b)}:wa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},Sf.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,Wd(h,function(a){a.r=+k(a.value)}),Wd(h,oe),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;Wd(h,function(a){a.r+=l}),Wd(h,oe),Wd(h,function(a){a.r-=l})}return re(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=Sf.layout.hierarchy().sort(ke),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},Ud(a,c)},Sf.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(Wd(m,c),m.parent.m=-m.z,Vd(m,d),j)Vd(l,f);else{var n=l,o=l,p=l;Vd(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);Vd(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;h>g;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){xe(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=ve(g),e=ue(e),g&&e;)i=ue(i),f=ve(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(we(ye(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!ve(f)&&(f.t=g,f.m+=l-k),e&&!ue(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=Sf.layout.hierarchy().sort(null).value(null),h=te,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},Ud(a,g)},Sf.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;Wd(i,function(a){var b=a.children;b&&b.length?(a.x=Ae(b),a.y=ze(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Be(i),l=Ce(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return Wd(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=Sf.layout.hierarchy().sort(null).value(null),c=te,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},Ud(a,b)},Sf.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=0,f.y=0,f.dx=j[0],f.dy=j[1],g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=Sf.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=De,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?De(b):Ee(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Ee(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?De:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},Ud(f,h)},Sf.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=Sf.random.normal.apply(Sf,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=Sf.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},Sf.scale={};var ji={floor:xa,ceil:xa};Sf.scale.linear=function(){return Le([0,1],[0,1],md,!1)};var ki={s:1,g:1,p:1,r:1,e:1};Sf.scale.log=function(){return Te(Sf.scale.linear().domain([0,1]),10,!0,[1,10])};var li=Sf.format(".0e"),mi={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};Sf.scale.pow=function(){return Ue(Sf.scale.linear(),1,[0,1])},Sf.scale.sqrt=function(){return Sf.scale.pow().exponent(.5)},Sf.scale.ordinal=function(){return We([],{t:"range",a:[[]]})},Sf.scale.category10=function(){return Sf.scale.ordinal().range(ni)},Sf.scale.category20=function(){return Sf.scale.ordinal().range(oi)},Sf.scale.category20b=function(){return Sf.scale.ordinal().range(pi)},Sf.scale.category20c=function(){return Sf.scale.ordinal().range(qi)};var ni=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(pa),oi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(pa),pi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(pa),qi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(pa);Sf.scale.quantile=function(){return Xe([],[])},Sf.scale.quantize=function(){return Ye(0,1,[0,1])},Sf.scale.threshold=function(){return Ze([.5],[0,1])},Sf.scale.identity=function(){return $e([0,1])},Sf.svg={},Sf.svg.arc=function(){function a(){var a=b.apply(this,arguments),f=c.apply(this,arguments),g=d.apply(this,arguments)+ri,h=e.apply(this,arguments)+ri,i=(g>h&&(i=g,g=h,h=i),h-g),j=wg>i?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=si?a?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+a+"A"+a+","+a+" 0 1,0 0,"+-a+"A"+a+","+a+" 0 1,0 0,"+a+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":a?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+a*m+","+a*n+"A"+a+","+a+" 0 "+j+",0 "+a*k+","+a*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0Z"}var b=_e,c=af,d=bf,e=cf;return a.innerRadius=function(c){return arguments.length?(b=wa(c),a):b},a.outerRadius=function(b){return arguments.length?(c=wa(b),a):c},a.startAngle=function(b){return arguments.length?(d=wa(b),a):d},a.endAngle=function(b){return arguments.length?(e=wa(b),a):e},a.centroid=function(){var a=(b.apply(this,arguments)+c.apply(this,arguments))/2,f=(d.apply(this,arguments)+e.apply(this,arguments))/2+ri;return[Math.cos(f)*a,Math.sin(f)*a]},a};var ri=-yg,si=xg-zg;Sf.svg.line=function(){return df(xa)};var ti=Sf.map({linear:ef,"linear-closed":ff,step:gf,"step-before":hf,"step-after":jf,basis:pf,"basis-open":qf,"basis-closed":rf,bundle:sf,cardinal:mf,"cardinal-open":kf,"cardinal-closed":lf,monotone:yf});ti.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var ui=[0,2/3,1/3,0],vi=[0,1/3,2/3,0],wi=[0,1/6,2/3,1/6];Sf.svg.line.radial=function(){var a=df(zf);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},hf.reverse=jf,jf.reverse=hf,Sf.svg.area=function(){return Af(xa)},Sf.svg.area.radial=function(){var a=Af(zf);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},Sf.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z";
}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)+ri,k=j.call(a,e,d)+ri;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>wg)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=nc,g=oc,h=Bf,i=bf,j=cf;return a.radius=function(b){return arguments.length?(h=wa(b),a):h},a.source=function(b){return arguments.length?(f=wa(b),a):f},a.target=function(b){return arguments.length?(g=wa(b),a):g},a.startAngle=function(b){return arguments.length?(i=wa(b),a):i},a.endAngle=function(b){return arguments.length?(j=wa(b),a):j},a},Sf.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=nc,c=oc,d=Cf;return a.source=function(c){return arguments.length?(b=wa(c),a):b},a.target=function(b){return arguments.length?(c=wa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},Sf.svg.diagonal.radial=function(){var a=Sf.svg.diagonal(),b=Cf,c=a.projection;return a.projection=function(a){return arguments.length?c(Df(b=a)):b},a},Sf.svg.symbol=function(){function a(a,d){return(xi.get(b.call(this,a,d))||Gf)(c.call(this,a,d))}var b=Ff,c=Ef;return a.type=function(c){return arguments.length?(b=wa(c),a):b},a.size=function(b){return arguments.length?(c=wa(b),a):c},a};var xi=Sf.map({circle:Gf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Bi)),c=b*Bi;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Ai),c=b*Ai/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Ai),c=b*Ai/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});Sf.svg.symbolTypes=xi.keys();var yi,zi,Ai=Math.sqrt(3),Bi=Math.tan(30*Bg),Ci=[],Di=0;Ci.call=og.call,Ci.empty=og.empty,Ci.node=og.node,Ci.size=og.size,Sf.transition=function(a){return arguments.length?yi?a.transition():a:rg.transition()},Sf.transition.prototype=Ci,Ci.select=function(a){var b,c,d,e=this.id,f=[];a=w(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]);for(var i=this[g],j=-1,k=i.length;++j<k;)(d=i[j])&&(c=a.call(d,d.__data__,j,g))?("__data__"in d&&(c.__data__=d.__data__),Kf(c,j,e,d.__transition__[e]),b.push(c)):b.push(null)}return Hf(f,e)},Ci.selectAll=function(a){var b,c,d,e,f,g=this.id,h=[];a=x(a);for(var i=-1,j=this.length;++i<j;)for(var k=this[i],l=-1,m=k.length;++l<m;)if(d=k[l]){f=d.__transition__[g],c=a.call(d,d.__data__,l,i),h.push(b=[]);for(var n=-1,o=c.length;++n<o;)(e=c[n])&&Kf(e,n,g,f),b.push(e)}return Hf(h,g)},Ci.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=I(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Hf(e,this.id)},Ci.tween=function(a,b){var c=this.id;return arguments.length<2?this.node().__transition__[c].tween.get(a):K(this,null==b?function(b){b.__transition__[c].tween.remove(a)}:function(d){d.__transition__[c].tween.set(a,b)})},Ci.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Jd:md,h=Sf.ns.qualify(a);return If(this,"attr."+a,b,h.local?f:e)},Ci.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=Sf.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Ci.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(b){return null==b?d:(b+="",function(){var d,e=Xf.getComputedStyle(this,null).getPropertyValue(a);return e!==b&&(d=md(e,b),function(b){this.style.setProperty(a,d(b),c)})})}var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(b="");for(c in a)this.style(c,a[c],b);return this}c=""}return If(this,"style."+a,b,e)},Ci.styleTween=function(a,b,c){function d(d,e){var f=b.call(this,d,e,Xf.getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),c)}}return arguments.length<3&&(c=""),this.tween("style."+a,d)},Ci.text=function(a){return If(this,"text",a,Jf)},Ci.remove=function(){return this.each("end.transition",function(){var a;this.__transition__.count<2&&(a=this.parentNode)&&a.removeChild(this)})},Ci.ease=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].ease:("function"!=typeof a&&(a=Sf.ease.apply(Sf,arguments)),K(this,function(c){c.__transition__[b].ease=a}))},Ci.delay=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].delay:K(this,"function"==typeof a?function(c,d,e){c.__transition__[b].delay=+a.call(c,c.__data__,d,e)}:(a=+a,function(c){c.__transition__[b].delay=a}))},Ci.duration=function(a){var b=this.id;return arguments.length<1?this.node().__transition__[b].duration:K(this,"function"==typeof a?function(c,d,e){c.__transition__[b].duration=Math.max(1,a.call(c,c.__data__,d,e))}:(a=Math.max(1,a),function(c){c.__transition__[b].duration=a}))},Ci.each=function(a,b){var c=this.id;if(arguments.length<2){var d=zi,e=yi;yi=c,K(this,function(b,d,e){zi=b.__transition__[c],a.call(b,b.__data__,d,e)}),zi=d,yi=e}else K(this,function(d){var e=d.__transition__[c];(e.event||(e.event=Sf.dispatch("start","end"))).on(a,b)});return this},Ci.transition=function(){for(var a,b,c,d,e=this.id,f=++Di,g=[],h=0,i=this.length;i>h;h++){g.push(a=[]);for(var b=this[h],j=0,k=b.length;k>j;j++)(c=b[j])&&(d=Object.create(c.__transition__[e]),d.delay+=d.duration,Kf(c,j,f,d)),a.push(c)}return Hf(g,f)},Sf.svg.axis=function(){function a(a){a.each(function(){var a,j=Sf.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):xa:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",zg),q=Sf.transition(o.exit()).style("opacity",zg).remove(),r=Sf.transition(o.order()).style("opacity",1),s=Ge(l),t=j.selectAll(".domain").data([0]),u=(t.enter().append("path").attr("class","domain"),Sf.transition(t));p.append("line"),p.append("text");var v=p.select("line"),w=r.select("line"),x=o.select("text").text(n),y=p.select("text"),z=r.select("text");switch(d){case"bottom":a=Lf,v.attr("y2",e),y.attr("y",Math.max(e,0)+g),w.attr("x2",0).attr("y2",e),z.attr("x",0).attr("y",Math.max(e,0)+g),x.attr("dy",".71em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+f+"V0H"+s[1]+"V"+f);break;case"top":a=Lf,v.attr("y2",-e),y.attr("y",-(Math.max(e,0)+g)),w.attr("x2",0).attr("y2",-e),z.attr("x",0).attr("y",-(Math.max(e,0)+g)),x.attr("dy","0em").style("text-anchor","middle"),u.attr("d","M"+s[0]+","+-f+"V0H"+s[1]+"V"+-f);break;case"left":a=Mf,v.attr("x2",-e),y.attr("x",-(Math.max(e,0)+g)),w.attr("x2",-e).attr("y2",0),z.attr("x",-(Math.max(e,0)+g)).attr("y",0),x.attr("dy",".32em").style("text-anchor","end"),u.attr("d","M"+-f+","+s[0]+"H0V"+s[1]+"H"+-f);break;case"right":a=Mf,v.attr("x2",e),y.attr("x",Math.max(e,0)+g),w.attr("x2",e).attr("y2",0),z.attr("x",Math.max(e,0)+g).attr("y",0),x.attr("dy",".32em").style("text-anchor","start"),u.attr("d","M"+f+","+s[0]+"H0V"+s[1]+"H"+f)}if(l.rangeBand){var A=l,B=A.rangeBand()/2;k=l=function(a){return A(a)+B}}else k.rangeBand?k=l:q.call(a,l);p.call(a,k),r.call(a,l)})}var b,c=Sf.scale.linear(),d=Ei,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Fi?b+"":Ei,a):d},a.ticks=function(){return arguments.length?(h=arguments,a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Ei="bottom",Fi={top:1,right:1,bottom:1,left:1};Sf.svg.brush=function(){function a(f){f.each(function(){var f=Sf.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),g=f.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=f.selectAll(".resize").data(o,xa);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Gi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var k,l=Sf.transition(f),m=Sf.transition(g);i&&(k=Ge(i),m.attr("x",k[0]).attr("width",k[1]-k[0]),c(l)),j&&(k=Ge(j),m.attr("y",k[0]).attr("height",k[1]-k[0]),d(l)),b(l)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+k[+/e$/.test(a)]+","+l[+/^s/.test(a)]+")"})}function c(a){a.select(".extent").attr("x",k[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",k[1]-k[0])}function d(a){a.select(".extent").attr("y",l[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1]-l[0])}function e(){function e(){32==Sf.event.keyCode&&(C||(t=null,E[0]-=k[1],E[1]-=l[1],C=2),s())}function o(){32==Sf.event.keyCode&&2==C&&(E[0]+=k[1],E[1]+=l[1],C=0,s())}function p(){var a=Sf.mouse(v),e=!1;u&&(a[0]+=u[0],a[1]+=u[1]),C||(Sf.event.altKey?(t||(t=[(k[0]+k[1])/2,(l[0]+l[1])/2]),E[0]=k[+(a[0]<t[0])],E[1]=l[+(a[1]<t[1])]):t=null),A&&q(a,i,0)&&(c(y),e=!0),B&&q(a,j,1)&&(d(y),e=!0),e&&(b(y),x({type:"brush",mode:C?"move":"resize"}))}function q(a,b,c){var d,e,h=Ge(b),i=h[0],j=h[1],o=E[c],p=c?l:k,q=p[1]-p[0];return C&&(i-=o,j-=q+o),d=(c?n:m)?Math.max(i,Math.min(j,a[c])):a[c],C?e=(d+=o)+q:(t&&(o=Math.max(i,Math.min(j,2*t[c]-d))),d>o?(e=d,d=o):e=o),p[0]!=d||p[1]!=e?(c?g=null:f=null,p[0]=d,p[1]=e,!0):void 0}function r(){p(),y.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),Sf.select("body").style("cursor",null),F.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),D(),x({type:"brushend"})}var t,u,v=this,w=Sf.select(Sf.event.target),x=h.of(v,arguments),y=Sf.select(v),z=w.datum(),A=!/^(n|s)$/.test(z)&&i,B=!/^(e|w)$/.test(z)&&j,C=w.classed("extent"),D=R(),E=Sf.mouse(v),F=Sf.select(Xf).on("keydown.brush",e).on("keyup.brush",o);if(Sf.event.changedTouches?F.on("touchmove.brush",p).on("touchend.brush",r):F.on("mousemove.brush",p).on("mouseup.brush",r),y.interrupt().selectAll("*").interrupt(),C)E[0]=k[0]-E[0],E[1]=l[0]-E[1];else if(z){var G=+/w$/.test(z),H=+/^n/.test(z);u=[k[1-G]-E[0],l[1-H]-E[1]],E[0]=k[G],E[1]=l[H]}else Sf.event.altKey&&(t=E.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),Sf.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),p()}var f,g,h=u(a,"brushstart","brush","brushend"),i=null,j=null,k=[0,0],l=[0,0],m=!0,n=!0,o=Hi[0];return a.event=function(a){a.each(function(){var a=h.of(this,arguments),b={x:k,y:l,i:f,j:g},c=this.__chart__||b;this.__chart__=b,yi?Sf.select(this).transition().each("start.brush",function(){f=c.i,g=c.j,k=c.x,l=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=nd(k,b.x),d=nd(l,b.y);return f=g=null,function(e){k=b.x=c(e),l=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i,g=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(i=b,o=Hi[!i<<1|!j],a):i},a.y=function(b){return arguments.length?(j=b,o=Hi[!i<<1|!j],a):j},a.clamp=function(b){return arguments.length?(i&&j?(m=!!b[0],n=!!b[1]):i?m=!!b:j&&(n=!!b),a):i&&j?[m,n]:i?m:j?n:null},a.extent=function(b){var c,d,e,h,m;return arguments.length?(i&&(c=b[0],d=b[1],j&&(c=c[0],d=d[0]),f=[c,d],i.invert&&(c=i(c),d=i(d)),c>d&&(m=c,c=d,d=m),(c!=k[0]||d!=k[1])&&(k=[c,d])),j&&(e=b[0],h=b[1],i&&(e=e[1],h=h[1]),g=[e,h],j.invert&&(e=j(e),h=j(h)),e>h&&(m=e,e=h,h=m),(e!=l[0]||h!=l[1])&&(l=[e,h])),a):(i&&(f?(c=f[0],d=f[1]):(c=k[0],d=k[1],i.invert&&(c=i.invert(c),d=i.invert(d)),c>d&&(m=c,c=d,d=m))),j&&(g?(e=g[0],h=g[1]):(e=l[0],h=l[1],j.invert&&(e=j.invert(e),h=j.invert(h)),e>h&&(m=e,e=h,h=m))),i&&j?[[c,e],[d,h]]:i?[c,d]:j&&[e,h])},a.clear=function(){return a.empty()||(k=[0,0],l=[0,0],f=g=null),a},a.empty=function(){return!!i&&k[0]==k[1]||!!j&&l[0]==l[1]},Sf.rebind(a,h,"on")};var Gi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Hi=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ii=_g.format=fh.timeFormat,Ji=Ii.utc,Ki=Ji("%Y-%m-%dT%H:%M:%S.%LZ");Ii.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Nf:Ki,Nf.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},Nf.toString=Ki.toString,_g.second=Ja(function(a){return new ah(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),_g.seconds=_g.second.range,_g.seconds.utc=_g.second.utc.range,_g.minute=Ja(function(a){return new ah(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),_g.minutes=_g.minute.range,_g.minutes.utc=_g.minute.utc.range,_g.hour=Ja(function(a){var b=a.getTimezoneOffset()/60;return new ah(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),_g.hours=_g.hour.range,_g.hours.utc=_g.hour.utc.range,_g.month=Ja(function(a){return a=_g.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),_g.months=_g.month.range,_g.months.utc=_g.month.utc.range;var Li=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Mi=[[_g.second,1],[_g.second,5],[_g.second,15],[_g.second,30],[_g.minute,1],[_g.minute,5],[_g.minute,15],[_g.minute,30],[_g.hour,1],[_g.hour,3],[_g.hour,6],[_g.hour,12],[_g.day,1],[_g.day,2],[_g.week,1],[_g.month,1],[_g.month,3],[_g.year,1]],Ni=Ii.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",xb]]),Oi={range:function(a,b,c){return Sf.range(Math.ceil(a/c)*c,+b,c).map(Pf)},floor:xa,ceil:xa};Mi.year=_g.year,_g.scale=function(){return Of(Sf.scale.linear(),Mi,Ni)};var Pi=Mi.map(function(a){return[a[0].utc,a[1]]}),Qi=Ji.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",xb]]);return Pi.year=_g.year.utc,_g.scale.utc=function(){return Of(Sf.scale.linear(),Pi,Qi)},Sf.text=ya(function(a){return a.responseText}),Sf.json=function(a,b){return za(a,"application/json",Qf,b)},Sf.html=function(a,b){return za(a,"text/html",Rf,b)},Sf.xml=ya(function(a){return a.responseXML}),Sf}()},{}],281:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){U=a}function j(a){Y=a}function k(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(p)}}function l(){return function(){T(p)}}function m(){var a=0,b=new _(p),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function n(){var a=new MessageChannel;return a.port1.onmessage=p,function(){a.port2.postMessage(0)}}function o(){return function(){setTimeout(p,1)}}function p(){for(var a=0;X>a;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}X=0}function q(){try{var a=b,c=a("vertx");return T=c.runOnLoop||c.runOnContext,l()}catch(d){return o()}}function r(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function t(){return new TypeError("A promises callback cannot return that same promise.")}function u(a){try{return a.then}catch(b){return ga.error=b,ga}}function v(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function w(a,b,c){Y(function(a){var d=!1,e=v(c,b,function(c){d||(d=!0,b!==c?z(a,c):B(a,c))},function(b){d||(d=!0,C(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,C(a,e))},a)}function x(a,b){b._state===ea?B(a,b._result):b._state===fa?C(a,b._result):D(b,void 0,function(b){z(a,b)},function(b){C(a,b)})}function y(a,b){if(b.constructor===a.constructor)x(a,b);else{var c=u(b);c===ga?C(a,ga.error):void 0===c?B(a,b):g(c)?w(a,b,c):B(a,b)}}function z(a,b){a===b?C(a,s()):f(b)?y(a,b):B(a,b)}function A(a){a._onerror&&a._onerror(a._result),E(a)}function B(a,b){a._state===da&&(a._result=b,a._state=ea,0!==a._subscribers.length&&Y(E,a))}function C(a,b){a._state===da&&(a._state=fa,a._result=b,Y(A,a))}function D(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ea]=c,e[f+fa]=d,0===f&&a._state&&Y(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?H(c,d,e,f):e(f);a._subscribers.length=0}}function F(){this.error=null}function G(a,b){try{return a(b)}catch(c){return ha.error=c,ha}}function H(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=G(c,d),e===ha?(i=!0,f=e.error,e=null):h=!0,b===e)return void C(b,t())}else e=d,h=!0;b._state!==da||(j&&h?z(b,e):i?C(b,f):a===ea?B(b,e):a===fa&&C(b,e))}function I(a,b){try{b(function(b){z(a,b)},function(b){C(a,b)})}catch(c){C(a,c)}}function J(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(r),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?B(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&B(c.promise,c._result))):C(c.promise,c._validationError())}function K(a){return new ia(this,a).promise}function L(a){function b(a){z(e,a)}function c(a){C(e,a)}var d=this,e=new d(r);if(!W(a))return C(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===da&&f>g;g++)D(d.resolve(a[g]),void 0,b,c);return e}function M(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(r);return z(c,a),c}function N(a){var b=this,c=new b(r);return C(c,a),c}function O(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Q(a){this._id=na++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==a&&(g(a)||O(),this instanceof Q||P(),I(this,a))}function R(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=oa)}var S;S=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var T,U,V,W=S,X=0,Y=({}.toString,function(a,b){ca[X]=a,ca[X+1]=b,X+=2,2===X&&(U?U(p):V())}),Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3);V=aa?k():_?m():ba?n():void 0===Z&&"function"==typeof b?q():o();var da=void 0,ea=1,fa=2,ga=new F,ha=new F;J.prototype._validateInput=function(a){return W(a)},J.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},J.prototype._init=function(){this._result=new Array(this.length)};var ia=J;J.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===da&&b>e;e++)a._eachEntry(d[e],e)},J.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==da?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},J.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===da&&(d._remaining--,a===fa?C(e,c):d._result[b]=c),0===d._remaining&&B(e,d._result)},J.prototype._willSettleAt=function(a,b){var c=this;D(a,void 0,function(a){c._settledAt(ea,b,a)},function(a){c._settledAt(fa,b,a)})};var ja=K,ka=L,la=M,ma=N,na=0,oa=Q;Q.all=ja,Q.race=ka,Q.resolve=la,Q.reject=ma,Q._setScheduler=i,Q._setAsap=j,Q._asap=Y,Q.prototype={constructor:Q,then:function(a,b){var c=this,d=c._state;if(d===ea&&!a||d===fa&&!b)return this;var e=new this.constructor(r),f=c._result;if(d){var g=arguments[d-1];Y(function(){H(d,e,g,f)})}else D(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var pa=R,qa={Promise:oa,polyfill:pa};"function"==typeof a&&a.amd?a(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:"undefined"!=typeof this&&(this.ES6Promise=qa),pa()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:259}],282:[function(a,b,c){(function(){c.ACCEPT_HEADER={xml:"application/xml",json:"application/json",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",csv:"text/comma-separated-values",fasta:"text/x-fasta",gff3:"text/x-gff3",bed:"text/x-bed",objects:"application/json;type=objects",jsonobjects:"application/json;type=objects",jsontable:"application/json;type=table",jsonrows:"application/json;type=rows",jsoncount:"application/json;type=count",jsonp:"application/javascript",jsonpobjects:"application/javascript;type=objects",jsonptable:"application/javascript;type=table",jsonprows:"application/javascript;type=rows",jsonpcount:"application/javascript;type=count"}}).call(this)},{}],283:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;f=a("url"),d=a("JSONStream"),n=a("http"),b=a("./constants").ACCEPT_HEADER,i=a("./version").VERSION,u=t=a("./util"),l=u.error,k=u.defer,p=u.merge,o=u.invoke,h="node-http/imjs-"+i,e=/,\s*$/,g="application/x-www-form-urlencoded",c.supports=function(){return!0},s=function(a,b,c){return function(a){var e,f;return null==a.pipe?c(new Error("response is not a stream")):(a.on("error",c),null!=a.statusCode&&200!==a.statusCode?(e=d.parse("error"),e.pause(),a.pipe(e),c([a.statusCode,e])):(f=d.parse("results.*"),f.pause(),a.pipe(f),b(f)))}},m=function(a,b,c,d){var e,f;return e=a.type,f=a.url,"Could not parse response to "+e+" "+f+': "'+b+'" ('+d+": "+c+")"},j=function(a,b,c){return function(d){var e;return e="",d.on("data",function(a){return e+=a}),d.on("error",c),d.on("end",function(){var f,g,h,i,j,k,l;if(f=d.headers["content-type"],"application/json"!==f&&!/json/.test(a.dataType)&&!/json/.test(a.data.format))return(j=e.match(/\[ERROR\] (\d+)([\s\S]*)/))?c(new Error(j[2])):(i=200<=(l=d.statusCode)&&400>l?b:c)(e);if(""===e&&200===d.statusCode)return b();try{return k=JSON.parse(e),(h=k.error)?c(new Error(h)):b(k)}catch(n){return g=n,c(d.statusCode>=400?new Error(d.statusCode):new Error(m(a,e,g,d.statusCode)))}})}},c.iterReq=function(a,b,c){return function(d,e,f,g,h){var i,j,k,m,n;return null==e&&(e={}),null==f&&(f=function(){}),null==g&&(g=function(){}),null==h&&(h=function(){}),t.isFunction(e)&&(n=[{},e,f,g],e=n[0],f=n[1],g=n[2],h=n[3]),m=p({format:c},e,{query:d.toXML()}),i=function(a){return a.on("data",f),a.on("error",g),a.on("end",h),setTimeout(function(){return null!=a.resume?a.resume():void 0},3),a},k=function(a){var b,c;return c=a[0],b=a[1],b.on("data",g),b.on("error",g),b.on("end",h),null!=b.resume&&b.resume(),l(c)},j=this.makeRequest(a,b,m,null,!0),j.then(i,k),j}},r=function(a,b,c){var d;return d=setTimeout(function(){return b("Request timed out.")},a),c.then(function(){return cancelTimeout(d)})},q=function(a){var c,d,e,i,j,k,l,m;if(!a.url)throw new Error("No url provided in "+JSON.stringify(a));if("string"==typeof a.data){if(e=a.data,"GET"===(k=a.type)||"DELETE"===k)throw new Error("Invalid request. "+a.type+" requests must not have bodies")}else e=t.querystring(a.data);if(d=f.parse(a.url,!0),d.withCredentials=!1,d.method=a.type||"GET",null!=a.port&&(d.port=a.port),d.headers={"User-Agent":h,Accept:b[a.dataType]},("GET"===(l=d.method)||"DELETE"===l)&&(null!=e?e.length:void 0)?(i=/\?/.test(d.path)?"&":"?",d.path+=i+e,e=null):(d.headers["Content-Type"]=(a.contentType||g)+"; charset=UTF-8",d.headers["Content-Length"]=e.length),null!=a.headers){m=a.headers;for(c in m)j=m[c],d.headers[c]=j}return null!=a.auth&&(d.auth=a.auth),[d,e]},c.doReq=function(a,b){var c,d,e,f,g,h,i,l,m,o,p;o=k(),f=o.promise,i=o.resolve,g=o.reject,f.then(null,a.error);try{p=q(a),m=p[0],e=p[1],d=(b?s:j)(a,i,g),h=n.request(m,d),h.on("error",function(b){return g(new Error("Error: "+m.method+" "+a.url+": "+b))}),null!=e&&h.write(e),h.end(),l=a.timeout,l>0&&r(l,g,f)}catch(t){c=t,g(c)}return f}}).call(this)},{"./constants":282,"./util":294,"./version":295,JSONStream:297,http:253,url:277}],284:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q={}.hasOwnProperty,r=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},s=function(a,b){return function(){return a.apply(b,arguments)}};k=a("./util"),n=c,o=k.uniqBy,i=k.difference,h=k.defer,p=k.withCB,m=k.id,l=k.get,j=k.fold,g=k.concatMap,f=6e4,b=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b;return a.prototype.getStats=function(a){return null!=a?this.stats[a]:this.stats},b=g(l("matches")),a.prototype.getMatches=function(a){var c;return"MATCH"===a?this.matches[a]:null!=(c=b(this.matches[a]))?c:[]},a.prototype.getMatchIds=function(a){return null!=a?this.getMatches(a).map(l("id")):this.allMatchIds()},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){var a;return(a=j(function(a){return function(b,c){return b.concat(a.getMatchIds(c))}}(this)))(this.goodMatchIds(),["DUPLICATE","WILDCARD","TYPE_CONVERTED","OTHER"])},a}(),e=function(){function a(a){var b,c;for(b in a)q.call(a,b)&&(c=a[b],this[b]=c)}var b,c,d,e;return e=o(m),b=g(m),c=function(a){var c,d;return b(function(){var b,e;b=a.identifiers,e=[];for(c in b)d=b[c],e.push(d);return e}())},d=function(a,b){return null==b||r.call(c(a),b)>=0},a.prototype.getStats=function(a){switch(a){case"objects":return this.getObjectStats();case"identifiers":return this.getIdentifierStats();default:return{objects:this.getObjectStats(),identifiers:this.getIdentifierStats()}}},a.prototype.getIdentifierStats=function(){var a,c,d,f,g,h;return h=function(a){var c,d;return e(b(function(){var b,e,f;for(f=[],b=0,e=a.length;e>b;b++)d=a[b],f.push(function(){var a;a=[];for(c in null!=d?d.identifiers:void 0)a.push(c);return a}());return f}()))},f=h(this.getMatches("MATCH")),c=h(this.getMatches()),g=f.length,a=c.length,d=i(c,f).length,{matches:g,all:a,issues:d}},a.prototype.getObjectStats=function(){var a,b,d,e;return e=this.goodMatchIds().length,a=this.allMatchIds().length,b=function(){var a;a=[];for(m in this)q.call(this,m)&&(d=this[m],r.call(c(d),"MATCH")<0&&a.push(m));return a}.call(this).length,{matches:e,all:a,issues:b}},a.prototype.getMatches=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(b));return c},a.prototype.getMatchIds=function(a){var b,c;c=[];for(m in this)q.call(this,m)&&(b=this[m],d(b,a)&&c.push(m));return c},a.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},a.prototype.allMatchIds=function(){return this.getMatchIds()},a}(),d=function(){function a(a,b){this.uid=a,this.service=b,this.del=s(this.del,this),this.fetchResults=s(this.fetchResults,this),this.fetchErrorMessage=s(this.fetchErrorMessage,this),this.fetchStatus=s(this.fetchStatus,this)}return a.prototype.fetchStatus=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("status")))},a.prototype.fetchErrorMessage=function(a){return p(a,this.service.get("ids/"+this.uid+"/status").then(l("message")))},a.prototype.fetchResults=function(a){var c,d;return c=this.service.get("ids/"+this.uid+"/result").then(l("results")),d=this.service.fetchVersion(),d.then(function(a){return c.then(function(c){return a>=16?new b(c):new e(c)})})},a.prototype.del=function(a){return p(a,this.service.makeRequest("DELETE","ids/"+this.uid))},a.prototype.decay=50,a.prototype.poll=function(a,b,c){var d,e,g,i,j,k,l;return l=h(),g=l.promise,j=l.resolve,i=l.reject,g.then(a,b),e=null!=c?c:function(){},k=this.fetchStatus(),k.then(null,i),d=this.decay,this.decay=Math.min(f,1.25*d),k.then(function(a){return function(b){switch(e(b),b){case"SUCCESS":return a.fetchResults().then(j,i);case"ERROR":return a.fetchErrorMessage().then(i,i);default:return setTimeout(function(){return a.poll(j,i,e)},d)}}}(this)),g},a}(),d.prototype.wait=d.prototype.poll,d.create=function(a){return function(b){return new d(b,a)}},n.IDResolutionJob=d,n.CategoryResults=b,n.IdResults=e}).call(this)},{"./util":294}],285:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=function(a,b){return function(){return a.apply(b,arguments)}},s={}.hasOwnProperty,t=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};p=a("./util"),k=c,n=p.merge,q=p.withCB,i=p.get,l=p.invoke,e=p.REQUIRES_VERSION,o=p.set,h=p.dejoin,g="list/tags",f="lists/shares",b="lists/invitations",m=function(a){return"__folder__"===a.substr(0,a.indexOf(":"))},j=function(a){return a.substr(a.indexOf(":")+1)},d=function(){function a(a,b){var c,d;this.service=b,this._updateTags=r(this._updateTags,this),this.hasTag=r(this.hasTag,this);for(c in a)s.call(a,c)&&(d=a[c],this[c]=d);this.dateCreated=null!=this.dateCreated?new Date(this.dateCreated):null,this.folders=this.tags.filter(m).map(j)}var c;return a.prototype.hasTag=function(a){return t.call(this.tags,a)>=0},a.prototype.query=function(a){return null==a&&(a=["*"]),this.service.query({select:a,from:this.type,where:[[this.type,"IN",this.name]]})},a.prototype.del=function(a){return this.service.makeRequest("DELETE","lists",{name:this.name},a)},c=function(a){var b;return b=a.tags},a.prototype._updateTags=function(a,b){return null==a?(this.tags=b.slice(),this.folders=this.tags.filter(m).map(j)):void 0},a.prototype.fetchTags=function(a){return q(this._updateTags,a,this.service.makeRequest("GET","list/tags",{
name:this.name}).then(c))},a.prototype.addTags=function(a,b){var d;return d={name:this.name,tags:a},q(this._updateTags,b,this.service.makeRequest("POST","list/tags",d).then(c))},a.prototype.removeTags=function(a,b){var d;return d={name:this.name,tags:a},q(this._updateTags,b,this.service.makeRequest("DELETE","list/tags",d).then(c))},a.prototype.contents=function(a){return q(a,this.query().then(h).then(l("records")))},a.prototype.rename=function(a,b){var c;return c=this.service.post("lists/rename",{oldname:this.name,newname:a}).then(i("listName")).then(function(a){return function(b){return a.name=b}}(this)).then(this.service.fetchList),q(b,c)},a.prototype.copy=function(a,b){var c,d,e,f,g,h,j;return null==a&&(a={}),null==b&&(b=function(){}),1===arguments.length&&p.isFunction(a)&&(g=[{},a],a=g[0],b=g[1]),"string"==typeof a&&(a={name:a}),d=c=null!=(h=a.name)?h:""+this.name+"_copy",f=this.tags.concat(null!=(j=a.tags)?j:[]),e=this.query(["id"]),q(b,this.service.fetchLists().then(l("map",i("name"))).then(function(a){return function(b){var g;for(g=1;t.call(b,d)>=0;)d=""+c+"-"+g++;return e.then(l("saveAsList",{name:d,tags:f,description:a.description}))}}(this)))},a.prototype.enrichment=function(a,b){return this.service.enrichment(n({list:this.name},a),b)},a.prototype.shareWithUser=function(a,b){return q(b,this.service.post(f,{list:this.name,"with":a}))},a.prototype.inviteUserToShare=function(a,c,d){return null==c&&(c=!0),null==d&&(d=function(){}),q(d,this.service.post(b,{list:this.name,to:a,notify:!!c}))},a}(),k.List=d}).call(this)},{"./util":294}],286:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m=function(a,b){return function(){return a.apply(b,arguments)}},n=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};f=a("./table").Table,e=a("./path").PathInfo,l=a("./util"),i=l.flatten,h=l.find,g=l.error,k=l.omap,j=c,b=new f({name:"Object",tags:[],displayName:"Object",attributes:{},references:{},collections:{}}),d=function(){function a(a){var c,d;this.name=a.name,c=a.classes,this.findCommonType=m(this.findCommonType,this),this.findSharedAncestor=m(this.findSharedAncestor,this),this.getAncestorsOf=m(this.getAncestorsOf,this),this.getSubclassesOf=m(this.getSubclassesOf,this),this.getPathInfo=m(this.getPathInfo,this),d=k(function(a){return function(b,c){return[b,new f(c,a)]}}(this)),this.classes=d(c),this.classes["java.lang.Object"]=b}return a.prototype.getPathInfo=function(a,b){return e.parse(this,a,b)},a.prototype.getSubclassesOf=function(a){var b,c,d,e,f,g;if(c=a&&a.name?a:this.classes[a],null==c)throw new Error(""+a+" is not a table");d=[c.name],f=this.classes;for(e in f)b=f[e],g=c.name,n.call(b.parents(),g)>=0&&(d=d.concat(this.getSubclassesOf(b)));return d},a.prototype.getAncestorsOf=function(a){var b,c;if(b=a&&a.name?a:this.classes[a],null==b)throw new Error(""+a+" is not a table");return c=b.parents(),c.filter(function(a){return function(b){return a.classes[b]}}(this)).reduce(function(a){return function(b,c){return b.concat(a.getAncestorsOf(c))}}(this),c)},a.prototype.findSharedAncestor=function(a,b){var c,d,e;return null===b||null===a?null:a===b?a:(c=this.getAncestorsOf(a),n.call(c,b)>=0?b:(d=this.getAncestorsOf(b),n.call(d,a)>=0?a:e=h(c,function(a){return n.call(d,a)>=0})))},a.prototype.findCommonType=function(a){return null==a&&(a=[]),a.reduce(this.findSharedAncestor)},a}(),d.prototype.makePath=d.prototype.getPathInfo,d.prototype.findCommonTypeOfMultipleClasses=d.prototype.findCommonType,d.load=function(a){var b;try{return new d(a)}catch(c){throw b=c,new Error("Error loading model: "+b)}},d.INTEGRAL_TYPES=["int","Integer","long","Long"],d.FRACTIONAL_TYPES=["double","Double","float","Float"],d.NUMERIC_TYPES=d.INTEGRAL_TYPES.concat(d.FRACTIONAL_TYPES),d.BOOLEAN_TYPES=["boolean","Boolean"],j.Model=d}).call(this)},{"./path":287,"./table":292,"./util":294}],287:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q=function(a,b){return function(){return a.apply(b,arguments)}},r=[].slice,s=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};k=c,o=a("./util"),p=o.withCB,g=o.concatMap,j=o.get,f=o.any,m=o.set,h=o.copy,n=o.success,i=o.error,b={},d={},l=function(a,b,c){var d,e,f;return""+(null!=a?a.name:void 0)+"|"+(null!=a&&null!=(f=a.service)?f.root:void 0)+"|"+b+":"+function(){var a;a=[];for(d in c)e=c[d],a.push(""+d+"="+e);return a}()},e=function(){function a(a){var b,c;this.root=a.root,this.model=a.model,this.descriptors=a.descriptors,this.subclasses=a.subclasses,this.displayName=a.displayName,this.ident=a.ident,this.allDescriptors=q(this.allDescriptors,this),this.getChildNodes=q(this.getChildNodes,this),this.getDisplayName=q(this.getDisplayName,this),this.isa=q(this.isa,this),this.append=q(this.append,this),this.getParent=q(this.getParent,this),this.getEndClass=q(this.getEndClass,this),this.containsCollection=q(this.containsCollection,this),this.isCollection=q(this.isCollection,this),this.isReverseReference=q(this.isReverseReference,this),this.isReference=q(this.isReference,this),this.isClass=q(this.isClass,this),this.isAttribute=q(this.isAttribute,this),this.isRoot=q(this.isRoot,this),c=this.descriptors,this.mid=2<=c.length?r.call(c,0,b=c.length-1):(b=0,[]),this.end=c[b++],null==this.ident&&(this.ident=l(this.model,this,this.subclasses))}return a.prototype.isRoot=function(){return 0===this.descriptors.length},a.prototype.isAttribute=function(){return null!=this.end&&!this.isReference()},a.prototype.isClass=function(){return this.isRoot()||this.isReference()},a.prototype.isReference=function(){var a;return null!=(null!=(a=this.end)?a.referencedType:void 0)},a.prototype.isReverseReference=function(){var a,b,c,d,e;return this.isReference()&&this.mid.length>0?(e=this.end,d=e.reverseReference,c=e.referencedType,b=this.getParent(),a=b.getParent(),null!=c&&a.isa(c)&&b.end.name===d):!1},a.prototype.isCollection=function(){var a,b;return null!=(a=null!=(b=this.end)?b.isCollection:void 0)?a:!1},a.prototype.containsCollection=function(){return f(this.descriptors,function(a){return a.isCollection})},a.prototype.getEndClass=function(){var a;return this.model.classes[this.subclasses[this.toString()]||(null!=(a=this.end)?a.referencedType:void 0)]||this.root},a.prototype.getParent=function(){var b;if(this.isRoot())throw new Error("Root paths do not have parents");return b={root:this.root,model:this.model,descriptors:this.mid.slice(),subclasses:this.subclasses},new a(b)},a.prototype.append=function(b){var c,d;if(this.isAttribute())throw new Error(""+this+" is an attribute.");if(d="string"==typeof b?this.getType().fields[b]:b,null==d)throw new Error(""+b+" is not a field of "+this.getType());return c={root:this.root,model:this.model,descriptors:this.descriptors.concat([d]),subclasses:this.subclasses},new a(c)},a.prototype.isa=function(a){var b,c;return null==a?!1:this.isAttribute()?this.getType()===a:(b=a.name?a.name:""+a,c=this.getType(),b===c.name||s.call(this.model.getAncestorsOf(c),b)>=0)},a.prototype.getDisplayName=function(a){var c,d,e,f;return(d=this.displayName)?n(d):(null==this.namePromise&&(this.namePromise=(c=b[this.ident])?n(c):this.isRoot()&&this.root.displayName?n(this.root.displayName):null==this.model.service?i("No service"):(f="model"+g(function(a){return"/"+a.name})(this.allDescriptors()),e=m({format:"json"})(h(this.subclasses)),this.model.service.get(f,e).then(j("display")).then(function(a){return function(c){var d;return null!=b[d=a.ident]?b[d]:b[d]=c}}(this)))),p(a,this.namePromise))},a.prototype.getChildNodes=function(){var a,b,c,d,e;d=(null!=(c=this.getEndClass())?c.fields:void 0)||{},e=[];for(b in d)a=d[b],e.push(this.append(a));return e},a.prototype.allDescriptors=function(){return[this.root].concat(this.descriptors)},a.prototype.toString=function(){return this.allDescriptors().map(j("name")).join(".")},a.prototype.equals=function(a){return this===a||this.ident&&(null!=a?a.ident:void 0)===this.ident},a.prototype.getType=function(){var a,b;return(null!=(a=this.end)&&null!=(b=a.type)?b.replace(/java\.lang\./,""):void 0)||this.getEndClass()},a}(),e.prototype.toPathString=e.prototype.toString,e.parse=function(a,b,c){var f,g,h,i,j,k,m,n,o;return null==c&&(c={}),j=l(a,b,c),(f=d[j])?f:(n=(b+"").split("."),o=g=a.classes[n.shift()],k=o.name,h=function(){var d,e,f,h;for(h=[],d=0,e=n.length;e>d;d++){if(m=n[d],i=(null!=g?g.fields[m]:void 0)||(null!=(f=g=a.classes[c[k]])?f.fields[m]:void 0),!i)throw new Error("Could not find "+m+" in "+g+" when parsing "+b);k+="."+m,g=a.classes[i.type||i.referencedType],h.push(i)}return h}(),d[j]=new e({root:o,model:a,descriptors:h,subclasses:c,ident:j}))},e.flushCache=function(){return d={},b={}},k.PathInfo=e}).call(this)},{"./util":294}],288:[function(a,b,c){(function(){var c;c=a("es6-promise").Promise,b.exports=c}).call(this)},{"es6-promise":281}],289:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},aa=function(a,b){return function(){return a.apply(b,arguments)}},ba=[].slice,ca={}.hasOwnProperty;e=a("backbone-events-standalone"),B=c,B.xml=a("./xml"),S=a("./util"),h=S.REQUIRES_VERSION,T=S.withCB,F=S.merge,u=S.filter,K=S.partition,v=S.fold,p=S.concatMap,z=S.id,w=S.get,E=S.invoke,P=S.querystring,x=function(a){var b;if(b=null!=(null!=a?a.toLowerCase:void 0)?g.OP_DICT[a.toLowerCase()]:null,!b)throw new Error("Illegal constraint operator: "+a);return b},b=["path","op","code"],j=b.concat(["value","extraValue"]),i=["rowByRow","eachRow","recordByRecord","eachRecord","records","rows","table","tableRows","values"],f=function(a){return S.compose(a.fetchList,w("listName"))},d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=function(a){return null==a&&(a=""),a.substr(a.indexOf("."))},o=function(a){return null!=a?"<value>"+S.escape(a)+"</value>":"<nullValue/>"},l=function(a,b){var c,d;return function(){var e;e=[];for(c in a)d=a[c],_.call(b,c)>=0&&e.push(""+c+'="'+S.escape(d)+'" ');return e}().join("")},J=function(a){return"<constraint "+l(a,b)+"/>"},Q=function(a){return"<constraint "+l(a,["path","type"])+"/>"},M=function(a){return"<constraint "+l(a,j)+"/>"},H=function(a){return"<constraint "+l(a,b)+">"+p(o)(a.values)+"</constraint>"},A=function(a){return"<constraint "+l(a,b)+'ids="'+a.ids.join(",")+'"/>'},m=function(a){var b;return null!=a.values?H(a):null!=a.ids?A(a):null==a.op?Q(a):(b=a.op,_.call(g.NULL_OPS,b)>=0?J(a):M(a))},y=function(a){return a.replace(/^[^\.]+\./,"")},q=function(a){var b,c,d,e,f,g,h,i,j,k,l;return g=a.path,j=a.type,f=a.op,k=a.value,l=a.values,d=a.extraValue,e=a.ids,b=a.code,c=a.editable,i=a.switched,h=a.switchable,e=null!=e?e.slice():void 0,l=null!=l?l.slice():void 0,I({path:g,type:j,op:f,value:k,values:l,extraValue:d,ids:e,code:b,editable:c,switched:i,switchable:h})},n=function(a){var b;return b=q(a),b.path=y(b.path),b},I=function(a){var b,c;for(b in a)c=a[b],null==c&&delete a[b];return a},s=function(a,b){return"Did not remove a single constraint. original = "+a+", reduced = "+b},D=function(a,b){var c,d,e,f,h,i,j;if(c={path:a},null===b)c.op="IS NULL";else if(S.isArray(b))c.op="ONE OF",c.values=b;else if("string"==(i=typeof b)||"number"===i||"boolean"===i)j="function"==typeof b.toUpperCase?b.toUpperCase():void 0,_.call(g.NULL_OPS,j)>=0?c.op=b:(c.op="=",c.value=b);else if(e=function(){var a;a=[];for(d in b)h=b[d],a.push(d);return a}(),_.call(e,"isa")>=0)S.isArray(b.isa)?(c.op=d,c.values=b.isa):c.type=b.isa;else{_.call(e,"extraValue")>=0&&(c.extraValue=b.extraValue);for(d in b)f=b[d],"extraValue"!==d&&(c.op=d,S.isArray(f)?c.values=f:c.value=f)}return c},C=function(a){var b,c,d,e;return a=a.slice(),c={path:a.shift()},1===a.length?(b=a[0],e="function"==typeof b.toUpperCase?b.toUpperCase():void 0,_.call(g.NULL_OPS,e)>=0?c.op=b:c.type=b):a.length>=2&&(c.op=a[0],d=a[1],S.isArray(d)?c.values=d:c.value=d,3===a.length&&(c.extraValue=a[2])),c},O=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(""+b.path+" "+b.direction);return e}().join(" ")},N=function(a){var b,c,d,e,f,g,h;if(null==a)return[];for(c=a.split(/\s+/),d=function(){var a,b,d;for(d=[],e=a=0,b=c.length/2;b>=0?b>a:a>b;e=b>=0?++a:--a)d.push(2*e);return d}(),h=[],f=0,g=d.length;g>f;f++)b=d[f],h.push([c[b],c[b+1]]);return h},L=function(){var a,b;return b=this.sortOrder,this.sortOrder=function(){var c,d,e;for(e=[],c=0,d=b.length;d>c;c++)a=b[c],this.isRelevant(a.path)&&e.push(a);return e}.call(this),b.length!==this.sortOrder.length?this.trigger("change:sortorder change:orderby",this.sortOrder.slice()):void 0},g=function(){function a(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(i=null!=c?c:{},d=i.model,f=i.summaryFields,this.addConstraint=aa(this.addConstraint,this),this.expandStar=aa(this.expandStar,this),this.adjustPath=aa(this.adjustPath,this),this.select=aa(this.select,this),null==a&&(a={}),this.constraints=[],this.views=[],this.joins={},this.displayNames=S.copy(null!=(j=null!=(l=a.displayNames)?l:a.aliases)?j:{}),m=["name","title","comment","description","type"],g=0,h=m.length;h>g;g++)e=m[g],null!=a[e]&&(this[e]=a[e]);this.service=null!=b?b:{},this.model=null!=(n=null!=d?d:a.model)?n:{},this.summaryFields=null!=(o=null!=f?f:a.summaryFields)?o:{},this.root=null!=(p=a.root)?p:a.from,this.maxRows=null!=(q=null!=(r=a.size)?r:a.limit)?q:a.maxRows,this.start=null!=(s=null!=(k=a.start)?k:a.offset)?s:0,this.select(a.views||a.view||a.select||[]),this.addConstraints(a.constraints||a.where||[]),this.addJoins(a.joins||a.join||[]),this.orderBy(a.sortOrder||a.orderBy||[]),null!=a.constraintLogic&&(this.constraintLogic=a.constraintLogic),this.on("change:views",L,this)}var b,c,e,g,i,j,k,o,t;return a.JOIN_STYLES=["INNER","OUTER"],a.BIO_FORMATS=["gff3","fasta","bed"],a.NULL_OPS=["IS NULL","IS NOT NULL"],a.ATTRIBUTE_VALUE_OPS=["=","!=",">",">=","<","<=","CONTAINS","LIKE","NOT LIKE"],a.MULTIVALUE_OPS=["ONE OF","NONE OF"],a.RANGE_OPS=["OVERLAPS","DOES NOT OVERLAP","OUTSIDE","WITHIN","CONTAINS","DOES NOT CONTAIN"],a.TERNARY_OPS=["LOOKUP"],a.LOOP_OPS=["=","!="],a.LIST_OPS=["IN","NOT IN"],a.OP_DICT={"=":"=","==":"==",eq:"=",eqq:"==","!=":"!=",ne:"!=",">":">",gt:">",">=":">=",ge:">=","<":"<",lt:"<","<=":"<=",le:"<=",contains:"CONTAINS",CONTAINS:"CONTAINS","does not contain":"DOES NOT CONTAIN","DOES NOT CONTAIN":"DOES NOT CONTAIN",like:"LIKE",LIKE:"LIKE","not like":"NOT LIKE","NOT LIKE":"NOT LIKE",lookup:"LOOKUP","IS NULL":"IS NULL","is null":"IS NULL","IS NOT NULL":"IS NOT NULL","is not null":"IS NOT NULL","ONE OF":"ONE OF","one of":"ONE OF","NONE OF":"NONE OF","none of":"NONE OF","in":"IN","not in":"NOT IN",IN:"IN","NOT IN":"NOT IN",WITHIN:"WITHIN",within:"WITHIN",OVERLAPS:"OVERLAPS",overlaps:"OVERLAPS","DOES NOT OVERLAP":"DOES NOT OVERLAP","does not overlap":"DOES NOT OVERLAP",OUTSIDE:"OUTSIDE",outside:"OUTSIDE",ISA:"ISA",isa:"ISA"},i=["name","view","sortOrder","constraintLogic","title","description","comment"],c=["path","type","op","code","value","ids"],k=function(a,b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a.hasAttribute(c)&&f.push([c,a.getAttribute(c)]);return f},e=function(a,b){var c,d,e,f,g;for(f=a.getElementsByTagName(b),g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(c);return g},t=function(a){return function(b){return b.getAttribute(a)}},a.fromXML=function(a){var b,d,f,g,h,j,l;if(d=B.xml.parse(a),j=e(d,"query")[0]||e(d,"template")[0],!j)throw new Error("no query in xml");return g=t("path"),l=t("style"),h=S.pairsToObj(k(j,i)),h.view=h.view.split(/\s+/),h.sortOrder=N(h.sortOrder),h.joins=function(){var a,b,c,d;for(c=e(j,"join"),d=[],a=0,b=c.length;b>a;a++)f=c[a],"OUTER"===l(f)&&d.push(g(f));return d}(),h.constraints=function(){var a,d,f,g;for(f=e(j,"constraint"),g=[],a=0,d=f.length;d>a;a++)b=f[a],g.push(function(a){var b,d,f,g,h;return b=S.pairsToObj(k(a,c)),null!=b.ids&&(b.ids=function(){var a,c,d,e;for(d=b.ids.split(","),e=[],a=0,c=d.length;c>a;a++)h=d[a],e.push(parseInt(h,10));return e}()),g=e(a,"value"),g.length&&(b.values=function(){var a,b,c;for(c=[],a=0,b=g.length;b>a;a++)f=g[a],c.push(function(){var a,b,c,e;for(c=f.childNodes,e=[],a=0,b=c.length;b>a;a++)d=c[a],e.push(d.data);return e}().join(""));return c}()),b}(b));return g}(),h},a.prototype.constraints=[],a.prototype.views=[],a.prototype.joins={},a.prototype.constraintLogic="",a.prototype.sortOrder="",a.prototype.name=null,a.prototype.title=null,a.prototype.comment=null,a.prototype.description=null,a.prototype.removeFromSelect=function(a){var b,c,d,e;return null==a&&(a=[]),a=S.stringList(a),b=S.compose(this.expandStar,this.adjustPath),a=S.flatten(function(){var c,e,f;for(f=[],c=0,e=a.length;e>c;c++)d=a[c],f.push(b(d));return f}()),this.sortOrder=function(){var b,d,e,f,g;for(e=this.sortOrder,g=[],b=0,d=e.length;d>b;b++)c=e[b],f=c.path,_.call(a,f)>=0||g.push(c);return g}.call(this),this.views=function(){var b,c,d,f;for(d=this.views,f=[],b=0,c=d.length;c>b;b++)e=d[b],_.call(a,e)>=0||f.push(e);return f}.call(this),this.trigger("remove:view",a),this.trigger("change:views",this.views),this.trigger("change",this.views)},a.prototype.removeConstraint=function(a,b){var c,d,e,f;if(null==b&&(b=!1),e=this.constraints,d="string"==typeof a?function(b){return b.code===a}:function(b){var c,d;return b.path===a.path&&b.op===a.op&&b.value===a.value&&b.extraValue===a.extraValue&&a.type===b.type&&(null!=(c=b.values)?c.join("%%"):void 0)===(null!=(d=a.values)?d.join("%%"):void 0)},f=function(){var a,b,f;for(f=[],a=0,b=e.length;b>a;a++)c=e[a],d(c)||f.push(c);return f}(),f.length!==e.length-1)throw new Error(s(e,f));return this.constraints=f,b?void 0:(this.trigger("change:constraints"),this.trigger("change"),this.trigger("removed:constraint",S.find(e,d)))},a.prototype.addToSelect=function(a,b){var c,d,e,f,g,h,i,j;if(null==a&&(a=[]),null==b&&(b={}),a=S.stringList(a),d=S.compose(this.expandStar,this.adjustPath),f=S.flatten(function(){var b,c,e;for(e=[],b=0,c=a.length;c>b;b++)g=a[b],e.push(d(g));return e}()),c=function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)e=f[a],_.call(this.views,e)>=0&&c.push(e);return c}.call(this),c.length)throw new Error(""+c+" already in the select list");if(c=function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)e=f[a],function(){var a,b,c;for(c=[],a=0,b=f.length;b>a;a++)h=f[a],h===e&&c.push(h);return c}().length>1&&c.push(e);return c}(),c.length)throw new Error(""+c+" specified multiple times as arguments to addToSelect");return(i=this.views).push.apply(i,f),b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","add:view","change:views"]):(this.trigger("add:view change:views",f),this.trigger("change")),this},a.prototype.select=function(a,b){var c,d;d=this.views.slice();try{this.views=[],this.addToSelect(a,b)}catch(e){c=e,this.views=d,S.error(c)}return this},a.prototype.adjustPath=function(a){return a=a&&a.name?a.name:""+a,null!=this.root?a.match("^"+this.root)||(a=this.root+"."+a):this.root=a.split(".")[0],a},a.prototype.getPossiblePaths=function(a,b,c){var d,e,f,g,h;return null==a&&(a=3),null==b&&(b=!0),null==c&&(c=null),g="string"==typeof c?function(a){return a[c]()}:c,d=function(a){return function(c,e){var f,g,h,i,j,k;return j=a.getPathInfo(c),!b&&j.isReverseReference()?[]:j.isAttribute()?[j]:(f=j.getType(),k=p(function(a){return d(""+c+"."+a.name,e-1)}),i=f&&e>0?k(function(){var a,b;a=f.fields,b=[];for(h in a)g=a[h],b.push(g);return b}()):[],[j].concat(i))}}(this),e=""+a+"-"+b,null==this._possiblePaths&&(this._possiblePaths={}),f=(null!=(h=this._possiblePaths)[e]?h[e]:h[e]=d(this.root,a)).slice(),null!=g?f.filter(g):f},a.prototype.getPathInfo=function(a){var b,c,d;return b=this.adjustPath(a),c=null!=(d=this.model)&&"function"==typeof d.getPathInfo?d.getPathInfo(b,this.getSubclasses()):void 0,c&&b in this.displayNames&&(c.displayName=this.displayNames[b]),c},a.prototype.makePath=a.prototype.getPathInfo,o=function(a){return[a.path,a.type]},j=S.compose(S.pairsToObj,S.map(o),u(w("type"))),a.prototype.getSubclasses=function(){return j(this.constraints)},a.prototype.getType=function(a){return this.getPathInfo(a).getType()},a.prototype.getViewNodes=function(){var a,b;return b=function(a){return function(b){return a.getPathInfo(b).getParent()}}(this),S.uniqBy(String,function(){var c,d,e,f;for(e=this.views,f=[],c=0,d=e.length;d>c;c++)a=e[c],f.push(b(a));return f}.call(this))},a.prototype.isInView=function(a){var b,c,d;if(b=this.getPathInfo(a),!b)throw new Error("Invalid path: "+a);return b.isAttribute()?(d=b.toString(),_.call(this.views,d)>=0):(c=b.toString(),S.any(this.getViewNodes(),function(a){return a.toString()===c}))},a.prototype.isConstrained=function(a,b){var c,d;if(null==b&&(b=!1),c=this.getPathInfo(a),!c)throw new Error("Invalid path: "+a);return d=function(a){return null!=a.op&&a.path===c.toString()},!c.isAttribute()&&b&&(d=function(a){return function(b){return null!=b.op&&(b.path===c.toString()||c.equals(a.getPathInfo(b.path).getParent()))}}(this)),S.any(this.constraints,d)},a.prototype.canHaveMultipleValues=function(a){return this.getPathInfo(a).containsCollection()},a.prototype.getQueryNodes=function(){var a,b,c,d;return d=this.getViewNodes(),b=function(){var b,d,e,f;for(e=this.constraints,f=[],b=0,d=e.length;d>b;b++)a=e[b],null==a.type&&(c=this.getPathInfo(a.path),c.isAttribute()?f.push(c.getParent()):f.push(c));return f}.call(this),S.uniqBy(String,d.concat(b))},a.prototype.isInQuery=function(a){var b,c,d,e,f,g;if(c=this.getPathInfo(a)){for(d=c.toPathString(),g=this.views.concat(function(){var a,c,d,e;for(d=this.constraints,e=[],a=0,c=d.length;c>a;a++)b=d[a],null==b.type&&e.push(b.path);return e}.call(this)),e=0,f=g.length;f>e;e++)if(a=g[e],0===a.indexOf(d))return!0;return!1}return!0},a.prototype.isRelevant=function(a){var b,c,d;return c=this.getPathInfo(a),c.isAttribute()&&(c=c.getParent()),d=c.toString(),b=this.getViewNodes(),S.any(b,function(a){return a.toPathString()===d})},a.prototype.expandStar=function(a){var b,c,d,e,f,g,h,i;if(/\*$/.test(a))if(h=a.substr(0,a.lastIndexOf(".")),d=function(a){return h+a},c=this.getType(h),/\.\*$/.test(a)){if(c&&this.summaryFields[c.name])return e=S.compose(d,r),function(){var a,b,d,g;for(d=this.summaryFields[c.name],g=[],a=0,b=d.length;b>a;a++)f=d[a],this.hasView(f)||g.push(e(f));return g}.call(this)}else if(/\.\*\*$/.test(a))return i=this.expandStar(h+".*"),b=function(){var a;a=[];for(g in c.attributes)a.push(d("."+g));return a}(),S.uniqBy(z,i.concat(b));return a},a.prototype.isOuterJoin=function(a){return"OUTER"===this.joins[this.adjustPath(a)]},a.prototype.hasView=function(a){var b;return this.views&&(b=this.adjustPath(a),_.call(this.views,b)>=0)},a.prototype.count=function(a){if(this.service.count)return this.service.count(this,a);throw new Error("This query has no service with count functionality attached.")},a.prototype.appendToList=function(a,b){var c,d,e,g,h;return(null!=a?a.name:void 0)?(c=a.name,h=function(b,c){return null==b?a.size=c.size:void 0}):(c=String(a),h=null),g=this.makeListQuery(),e={listName:c,query:g.toXML()},d=f(this.service),T(h,b,this.service.post("query/append/tolist",e).then(d))},a.prototype.selectPreservingImpliedConstraints=function(a){var b,c,d,e,f;for(null==a&&(a=[]),c=this.clone(),c.select(a),f=this.getViewNodes(),d=0,e=f.length;e>d;d++)b=f[d],this.isOuterJoined(b)||c.isInView(b||c.isConstrained(b))||null==b.getEndClass().fields.id||c.addConstraint([b.append("id"),"IS NOT NULL"]);return c},a.prototype.makeListQuery=function(){var a,b;return a=this.views.slice(),1===a.length&&(null!=(b=a[0])?b.match(/\.id$/):void 0)||(a=["id"]),this.selectPreservingImpliedConstraints(a)},a.prototype.saveAsList=function(a,b){var c,d;return d=this.makeListQuery(),c=S.copy(a),c.listName=c.listName||c.name,c.query=d.toXML(),a.tags&&(c.tags=a.tags.join(";")),T(b,this.service.post("query/tolist",c).then(f(this.service)))},a.prototype.summarise=function(a,b,c){return this.filterSummary(a,"",b,c)},a.prototype.summarize=function(){var a;return a=1<=arguments.length?ba.call(arguments,0):[],this.summarise.apply(this,a)},g=function(a){var b,c,d,e,f,g,h;for(b=null!=(null!=(g=a.results[0])?g.max:void 0),h=a.results,e=0,f=h.length;f>e;e++)c=h[e],c.count=parseInt(c.count,10);return d={uniqueValues:a.uniqueValues,filteredCount:a.filteredCount},b&&(d=F(d,a.results[0])),a.stats=d,a},a.prototype.filterSummary=function(a,b,c,d){var e,f,h;return null==d&&(d=function(){}),S.isFunction(c)&&(h=[c,null],d=h[0],c=h[1]),a=this.adjustPath(a),f=this.clone(),_.call(f.views,a)<0&&f.views.push(a),e={query:f.toXML(),summaryPath:a,format:"jsonrows"},c&&(e.size=c),b&&(e.filterTerm=b),T(d,this.service.post("query/results",e).then(g))},a.prototype.clone=function(b){var c,d,e,f;if(c=new a(this,this.service),null==c._callbacks&&(c._callbacks={}),b){f=this._callbacks;for(d in f)ca.call(f,d)&&(e=f[d],c._callbacks[d]=e);c.off("change:views",L,this)}return c},a.prototype.next=function(){var a;return a=this.clone(),this.maxRows&&(a.start=this.start+this.maxRows),a},a.prototype.previous=function(){var a;return a=this.clone(),this.maxRows?a.start=this.start-this.maxRows:a.start=0,a},a.prototype.getSortDirection=function(a){var b,c;if(b=this.adjustPath(a),!this.isInQuery(b)&&!this.isRelevant(b))throw new Error(""+a+" is not in the query");return c=S.find(this.sortOrder,function(a){var c;return c=a.path,b===c}),null!=c?c.direction:void 0},a.prototype.isOuterJoined=function(a){var b,c,d;a=this.adjustPath(a),d=this.joins;for(c in d)if(b=d[c],"OUTER"===b&&0===a.indexOf(c))return!0;return!1},a.prototype.getOuterJoin=function(a){var b,c;return a=this.adjustPath(a),b=function(){var a;a=[];for(c in this.joins)a.push(c);return a}.call(this).sort(function(a,b){return b.length-a.length}),S.find(b,function(b){return function(c){return"OUTER"===b.joins[c]&&0===a.indexOf(c)}}(this))},a.prototype._parse_sort_order=function(a){var b,c,d,e,f,g;if(null==a)throw new Error("No input");if("string"==typeof a)e={path:a,direction:"ASC"};else if(S.isArray(a))d=a[0],b=a[1],e={path:d,direction:b};else if(null==a.path){for(c in a)f=a[c],g=[c,f],d=g[0],b=g[1];e={path:d,direction:b}}else d=a.path,b=a.direction,e={path:d,direction:b};return e.path=this.adjustPath(e.path),null==e.direction&&(e.direction="ASC"),e.direction=e.direction.toUpperCase(),e},a.prototype.addOrSetSortOrder=function(a){var b,c;return a=this._parse_sort_order(a),b=this.getSortDirection(a.path),null==b?this.addSortOrder(a):b!==a.direction&&(c=S.find(this.sortOrder,function(b){var c;return c=b.path,c===a.path}),c.direction=a.direction,this.trigger("change:sortorder",this.sortOrder),this.trigger("change")),this},a.prototype.addSortOrder=function(a,b){var c;return c=(null!=b?b:{}).silent,this.sortOrder.push(this._parse_sort_order(a)),c?void 0:(this.trigger("add:sortorder",a),this.trigger("change:sortorder",this.sortOrder),this.trigger("change"))},a.prototype.orderBy=function(a,b){var c,d,e,f,g,h,i,j;for(null==b&&(b={}),f=this.sortOrder.slice(),this.sortOrder=[],h=0,i=a.length;i>h;h++)e=a[h],this.addSortOrder(this._parse_sort_order(e),{silent:!0});return c=function(){var a,b,c,e,f;for(c=this.sortOrder,f=[],a=0,b=c.length;b>a;a++)e=c[a],g=e.path,d=e.direction,f.push({path:g,direction:d});return f}.call(this),this.trigger("set:sortorder",c),O(f)!==this.getSorting()&&(b.silent?b.events=(null!=(j=b.events)?j:[]).concat(["change","change:sortorder"]):(this.trigger("change:sortorder",c),this.trigger("change"))),this},a.prototype.addJoins=function(a){var b,c,d,e,f,g,h;if(S.isArray(a)){for(g=[],e=0,f=a.length;f>e;e++)b=a[e],g.push(this.addJoin(b));return g}h=[];for(c in a)d=a[c],h.push(this.addJoin({path:c,style:d}));return h},a.prototype.addJoin=function(a){return"string"==typeof a&&(a={path:a,style:"OUTER"}),this.setJoinStyle(a.path,a.style)},a.prototype.setJoinStyle=function(b,c){if(null==c&&(c="OUTER"),b=this.adjustPath(b),c=c.toUpperCase(),_.call(a.JOIN_STYLES,c)<0)throw new Error("Invalid join style: "+c);return this.joins[b]!==c&&(this.joins[b]=c,this.trigger("change:joins",{path:b,style:c}),this.trigger("change")),this},a.prototype.addConstraints=function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b="and"),this.__silent__=!0,e=this.constraintLogic,S.isArray(a))for(h=0,i=a.length;i>h;h++)c=a[h],this.addConstraint(c,b);else{g=function(a){return function(c,d){return a.addConstraint(D(c,d),b)}}(this);for(f in a)d=a[f],g(f,d)}return this.__silent__=!1,this.trigger("add:constraint"),this.trigger("change:constraints"),e!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")},a.prototype.addConstraint=function(a,b){var c,e,f,g,h,i,j;if(null==b&&(b="and"),"and"!==b&&"or"!==b)throw new Error("Unknown logical conjunction: "+b);return a=S.isArray(a)?C(a):q(a),"OFF"===a.switched?this:(a.path=this.adjustPath(a.path),null==a.type&&(a.op=x(a.op)),this.constraints.push(a),f="or"===b||(null!=(j=this.constraintLogic)?j.length:void 0)>0,g=this.constraints.length,i=this.constraintLogic,f&&(h=2===g?""+d[0]+" "+b+" "+d[1]:(e=this.constraintLogic,e||(e=function(){var a,b,e;for(e=[],c=a=0,b=g-2;b>=0?b>=a:a>=b;c=b>=0?++a:--a)e.push(d[c]);return e}().join(" and ")),"("+e+") "+b+" "+d[g-1]),this.constraintLogic=h),this.__silent__||(this.trigger("add:constraint",a),this.trigger("change:constraints"),i!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")),this)},a.prototype.getSorting=function(){return O(this.sortOrder)},a.prototype.getConstraintXML=function(){var a,b;return b=function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],(null==a.type||this.isInQuery(a.path))&&e.push(a);return e}.call(this),b.length?p(m)(p(z)(K(function(a){return null!=a.type})(b))):""},a.prototype.getJoinXML=function(){var a,b,c;return c=function(){var c,d;c=this.joins,d=[];for(a in c)b=c[a],this.isInQuery(a)&&"OUTER"===b&&d.push('<join path="'+a+'" style="OUTER"/>');return d}.call(this),c.join("")},a.prototype.toXML=function(){var a,b,c,d;return a={model:this.model.name,view:this.views.join(" "),sortOrder:this.getSorting(),constraintLogic:this.constraintLogic},null!=this.name&&(a.name=this.name),b=function(){var b;b=[];for(c in a)d=a[c],d&&b.push(c+'="'+d+'"');return b}().join(" "),"<query "+b+" >"+this.getJoinXML()+this.getConstraintXML()+"</query>"},a.prototype.toJSON=function(){var a,b,c,d,e;return I({name:this.name,title:this.title,comment:this.comment,description:this.description,constraintLogic:this.constraintLogic,from:this.root,select:function(){var a,b,c,d;for(c=this.views,d=[],a=0,b=c.length;b>a;a++)e=c[a],d.push(y(e));return d}.call(this),orderBy:function(){var a,d,e,f,g;for(e=this.sortOrder,g=[],a=0,d=e.length;d>a;a++)f=e[a],c=f.path,b=f.direction,g.push({path:y(c),direction:b});return g}.call(this),joins:function(){var a,b;a=this.joins,b=[];for(c in a)d=a[c],"OUTER"===d&&b.push(y(c));return b}.call(this),where:function(){var b,c,d,e;for(d=this.constraints,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(n(a));return e}.call(this)})},a.prototype.fetchCode=function(a,b){var c;return c={query:this.toXML(),lang:a},T(b,this.service.post("query/code",c).then(this.service.VERIFIER).then(w("code")))},a.prototype.setName=function(a){this.name=a},a.prototype.save=function(a,b){return h(this.service,16,function(c){return function(){var d,e;return S.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),d={type:"PUT",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},T(b,c.service.authorise(d)).then(function(a){return c.service.doReq(a)}).then(function(a){return a.queries})}}(this))},a.prototype.store=function(a,b){return h(this.service,16,function(c){return function(){var d,e,f,g;return S.isFunction(a)&&(g=[null,a],a=g[0],b=g[1]),null!=a&&c.setName(a),f=function(a,b){return null==a?c.setName(b):void 0},d=S.compose(w(c.name),w("queries")),e={type:"POST",path:"user/queries",data:c.toXML(),contentType:"application/xml",dataType:"json"},T(b,f,c.service.authorise(e)).then(function(a){return c.service.doReq(a);
}).then(d)}}(this))},a.prototype.saveAsTemplate=function(a,b){return h(this.service,16,function(c){return function(){var d,e;if(S.isFunction(a)&&(e=[null,a],a=e[0],b=e[1]),null!=a&&c.setName(a),!c.name)throw new Error("Templates must have a name");return d={type:"POST",path:"templates",data:"<template "+l(c,["name","title","comment"])+">"+c.toXML()+"</template>",contentType:"application/xml",dataType:"json"},T(b,c.service.authorise(d).then(function(a){return c.service.doReq(a)}))}}(this))},a.prototype.getCodeURI=function(a){var b,c;return b={query:this.toXML(),lang:a,format:"text"},null!=(null!=(c=this.service)?c.token:void 0)&&(b.token=this.service.token),""+this.service.root+"query/code?"+P(b)},a.prototype.getExportURI=function(b,c){var d,e;return null==b&&(b="tab"),null==c&&(c={}),_.call(a.BIO_FORMATS,b)>=0?this["get"+b.toUpperCase()+"URI"](c):(d=F(c,{query:this.toXML(),format:b}),null!=(null!=(e=this.service)?e.token:void 0)&&(d.token=this.service.token),""+this.service.root+"query/results?"+P(d))},a.prototype.needsAuthentication=function(){return S.any(this.constraints,function(a){var b;return"NOT IN"===(b=a.op)||"IN"===b})},a.prototype.fetchQID=function(a){return T(a,this.service.post("queries",{query:this.toXML()}).then(w("id")))},b=function(a){return a.append("primaryIdentifier").toString()},a.prototype.__bio_req=function(a,c){var d,e;return e=this.makeListQuery(),d=function(b){return S.any(a,function(a){return b.isa(a)})},e.views=S.take(c)(function(){var a,e,f,g;for(f=this.getViewNodes(),g=[],a=0,e=f.length;e>a;a++)c=f[a],d(c)&&g.push(b(c));return g}.call(this)),{query:e.toXML(),format:"text"}},a.prototype._fasta_req=function(){return this.__bio_req(["SequenceFeature","Protein"],1)},a.prototype._gff3_req=function(){return this.__bio_req(["SequenceFeature"])},a.prototype._bed_req=a.prototype._gff3_req,a}(),R=v(function(a,b){return a.concat(b)}),g.prototype.toString=g.prototype.toXML,g.ATTRIBUTE_OPS=R([g.ATTRIBUTE_VALUE_OPS,g.MULTIVALUE_OPS,g.NULL_OPS]),g.REFERENCE_OPS=R([g.TERNARY_OPS,g.LOOP_OPS,g.LIST_OPS]),k=function(a,b){return function(c,d){var e,f,g,h,i;return null==c&&(c={}),null==d&&(d=function(){}),S.isFunction(c)&&(i=[{},c],c=i[0],d=i[1]),e=function(a){return function(b){var c;return c=a.getPathInfo(b),c.isAttribute()?c:c.append("id")}}(this),null!=(null!=c?c.view:void 0)&&(c.view=function(){var a,b,d,e;for(d=c.view,e=[],a=0,b=d.length;b>a;a++)h=d[a],e.push(this.getPathInfo(h).toString());return e}.call(this)),f=null!=c["export"]?this.selectPreservingImpliedConstraints(c["export"].map(e)):this,g=F(f[a](),c),b.call(f,g,d)}},$=g.BIO_FORMATS,U=function(a){var b,c,d;return c="_"+a+"_req",b="get"+a.toUpperCase(),d=b+"URI",g.prototype[b]=k(c,function(b,c){return T(c,this.service.post("query/results/"+a,b))}),g.prototype[d]=k(c,function(b,c){return null!=this.service.token&&(b.token=this.service.token),""+this.service.root+"query/results/"+a+"?"+P(b)})};for(W=0,Y=$.length;Y>W;W++)t=$[W],U(t);for(V=function(a){return function(){var b,c,d,e;if(c=arguments[0],b=2<=arguments.length?ba.call(arguments,1):[],this.service[a])return null==c?c={}:S.isFunction(c)&&(c={},b=function(){var a,b,c;for(c=[],a=0,b=arguments.length;b>a;a++)d=arguments[a],c.push(d);return c}.apply(this,arguments)),c=I(F({start:this.start,size:this.maxRows},c)),(e=this.service)[a].apply(e,[this,c].concat(ba.call(b)));throw new Error("Service does not provide '"+a+"'.")}},X=0,Z=i.length;Z>X;X++)G=i[X],g.prototype[G]=V(G);e.mixin(g.prototype),g.prototype.emit=g.prototype.trigger,g.prototype.bind=g.prototype.on,B.Query=g}).call(this)},{"./util":294,"./xml":296,"backbone-events-standalone":301}],290:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa=function(a,b){return function(){return a.apply(b,arguments)}},pa={}.hasOwnProperty,qa=[].slice;for(x=a("./promise"),s=a("./model").Model,A=a("./query").Query,p=a("./lists").List,N=a("./user").User,k=a("./id-resolution-job").IDResolutionJob,fa=a("./version"),ea=a("./util"),Y=a("./http"),da=ea.querystring,ga=ea.withCB,$=ea.map,_=ea.merge,W=ea.get,ba=ea.set,Z=ea.invoke,ca=ea.success,V=ea.error,D=ea.REQUIRES_VERSION,U=ea.dejoin,O={},d={},B={},q={},H={},R={},g="http://",P="version",K="templates",C="version/release",e="classkeys",m="lists",r="model",G="summaryfields",y="query/results",z="search",S="widgets",h="list/enrichment",T="listswithobject",n={union:"lists/union",intersection:"lists/intersect",difference:"lists/diff"},E="lists/subtract",Q="user/whoami",J=y+"/tablerows",w="user/preferences",v="path/values",M="user/tokens",l="ids",u={},ma=[P,C,e,S,r,G,z,v],ia=0,ka=ma.length;ka>ia;ia++)aa=ma[ia],u[aa]=!0;for(b={},na=[Q,w,n,E,T,h,K,M],ja=0,la=na.length;la>ja;ja++)aa=na[ja],b[aa]=!0;t=function(a,c){return u[a]?!1:b[a]?!0:(null!=c?c.needsAuthentication:void 0)?c.needsAuthentication():!0},i=/^https?:\/\//i,j=/service\/?$/i,F="/service/",f=function(a){var b,c;return(b=null!=(c=console.error)?c:console.log)(a)},ha=function(a,b,c,d,e){var f,g,h,i,j;return h=this.root,i=this.useCache,g=null!=this[a]?this[a]:this[a]=i&&(j=b[h])?ca(j):(f={type:"GET",dataType:"json",data:{format:"json"}},this.doReq(_(f,{url:this.root+c})).then(function(a){return b[h]=a[d]})),ga(e,g)},X=function(a){return function(b){return new x(function(c,d){var e;return(e=ea.find(b,function(b){return b.name===a}))?c(e):d('List "'+a+'" not found among: '+b.map(W("name")))})}},o=function(a,b){return null==b&&(b="listName"),ea.compose(a.fetchList,W(b))},L=function(a){var b,c,d,e,f,g;for(null==a&&(a=[]),e=ea.isArray(a)?a:[a],g=[],c=0,d=e.length;d>c;c++)b=e[c],g.push(null!=(f=b.name)?f:b);return g},I=function(){function a(a){var b;if(this.root=a.root,this.token=a.token,this.errorHandler=a.errorHandler,this.DEBUG=a.DEBUG,this.help=a.help,b=a.noCache,this.connectAs=oa(this.connectAs,this),this.createList=oa(this.createList,this),this.resolveIds=oa(this.resolveIds,this),this.templateQuery=oa(this.templateQuery,this),this.savedQuery=oa(this.savedQuery,this),this.query=oa(this.query,this),this.fetchRelease=oa(this.fetchRelease,this),this.fetchClassKeys=oa(this.fetchClassKeys,this),this.fetchVersion=oa(this.fetchVersion,this),this.fetchSummaryFields=oa(this.fetchSummaryFields,this),this.fetchModel=oa(this.fetchModel,this),this.fetchWidgetMap=oa(this.fetchWidgetMap,this),this.fetchWidgets=oa(this.fetchWidgets,this),this.complement=oa(this.complement,this),this.fetchListsContaining=oa(this.fetchListsContaining,this),this.fetchList=oa(this.fetchList,this),this.findLists=oa(this.findLists,this),this.fetchLists=oa(this.fetchLists,this),this.fetchTemplates=oa(this.fetchTemplates,this),this.tableRows=oa(this.tableRows,this),this.values=oa(this.values,this),this.rows=oa(this.rows,this),this.records=oa(this.records,this),this.table=oa(this.table,this),this.pathValues=oa(this.pathValues,this),this.fetchUser=oa(this.fetchUser,this),this.whoami=oa(this.whoami,this),this.findById=oa(this.findById,this),this.count=oa(this.count,this),this.enrichment=oa(this.enrichment,this),null==this.root)throw new Error("No service root provided. This is required");i.test(this.root)||(this.root=g+this.root),j.test(this.root)||(this.root=this.root+F),this.root=this.root.replace(/ice$/,"ice/"),null==this.errorHandler&&(this.errorHandler=f),null==this.help&&(this.help="no.help.available@dev.null"),this.useCache=!b,this.getFormat=function(a){return function(a){return null==a&&(a="json"),a}}(this)}var b,c,u,x,I,M;return a.prototype.doReq=Y.doReq,a.prototype.post=function(a,b){return this.makeRequest("POST",a,b)},a.prototype.get=function(a,b){return this.makeRequest("GET",a,b)},a.prototype.makeRequest=function(a,b,c,d,e){var f,g,h,i,j,k,l;return null==a&&(a="GET"),null==b&&(b=""),null==c&&(c={}),null==d&&(d=function(){}),null==e&&(e=!1),ea.isArray(d)&&(j=d,d=j[0],g=j[1]),ea.isArray(c)&&(c=ea.pairsToObj(c)),null==g&&(g=this.errorHandler),c=ea.copy(c),f=this.getFormat(c.format),Y.supports(a)||(k=[a,Y.getMethod(a)],c.method=k[0],a=k[1]),h={data:c,dataType:f,success:d,error:g,path:b,type:a},null!=c.auth&&(h.auth=c.auth,delete h.data.auth),null!=c.headers&&(h.headers=ea.copy(c.headers),delete h.data.headers),(i=null!=(l=c.timeout)?l:this.timeout)&&(h.timeout=i,delete c.timeout),this.authorise(h).then(function(a){return function(b){return a.doReq(b,e)}}(this))},a.prototype.authorise=function(a){return this.fetchVersion().then(function(b){return function(c){var d,e,f;return d=ea.copy(a),null==d.headers&&(d.headers={}),d.url=b.root+d.path,e=[],14>c&&("string"==typeof d.data?e.push(["format",d.dataType]):d.data.format=d.dataType),null!=b.token&&t(a.path,null!=(f=d.data)?f.query:void 0)&&(c>=14?d.headers.Authorization="Token "+b.token:"string"==typeof d.data?e.push(["token",b.token]):d.data.token=b.token),e.length&&(d.url+="?"+da(e)),d}}(this))},a.prototype.enrichment=function(a,b){return D(this,8,function(c){return function(){var d;return d=_({maxp:.05,correction:"Holm-Bonferroni"},a),ga(b,c.get(h,d).then(W("results")))}}(this))},a.prototype.search=function(a,b){return null==a&&(a={}),null==b&&(b=function(){}),D(this,9,function(c){return function(){var d,e,f,g;if(ea.isFunction(a)&&(g=[a,{}],b=g[0],a=g[1]),"string"==typeof a)e={q:a};else{e={q:a.q};for(d in a)pa.call(a,d)&&(f=a[d],"q"!==d&&(e["facet_"+d]=f))}return ga(b,c.post(z,e))}}(this))},a.prototype.makePath=function(a,b,c){return null==b&&(b={}),null==c&&(c=function(){}),ga(c,this.fetchModel().then(function(c){return c.makePath(a,b)}))},a.prototype.count=function(a,b){var c,d;return null==b&&(b=function(){}),c=a?null!=a.toPathString?(aa=a.isClass()?a.append("id"):a,this.pathValues(aa,"count")):null!=a.toXML?(d={query:a,format:"jsoncount"},this.post(y,d).then(W("count"))):"string"==typeof a?this.fetchModel().then(function(b){return function(c){var d;try{return b.count(c.makePath(a))}catch(e){return d=e,b.query({select:[a]}).then(b.count)}}}(this)):this.query(a).then(this.count):V("Not enough arguments"),ga(b,c)},a.prototype.findById=function(a,b,c,d){var e,f;return null==c&&(c=["**"]),null==d&&(d=function(){}),ea.isFunction(c)&&(f=[["**"],c],c=f[0],d=f[1]),e=this.query({from:a,select:c,where:{id:b}}).then(U).then(Z("records")).then(W(0)),ga(d,e)},a.prototype.lookup=function(a,b,c,d){var e,f;return ea.isFunction(c)&&(f=[null,c],c=f[0],d=f[1]),e=this.query({from:a,select:["**"],where:[[a,"LOOKUP",b,c]]}).then(U).then(Z("records")),ga(d,e)},a.prototype.find=function(a,b,c,d){var e;return ea.isFunction(c)&&(e=[null,c],c=e[0],d=e[1]),ga(d,this.lookup(a,b,c).then(function(a){return null==a||0===a.length?V("Nothing found"):a.length>1?V("Multiple items found: "+a.slice(0,3)+"..."):ca(a[0])}))},a.prototype.whoami=function(a){return D(this,9,function(b){return function(){return ga(a,b.get(Q).then(W("user")).then(function(a){return new N(b,a)}))}}(this))},a.prototype.fetchUser=function(){var a;return a=1<=arguments.length?qa.call(arguments,0):[],this.whoami.apply(this,a)},I=function(a,b){return{format:a,path:String(b),typeConstraints:JSON.stringify(b.subclasses)}},a.prototype.pathValues=function(a,b,c){return null==b&&(b={}),D(this,6,function(d){return function(){var e,f,g,h,i;return"string"==typeof b&&(h=b,b={}),ea.isFunction(b)&&(i=[c,b],b=i[0],c=i[1]),"count"!==h&&(h="results"),f="count"===h?"jsoncount":"json",g=function(){var c;try{return this.fetchModel().then(Z("makePath",a,null!=(c=a.subclasses)?c:b)).then(function(a){return I(f,a)}).then(function(a){return function(b){return a.post(v,b)}}(this)).then(W(h))}catch(d){return e=d,V(e)}}.call(d),ga(c,g)}}(this))},a.prototype.doPagedRequest=function(a,b,c,d,e){var f,g;return null==c&&(c={}),null==e&&(e=function(){}),null!=a.toXML?(ea.isFunction(c)&&(g=[c,{}],e=g[0],c=g[1]),f=_(c,{query:a,format:d}),ga(e,this.post(b,f).then(W("results")))):this.query(a).then(function(a){return function(f){return a.doPagedRequest(f,b,c,d,e)}}(this))},a.prototype.table=function(a,b,c){return this.doPagedRequest(a,y,b,"jsontable",c)},a.prototype.records=function(a,b,c){return this.doPagedRequest(a,y,b,"jsonobjects",c)},a.prototype.rows=function(a,b,c){return this.doPagedRequest(a,y,b,"json",c)},a.prototype.values=function(a,b,c){var d,e;return ea.isFunction(b)&&(e=[b,c],c=e[0],b=e[1]),d=null==a?V("No query term supplied"):null!=a.descriptors||"string"==typeof a?this.pathValues(a,b).then($(W("value"))):null!=a.toXML?1!==a.views.length?V("Expected one column, got "+a.views.length):this.rows(a,b).then($(W(0))):this.query(a).then(function(a){return function(c){return a.values(c,b)}}(this)),ga(c,d)},a.prototype.tableRows=function(a,b,c){return this.doPagedRequest(a,J,b,"json",c)},a.prototype.fetchTemplates=function(a){return ga(a,this.get(K).then(W("templates")))},a.prototype.fetchLists=function(a){return this.findLists("",a)},a.prototype.findLists=function(a,b){return null==a&&(a=""),null==b&&(b=function(){}),this.fetchVersion().then(function(c){return function(d){var e;return ga(b,a&&13>d?V("Finding lists by name on the server requires version 13. This is only "+d):(e=function(a){var b,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],f.push(new p(b,c));return f},c.get(m,{name:a}).then(W("lists")).then(e)))}}(this))},a.prototype.fetchList=function(a,b){return this.fetchVersion().then(function(c){return function(d){return ga(b,13>d?c.findLists().then(X(a)):c.findLists(a).then(W(0)))}}(this))},a.prototype.fetchListsContaining=function(a,b){var c;return c=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],f.push(new p(c,a));return f}}(this),ga(b,this.get(T,a).then(W("lists")).then(c))},a.prototype.combineLists=function(a,b,c){var d,e,f,g,h,i;return i=_({lists:[],tags:[]},b),f=i.name,e=i.lists,h=i.tags,d=i.description,g={name:f,description:d},null==g.description&&(g.description=""+a+" of "+e.join(", ")),g.tags=h.join(";"),g.lists=e.join(";"),ga(c,this.get(n[a],g).then(o(this)))},a.prototype.merge=function(){return this.combineLists.apply(this,["union"].concat(qa.call(arguments)))},a.prototype.intersect=function(){return this.combineLists.apply(this,["intersection"].concat(qa.call(arguments)))},a.prototype.diff=function(){return this.combineLists.apply(this,["difference"].concat(qa.call(arguments)))},a.prototype.complement=function(a,b){var c,d,e,f,g,h,i,j,k;return null==a&&(a={}),null==b&&(b=function(){}),f=a.from,e=a.exclude,h=a.name,d=a.description,k=a.tags,c=function(){return"Relative complement of "+g.join(" and ")+" in "+i.join(" and ")},i=L(f),g=L(e),null==h&&(h=c()),null==d&&(d=c()),null==k&&(k=[]),j={name:h,description:d,tags:k,lists:g,references:i},ga(b,this.post(E,j).then(o(this)))},a.prototype.fetchWidgets=function(a){return D(this,8,function(b){return function(){return ha.call(b,"widgets",R,S,"widgets",a)}}(this))},M=ea.omap(function(a){return[a.name,a]}),a.prototype.fetchWidgetMap=function(a){return D(this,8,function(b){return function(){return ga(a,null!=b.__wmap__?b.__wmap__:b.__wmap__=b.fetchWidgets().then(M))}}(this))},a.prototype.fetchModel=function(a){var b;return b=ha.call(this,"model",q,r,"model").then(s.load).then(ba({service:this})),ga(a,b)},a.prototype.fetchSummaryFields=function(a){return ha.call(this,"summaryFields",H,G,"classes",a)},a.prototype.fetchVersion=function(a){return ha.call(this,"version",O,P,"version",a)},a.prototype.fetchClassKeys=function(a){return ha.call(this,"classkeys",d,e,"classes",a)},a.prototype.fetchRelease=function(a){return ha.call(this,"release",B,C,"version",a)},a.prototype.query=function(a,b){var c;return c=function(b){return function(c){var d,e;return d=c[0],e=c[1],new A(a,b,{model:d,summaryFields:e})}}(this),ga(b,ea.parallel(this.fetchModel(),this.fetchSummaryFields()).then(c))},x=function(a,b){return function(c){return c?a.query(c):V("No query found called "+b)}},c=function(a){return a?"string"==typeof a?ca():V("Name must be a string"):V("Name not provided")},a.prototype.savedQuery=function(a,b){return D(this,16,function(d){return function(){return c(a).then(function(){return ga(b,d.get("user/queries",{filter:a}).then(function(b){return b.queries[a]}).then(x(d,a)))})}}(this))},a.prototype.templateQuery=function(a,b){return c(a).then(function(c){return function(){return ga(b,c.fetchTemplates().then(W(a)).then(ba("type","TEMPLATE")).then(x(c,a)))}}(this))},a.prototype.manageUserPreferences=function(a,b,c){return D(this,11,function(d){return function(){return ga(c,d.makeRequest(a,w,b).then(W("preferences")))}}(this))},a.prototype.resolveIds=function(a,b){return D(this,10,function(c){return function(){var d;return d={type:"POST",url:c.root+l,contentType:"application/json",data:JSON.stringify(a),dataType:"json"},ga(b,c.doReq(d).then(W("uid")).then(k.create(c)))}}(this))},a.prototype.resolutionJob=function(a){return k.create(this)(a)},a.prototype.createList=function(a,b,c){var d,e;return null==a&&(a={}),null==b&&(b=""),null==c&&(c=function(){}),d=function(b){return function(c){return _(c,{token:b.token,tags:a.tags||[]})}}(this),e={data:ea.isArray(b)?b.map(function(a){return'"'+a+'"'}).join("\n"):b,dataType:"json",url:""+this.root+"lists?"+da(d(a)),type:"POST",contentType:"text/plain"},ga(c,this.doReq(e).then(o(this)))},u=function(a){return a.user.temporaryToken},a.prototype.connectAs=function(b){return a.connect(_(this,{token:b,noCache:!this.useCache}))},a.prototype.register=function(a,b,c){return D(this,9,function(d){return function(){return ga(c,d.post("users",{name:a,password:b}).then(u).then(d.connectAs))}}(this))},b=300,a.prototype.getDeregistrationToken=function(a,c){return null==a&&(a=b),D(this,16,function(b){return function(){var d;return d=null!=b.token?b.post("user/deregistration",{validity:a}).then(W("token")):V("Not registered"),ga(c,d)}}(this))},a.prototype.deregister=function(a,b){return D(this,16,function(c){return function(){return ga(b,c.makeRequest("DELETE","user",{deregistrationToken:a,format:"xml"}))}}(this))},a.prototype.login=function(a,b,c){return D(this,9,function(d){return function(){var e;return e=""+a+":"+b,ga(c,d.logout().then(function(a){return a.get("user/token",{auth:e})})).then(W("token")).then(d.connectAs)}}(this))},a.prototype.logout=function(a){return ga(a,ca(this.connectAs()))},a}(),I.prototype.rowByRow=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"json"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.rowByRow.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRow=I.prototype.rowByRow,I.prototype.recordByRecord=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?qa.call(arguments,1):[],b=Y.iterReq("POST",y,"jsonobjects"),null!=c.toXML?b.apply(this,arguments):this.query(c).then(function(b){return function(c){return b.recordByRecord.apply(b,[c].concat(qa.call(a)))}}(this))},I.prototype.eachRecord=I.prototype.recordByRecord,I.prototype.union=I.prototype.merge,I.prototype.difference=I.prototype.diff,I.prototype.symmetricDifference=I.prototype.diff,I.prototype.relativeComplement=I.prototype.complement,I.prototype.subtract=I.prototype.complement,I.flushCaches=function(){return q={},O={},B={},d={},H={},R={}},I.connect=function(a){if(null==(null!=a?a.root:void 0))throw new Error("Invalid options provided: "+JSON.stringify(a));return new I(a)},c.Service=I,c.Model=s,c.Query=A,c.utils=ea,c.VERSION=fa.VERSION,c.imjs=fa}).call(this)},{"./http":283,"./id-resolution-job":284,"./lists":285,"./model":286,"./promise":288,"./query":289,"./user":293,"./util":294,"./version":295}],291:[function(a,b,c){(function(a){(function(){var b;c.DOMParser=null!=a.DOMParser?a.DOMParser:b=function(){function a(){throw new Error("DOMParser is not available")}return a}()}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],292:[function(a,b,c){(function(){var b,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=function(a,b){var c,d,e;e=[];for(c in a)d=a[c],e.push(b[c]=d);return e},b=a("./promise"),e=["attributes","references","collections"],c.Table=function(){function a(a,b){var c,g,h,i,j,k,l;for(this.model=b,this.getDisplayName=f(this.getDisplayName,this),this.name=a.name,this.tags=a.tags,this.displayName=a.displayName,this.attributes=a.attributes,this.references=a.references,this.collections=a.collections,this.fields={},this.__parents__=null!=(k=a["extends"])?k:[],i=0,j=e.length;j>i;i++){if(g=e[i],null==this[g])throw new Error("Bad model data: missing "+g);d(this[g],this.fields)}l=this.collections;for(h in l)c=l[h],c.isCollection=!0}return a.prototype.toString=function(){var a,b;return"[Table name="+this.name+", fields=["+function(){var c,d;c=this.fields,d=[];for(a in c)b=c[a],d.push(a);return d}.call(this)+"]]"},a.prototype.parents=function(){var a;return(null!=(a=this.__parents__)?a:[]).slice()},a.prototype.getDisplayName=function(){return new b(function(a){return function(b,c){return null!=a.model?b(a.model.makePath(a.name).getDisplayName()):c(new Error("model not set - cannot make path"))}}(this))},a}()}).call(this)},{"./promise":288}],293:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};i=a("./util"),h=i.withCB,f=i.get,g=i.isFunction,b=i.any,e=i.error,d=function(a,b,c,d){return a.service.manageUserPreferences(c,b,d).then(function(b){return a.preferences=b})},c.User=function(){function a(a,b){this.service=a,this.username=b.username,this.preferences=b.preferences,this.refresh=j(this.refresh,this),this.clearPreferences=j(this.clearPreferences,this),this.clearPreference=j(this.clearPreference,this),this.setPreferences=j(this.setPreferences,this),this.setPreference=j(this.setPreference,this),this.hasPreferences=null!=this.preferences,null==this.preferences&&(this.preferences={})}return a.prototype.setPreference=function(a,b,c){var d,f;if(g(b)&&(f=[null,b],b=f[0],c=f[1]),"string"==typeof a)d={},d[a]=b;else{if(null!=b)return h(c,e("Incorrect arguments to setPreference"));d=a}return this.setPreferences(d,c)},a.prototype.setPreferences=function(a,b){return d(this,a,"POST",b)},a.prototype.clearPreference=function(a,b){return d(this,{key:a},"DELETE",b)},a.prototype.clearPreferences=function(a){return d(this,{},"DELETE",a)},a.prototype.refresh=function(a){return d(this,{},"GET",a)},a.prototype.createToken=function(a,c,d){var e,i;return null==a&&(a="day"),null==d&&b([a,c],g)&&(g(a)?(e=[null,null,a],a=e[0],c=e[1],d=e[2]):g(c)&&(i=[null,c],c=i[0],d=i[1])),h(d,this.service.post("user/tokens",{type:a,message:c}).then(f("token")))},a.prototype.fetchCurrentTokens=function(a){return h(a,this.service.get("user/tokens").then(f("tokens")))},a.prototype.revokeAllTokens=function(a){return h(a,this.service.makeRequest("DELETE","user/tokens"))},a.prototype.revokeToken=function(a,b){return h(b,this.service.makeRequest("DELETE","user/tokens/"+a))},a}()}).call(this)},{"./util":294}],294:[function(a,b,c){(function(){var b,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=[].slice,x=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},y={}.hasOwnProperty;b=a("./promise"),s=c,s.defer=function(){var a;return a={},a.promise=new b(function(b,c){return a.resolve=b,a.reject=c}),a},g=function(a){return encodeURIComponent(String(a))},r=function(a){var b;return function(){var c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push(b.map(g).join("="));return e}().join("&")},s.querystring=function(a){var b,c,d,e,f,g;if(!a)return"";if(o(a))d=a.slice();else{d=[];for(b in a)g=a[b],o(g)?(e=function(){var a,c,d;for(d=[],a=0,c=g.length;c>a;a++)f=g[a],d.push([b,f]);return d}(),d=d.concat(e)):d.push([b,g])}return r(function(){var a,b,e;for(e=[],a=0,b=d.length;b>a;a++)c=d[a],null!=c[1]&&e.push(c);return e}())},s.curry=f=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],b.apply(null,a.concat(c))}},s.error=i=function(a){return new b(function(b,c){return c(new Error(a))})},s.success=t=function(a){return new b(function(b,c){return b(a)})},s.parallel=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],1===a.length&&!a[0].then&&a[0].length?b.all(a[0]):b.all(a)},s.withCB=function(){var a,b,c,d,e,g,h,i;for(b=2<=arguments.length?w.call(arguments,0,g=arguments.length-1):(g=0,[]),e=arguments[g++],h=0,i=b.length;i>h;h++)a=b[h],null!=a&&(d=f(a,null),c=a,e.then(d,c));return e},s.fold=k=function(a){return function(b,c){var d,e,f;if(1===arguments.length&&(c=(null!=b?b.slice():void 0)||b,b=(null!=c?c.shift():void 0)||{}),null==c)throw new Error("xs is null");if(null!=c.reduce)return c.reduce(a,b);e=b;for(d in c)f=c[d],e=null!=e?a(e,d,f):{k:f};return e}},s.take=function(a){return function(b){return null!=a?b.slice(0,+(a-1)+1||9e9):b.slice()}},s.filter=function(a){return function(b){var c,d,e,f;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a(c)&&f.push(c);return f}},s.uniqBy=function(a,b){var c,d,e,g,h,i;if(1===arguments.length)return f(s.uniqBy,a);if(d=[],e=[],null==b)return e;for(h=0,i=b.length;i>h;h++)g=b[h],c=a(g),x.call(d,c)<0&&(d.push(c),e.push(g));return e},s.find=function(a,b){var c,d,e;if(1===arguments.length)return b=a,function(a){return s.find(a,b)};for(d=0,e=a.length;e>d;d++)if(c=a[d],b(c))return c;return null},o=null!=(v=Array.isArray)?v:function(a){return null!=(null!=a?a.splice:void 0)&&null!=(null!=a?a.push:void 0)&&null!=(null!=a?a.pop:void 0)&&null!=(null!=a?a.slice:void 0)},s.isArray=o,s.isFunction="function"!=typeof/./?function(a){return"function"==typeof a}:function(a){return null!=a&&null!=a.call&&null!=a.apply&&"[object Function]"===a.toString()},h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},s.escape=function(a){var b,c,d,e,f,g;if(null==a)return"";for(e=String(a).replace(/[&<>"']/g,function(a){return h[a]}),d=[],c=f=0,g=e.length;g>=0?g>=f:f>=g;c=g>=0?++f:--f)b=e.charCodeAt(c),b>256?d.push("&#"+b+";"):d.push(e.charAt(c));return d.join("")},s.omap=function(a){var b;return b=k(function(b,c,d){var e,f,g;return g=a(c,d),e=g[0],f=g[1],o(f)&&(f=f.slice()),b[e]=f,b}),function(a){return b({},a)}},s.copy=s.omap(function(a,b){return[a,b]}),s.partition=function(a){return function(b){var c;return(c=k(function(b,c){var d,e;return e=b[0],d=b[1],a(c)?[e.concat([c]),d]:[e,d.concat([c])]}))([[],[]],b)}},s.id=l=function(a){return a},s.concatMap=function(a){return function(b){var c,d,e,f,g;for(d=void 0,f=0,g=b.length;g>f;f++)e=b[f],c=a(e),d=void 0===d?c:"number"==typeof d?d+c:null!=d.concat?d.concat(c):p(d,c);return d}},s.map=function(a){return m("map",a)},e=k(function(a,b){return function(){var c;return c=1<=arguments.length?w.call(arguments,0):[],a(b.apply(null,c))}}),s.compose=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],e(a)},s.flatMap=s.concatMap,s.difference=function(a,b){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],x.call(b,c)<0&&f.push(c);return f},s.stringList=function(a){return"string"==typeof a?[a]:a},s.flatten=j=function(){var a,b,c,d,e,f,g,h,i;for(c=1<=arguments.length?w.call(arguments,0):[],a=[],e=0,g=c.length;g>e;e++)if(b=c[e],o(b))for(i=j.apply(null,b),f=0,h=i.length;h>f;f++)d=i[f],a.push(d);else a.push(b);return a},s.sum=s.concatMap(l),s.merge=p=function(){var a,b,c,d,e,f,g;for(d=1<=arguments.length?w.call(arguments,0):[],b={},f=0,g=d.length;g>f;f++){c=d[f];for(a in c)y.call(c,a)&&(e=c[a],b[a]=e)}return b},s.any=function(a,b){var c,d,e;for(null==b&&(b=l),d=0,e=a.length;e>d;d++)if(c=a[d],b(c))return!0;return!1},s.invoke=m=function(){var a,b;return b=arguments[0],a=2<=arguments.length?w.call(arguments,1):[],n(b,a)},s.invokeWith=n=function(a,b,c){return null==b&&(b=[]),null==c&&(c=null),function(d){if(null==d)throw new Error('Cannot call method "'+a+'" of null');if(d[a])return d[a].apply(c||d,b);throw new Error('Cannot call undefined method "'+a+" of "+d)}},s.get=function(a){return function(b){return b[a]}},s.set=function(a,b){return function(c){var d,e;if(2===arguments.length)c[a]=b;else for(d in a)y.call(a,d)&&(e=a[d],c[d]=e);return c}},d=function(a,b){return"This service requires a service at version "+a+" or above. This one is at "+b},s.REQUIRES_VERSION=function(a,b,c){return a.fetchVersion().then(function(a){return a>=b?c():i(d(b,a))})},s.dejoin=function(a){var b,c,d,e,f;for(f=a.views,d=0,e=f.length;e>d;d++)c=f[d],b=c.split("."),b.length>2&&a.addJoin(b.slice(1,-1).join("."));return a},u=k(function(a,b){return a.then(b)}),s.sequence=function(){var a;return a=1<=arguments.length?w.call(arguments,0):[],u(t(),a)},q=k(function(a,b){var c,d;if(c=b[0],d=b[1],null!=a[c])throw new Error("Duplicate key: "+c);return a[c]=d,a}),s.pairsToObj=function(a){return q({},a)}}).call(this)},{"./promise":288}],295:[function(a,b,c){(function(){c.VERSION="3.14.0"}).call(this)},{}],296:[function(a,b,c){(function(){var b,d;b=a("xmldom").DOMParser,d=function(a){return a=a.replace(/^\s*/g,""),a=a.replace(/\s$/g,""),0===a.length?a:">"!==a[a.length-1]?a+">":a},c.parse=function(a){var c,e;if("string"!=typeof a)throw new Error("Expected a string - got "+a);if(a=d(a),!a)throw new Error("Expected content - got empty string");if(c=function(){try{return e=new b,e.parseFromString(a,"text/xml")}catch(c){}}(),!c||!c.documentElement||c.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+a);return c}}).call(this)},{xmldom:291}],297:[function(a,b,c){(function(d,e){function f(a,b){return"string"==typeof a?b==a:a&&"function"==typeof a.exec?a.exec(b):"boolean"==typeof a?a:"function"==typeof a?a(b):!1}var g=a("jsonparse"),h=a("through");c.parse=function(a,b){var c=new g,d=h(function(a){"string"==typeof a&&(a=new e(a)),c.write(a)},function(a){a&&d.write(a),d.queue(null)});"string"==typeof a&&(a=a.split(".").map(function(a){return"*"===a?!0:""===a?{recurse:!0}:a}));var i=0;return a&&a.length||(a=null),c.onValue=function(c){if(this.root||(d.root=c),a){for(var e=0,g=0;e<a.length;){var h,j=a[e];if(g++,j&&!j.recurse){if(h=g===this.stack.length?this:this.stack[g],!h)return;if(!f(j,h.key))return;e++}else{e++;var k=a[e];if(!k)return;for(;;){if(h=g===this.stack.length?this:this.stack[g],!h)return;if(f(k,h.key)){e++;break}g++}}}if(g===this.stack.length){i++;var l=this.stack.slice(1).map(function(a){return a.key}).concat([this.key]),m=this.value[this.key];null!=m&&null!=(m=b?b(m,l):m)&&d.queue(m),delete this.value[this.key]}}},c._onToken=c.onToken,c.onToken=function(b,e){c._onToken(b,e),0===this.stack.length&&d.root&&(a||d.queue(d.root),d.emit("root",d.root,i),i=0,d.root=null)},c.onError=function(a){d.emit("error",a)},d},c.stringify=function(a,b,c,d){d=d||0,a===!1?(a="",b="\n",c=""):null==a&&(a="[\n",b="\n,\n",c="\n]\n");var e,f=!0,g=!1;return e=h(function(c){g=!0;var h=JSON.stringify(c,null,d);f?(f=!1,e.queue(a+h)):e.queue(b+h)},function(b){g||e.queue(a),e.queue(c),e.queue(null)})},c.stringifyObject=function(a,b,c,d){d=d||0,a===!1?(a="",b="\n",c=""):null==a&&(a="{\n",b="\n,\n",c="\n}\n");var e=!0,f=!1;return stream=h(function(c){f=!0;var g=JSON.stringify(c[0])+":"+JSON.stringify(c[1],null,d);e?(e=!1,this.queue(a+g)):this.queue(b+g)},function(b){f||this.queue(a),this.queue(c),this.queue(null)}),stream},b.parent||"browser"===d.title||d.stdin.pipe(c.parse(d.argv[2])).pipe(c.stringify("[",",\n","]\n",2)).pipe(d.stdout)}).call(this,a("_process"),a("buffer").Buffer)},{_process:259,buffer:248,jsonparse:298,through:299}],298:[function(a,b,c){(function(a){function c(a){for(var b=Object.keys(e),c=0,d=b.length;d>c;c++){var f=b[c];if(e[f]===a)return f}return a&&"0x"+a.toString(16)}function d(){this.tState=q,this.value=void 0,this.string=void 0,this.unicode=void 0,this.negative=void 0,this.magnatude=void 0,this.position=void 0,this.exponent=void 0,this.negativeExponent=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=P,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new a(2),3:new a(3),4:new a(4)}}var e={},f=e.LEFT_BRACE=1,g=e.RIGHT_BRACE=2,h=e.LEFT_BRACKET=3,i=e.RIGHT_BRACKET=4,j=e.COLON=5,k=e.COMMA=6,l=e.TRUE=7,m=e.FALSE=8,n=e.NULL=9,o=e.STRING=10,p=e.NUMBER=11,q=e.START=17,r=e.TRUE1=33,s=e.TRUE2=34,t=e.TRUE3=35,u=e.FALSE1=49,v=e.FALSE2=50,w=e.FALSE3=51,x=e.FALSE4=52,y=e.NULL1=65,z=e.NULL3=66,A=e.NULL2=67,B=e.NUMBER1=81,C=e.NUMBER2=82,D=e.NUMBER3=83,E=e.NUMBER4=84,F=e.NUMBER5=85,G=e.NUMBER6=86,H=e.NUMBER7=87,I=e.NUMBER8=88,J=e.STRING1=97,K=e.STRING2=98,L=e.STRING3=99,M=e.STRING4=100,N=e.STRING5=101,O=e.STRING6=102,P=e.VALUE=113,Q=e.KEY=114,R=e.OBJECT=129,S=e.ARRAY=130,T=d.prototype;
T.charError=function(a,b){this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(a[b]))+" at position "+b+" in state "+c(this.tState)))},T.onError=function(a){throw a},T.write=function(b){"string"==typeof b&&(b=new a(b));for(var c,d=0,e=b.length;e>d;d++)if(this.tState===q)c=b[d],123===c?this.onToken(f,"{"):125===c?this.onToken(g,"}"):91===c?this.onToken(h,"["):93===c?this.onToken(i,"]"):58===c?this.onToken(j,":"):44===c?this.onToken(k,","):116===c?this.tState=r:102===c?this.tState=u:110===c?this.tState=y:34===c?(this.string="",this.tState=J):45===c?(this.negative=!0,this.tState=B):48===c?(this.magnatude=0,this.tState=C):c>48&&64>c?(this.magnatude=c-48,this.tState=D):32===c||9===c||10===c||13===c||this.charError(b,d);else if(this.tState===J)if(c=b[d],this.bytes_remaining>0){for(var P=0;P<this.bytes_remaining;P++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+P]=b[P];this.string+=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,d=d+P-1}else if(0===this.bytes_remaining&&c>=128)if(c>=194&&223>=c&&(this.bytes_in_sequence=2),c>=224&&239>=c&&(this.bytes_in_sequence=3),c>=240&&244>=c&&(this.bytes_in_sequence=4),this.bytes_in_sequence+d>b.length){for(var Q=0;Q<=b.length-1-d;Q++)this.temp_buffs[this.bytes_in_sequence][Q]=b[d+Q];this.bytes_remaining=d+this.bytes_in_sequence-b.length,d=b.length-1}else this.string+=b.slice(d,d+this.bytes_in_sequence).toString(),d=d+this.bytes_in_sequence-1;else 34===c?(this.tState=q,this.onToken(o,this.string),this.string=void 0):92===c?this.tState=K:c>=32?this.string+=String.fromCharCode(c):this.charError(b,d);else this.tState===K?(c=b[d],34===c?(this.string+='"',this.tState=J):92===c?(this.string+="\\",this.tState=J):47===c?(this.string+="/",this.tState=J):98===c?(this.string+="\b",this.tState=J):102===c?(this.string+="\f",this.tState=J):110===c?(this.string+="\n",this.tState=J):114===c?(this.string+="\r",this.tState=J):116===c?(this.string+="	",this.tState=J):117===c?(this.unicode="",this.tState=L):this.charError(b,d)):this.tState===L||this.tState===M||this.tState===N||this.tState===O?(c=b[d],c>=48&&64>c||c>64&&70>=c||c>96&&102>=c?(this.unicode+=String.fromCharCode(c),this.tState++===O&&(this.string+=String.fromCharCode(parseInt(this.unicode,16)),this.unicode=void 0,this.tState=J)):this.charError(b,d)):this.tState===B?(c=b[d],48===c?(this.magnatude=0,this.tState=C):c>48&&64>c?(this.magnatude=c-48,this.tState=D):this.charError(b,d)):this.tState===C?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.onToken(p,0),this.magnatude=void 0,this.negative=void 0,d--)):this.tState===D?(c=b[d],46===c?(this.position=.1,this.tState=E):101===c||69===c?(this.exponent=0,this.tState=G):c>=48&&64>c?this.magnatude=10*this.magnatude+c-48:(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===E?(c=b[d],c>=48&&64>c?(this.magnatude+=this.position*(c-48),this.position/=10,this.tState=F):this.charError(b,d)):this.tState===F?(c=b[d],c>=48&&64>c?(this.magnatude+=this.position*(c-48),this.position/=10):101===c||69===c?(this.exponent=0,this.tState=G):(this.tState=q,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(p,this.negative?-this.magnatude:this.magnatude),this.magnatude=void 0,this.position=void 0,d--)):this.tState===G?(c=b[d],43===c||45===c?(45===c&&(this.negativeExponent=!0),this.tState=H):c>=48&&64>c?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===H?(c=b[d],c>=48&&64>c?(this.exponent=10*this.exponent+(c-48),this.tState=I):this.charError(b,d)):this.tState===I?(c=b[d],c>=48&&64>c?this.exponent=10*this.exponent+(c-48):(this.negativeExponent&&(this.exponent=-this.exponent,this.negativeExponent=void 0),this.magnatude*=Math.pow(10,this.exponent),this.exponent=void 0,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.tState=q,this.onToken(p,this.magnatude),this.magnatude=void 0,d--)):this.tState===r?114===b[d]?this.tState=s:this.charError(b,d):this.tState===s?117===b[d]?this.tState=t:this.charError(b,d):this.tState===t?101===b[d]?(this.tState=q,this.onToken(l,!0)):this.charError(b,d):this.tState===u?97===b[d]?this.tState=v:this.charError(b,d):this.tState===v?108===b[d]?this.tState=w:this.charError(b,d):this.tState===w?115===b[d]?this.tState=x:this.charError(b,d):this.tState===x?101===b[d]?(this.tState=q,this.onToken(m,!1)):this.charError(b,d):this.tState===y?117===b[d]?this.tState=z:this.charError(b,d):this.tState===z?108===b[d]?this.tState=A:this.charError(b,d):this.tState===A&&(108===b[d]?(this.tState=q,this.onToken(n,null)):this.charError(b,d))},T.onToken=function(a,b){},T.parseError=function(a,b){this.onError(new Error("Unexpected "+c(a)+(b?"("+JSON.stringify(b)+")":"")+" in state "+c(this.state)))},T.onError=function(a){throw a},T.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},T.pop=function(){var a=this.value,b=this.stack.pop();this.value=b.value,this.key=b.key,this.mode=b.mode,this.emit(a),this.mode||(this.state=P)},T.emit=function(a){this.mode&&(this.state=k),this.onValue(a)},T.onValue=function(a){},T.onToken=function(a,b){this.state===P?a===o||a===p||a===l||a===m||a===n?(this.value&&(this.value[this.key]=b),this.emit(b)):a===f?(this.push(),this.value?this.value=this.value[this.key]={}:this.value={},this.key=void 0,this.state=Q,this.mode=R):a===h?(this.push(),this.value?this.value=this.value[this.key]=[]:this.value=[],this.key=0,this.mode=S,this.state=P):a===g?this.mode===R?this.pop():this.parseError(a,b):a===i&&this.mode===S?this.pop():this.parseError(a,b):this.state===Q?a===o?(this.key=b,this.state=j):a===g?this.pop():this.parseError(a,b):this.state===j?a===j?this.state=P:this.parseError(a,b):this.state===k?a===k?this.mode===S?(this.key++,this.state=P):this.mode===R&&(this.state=Q):a===i&&this.mode===S||a===g&&this.mode===R?this.pop():this.parseError(a,b):this.parseError(a,b)},b.exports=d}).call(this,a("buffer").Buffer)},{buffer:248}],299:[function(a,b,c){(function(d){function e(a,b,c){function e(){for(;j.length&&!l.paused;){var a=j.shift();if(null===a)return l.emit("end");l.emit("data",a)}}function g(){l.writable=!1,b.call(l),!l.readable&&l.autoDestroy&&l.destroy()}a=a||function(a){this.queue(a)},b=b||function(){this.queue(null)};var h=!1,i=!1,j=[],k=!1,l=new f;return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(c&&c.autoDestroy===!1),l.write=function(b){return a.call(this,b),!l.paused},l.queue=l.push=function(a){return k?l:(null===a&&(k=!0),j.push(a),e(),l)},l.on("end",function(){l.readable=!1,!l.writable&&l.autoDestroy&&d.nextTick(function(){l.destroy()})}),l.end=function(a){return h?void 0:(h=!0,arguments.length&&l.write(a),g(),l)},l.destroy=function(){return i?void 0:(i=!0,h=!0,j.length=0,l.writable=l.readable=!1,l.emit("close"),l)},l.pause=function(){return l.paused?void 0:(l.paused=!0,l)},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),e(),l.paused||l.emit("drain"),l},l}var f=a("stream");c=b.exports=e,e.through=e}).call(this,a("_process"))},{_process:259,stream:275}],300:[function(b,c,d){!function(){function b(){return{keys:Object.keys||function(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("keys() called on a non-object");var b,c=[];for(b in a)a.hasOwnProperty(b)&&(c[c.length]=b);return c},uniqueId:function(a){var b=++j+"";return a?a+b:b},has:function(a,b){return h.call(a,b)},each:function(a,b,c){if(null!=a)if(g&&a.forEach===g)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;e>d;d++)b.call(c,a[d],d,a);else for(var f in a)this.has(a,f)&&b.call(c,a[f],f,a)},once:function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}}}var e,f=this,g=Array.prototype.forEach,h=Object.prototype.hasOwnProperty,i=Array.prototype.slice,j=0,k=b();e={on:function(a,b,c){if(!m(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,c){if(!m(this,"once",a,[b,c])||!b)return this;var d=this,e=k.once(function(){d.off(a,e),b.apply(this,arguments)});return e._callback=b,this.on(a,e,c)},off:function(a,b,c){var d,e,f,g,h,i,j,l;if(!this._events||!m(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;for(g=a?[a]:k.keys(this._events),h=0,i=g.length;i>h;h++)if(a=g[h],f=this._events[a]){if(this._events[a]=d=[],b||c)for(j=0,l=f.length;l>j;j++)e=f[j],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&d.push(e);d.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=i.call(arguments,1);if(!m(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&n(c,b),d&&n(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}};var l=/\s+/,m=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(l.test(c)){for(var f=c.split(l),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},n=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},o={listenTo:"on",listenToOnce:"once"};k.each(o,function(a,b){e[b]=function(b,c,d){var e=this._listeners||(this._listeners={}),f=b._listenerId||(b._listenerId=k.uniqueId("l"));return e[f]=b,"object"==typeof c&&(d=this),b[a](c,d,this),this}}),e.bind=e.on,e.unbind=e.off,e.mixin=function(a){var b=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return k.each(b,function(b){a[b]=this[b]},this),a},"undefined"!=typeof d?("undefined"!=typeof c&&c.exports&&(d=c.exports=e),d.BackboneEvents=e):"function"==typeof a&&"object"==typeof a.amd?a(function(){return e}):f.BackboneEvents=e}(this)},{}],301:[function(a,b,c){b.exports=a("./backbone-events-standalone")},{"./backbone-events-standalone":300}],302:[function(a,b,c){var d=a("jquery");!function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(d)},{jquery:309}],303:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=Math.abs(j-t)<=p,e=Math.abs(k-s)<=p,f=Math.abs(h-r)<=p,g=Math.abs(i-q)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=Math.abs(j-s)<=p,e=Math.abs(k-t)<=p,f=Math.abs(h-q)<=p,g=Math.abs(i-r)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{
top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(d)},{"./core":302,"./mouse":305,"./widget":308,jquery:309}],304:[function(a,b,c){var d=a("jquery");a("./core"),a("./widget"),a("./mouse"),a("./draggable"),function(a,b){function c(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b,c=this.options,d=c.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(d)?d:function(a){return a.is(d)},this.proportions=function(){return arguments.length?void(b=arguments[0]):b?b:b={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},a.ui.ddmanager.droppables[c.scope]=a.ui.ddmanager.droppables[c.scope]||[],a.ui.ddmanager.droppables[c.scope].push(this),c.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];b<c.length;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,b,d){if(!b.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=(a.positionAbs||a.position.absolute).top,i=g+a.helperProportions.width,j=h+a.helperProportions.height,k=b.offset.left,l=b.offset.top,m=k+b.proportions().width,n=l+b.proportions().height;switch(d){case"fit":return g>=k&&m>=i&&h>=l&&n>=j;case"intersect":return k<g+a.helperProportions.width/2&&i-a.helperProportions.width/2<m&&l<h+a.helperProportions.height/2&&j-a.helperProportions.height/2<n;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,c(f,l,b.proportions().height)&&c(e,k,b.proportions().width);case"touch":return(h>=l&&n>=h||j>=l&&n>=j||l>h&&j>n)&&(g>=k&&m>=g||i>=k&&m>=i||k>g&&i>m);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;d<f.length;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;e<h.length;e++)if(h[e]===f[d].element[0]){f[d].proportions().height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions({width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight}))}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(d)},{"./core":302,"./draggable":303,"./mouse":305,"./widget":308,jquery:309}],305:[function(a,b,c){var d=a("jquery");a("./widget"),function(a,b){var c=!1;a(document).mouseup(function(){c=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=1===b.which,f="string"==typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(d)},{"./widget":308,jquery:309}],306:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var d,e,f,g,h=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),d=this._start(b,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),b.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(b,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(d)},{"./core":302,"./mouse":305,"./widget":308,jquery:309}],307:[function(a,b,c){var d=a("jquery");a("./core"),a("./mouse"),a("./widget"),function(a,b){function c(a,b,c){return a>b&&b+c>a}function d(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||d(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var b="x"===this.options.axis||c(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||c(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=b&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var b=c(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=c(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&b||"up"===e&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)g=a.data(f[e],this.widgetFullName),g&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());
var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||d(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!n||c(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),Math.abs(l-k)<g&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down"));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(b,h,null,!0):this._rearrange(b,null,this.containers[p].element,!0),this._trigger("change",b,this._uiHash()),this.containers[p]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)("auto"===this._storedCSS[d]||"static"===this._storedCSS[d])&&(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(d)},{"./core":302,"./mouse":305,"./widget":308,jquery:309}],308:[function(a,b,c){var d=a("jquery");!function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(a.isPlainObject(f)?c[e]=a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):c[e]=f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(d)},{jquery:309}],309:[function(b,c,d){!function(a,b){"object"==typeof c&&"object"==typeof c.exports?c.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(b,c){function d(a){var b="length"in a&&a.length,c=aa.type(a);return"function"===c||aa.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function e(a,b,c){if(aa.isFunction(b))return aa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return aa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ia.test(b))return aa.filter(b,a,c);b=aa.filter(b,a)}return aa.grep(a,function(a){return V.call(b,a)>=0!==c})}function f(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function g(a){var b=pa[a]={};return aa.each(a.match(oa)||[],function(a,c){b[c]=!0}),b}function h(){$.removeEventListener("DOMContentLoaded",h,!1),b.removeEventListener("load",h,!1),aa.ready()}function i(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=aa.expando+i.uid++}function j(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(va,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:ua.test(c)?aa.parseJSON(c):c}catch(e){}ta.set(a,b,c)}else c=void 0;return c}function k(){return!0}function l(){return!1}function m(){try{return $.activeElement}catch(a){}}function n(a,b){return aa.nodeName(a,"table")&&aa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function o(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function p(a){var b=La.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function q(a,b){for(var c=0,d=a.length;d>c;c++)sa.set(a[c],"globalEval",!b||sa.get(b[c],"globalEval"))}function r(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(sa.hasData(a)&&(f=sa.access(a),g=sa.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)aa.event.add(b,e,j[e][c])}ta.hasData(a)&&(h=ta.access(a),i=aa.extend({},h),ta.set(b,i))}}function s(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&aa.nodeName(a,b)?aa.merge([a],c):c}function t(a,b){var c=b.nodeName.toLowerCase();"input"===c&&za.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function u(a,c){var d,e=aa(c.createElement(a)).appendTo(c.body),f=b.getDefaultComputedStyle&&(d=b.getDefaultComputedStyle(e[0]))?d.display:aa.css(e[0],"display");return e.detach(),f}function v(a){var b=$,c=Pa[a];return c||(c=u(a,b),"none"!==c&&c||(Oa=(Oa||aa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Oa[0].contentDocument,b.write(),b.close(),c=u(a,b),Oa.detach()),Pa[a]=c),c}function w(a,b,c){var d,e,f,g,h=a.style;return c=c||Sa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||aa.contains(a.ownerDocument,a)||(g=aa.style(a,b)),Ra.test(g)&&Qa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function x(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function y(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Ya.length;e--;)if(b=Ya[e]+c,b in a)return b;return d}function z(a,b,c){var d=Ua.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function A(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=aa.css(a,c+xa[f],!0,e)),d?("content"===c&&(g-=aa.css(a,"padding"+xa[f],!0,e)),"margin"!==c&&(g-=aa.css(a,"border"+xa[f]+"Width",!0,e))):(g+=aa.css(a,"padding"+xa[f],!0,e),"padding"!==c&&(g+=aa.css(a,"border"+xa[f]+"Width",!0,e)));return g}function B(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Sa(a),g="border-box"===aa.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=w(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ra.test(e))return e;d=g&&(Z.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+A(a,b,c||(g?"border":"content"),d,f)+"px"}function C(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=sa.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&ya(d)&&(f[g]=sa.access(d,"olddisplay",v(d.nodeName)))):(e=ya(d),"none"===c&&e||sa.set(d,"olddisplay",e?c:aa.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function D(a,b,c,d,e){return new D.prototype.init(a,b,c,d,e)}function E(){return setTimeout(function(){Za=void 0}),Za=aa.now()}function F(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=xa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function G(a,b,c){for(var d,e=(db[b]||[]).concat(db["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function H(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&ya(a),p=sa.get(a,"fxshow");c.queue||(h=aa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,aa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=aa.css(a,"display"),k="none"===j?sa.get(a,"olddisplay")||v(a.nodeName):j,"inline"===k&&"none"===aa.css(a,"float")&&(n.display="inline-block")),c.overflow&&(n.overflow="hidden",l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],_a.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||aa.style(a,d)}else j=void 0;if(aa.isEmptyObject(m))"inline"===("none"===j?v(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=sa.access(a,"fxshow",{}),f&&(p.hidden=!o),o?aa(a).show():l.done(function(){aa(a).hide()}),l.done(function(){var b;sa.remove(a,"fxshow");for(b in m)aa.style(a,b,m[b])});for(d in m)g=G(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function I(a,b){var c,d,e,f,g;for(c in a)if(d=aa.camelCase(c),e=b[d],f=a[c],aa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=aa.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function J(a,b,c){var d,e,f=0,g=cb.length,h=aa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Za||E(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:aa.extend({},b),opts:aa.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Za||E(),duration:c.duration,tweens:[],createTween:function(b,c){var d=aa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(I(k,j.opts.specialEasing);g>f;f++)if(d=cb[f].call(j,a,k,j.opts))return d;return aa.map(k,G,j),aa.isFunction(j.opts.start)&&j.opts.start.call(a,j),aa.fx.timer(aa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function K(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(oa)||[];if(aa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function L(a,b,c,d){function e(h){var i;return f[h]=!0,aa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===ub;return e(b.dataTypes[0])||!f["*"]&&e("*")}function M(a,b){var c,d,e=aa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&aa.extend(!0,a,d),a}function N(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function O(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function P(a,b,c,d){var e;if(aa.isArray(b))aa.each(b,function(b,e){c||zb.test(a)?d(a,e):P(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==aa.type(b))d(a,b);else for(e in b)P(a+"["+e+"]",b[e],c,d)}function Q(a){return aa.isWindow(a)?a:9===a.nodeType&&a.defaultView}var R=[],S=R.slice,T=R.concat,U=R.push,V=R.indexOf,W={},X=W.toString,Y=W.hasOwnProperty,Z={},$=b.document,_="2.1.4",aa=function(a,b){return new aa.fn.init(a,b)},ba=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ca=/^-ms-/,da=/-([\da-z])/gi,ea=function(a,b){return b.toUpperCase()};aa.fn=aa.prototype={jquery:_,constructor:aa,selector:"",length:0,toArray:function(){return S.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:S.call(this)},pushStack:function(a){var b=aa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return aa.each(this,a,b)},map:function(a){return this.pushStack(aa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(S.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:U,sort:R.sort,splice:R.splice},aa.extend=aa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||aa.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(aa.isPlainObject(d)||(e=aa.isArray(d)))?(e?(e=!1,f=c&&aa.isArray(c)?c:[]):f=c&&aa.isPlainObject(c)?c:{},g[b]=aa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},aa.extend({expando:"jQuery"+(_+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===aa.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!aa.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==aa.type(a)||a.nodeType||aa.isWindow(a)?!1:a.constructor&&!Y.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?W[X.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=aa.trim(a),a&&(1===a.indexOf("use strict")?(b=$.createElement("script"),b.text=a,$.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ca,"ms-").replace(da,ea)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e,f=0,g=a.length,h=d(a);if(c){if(h)for(;g>f&&(e=b.apply(a[f],c),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],c),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(ba,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(d(Object(a))?aa.merge(c,"string"==typeof a?[a]:a):U.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:V.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var e,f=0,g=a.length,h=d(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,c),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&i.push(e);return T.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),aa.isFunction(a)?(d=S.call(arguments,2),e=function(){return a.apply(b||this,d.concat(S.call(arguments)))},e.guid=a.guid=a.guid||aa.guid++,e):void 0},now:Date.now,support:Z}),aa.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){W["[object "+b+"]"]=b.toLowerCase();
});var fa=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],h=b.nodeType,"string"!=typeof a||!a||1!==h&&9!==h&&11!==h)return c;if(!d&&I){if(11!==h&&(e=sa.exec(a)))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return $.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&v.getElementsByClassName)return $.apply(c,b.getElementsByClassName(g)),c}if(v.qsa&&(!J||!J.test(a))){if(n=l=N,o=b,p=1!==h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=z(a),(l=b.getAttribute("id"))?n=l.replace(ua,"\\$&"):b.setAttribute("id",n),n="[id='"+n+"'] ",i=j.length;i--;)j[i]=n+m(j[i]);o=ta.test(a)&&k(b.parentNode)||b,p=j.join(",")}if(p)try{return $.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{l||b.removeAttribute("id")}}}return B(a.replace(ia,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||V)-(~a.sourceIndex||V);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?aa(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return aa(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];e>h;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ia,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Y.call(i));r=q(r)}$.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+1*new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V=1<<31,W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,aa=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},ba="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ca="[\\x20\\t\\r\\n\\f]",da="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ea=da.replace("w","w#"),fa="\\["+ca+"*("+da+")(?:"+ca+"*([*^$|!~]?=)"+ca+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ea+"))|)"+ca+"*\\]",ga=":("+da+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+fa+")*)|.*)\\)|)",ha=new RegExp(ca+"+","g"),ia=new RegExp("^"+ca+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ca+"+$","g"),ja=new RegExp("^"+ca+"*,"+ca+"*"),ka=new RegExp("^"+ca+"*([>+~]|"+ca+")"+ca+"*"),la=new RegExp("="+ca+"*([^\\]'\"]*?)"+ca+"*\\]","g"),ma=new RegExp(ga),na=new RegExp("^"+ea+"$"),oa={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da.replace("w","w*")+")"),ATTR:new RegExp("^"+fa),PSEUDO:new RegExp("^"+ga),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ca+"*(even|odd|(([+-]|)(\\d*)n|)"+ca+"*(?:([+-]|)"+ca+"*(\\d+)|))"+ca+"*\\)|)","i"),bool:new RegExp("^(?:"+ba+")$","i"),needsContext:new RegExp("^"+ca+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ca+"*((?:-\\d)?\\d*)"+ca+"*\\)|)(?=[^-]|$)","i")},pa=/^(?:input|select|textarea|button)$/i,qa=/^h\d$/i,ra=/^[^{]+\{\s*\[native \w/,sa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ta=/[+~]/,ua=/'|\\/g,va=new RegExp("\\\\([\\da-f]{1,6}"+ca+"?|("+ca+")|.)","ig"),wa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},xa=function(){F()};try{$.apply(X=_.call(O.childNodes),O.childNodes),X[O.childNodes.length].nodeType}catch(ya){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:O;return d!==G&&9===d.nodeType&&d.documentElement?(G=d,H=d.documentElement,c=d.defaultView,c&&c!==c.top&&(c.addEventListener?c.addEventListener("unload",xa,!1):c.attachEvent&&c.attachEvent("onunload",xa)),I=!y(d),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(d.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=ra.test(d.getElementsByClassName),v.getById=e(function(a){return H.appendChild(a).id=N,!d.getElementsByName||!d.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(va,wa);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):v.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){return I?b.getElementsByClassName(a):void 0},K=[],J=[],(v.qsa=ra.test(d.querySelectorAll))&&(e(function(a){H.appendChild(a).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]="+ca+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+ca+"*(?:value|"+ba+")"),a.querySelectorAll("[id~="+N+"-]").length||J.push("~="),a.querySelectorAll(":checked").length||J.push(":checked"),a.querySelectorAll("a#"+N+"+*").length||J.push(".#.+[+~]")}),e(function(a){var b=d.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+ca+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=ra.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",ga)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=ra.test(H.compareDocumentPosition),M=b||ra.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c?c:(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!v.sortDetached&&b.compareDocumentPosition(a)===c?a===d||a.ownerDocument===O&&M(O,a)?-1:b===d||b.ownerDocument===O&&M(O,b)?1:D?aa(D,a)-aa(D,b):0:4&c?-1:1)}:function(a,b){if(a===b)return E=!0,0;var c,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===d?-1:b===d?1:f?-1:h?1:D?aa(D,a)-aa(D,b):0;if(f===h)return g(a,b);for(c=a;c=c.parentNode;)i.unshift(c);for(c=b;c=c.parentNode;)j.unshift(c);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},d):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(la,"='$1']"),!(!v.matchesSelector||!I||K&&K.test(c)||J&&J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&W.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:oa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(va,wa),a[3]=(a[3]||a[4]||a[5]||"").replace(va,wa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return oa.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&ma.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(va,wa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+ca+")"+a+"("+ca+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ha," ")+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=aa(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ia,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(va,wa),function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return na.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(va,wa).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return qa.test(a.nodeName)},input:function(a){return pa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){(!d||(e=ja.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ka.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ia," ")}),h=h.slice(d.length));for(g in w.filter)!(e=oa[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(va,wa),b)||[])[0],!b)return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=oa.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(va,wa),ta.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return $.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,ta.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ba,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(b);aa.find=fa,aa.expr=fa.selectors,aa.expr[":"]=aa.expr.pseudos,aa.unique=fa.uniqueSort,aa.text=fa.getText,aa.isXMLDoc=fa.isXML,aa.contains=fa.contains;var ga=aa.expr.match.needsContext,ha=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ia=/^.[^:#\[\.,]*$/;aa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?aa.find.matchesSelector(d,a)?[d]:[]:aa.find.matches(a,aa.grep(b,function(a){return 1===a.nodeType}))},aa.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(aa(a).filter(function(){for(b=0;c>b;b++)if(aa.contains(e[b],this))return!0}));for(b=0;c>b;b++)aa.find(a,e[b],d);return d=this.pushStack(c>1?aa.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(e(this,a||[],!1))},not:function(a){return this.pushStack(e(this,a||[],!0))},is:function(a){return!!e(this,"string"==typeof a&&ga.test(a)?aa(a):a||[],!1).length}});var ja,ka=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,la=aa.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ka.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ja).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof aa?b[0]:b,aa.merge(this,aa.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:$,!0)),ha.test(c[1])&&aa.isPlainObject(b))for(c in b)aa.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=$.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=$,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):aa.isFunction(a)?"undefined"!=typeof ja.ready?ja.ready(a):a(aa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),aa.makeArray(a,this))};la.prototype=aa.fn,ja=aa($);var ma=/^(?:parents|prev(?:Until|All))/,na={children:!0,contents:!0,next:!0,prev:!0};aa.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&aa(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),aa.fn.extend({has:function(a){var b=aa(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(aa.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=ga.test(a)||"string"!=typeof a?aa(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&aa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?aa.unique(f):f)},index:function(a){return a?"string"==typeof a?V.call(aa(a),this[0]):V.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(aa.unique(aa.merge(this.get(),aa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),aa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return aa.dir(a,"parentNode")},parentsUntil:function(a,b,c){return aa.dir(a,"parentNode",c)},next:function(a){return f(a,"nextSibling")},prev:function(a){return f(a,"previousSibling")},nextAll:function(a){return aa.dir(a,"nextSibling")},prevAll:function(a){return aa.dir(a,"previousSibling")},nextUntil:function(a,b,c){return aa.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return aa.dir(a,"previousSibling",c)},siblings:function(a){return aa.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return aa.sibling(a.firstChild)},contents:function(a){return a.contentDocument||aa.merge([],a.childNodes)}},function(a,b){aa.fn[a]=function(c,d){var e=aa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=aa.filter(d,e)),this.length>1&&(na[a]||aa.unique(e),ma.test(a)&&e.reverse()),this.pushStack(e)}});var oa=/\S+/g,pa={};aa.Callbacks=function(a){a="string"==typeof a?pa[a]||g(a):aa.extend({},a);var b,c,d,e,f,h,i=[],j=!a.once&&[],k=function(g){for(b=a.memory&&g,c=!0,h=e||0,e=0,f=i.length,d=!0;i&&f>h;h++)if(i[h].apply(g[0],g[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function g(b){aa.each(b,function(b,c){var d=aa.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&aa.each(arguments,function(a,b){for(var c;(c=aa.inArray(b,i,c))>-1;)i.splice(c,1),d&&(f>=c&&f--,h>=c&&h--)}),this},has:function(a){return a?aa.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],f=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},aa.extend({Deferred:function(a){var b=[["resolve","done",aa.Callbacks("once memory"),"resolved"],["reject","fail",aa.Callbacks("once memory"),"rejected"],["notify","progress",aa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return aa.Deferred(function(c){aa.each(b,function(b,f){var g=aa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&aa.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?aa.extend(a,d):d}},e={};return d.pipe=d.then,aa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=S.call(arguments),g=f.length,h=1!==g||a&&aa.isFunction(a.promise)?g:0,i=1===h?a:aa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?S.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&aa.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var qa;aa.fn.ready=function(a){return aa.ready.promise().done(a),this},aa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?aa.readyWait++:aa.ready(!0)},ready:function(a){(a===!0?--aa.readyWait:aa.isReady)||(aa.isReady=!0,a!==!0&&--aa.readyWait>0||(qa.resolveWith($,[aa]),aa.fn.triggerHandler&&(aa($).triggerHandler("ready"),aa($).off("ready"))))}}),aa.ready.promise=function(a){return qa||(qa=aa.Deferred(),"complete"===$.readyState?setTimeout(aa.ready):($.addEventListener("DOMContentLoaded",h,!1),b.addEventListener("load",h,!1))),qa.promise(a)},aa.ready.promise();var ra=aa.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===aa.type(c)){e=!0;for(h in c)aa.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,aa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(aa(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};aa.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},i.uid=1,i.accepts=aa.acceptData,i.prototype={key:function(a){if(!i.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=i.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,aa.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(aa.isEmptyObject(f))aa.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,aa.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{aa.isArray(b)?d=b.concat(b.map(aa.camelCase)):(e=aa.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(oa)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!aa.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var sa=new i,ta=new i,ua=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,va=/([A-Z])/g;aa.extend({hasData:function(a){return ta.hasData(a)||sa.hasData(a)},data:function(a,b,c){return ta.access(a,b,c)},removeData:function(a,b){ta.remove(a,b)},_data:function(a,b,c){return sa.access(a,b,c)},_removeData:function(a,b){sa.remove(a,b)}}),aa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=ta.get(f),1===f.nodeType&&!sa.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=aa.camelCase(d.slice(5)),j(f,d,e[d])));sa.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){ta.set(this,a)}):ra(this,function(b){var c,d=aa.camelCase(a);if(f&&void 0===b){if(c=ta.get(f,a),void 0!==c)return c;if(c=ta.get(f,d),void 0!==c)return c;if(c=j(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=ta.get(this,d);ta.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&ta.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){ta.remove(this,a)})}}),aa.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=sa.get(a,b),c&&(!d||aa.isArray(c)?d=sa.access(a,b,aa.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=aa.queue(a,b),d=c.length,e=c.shift(),f=aa._queueHooks(a,b),g=function(){aa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return sa.get(a,c)||sa.access(a,c,{empty:aa.Callbacks("once memory").add(function(){sa.remove(a,[b+"queue",c])})})}}),aa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?aa.queue(this[0],a):void 0===b?this:this.each(function(){var c=aa.queue(this,a,b);aa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&aa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){aa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=aa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=sa.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var wa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xa=["Top","Right","Bottom","Left"],ya=function(a,b){return a=b||a,"none"===aa.css(a,"display")||!aa.contains(a.ownerDocument,a)},za=/^(?:checkbox|radio)$/i;!function(){var a=$.createDocumentFragment(),b=a.appendChild($.createElement("div")),c=$.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),Z.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var Aa="undefined";Z.focusinBubbles="onfocusin"in b;var Ba=/^key/,Ca=/^(?:mouse|pointer|contextmenu)|click/,Da=/^(?:focusinfocus|focusoutblur)$/,Ea=/^([^.]*)(?:\.(.+)|)$/;aa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=sa.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=aa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof aa!==Aa&&aa.event.triggered!==b.type?aa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(oa)||[""],j=b.length;j--;)h=Ea.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=aa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=aa.event.special[n]||{},k=aa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&aa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),aa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=sa.hasData(a)&&sa.get(a);if(q&&(i=q.events)){for(b=(b||"").match(oa)||[""],j=b.length;j--;)if(h=Ea.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=aa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||aa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)aa.event.remove(a,n+b[j],c,d,!0);aa.isEmptyObject(i)&&(delete q.handle,sa.remove(a,"events"))}},trigger:function(a,c,d,e){var f,g,h,i,j,k,l,m=[d||$],n=Y.call(a,"type")?a.type:a,o=Y.call(a,"namespace")?a.namespace.split("."):[];if(g=h=d=d||$,3!==d.nodeType&&8!==d.nodeType&&!Da.test(n+aa.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,a=a[aa.expando]?a:new aa.Event(n,"object"==typeof a&&a),
a.isTrigger=e?2:3,a.namespace=o.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,a.target||(a.target=d),c=null==c?[a]:aa.makeArray(c,[a]),l=aa.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!aa.isWindow(d)){for(i=l.delegateType||n,Da.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||$)&&m.push(h.defaultView||h.parentWindow||b)}for(f=0;(g=m[f++])&&!a.isPropagationStopped();)a.type=f>1?i:l.bindType||n,k=(sa.get(g,"events")||{})[a.type]&&sa.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&aa.acceptData(g)&&(a.result=k.apply(g,c),a.result===!1&&a.preventDefault());return a.type=n,e||a.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!aa.acceptData(d)||j&&aa.isFunction(d[n])&&!aa.isWindow(d)&&(h=d[j],h&&(d[j]=null),aa.event.triggered=n,d[n](),aa.event.triggered=void 0,h&&(d[j]=h)),a.result}},dispatch:function(a){a=aa.event.fix(a);var b,c,d,e,f,g=[],h=S.call(arguments),i=(sa.get(this,"events")||{})[a.type]||[],j=aa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=aa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(f.namespace))&&(a.handleObj=f,a.data=f.data,d=((aa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?aa(e,this).index(i)>=0:aa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||$,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[aa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ca.test(e)?this.mouseHooks:Ba.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new aa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=$),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&aa.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return aa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=aa.extend(new aa.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?aa.event.trigger(e,null,b):aa.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},aa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},aa.Event=function(a,b){return this instanceof aa.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?k:l):this.type=a,b&&aa.extend(this,b),this.timeStamp=a&&a.timeStamp||aa.now(),void(this[aa.expando]=!0)):new aa.Event(a,b)},aa.Event.prototype={isDefaultPrevented:l,isPropagationStopped:l,isImmediatePropagationStopped:l,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=k,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=k,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=k,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},aa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){aa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!aa.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Z.focusinBubbles||aa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){aa.event.simulate(b,a.target,aa.event.fix(a),!0)};aa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=sa.access(d,b);e||d.addEventListener(a,c,!0),sa.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=sa.access(d,b)-1;e?sa.access(d,b,e):(d.removeEventListener(a,c,!0),sa.remove(d,b))}}}),aa.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=l;else if(!d)return this;return 1===e&&(f=d,d=function(a){return aa().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=aa.guid++)),this.each(function(){aa.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,aa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=l),this.each(function(){aa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){aa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?aa.event.trigger(a,b,c,!0):void 0}});var Fa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ga=/<([\w:]+)/,Ha=/<|&#?\w+;/,Ia=/<(?:script|style|link)/i,Ja=/checked\s*(?:[^=]|=\s*.checked.)/i,Ka=/^$|\/(?:java|ecma)script/i,La=/^true\/(.*)/,Ma=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Na={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Na.optgroup=Na.option,Na.tbody=Na.tfoot=Na.colgroup=Na.caption=Na.thead,Na.th=Na.td,aa.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=aa.contains(a.ownerDocument,a);if(!(Z.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||aa.isXMLDoc(a)))for(g=s(h),f=s(a),d=0,e=f.length;e>d;d++)t(f[d],g[d]);if(b)if(c)for(f=f||s(a),g=g||s(h),d=0,e=f.length;e>d;d++)r(f[d],g[d]);else r(a,h);return g=s(h,"script"),g.length>0&&q(g,!i&&s(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===aa.type(e))aa.merge(l,e.nodeType?[e]:e);else if(Ha.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Ga.exec(e)||["",""])[1].toLowerCase(),h=Na[g]||Na._default,f.innerHTML=h[1]+e.replace(Fa,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;aa.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===aa.inArray(e,d))&&(i=aa.contains(e.ownerDocument,e),f=s(k.appendChild(e),"script"),i&&q(f),c))for(j=0;e=f[j++];)Ka.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f=aa.event.special,g=0;void 0!==(c=a[g]);g++){if(aa.acceptData(c)&&(e=c[sa.expando],e&&(b=sa.cache[e]))){if(b.events)for(d in b.events)f[d]?aa.event.remove(c,d):aa.removeEvent(c,d,b.handle);sa.cache[e]&&delete sa.cache[e]}delete ta.cache[c[ta.expando]]}}}),aa.fn.extend({text:function(a){return ra(this,function(a){return void 0===a?aa.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=n(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=n(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?aa.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||aa.cleanData(s(c)),c.parentNode&&(b&&aa.contains(c.ownerDocument,c)&&q(s(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(aa.cleanData(s(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return aa.clone(this,a,b)})},html:function(a){return ra(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Ia.test(a)&&!Na[(Ga.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Fa,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(aa.cleanData(s(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,aa.cleanData(s(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=T.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],n=aa.isFunction(m);if(n||j>1&&"string"==typeof m&&!Z.checkClone&&Ja.test(m))return this.each(function(c){var d=k.eq(c);n&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=aa.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=aa.map(s(c,"script"),o),f=e.length;j>i;i++)g=c,i!==l&&(g=aa.clone(g,!0,!0),f&&aa.merge(e,s(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,aa.map(e,p),i=0;f>i;i++)g=e[i],Ka.test(g.type||"")&&!sa.access(g,"globalEval")&&aa.contains(h,g)&&(g.src?aa._evalUrl&&aa._evalUrl(g.src):aa.globalEval(g.textContent.replace(Ma,"")))}return this}}),aa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){aa.fn[a]=function(a){for(var c,d=[],e=aa(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),aa(e[g])[b](c),U.apply(d,c.get());return this.pushStack(d)}});var Oa,Pa={},Qa=/^margin/,Ra=new RegExp("^("+wa+")(?!px)[a-z%]+$","i"),Sa=function(a){return a.ownerDocument.defaultView.opener?a.ownerDocument.defaultView.getComputedStyle(a,null):b.getComputedStyle(a,null)};!function(){function a(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",g.innerHTML="",e.appendChild(f);var a=b.getComputedStyle(g,null);c="1%"!==a.top,d="4px"===a.width,e.removeChild(f)}var c,d,e=$.documentElement,f=$.createElement("div"),g=$.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),b.getComputedStyle&&aa.extend(Z,{pixelPosition:function(){return a(),c},boxSizingReliable:function(){return null==d&&a(),d},reliableMarginRight:function(){var a,c=g.appendChild($.createElement("div"));return c.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",g.style.width="1px",e.appendChild(f),a=!parseFloat(b.getComputedStyle(c,null).marginRight),e.removeChild(f),g.removeChild(c),a}}))}(),aa.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Ta=/^(none|table(?!-c[ea]).+)/,Ua=new RegExp("^("+wa+")(.*)$","i"),Va=new RegExp("^([+-])=("+wa+")","i"),Wa={position:"absolute",visibility:"hidden",display:"block"},Xa={letterSpacing:"0",fontWeight:"400"},Ya=["Webkit","O","Moz","ms"];aa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=w(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=aa.camelCase(b),i=a.style;return b=aa.cssProps[h]||(aa.cssProps[h]=y(i,h)),g=aa.cssHooks[b]||aa.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Va.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(aa.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||aa.cssNumber[h]||(c+="px"),Z.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=aa.camelCase(b);return b=aa.cssProps[h]||(aa.cssProps[h]=y(a.style,h)),g=aa.cssHooks[b]||aa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=w(a,b,d)),"normal"===e&&b in Xa&&(e=Xa[b]),""===c||c?(f=parseFloat(e),c===!0||aa.isNumeric(f)?f||0:e):e}}),aa.each(["height","width"],function(a,b){aa.cssHooks[b]={get:function(a,c,d){return c?Ta.test(aa.css(a,"display"))&&0===a.offsetWidth?aa.swap(a,Wa,function(){return B(a,b,d)}):B(a,b,d):void 0},set:function(a,c,d){var e=d&&Sa(a);return z(a,c,d?A(a,b,d,"border-box"===aa.css(a,"boxSizing",!1,e),e):0)}}}),aa.cssHooks.marginRight=x(Z.reliableMarginRight,function(a,b){return b?aa.swap(a,{display:"inline-block"},w,[a,"marginRight"]):void 0}),aa.each({margin:"",padding:"",border:"Width"},function(a,b){aa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+xa[d]+b]=f[d]||f[d-2]||f[0];return e}},Qa.test(a)||(aa.cssHooks[a+b].set=z)}),aa.fn.extend({css:function(a,b){return ra(this,function(a,b,c){var d,e,f={},g=0;if(aa.isArray(b)){for(d=Sa(a),e=b.length;e>g;g++)f[b[g]]=aa.css(a,b[g],!1,d);return f}return void 0!==c?aa.style(a,b,c):aa.css(a,b)},a,b,arguments.length>1)},show:function(){return C(this,!0)},hide:function(){return C(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){ya(this)?aa(this).show():aa(this).hide()})}}),aa.Tween=D,D.prototype={constructor:D,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(aa.cssNumber[c]?"":"px")},cur:function(){var a=D.propHooks[this.prop];return a&&a.get?a.get(this):D.propHooks._default.get(this)},run:function(a){var b,c=D.propHooks[this.prop];return this.options.duration?this.pos=b=aa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):D.propHooks._default.set(this),this}},D.prototype.init.prototype=D.prototype,D.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=aa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){aa.fx.step[a.prop]?aa.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[aa.cssProps[a.prop]]||aa.cssHooks[a.prop])?aa.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},D.propHooks.scrollTop=D.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},aa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},aa.fx=D.prototype.init,aa.fx.step={};var Za,$a,_a=/^(?:toggle|show|hide)$/,ab=new RegExp("^(?:([+-])=|)("+wa+")([a-z%]*)$","i"),bb=/queueHooks$/,cb=[H],db={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=ab.exec(b),f=e&&e[3]||(aa.cssNumber[a]?"":"px"),g=(aa.cssNumber[a]||"px"!==f&&+d)&&ab.exec(aa.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,aa.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};aa.Animation=aa.extend(J,{tweener:function(a,b){aa.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],db[c]=db[c]||[],db[c].unshift(b)},prefilter:function(a,b){b?cb.unshift(a):cb.push(a)}}),aa.speed=function(a,b,c){var d=a&&"object"==typeof a?aa.extend({},a):{complete:c||!c&&b||aa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!aa.isFunction(b)&&b};return d.duration=aa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in aa.fx.speeds?aa.fx.speeds[d.duration]:aa.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){aa.isFunction(d.old)&&d.old.call(this),d.queue&&aa.dequeue(this,d.queue)},d},aa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(ya).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=aa.isEmptyObject(a),f=aa.speed(b,c,d),g=function(){var b=J(this,aa.extend({},a),f);(e||sa.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=aa.timers,g=sa.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&bb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&aa.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=sa.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=aa.timers,g=d?d.length:0;for(c.finish=!0,aa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),aa.each(["toggle","show","hide"],function(a,b){var c=aa.fn[b];aa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(F(b,!0),a,d,e)}}),aa.each({slideDown:F("show"),slideUp:F("hide"),slideToggle:F("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){aa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),aa.timers=[],aa.fx.tick=function(){var a,b=0,c=aa.timers;for(Za=aa.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||aa.fx.stop(),Za=void 0},aa.fx.timer=function(a){aa.timers.push(a),a()?aa.fx.start():aa.timers.pop()},aa.fx.interval=13,aa.fx.start=function(){$a||($a=setInterval(aa.fx.tick,aa.fx.interval))},aa.fx.stop=function(){clearInterval($a),$a=null},aa.fx.speeds={slow:600,fast:200,_default:400},aa.fn.delay=function(a,b){return a=aa.fx?aa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=$.createElement("input"),b=$.createElement("select"),c=b.appendChild($.createElement("option"));a.type="checkbox",Z.checkOn=""!==a.value,Z.optSelected=c.selected,b.disabled=!0,Z.optDisabled=!c.disabled,a=$.createElement("input"),a.value="t",a.type="radio",Z.radioValue="t"===a.value}();var eb,fb,gb=aa.expr.attrHandle;aa.fn.extend({attr:function(a,b){return ra(this,aa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){aa.removeAttr(this,a)})}}),aa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===Aa?aa.prop(a,b,c):(1===f&&aa.isXMLDoc(a)||(b=b.toLowerCase(),d=aa.attrHooks[b]||(aa.expr.match.bool.test(b)?fb:eb)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=aa.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void aa.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(oa);if(f&&1===a.nodeType)for(;c=f[e++];)d=aa.propFix[c]||c,aa.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Z.radioValue&&"radio"===b&&aa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),fb={set:function(a,b,c){return b===!1?aa.removeAttr(a,c):a.setAttribute(c,c),c}},aa.each(aa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=gb[b]||aa.find.attr;gb[b]=function(a,b,d){var e,f;return d||(f=gb[b],gb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,gb[b]=f),e}});var hb=/^(?:input|select|textarea|button)$/i;aa.fn.extend({prop:function(a,b){return ra(this,aa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[aa.propFix[a]||a]})}}),aa.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!aa.isXMLDoc(a),f&&(b=aa.propFix[b]||b,e=aa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||hb.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Z.optSelected||(aa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),aa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){aa.propFix[this.toLowerCase()]=this});var ib=/[\t\r\n\f]/g;aa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(oa)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ib," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=aa.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(oa)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ib," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?aa.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):aa.isFunction(a)?this.each(function(c){aa(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=aa(this),f=a.match(oa)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===Aa||"boolean"===c)&&(this.className&&sa.set(this,"__className__",this.className),this.className=this.className||a===!1?"":sa.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ib," ").indexOf(b)>=0)return!0;return!1}});var jb=/\r/g;aa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=aa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,aa(this).val()):a,null==e?e="":"number"==typeof e?e+="":aa.isArray(e)&&(e=aa.map(e,function(a){return null==a?"":a+""})),b=aa.valHooks[this.type]||aa.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=aa.valHooks[e.type]||aa.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(jb,""):null==c?"":c)}}}),aa.extend({valHooks:{option:{get:function(a){var b=aa.find.attr(a,"value");return null!=b?b:aa.trim(aa.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(Z.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&aa.nodeName(c.parentNode,"optgroup"))){if(b=aa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=aa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=aa.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),aa.each(["radio","checkbox"],function(){aa.valHooks[this]={set:function(a,b){return aa.isArray(b)?a.checked=aa.inArray(aa(a).val(),b)>=0:void 0}},Z.checkOn||(aa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),aa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){aa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),aa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var kb=aa.now(),lb=/\?/;aa.parseJSON=function(a){return JSON.parse(a+"")},aa.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&aa.error("Invalid XML: "+a),b};var mb=/#.*$/,nb=/([?&])_=[^&]*/,ob=/^(.*?):[ \t]*([^\r\n]*)$/gm,pb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,qb=/^(?:GET|HEAD)$/,rb=/^\/\//,sb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,tb={},ub={},vb="*/".concat("*"),wb=b.location.href,xb=sb.exec(wb.toLowerCase())||[];aa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wb,type:"GET",isLocal:pb.test(xb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":vb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":aa.parseJSON,"text xml":aa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?M(M(a,aa.ajaxSettings),b):M(aa.ajaxSettings,a)},ajaxPrefilter:K(tb),ajaxTransport:K(ub),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=N(l,v,c)),s=O(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(aa.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(aa.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,(a||!w)&&(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--aa.active||aa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=aa.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?aa(m):aa.event,o=aa.Deferred(),p=aa.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=ob.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||wb)+"").replace(mb,"").replace(rb,xb[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=aa.trim(l.dataType||"*").toLowerCase().match(oa)||[""],null==l.crossDomain&&(i=sb.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===xb[1]&&i[2]===xb[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(xb[3]||("http:"===xb[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=aa.param(l.data,l.traditional)),L(tb,l,b,v),2===t)return v;j=aa.event&&l.global,j&&0===aa.active++&&aa.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!qb.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(lb.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=nb.test(e)?e.replace(nb,"$1_="+kb++):e+(lb.test(e)?"&":"?")+"_="+kb++)),l.ifModified&&(aa.lastModified[e]&&v.setRequestHeader("If-Modified-Since",aa.lastModified[e]),aa.etag[e]&&v.setRequestHeader("If-None-Match",aa.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+vb+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=L(ub,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return aa.get(a,b,c,"json")},getScript:function(a,b){return aa.get(a,void 0,b,"script")}}),aa.each(["get","post"],function(a,b){aa[b]=function(a,c,d,e){return aa.isFunction(c)&&(e=e||d,d=c,c=void 0),aa.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),aa._evalUrl=function(a){return aa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},aa.fn.extend({wrapAll:function(a){var b;return aa.isFunction(a)?this.each(function(b){aa(this).wrapAll(a.call(this,b))}):(this[0]&&(b=aa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return aa.isFunction(a)?this.each(function(b){aa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=aa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=aa.isFunction(a);return this.each(function(c){aa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){
return this.parent().each(function(){aa.nodeName(this,"body")||aa(this).replaceWith(this.childNodes)}).end()}}),aa.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},aa.expr.filters.visible=function(a){return!aa.expr.filters.hidden(a)};var yb=/%20/g,zb=/\[\]$/,Ab=/\r?\n/g,Bb=/^(?:submit|button|image|reset|file)$/i,Cb=/^(?:input|select|textarea|keygen)/i;aa.param=function(a,b){var c,d=[],e=function(a,b){b=aa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=aa.ajaxSettings&&aa.ajaxSettings.traditional),aa.isArray(a)||a.jquery&&!aa.isPlainObject(a))aa.each(a,function(){e(this.name,this.value)});else for(c in a)P(c,a[c],b,e);return d.join("&").replace(yb,"+")},aa.fn.extend({serialize:function(){return aa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=aa.prop(this,"elements");return a?aa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!aa(this).is(":disabled")&&Cb.test(this.nodeName)&&!Bb.test(a)&&(this.checked||!za.test(a))}).map(function(a,b){var c=aa(this).val();return null==c?null:aa.isArray(c)?aa.map(c,function(a){return{name:b.name,value:a.replace(Ab,"\r\n")}}):{name:b.name,value:c.replace(Ab,"\r\n")}}).get()}}),aa.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Db=0,Eb={},Fb={0:200,1223:204},Gb=aa.ajaxSettings.xhr();b.attachEvent&&b.attachEvent("onunload",function(){for(var a in Eb)Eb[a]()}),Z.cors=!!Gb&&"withCredentials"in Gb,Z.ajax=Gb=!!Gb,aa.ajaxTransport(function(a){var b;return Z.cors||Gb&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Db;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Eb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Fb[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Eb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),aa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return aa.globalEval(a),a}}}),aa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),aa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=aa("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),$.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hb=[],Ib=/(=)\?(?=&|$)|\?\?/;aa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hb.pop()||aa.expando+"_"+kb++;return this[a]=!0,a}}),aa.ajaxPrefilter("json jsonp",function(a,c,d){var e,f,g,h=a.jsonp!==!1&&(Ib.test(a.url)?"url":"string"==typeof a.data&&!(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ib.test(a.data)&&"data");return h||"jsonp"===a.dataTypes[0]?(e=a.jsonpCallback=aa.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,h?a[h]=a[h].replace(Ib,"$1"+e):a.jsonp!==!1&&(a.url+=(lb.test(a.url)?"&":"?")+a.jsonp+"="+e),a.converters["script json"]=function(){return g||aa.error(e+" was not called"),g[0]},a.dataTypes[0]="json",f=b[e],b[e]=function(){g=arguments},d.always(function(){b[e]=f,a[e]&&(a.jsonpCallback=c.jsonpCallback,Hb.push(e)),g&&aa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),aa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||$;var d=ha.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=aa.buildFragment([a],b,e),e&&e.length&&aa(e).remove(),aa.merge([],d.childNodes))};var Jb=aa.fn.load;aa.fn.load=function(a,b,c){if("string"!=typeof a&&Jb)return Jb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=aa.trim(a.slice(h)),a=a.slice(0,h)),aa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&aa.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?aa("<div>").append(aa.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},aa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){aa.fn[b]=function(a){return this.on(b,a)}}),aa.expr.filters.animated=function(a){return aa.grep(aa.timers,function(b){return a===b.elem}).length};var Kb=b.document.documentElement;aa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=aa.css(a,"position"),l=aa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=aa.css(a,"top"),i=aa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),aa.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},aa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){aa.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,aa.contains(b,d)?(typeof d.getBoundingClientRect!==Aa&&(e=d.getBoundingClientRect()),c=Q(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===aa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),aa.nodeName(a[0],"html")||(d=a.offset()),d.top+=aa.css(a[0],"borderTopWidth",!0),d.left+=aa.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-aa.css(c,"marginTop",!0),left:b.left-d.left-aa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Kb;a&&!aa.nodeName(a,"html")&&"static"===aa.css(a,"position");)a=a.offsetParent;return a||Kb})}}),aa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d="pageYOffset"===c;aa.fn[a]=function(e){return ra(this,function(a,e,f){var g=Q(a);return void 0===f?g?g[c]:a[e]:void(g?g.scrollTo(d?b.pageXOffset:f,d?f:b.pageYOffset):a[e]=f)},a,e,arguments.length,null)}}),aa.each(["top","left"],function(a,b){aa.cssHooks[b]=x(Z.pixelPosition,function(a,c){return c?(c=w(a,b),Ra.test(c)?aa(a).position()[b]+"px":c):void 0})}),aa.each({Height:"height",Width:"width"},function(a,b){aa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){aa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return ra(this,function(b,c,d){var e;return aa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?aa.css(b,c,g):aa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),aa.fn.size=function(){return this.length},aa.fn.andSelf=aa.fn.addBack,"function"==typeof a&&a.amd&&a("jquery",[],function(){return aa});var Lb=b.jQuery,Mb=b.$;return aa.noConflict=function(a){return b.$===aa&&(b.$=Mb),a&&b.jQuery===aa&&(b.jQuery=Lb),aa},typeof c===Aa&&(b.jQuery=b.$=aa),aa})},{}],310:[function(b,c,d){!function(e,f){"function"==typeof b&&"object"==typeof d&&"object"==typeof c?c.exports=f():"function"==typeof a&&a.amd?a(function(){return f()}):e.pluralize=f()}(this,function(){function a(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}function b(a){return"string"==typeof a?new RegExp("^"+a+"$","i"):a}function c(b,c){return b===b.toUpperCase()?c.toUpperCase():b[0]===b[0].toUpperCase()?a(c):c.toLowerCase()}function d(a,b){return a.replace(/\$(\d{1,2})/g,function(a,c){return b[c]||""})}function e(a,b){if(!a.length||j.hasOwnProperty(a))return a;for(var e=b.length;e--;){var f=b[e];if(f[0].test(a))return a.replace(f[0],function(a,b,e){var g=d(f[1],arguments);return""===a?c(e[b-1],g):c(a,g)})}return a}function f(a,b,d){return function(f){var g=f.toLowerCase();return b.hasOwnProperty(g)?c(f,g):a.hasOwnProperty(g)?c(f,a[g]):e(f,d)}}function g(a,b,c){var d=1===b?g.singular(a):g.plural(a);return(c?b+" ":"")+d}var h=[],i=[],j={},k={},l={};return g.plural=f(l,k,h),g.singular=f(k,l,i),g.addPluralRule=function(a,c){h.push([b(a),c])},g.addSingularRule=function(a,c){i.push([b(a),c])},g.addUncountableRule=function(a){return"string"==typeof a?j[a.toLowerCase()]=!0:(g.addPluralRule(a,"$0"),void g.addSingularRule(a,"$0"))},g.addIrregularRule=function(a,b){b=b.toLowerCase(),a=a.toLowerCase(),l[a]=b,k[b]=a},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["thief","thieves"],["genie","genies"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach(function(a){return g.addIrregularRule(a[0],a[1])}),[[/s?$/i,"s"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\w+hedr)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(i)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"]].forEach(function(a){return g.addPluralRule(a[0],a[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(?:sis|ses)$/i,"$1sis"],[/(^analy)(?:sis|ses)$/i,"$1sis"],[/([^aeflor])ves$/i,"$1fe"],[/(hive|tive|dr?ive)s$/i,"$1"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(^[pl]|zomb|^(?:neck)?t|[aeo][lt]|cut)ies$/i,"$1ie"],[/([^c][eor]n|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(e[mn]u)s?$/i,"$1"],[/(movie|twelve)s$/i,"$1"],[/(cris|test|diagnos)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|\w+hedr)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(a){return g.addSingularRule(a[0],a[1])}),["advice","agenda","bison","bream","buffalo","carp","chassis","cod","cooperation","corps","digestion","debris","diabetes","energy","equipment","elk","excretion","expertise","flounder","gallows","graffiti","headquarters","health","herpes","highjinks","homework","information","jeans","justice","kudos","labour","machinery","mackerel","media","mews","moose","news","pike","plankton","pliers","pollution","premises","rain","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","trout","tuna","whiting","wildebeest","wildlife",/pox$/i,/ois$/i,/deer$/i,/fish$/i,/sheep$/i,/measles$/i,/[^aeiou]ese$/i].forEach(g.addUncountableRule),g})},{}],311:[function(a,b,c){!function(a){var b=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return"string"==typeof a},isNumber:function(a){return"number"==typeof a},isArray:a.isArray,isFunction:a.isFunction,isObject:a.isPlainObject,isUndefined:function(a){return"undefined"==typeof a},toStr:function(a){return b.isUndefined(a)||null===a?"":a+""},bind:a.proxy,each:function(b,c){function d(a,b){return c(b,a)}a.each(b,d)},map:a.map,filter:a.grep,every:function(b,c){var d=!0;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?void 0:!1}),!!d):d},some:function(b,c){var d=!1;return b?(a.each(b,function(a,e){return(d=c.call(null,e,a,b))?!1:void 0}),!!d):d},mixin:a.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function(b){function c(){return String(b)}return a.isFunction(b)?b:c},defer:function(a){setTimeout(a,0)},debounce:function(a,b,c){var d,e;return function(){var f,g,h=this,i=arguments;return f=function(){d=null,c||(e=a.apply(h,i))},g=c&&!d,clearTimeout(d),d=setTimeout(f,b),g&&(e=a.apply(h,i)),e}},throttle:function(a,b){var c,d,e,f,g,h;return g=0,h=function(){g=new Date,e=null,f=a.apply(c,d)},function(){var i=new Date,j=b-(i-g);return c=this,d=arguments,0>=j?(clearTimeout(e),e=null,g=i,f=a.apply(c,d)):e||(e=setTimeout(h,j)),f}},noop:function(){}}}(),c="0.10.5",d=function(){"use strict";function a(a){return a=b.toStr(a),a?a.split(/\s+/):[]}function c(a){return a=b.toStr(a),a?a.split(/\W+/):[]}function d(a){return function(){var c=[].slice.call(arguments,0);return function(d){var e=[];return b.each(c,function(c){e=e.concat(a(b.toStr(d[c])))}),e}}}return{nonword:c,whitespace:a,obj:{nonword:d(c),whitespace:d(a)}}}(),e=function(){"use strict";function c(c){this.maxSize=b.isNumber(c)?c:100,this.reset(),this.maxSize<=0&&(this.set=this.get=a.noop)}function d(){this.head=this.tail=null}function e(a,b){this.key=a,this.val=b,this.prev=this.next=null}return b.mixin(c.prototype,{set:function(a,b){var c,d=this.list.tail;this.size>=this.maxSize&&(this.list.remove(d),delete this.hash[d.key]),(c=this.hash[a])?(c.val=b,this.list.moveToFront(c)):(c=new e(a,b),this.list.add(c),this.hash[a]=c,this.size++)},get:function(a){var b=this.hash[a];return b?(this.list.moveToFront(b),b.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new d}}),b.mixin(d.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=a),this.head=a,this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next,a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a),this.add(a)}}),c}(),f=function(){"use strict";function a(a){this.prefix=["__",a,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+b.escapeRegExChars(this.prefix))}function c(){return(new Date).getTime()}function d(a){return JSON.stringify(b.isUndefined(a)?null:a)}function e(a){return JSON.parse(a)}var f,g;try{f=window.localStorage,f.setItem("~~~","!"),f.removeItem("~~~")}catch(h){f=null}return g=f&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){return this.isExpired(a)&&this.remove(a),e(f.getItem(this._prefix(a)))},set:function(a,e,g){return b.isNumber(g)?f.setItem(this._ttlKey(a),d(c()+g)):f.removeItem(this._ttlKey(a)),f.setItem(this._prefix(a),d(e))},remove:function(a){return f.removeItem(this._ttlKey(a)),f.removeItem(this._prefix(a)),this},clear:function(){var a,b,c=[],d=f.length;for(a=0;d>a;a++)(b=f.key(a)).match(this.keyMatcher)&&c.push(b.replace(this.keyMatcher,""));for(a=c.length;a--;)this.remove(c[a]);return this},isExpired:function(a){var d=e(f.getItem(this._ttlKey(a)));return b.isNumber(d)&&c()>d?!0:!1}}:{get:b.noop,set:b.noop,remove:b.noop,clear:b.noop,isExpired:b.noop},b.mixin(a.prototype,g),a}(),g=function(){"use strict";function c(b){b=b||{},this.cancelled=!1,this.lastUrl=null,this._send=b.transport?d(b.transport):a.ajax,this._get=b.rateLimiter?b.rateLimiter(this._get):this._get,this._cache=b.cache===!1?new e(0):i}function d(c){return function(d,e){function f(a){b.defer(function(){h.resolve(a)})}function g(a){b.defer(function(){h.reject(a)})}var h=a.Deferred();return c(d,e,f,g),h}}var f=0,g={},h=6,i=new e(10);return c.setMaxPendingRequests=function(a){h=a},c.resetCache=function(){i.reset()},b.mixin(c.prototype,{_get:function(a,b,c){function d(b){c&&c(null,b),k._cache.set(a,b)}function e(){c&&c(!0)}function i(){f--,delete g[a],k.onDeckRequestArgs&&(k._get.apply(k,k.onDeckRequestArgs),k.onDeckRequestArgs=null)}var j,k=this;this.cancelled||a!==this.lastUrl||((j=g[a])?j.done(d).fail(e):h>f?(f++,g[a]=this._send(a,b).done(d).fail(e).always(i)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(a,c,d){var e;return b.isFunction(c)&&(d=c,c={}),this.cancelled=!1,this.lastUrl=a,(e=this._cache.get(a))?b.defer(function(){d&&d(null,e)}):this._get(a,c,d),!!e},cancel:function(){this.cancelled=!0}}),c}(),h=function(){"use strict";function c(b){b=b||{},b.datumTokenizer&&b.queryTokenizer||a.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=b.datumTokenizer,this.queryTokenizer=b.queryTokenizer,this.reset()}function d(a){return a=b.filter(a,function(a){return!!a}),a=b.map(a,function(a){return a.toLowerCase()})}function e(){return{ids:[],children:{}}}function f(a){for(var b={},c=[],d=0,e=a.length;e>d;d++)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c}function g(a,b){function c(a,b){return a-b}var d=0,e=0,f=[];a=a.sort(c),b=b.sort(c);for(var g=a.length,h=b.length;g>d&&h>e;)a[d]<b[e]?d++:a[d]>b[e]?e++:(f.push(a[d]),d++,e++);return f}return b.mixin(c.prototype,{bootstrap:function(a){this.datums=a.datums,this.trie=a.trie},add:function(a){var c=this;a=b.isArray(a)?a:[a],b.each(a,function(a){var f,g;f=c.datums.push(a)-1,g=d(c.datumTokenizer(a)),b.each(g,function(a){var b,d,g;for(b=c.trie,d=a.split("");g=d.shift();)b=b.children[g]||(b.children[g]=e()),b.ids.push(f)})})},get:function(a){var c,e,h=this;return c=d(this.queryTokenizer(a)),b.each(c,function(a){var b,c,d,f;if(e&&0===e.length)return!1;for(b=h.trie,c=a.split("");b&&(d=c.shift());)b=b.children[d];return b&&0===c.length?(f=b.ids.slice(0),void(e=e?g(e,f):f)):(e=[],!1)}),e?b.map(f(e),function(a){return h.datums[a]}):[]},reset:function(){this.datums=[],this.trie=e()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),c}(),i=function(){"use strict";function d(a){return a.local||null}function e(d){var e,f;return f={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(e=d.prefetch||null)&&(e=b.isString(e)?{url:e}:e,e=b.mixin(f,e),e.thumbprint=c+e.thumbprint,e.ajax.type=e.ajax.type||"GET",e.ajax.dataType=e.ajax.dataType||"json",!e.url&&a.error("prefetch requires url to be set")),e}function f(c){function d(a){return function(c){return b.debounce(c,a)}}function e(a){return function(c){return b.throttle(c,a)}}var f,g;return g={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(f=c.remote||null)&&(f=b.isString(f)?{url:f}:f,f=b.mixin(g,f),f.rateLimiter=/^throttle$/i.test(f.rateLimitBy)?e(f.rateLimitWait):d(f.rateLimitWait),f.ajax.type=f.ajax.type||"GET",f.ajax.dataType=f.ajax.dataType||"json",delete f.rateLimitBy,delete f.rateLimitWait,!f.url&&a.error("remote requires url to be set")),f}return{local:d,prefetch:e,remote:f}}();!function(c){"use strict";function e(b){b&&(b.local||b.prefetch||b.remote)||a.error("one of local, prefetch, or remote is required"),this.limit=b.limit||5,this.sorter=j(b.sorter),this.dupDetector=b.dupDetector||k,this.local=i.local(b),this.prefetch=i.prefetch(b),this.remote=i.remote(b),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new h({datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer}),this.storage=this.cacheKey?new f(this.cacheKey):null}function j(a){function c(b){return b.sort(a)}function d(a){return a}return b.isFunction(a)?c:d}function k(){return!1}var l,m;return l=c.Bloodhound,m={data:"data",protocol:"protocol",thumbprint:"thumbprint"},c.Bloodhound=e,e.noConflict=function(){return c.Bloodhound=l,e},e.tokenizers=d,b.mixin(e.prototype,{_loadPrefetch:function(b){function c(a){f.clear(),f.add(b.filter?b.filter(a):a),f._saveToStorage(f.index.serialize(),b.thumbprint,b.ttl)}var d,e,f=this;return(d=this._readFromStorage(b.thumbprint))?(this.index.bootstrap(d),e=a.Deferred().resolve()):e=a.ajax(b.url,b.ajax).done(c),e},_getFromRemote:function(a,b){function c(a,c){b(a?[]:f.remote.filter?f.remote.filter(c):c)}var d,e,f=this;if(this.transport)return a=a||"",e=encodeURIComponent(a),d=this.remote.replace?this.remote.replace(this.remote.url,a):this.remote.url.replace(this.remote.wildcard,e),this.transport.get(d,this.remote.ajax,c)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(a,b,c){this.storage&&(this.storage.set(m.data,a,c),this.storage.set(m.protocol,location.protocol,c),this.storage.set(m.thumbprint,b,c))},_readFromStorage:function(a){var b,c={};return this.storage&&(c.data=this.storage.get(m.data),c.protocol=this.storage.get(m.protocol),c.thumbprint=this.storage.get(m.thumbprint)),b=c.thumbprint!==a||c.protocol!==location.protocol,c.data&&!b?c.data:null},_initialize:function(){function c(){e.add(b.isFunction(f)?f():f)}var d,e=this,f=this.local;return d=this.prefetch?this._loadPrefetch(this.prefetch):a.Deferred().resolve(),f&&d.done(c),this.transport=this.remote?new g(this.remote):null,this.initPromise=d.promise()},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a)},get:function(a,c){function d(a){var d=f.slice(0);b.each(a,function(a){var c;return c=b.some(d,function(b){return e.dupDetector(a,b)}),!c&&d.push(a),d.length<e.limit}),c&&c(e.sorter(d))}var e=this,f=[],g=!1;f=this.index.get(a),f=this.sorter(f).slice(0,this.limit),f.length<this.limit?g=this._getFromRemote(a,d):this._cancelLastRemoteRequest(),g||(f.length>0||!this.transport)&&c&&c(f)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&g.resetCache()},ttAdapter:function(){return b.bind(this.get,this)}}),e}(this);var j=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}(),k=function(){"use strict";var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return b.isMsie()&&b.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),b.isMsie()&&b.isMsie()<=7&&b.mixin(a.input,{marginTop:"-1px"}),a}(),l=function(){"use strict";function c(b){b&&b.el||a.error("EventBus initialized without el"),this.$el=a(b.el)}var d="typeahead:";return b.mixin(c.prototype,{trigger:function(a){var b=[].slice.call(arguments,1);this.$el.trigger(d+a,b)}}),c}(),m=function(){"use strict";function a(a,b,c,d){var e;if(!c)return this;for(b=b.split(i),c=d?h(c,d):c,this._callbacks=this._callbacks||{};e=b.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][a].push(c);return this}function b(b,c,d){return a.call(this,"async",b,c,d)}function c(b,c,d){return a.call(this,"sync",b,c,d)}function d(a){var b;if(!this._callbacks)return this;for(a=a.split(i);b=a.shift();)delete this._callbacks[b];return this}function e(a){var b,c,d,e,g;if(!this._callbacks)return this;for(a=a.split(i),d=[].slice.call(arguments,1);(b=a.shift())&&(c=this._callbacks[b]);)e=f(c.sync,this,[b].concat(d)),g=f(c.async,this,[b].concat(d)),e()&&j(g);return this}function f(a,b,c){function d(){for(var d,e=0,f=a.length;!d&&f>e;e+=1)d=a[e].apply(b,c)===!1;return!d}return d}function g(){var a;return a=window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}function h(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,0))}}var i=/\s+/,j=g();return{onSync:c,onAsync:b,off:d,trigger:e}}(),n=function(a){"use strict";function c(a,c,d){for(var e,f=[],g=0,h=a.length;h>g;g++)f.push(b.escapeRegExChars(a[g]));return e=d?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")",c?new RegExp(e):new RegExp(e,"i")}var d={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(e){function f(b){var c,d,f;return(c=h.exec(b.data))&&(f=a.createElement(e.tagName),e.className&&(f.className=e.className),d=b.splitText(c.index),d.splitText(c[0].length),f.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(f,d)),!!c}function g(a,b){for(var c,d=3,e=0;e<a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===d?e+=b(c)?1:0:g(c,b)}var h;e=b.mixin({},d,e),e.node&&e.pattern&&(e.pattern=b.isArray(e.pattern)?e.pattern:[e.pattern],h=c(e.pattern,e.caseSensitive,e.wordsOnly),g(e.node,f))}}(window.document),o=function(){"use strict";function c(c){var e,f,h,i,j=this;c=c||{},c.input||a.error("input is missing"),e=b.bind(this._onBlur,this),f=b.bind(this._onFocus,this),h=b.bind(this._onKeydown,this),i=b.bind(this._onInput,this),this.$hint=a(c.hint),this.$input=a(c.input).on("blur.tt",e).on("focus.tt",f).on("keydown.tt",h),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=b.noop),b.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){g[a.which||a.keyCode]||b.defer(b.bind(j._onInput,j,a))}):this.$input.on("input.tt",i),this.query=this.$input.val(),this.$overflowHelper=d(this.$input)}function d(b){return a('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:b.css("font-family"),fontSize:b.css("font-size"),fontStyle:b.css("font-style"),fontVariant:b.css("font-variant"),fontWeight:b.css("font-weight"),wordSpacing:b.css("word-spacing"),letterSpacing:b.css("letter-spacing"),textIndent:b.css("text-indent"),textRendering:b.css("text-rendering"),textTransform:b.css("text-transform")}).insertAfter(b)}function e(a,b){return c.normalizeQuery(a)===c.normalizeQuery(b)}function f(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var g;return g={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},c.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},b.mixin(c.prototype,m,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var b=g[a.which||a.keyCode];this._managePreventDefault(b,a),b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,b){var c,d,e;switch(a){case"tab":d=this.getHint(),e=this.getInputValue(),c=d&&d!==e&&!f(b);break;case"up":case"down":c=!f(b);break;default:c=!1}c&&b.preventDefault()},_shouldTrigger:function(a,b){var c;switch(a){case"tab":c=!f(b);break;default:c=!0}return c},_checkInputValue:function(){var a,b,c;a=this.getInputValue(),b=e(a,this.query),c=b?this.query.length!==a.length:!1,this.query=a,b?c&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,b){this.$input.val(a),b?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b,c,d;a=this.getInputValue(),b=this.getHint(),c=a!==b&&0===b.indexOf(a),d=""!==a&&c&&!this.hasOverflow(),!d&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c,d;return a=this.$input.val().length,c=this.$input[0].selectionStart,b.isNumber(c)?c===a:document.selection?(d=document.selection.createRange(),d.moveStart("character",-a),a===d.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),c}(),p=function(){"use strict";function c(c){c=c||{},c.templates=c.templates||{},c.source||a.error("missing source"),c.name&&!f(c.name)&&a.error("invalid dataset name: "+c.name),this.query=null,this.highlight=!!c.highlight,this.name=c.name||b.getUniqueId(),this.source=c.source,this.displayFn=d(c.display||c.displayKey),this.templates=e(c.templates,this.displayFn),this.$el=a(j.dataset.replace("%CLASS%",this.name))}function d(a){function c(b){return b[a]}return a=a||"value",b.isFunction(a)?a:c}function e(a,c){function d(a){return"<p>"+c(a)+"</p>"}return{empty:a.empty&&b.templatify(a.empty),header:a.header&&b.templatify(a.header),footer:a.footer&&b.templatify(a.footer),suggestion:a.suggestion||d}}function f(a){return/^[_a-zA-Z0-9-]+$/.test(a)}var g="ttDataset",h="ttValue",i="ttDatum";return c.extractDatasetName=function(b){return a(b).data(g)},c.extractValue=function(b){return a(b).data(h)},c.extractDatum=function(b){return a(b).data(i)},b.mixin(c.prototype,m,{_render:function(c,d){function e(){return p.templates.empty({query:c,isEmpty:!0})}function f(){function e(b){var c;return c=a(j.suggestion).append(p.templates.suggestion(b)).data(g,p.name).data(h,p.displayFn(b)).data(i,b),c.children().each(function(){a(this).css(k.suggestionChild)}),c}var f,l;return f=a(j.suggestions).css(k.suggestions),l=b.map(d,e),f.append.apply(f,l),p.highlight&&n({className:"tt-highlight",node:f[0],pattern:c}),f}function l(){return p.templates.header({query:c,isEmpty:!o})}function m(){return p.templates.footer({query:c,isEmpty:!o})}if(this.$el){var o,p=this;this.$el.empty(),o=d&&d.length,!o&&this.templates.empty?this.$el.html(e()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null):o&&this.$el.html(f()).prepend(p.templates.header?l():null).append(p.templates.footer?m():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){function b(b){c.canceled||a!==c.query||c._render(a,b)}var c=this;this.query=a,this.canceled=!1,this.source(a,b)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty");
},destroy:function(){this.$el=null}}),c}(),q=function(){"use strict";function c(c){var e,f,g,h=this;c=c||{},c.menu||a.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=b.map(c.datasets,d),e=b.bind(this._onSuggestionClick,this),f=b.bind(this._onSuggestionMouseEnter,this),g=b.bind(this._onSuggestionMouseLeave,this),this.$menu=a(c.menu).on("click.tt",".tt-suggestion",e).on("mouseenter.tt",".tt-suggestion",f).on("mouseleave.tt",".tt-suggestion",g),b.each(this.datasets,function(a){h.$menu.append(a.getRoot()),a.onSync("rendered",h._onRendered,h)})}function d(a){return new p(a)}return b.mixin(c.prototype,m,{_onSuggestionClick:function(b){this.trigger("suggestionClicked",a(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor(),this._setCursor(a(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function a(a){return a.isEmpty()}this.isEmpty=b.every(this.datasets,a),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(a,b){a.first().addClass("tt-cursor"),!b&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(a){var b,c,d,e;if(this.isOpen){if(c=this._getCursor(),b=this._getSuggestions(),this._removeCursor(),d=b.index(c)+a,d=(d+1)%(b.length+1)-1,-1===d)return void this.trigger("cursorRemoved");-1>d&&(d=b.length-1),this._setCursor(e=b.eq(d)),this._ensureVisible(e)}},_ensureVisible:function(a){var b,c,d,e;b=a.position().top,c=b+a.outerHeight(!0),d=this.$menu.scrollTop(),e=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>b?this.$menu.scrollTop(d+b):c>e&&this.$menu.scrollTop(d+(c-e))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(a){this.$menu.css("ltr"===a?k.ltr:k.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(a){var b=null;return a.length&&(b={raw:p.extractDatum(a),value:p.extractValue(a),datasetName:p.extractDatasetName(a)}),b},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(a){function c(b){b.update(a)}b.each(this.datasets,c)},empty:function(){function a(a){a.clear()}b.each(this.datasets,a),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function a(a){a.destroy()}this.$menu.off(".tt"),this.$menu=null,b.each(this.datasets,a)}}),c}(),r=function(){"use strict";function c(c){var e,f,g;c=c||{},c.input||a.error("missing input"),this.isActivated=!1,this.autoselect=!!c.autoselect,this.minLength=b.isNumber(c.minLength)?c.minLength:1,this.$node=d(c.input,c.withHint),e=this.$node.find(".tt-dropdown-menu"),f=this.$node.find(".tt-input"),g=this.$node.find(".tt-hint"),f.on("blur.tt",function(a){var c,d,g;c=document.activeElement,d=e.is(c),g=e.has(c).length>0,b.isMsie()&&(d||g)&&(a.preventDefault(),a.stopImmediatePropagation(),b.defer(function(){f.focus()}))}),e.on("mousedown.tt",function(a){a.preventDefault()}),this.eventBus=c.eventBus||new l({el:f}),this.dropdown=new q({menu:e,datasets:c.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new o({input:f,hint:g}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}function d(b,c){var d,f,h,i;d=a(b),f=a(j.wrapper).css(k.wrapper),h=a(j.dropdown).css(k.dropdown),i=d.clone().css(k.hint).css(e(d)),i.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),d.data(g,{dir:d.attr("dir"),autocomplete:d.attr("autocomplete"),spellcheck:d.attr("spellcheck"),style:d.attr("style")}),d.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(c?k.input:k.inputWithNoHint);try{!d.attr("dir")&&d.attr("dir","auto")}catch(l){}return d.wrap(f).parent().prepend(c?i:null).append(h)}function e(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function f(a){var c=a.find(".tt-input");b.each(c.data(g),function(a,d){b.isUndefined(a)?c.removeAttr(d):c.attr(d,a)}),c.detach().removeData(g).removeClass("tt-input").insertAfter(a),a.remove()}var g="ttAttrs";return b.mixin(c.prototype,{_onSuggestionClicked:function(a,b){var c;(c=this.dropdown.getDatumForSuggestion(b))&&this._select(c)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();this.input.setInputValue(a.value,!0),this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(a,b){var c,d;c=this.dropdown.getDatumForCursor(),d=this.dropdown.getDatumForTopSuggestion(),c?(this._select(c),b.preventDefault()):this.autoselect&&d&&(this._select(d),b.preventDefault())},_onTabKeyed:function(a,b){var c;(c=this.dropdown.getDatumForCursor())?(this._select(c),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid(),b.length>=this.minLength?this.dropdown.update(b):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var a;this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,c,d,e,f,g;a=this.dropdown.getDatumForTopSuggestion(),a&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(c=this.input.getInputValue(),d=o.normalizeQuery(c),e=b.escapeRegExChars(d),f=new RegExp("^(?:"+e+")(.+$)","i"),g=f.exec(a.value),g?this.input.setHint(c+g[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,c,d,e;b=this.input.getHint(),c=this.input.getQuery(),d=a||this.input.isCursorAtEnd(),b&&c!==b&&d&&(e=this.dropdown.getDatumForTopSuggestion(),e&&this.input.setInputValue(e.value),this.eventBus.trigger("autocompleted",e.raw,e.datasetName))},_select:function(a){this.input.setQuery(a.value),this.input.setInputValue(a.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",a.raw,a.datasetName),this.dropdown.close(),b.defer(b.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(a){a=b.toStr(a),this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),f(this.$node),this.$node=null}}),c}();!function(){"use strict";var c,d,e;c=a.fn.typeahead,d="ttTypeahead",e={initialize:function(c,e){function f(){var f,g,h=a(this);b.each(e,function(a){a.highlight=!!c.highlight}),g=new r({input:h,eventBus:f=new l({el:h}),withHint:b.isUndefined(c.hint)?!0:!!c.hint,minLength:c.minLength,autoselect:c.autoselect,datasets:e}),h.data(d,g)}return e=b.isArray(e)?e:[].slice.call(arguments,1),c=c||{},this.each(f)},open:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.open()}return this.each(b)},close:function(){function b(){var b,c=a(this);(b=c.data(d))&&b.close()}return this.each(b)},val:function(b){function c(){var c,e=a(this);(c=e.data(d))&&c.setVal(b)}function e(a){var b,c;return(b=a.data(d))&&(c=b.getVal()),c}return arguments.length?this.each(c):e(this.first())},destroy:function(){function b(){var b,c=a(this);(b=c.data(d))&&(b.destroy(),c.removeData(d))}return this.each(b)}},a.fn.typeahead=function(b){var c;return e[b]&&"initialize"!==b?(c=this.filter(function(){return!!a(this).data(d)}),e[b].apply(c,[].slice.call(arguments,1))):e.initialize.apply(this,arguments)},a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this}}()}(window.jQuery)},{}],312:[function(b,c,d){(function(){function b(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=w(d,f,4);var g=!D(c)&&v.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function e(a){return function(b,c,d){c=x(c,d);for(var e=C(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function f(a,b,c){return function(d,e,f){var g=0,h=C(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(n.call(d,g,h),v.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function g(a,b){var c=I.length,d=a.constructor,e=v.isFunction(d)&&d.prototype||k,f="constructor";for(v.has(a,f)&&!v.contains(b,f)&&b.push(f);c--;)f=I[c],f in a&&a[f]!==e[f]&&!v.contains(b,f)&&b.push(f)}var h=this,i=h._,j=Array.prototype,k=Object.prototype,l=Function.prototype,m=j.push,n=j.slice,o=k.toString,p=k.hasOwnProperty,q=Array.isArray,r=Object.keys,s=l.bind,t=Object.create,u=function(){},v=function(a){return a instanceof v?a:this instanceof v?void(this._wrapped=a):new v(a)};"undefined"!=typeof d?("undefined"!=typeof c&&c.exports&&(d=c.exports=v),d._=v):h._=v,v.VERSION="1.8.3";var w=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},x=function(a,b,c){return null==a?v.identity:v.isFunction(a)?w(a,b,c):v.isObject(a)?v.matcher(a):v.property(a)};v.iteratee=function(a,b){return x(a,b,1/0)};var y=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},z=function(a){if(!v.isObject(a))return{};if(t)return t(a);u.prototype=a;var b=new u;return u.prototype=null,b},A=function(a){return function(b){return null==b?void 0:b[a]}},B=Math.pow(2,53)-1,C=A("length"),D=function(a){var b=C(a);return"number"==typeof b&&b>=0&&B>=b};v.each=v.forEach=function(a,b,c){b=w(b,c);var d,e;if(D(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=v.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},v.map=v.collect=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},v.reduce=v.foldl=v.inject=b(1),v.reduceRight=v.foldr=b(-1),v.find=v.detect=function(a,b,c){var d;return d=D(a)?v.findIndex(a,b,c):v.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},v.filter=v.select=function(a,b,c){var d=[];return b=x(b,c),v.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},v.reject=function(a,b,c){return v.filter(a,v.negate(x(b)),c)},v.every=v.all=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},v.some=v.any=function(a,b,c){b=x(b,c);for(var d=!D(a)&&v.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},v.contains=v.includes=v.include=function(a,b,c,d){return D(a)||(a=v.values(a)),("number"!=typeof c||d)&&(c=0),v.indexOf(a,b,c)>=0},v.invoke=function(a,b){var c=n.call(arguments,2),d=v.isFunction(b);return v.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},v.pluck=function(a,b){return v.map(a,v.property(b))},v.where=function(a,b){return v.filter(a,v.matcher(b))},v.findWhere=function(a,b){return v.find(a,v.matcher(b))},v.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=D(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},v.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=D(a)?a:v.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=x(b,c),v.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},v.shuffle=function(a){for(var b,c=D(a)?a:v.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=v.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},v.sample=function(a,b,c){return null==b||c?(D(a)||(a=v.values(a)),a[v.random(a.length-1)]):v.shuffle(a).slice(0,Math.max(0,b))},v.sortBy=function(a,b,c){return b=x(b,c),v.pluck(v.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};return c=x(c,d),v.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};v.groupBy=E(function(a,b,c){v.has(a,c)?a[c].push(b):a[c]=[b]}),v.indexBy=E(function(a,b,c){a[c]=b}),v.countBy=E(function(a,b,c){v.has(a,c)?a[c]++:a[c]=1}),v.toArray=function(a){return a?v.isArray(a)?n.call(a):D(a)?v.map(a,v.identity):v.values(a):[]},v.size=function(a){return null==a?0:D(a)?a.length:v.keys(a).length},v.partition=function(a,b,c){b=x(b,c);var d=[],e=[];return v.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},v.first=v.head=v.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:v.initial(a,a.length-b)},v.initial=function(a,b,c){return n.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},v.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:v.rest(a,Math.max(0,a.length-b))},v.rest=v.tail=v.drop=function(a,b,c){return n.call(a,null==b||c?1:b)},v.compact=function(a){return v.filter(a,v.identity)};var F=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=C(a);h>g;g++){var i=a[g];if(D(i)&&(v.isArray(i)||v.isArguments(i))){b||(i=F(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};v.flatten=function(a,b){return F(a,b,!1)},v.without=function(a){return v.difference(a,n.call(arguments,1))},v.uniq=v.unique=function(a,b,c,d){v.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=x(c,d));for(var e=[],f=[],g=0,h=C(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?v.contains(f,j)||(f.push(j),e.push(i)):v.contains(e,i)||e.push(i)}return e},v.union=function(){return v.uniq(F(arguments,!0,!0))},v.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=C(a);e>d;d++){var f=a[d];if(!v.contains(b,f)){for(var g=1;c>g&&v.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},v.difference=function(a){var b=F(arguments,!0,!0,1);return v.filter(a,function(a){return!v.contains(b,a)})},v.zip=function(){return v.unzip(arguments)},v.unzip=function(a){for(var b=a&&v.max(a,C).length||0,c=Array(b),d=0;b>d;d++)c[d]=v.pluck(a,d);return c},v.object=function(a,b){for(var c={},d=0,e=C(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},v.findIndex=e(1),v.findLastIndex=e(-1),v.sortedIndex=function(a,b,c,d){c=x(c,d,1);for(var e=c(b),f=0,g=C(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},v.indexOf=f(1,v.findIndex,v.sortedIndex),v.lastIndexOf=f(-1,v.findLastIndex),v.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var G=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=z(a.prototype),g=a.apply(f,e);return v.isObject(g)?g:f};v.bind=function(a,b){if(s&&a.bind===s)return s.apply(a,n.call(arguments,1));if(!v.isFunction(a))throw new TypeError("Bind must be called on a function");var c=n.call(arguments,2),d=function(){return G(a,d,b,this,c.concat(n.call(arguments)))};return d},v.partial=function(a){var b=n.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===v?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return G(a,c,this,this,f)};return c},v.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=v.bind(a[c],a);return a},v.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return v.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},v.delay=function(a,b){var c=n.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},v.defer=v.partial(v.delay,v,1),v.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:v.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=v.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},v.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=v.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=v.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},v.wrap=function(a,b){return v.partial(b,a)},v.negate=function(a){return function(){return!a.apply(this,arguments)}},v.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},v.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},v.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},v.once=v.partial(v.before,2);var H=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];v.keys=function(a){if(!v.isObject(a))return[];if(r)return r(a);var b=[];for(var c in a)v.has(a,c)&&b.push(c);return H&&g(a,b),b},v.allKeys=function(a){if(!v.isObject(a))return[];var b=[];for(var c in a)b.push(c);return H&&g(a,b),b},v.values=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},v.mapObject=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},v.pairs=function(a){for(var b=v.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},v.invert=function(a){for(var b={},c=v.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},v.functions=v.methods=function(a){var b=[];for(var c in a)v.isFunction(a[c])&&b.push(c);return b.sort()},v.extend=y(v.allKeys),v.extendOwn=v.assign=y(v.keys),v.findKey=function(a,b,c){b=x(b,c);for(var d,e=v.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},v.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;v.isFunction(b)?(e=v.allKeys(g),d=w(b,c)):(e=F(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},v.omit=function(a,b,c){if(v.isFunction(b))b=v.negate(b);else{var d=v.map(F(arguments,!1,!1,1),String);b=function(a,b){return!v.contains(d,b)}}return v.pick(a,b,c)},v.defaults=y(v.allKeys,!0),v.create=function(a,b){var c=z(a);return b&&v.extendOwn(c,b),c},v.clone=function(a){return v.isObject(a)?v.isArray(a)?a.slice():v.extend({},a):a},v.tap=function(a,b){return b(a),a},v.isMatch=function(a,b){var c=v.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var J=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof v&&(a=a._wrapped),b instanceof v&&(b=b._wrapped);var e=o.call(a);if(e!==o.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(v.isFunction(g)&&g instanceof g&&v.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!J(a[i],b[i],c,d))return!1}else{var j,k=v.keys(a);if(i=k.length,v.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!v.has(b,j)||!J(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};v.isEqual=function(a,b){return J(a,b)},v.isEmpty=function(a){return null==a?!0:D(a)&&(v.isArray(a)||v.isString(a)||v.isArguments(a))?0===a.length:0===v.keys(a).length},v.isElement=function(a){return!(!a||1!==a.nodeType)},v.isArray=q||function(a){return"[object Array]"===o.call(a)},v.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},v.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){v["is"+a]=function(b){return o.call(b)==="[object "+a+"]"}}),v.isArguments(arguments)||(v.isArguments=function(a){return v.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(v.isFunction=function(a){return"function"==typeof a||!1}),v.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},v.isNaN=function(a){return v.isNumber(a)&&a!==+a},v.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===o.call(a)},v.isNull=function(a){return null===a},v.isUndefined=function(a){return void 0===a},v.has=function(a,b){return null!=a&&p.call(a,b)},v.noConflict=function(){return h._=i,this},v.identity=function(a){return a},v.constant=function(a){return function(){return a}},v.noop=function(){},v.property=A,v.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},v.matcher=v.matches=function(a){return a=v.extendOwn({},a),function(b){return v.isMatch(b,a)}},v.times=function(a,b,c){var d=Array(Math.max(0,a));b=w(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},v.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},v.now=Date.now||function(){return(new Date).getTime()};var K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},L=v.invert(K),M=function(a){var b=function(b){return a[b]},c="(?:"+v.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};v.escape=M(K),v.unescape=M(L),v.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),v.isFunction(d)?d.call(a):d};var N=0;v.uniqueId=function(a){var b=++N+"";return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var O=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Q=/\\|'|\r|\n|\u2028|\u2029/g,R=function(a){return"\\"+P[a]};v.template=function(a,b,c){!b&&c&&(b=c),b=v.defaults({},b,v.templateSettings);var d=RegExp([(b.escape||O).source,(b.interpolate||O).source,(b.evaluate||O).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(Q,R),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,v)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},v.chain=function(a){var b=v(a);return b._chain=!0,b};var S=function(a,b){return a._chain?v(b).chain():b};v.mixin=function(a){v.each(v.functions(a),function(b){var c=v[b]=a[b];v.prototype[b]=function(){var a=[this._wrapped];return m.apply(a,arguments),S(this,c.apply(v,a))}})},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=j[a];v.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],S(this,c)}}),v.each(["concat","join","slice"],function(a){var b=j[a];v.prototype[a]=function(){return S(this,b.apply(this._wrapped,arguments))}}),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return""+this._wrapped},"function"==typeof a&&a.amd&&a("underscore",[],function(){return v})}).call(this)},{}]},{},[15])(15)});